----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-04-27 16:52:51,220: rank0[3868616][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 27/1172 [00:00<00:04, 262.50 examples/s]Map:   5%|▍         | 55/1172 [00:00<00:04, 265.18 examples/s]Map:   7%|▋         | 83/1172 [00:00<00:04, 264.82 examples/s]Map:   9%|▉         | 111/1172 [00:00<00:03, 265.35 examples/s]Map:  12%|█▏        | 139/1172 [00:00<00:03, 266.31 examples/s]Map:  14%|█▍        | 167/1172 [00:00<00:03, 266.25 examples/s]Map:  17%|█▋        | 195/1172 [00:00<00:03, 267.15 examples/s]Map:  19%|█▉        | 223/1172 [00:00<00:03, 267.81 examples/s]Map:  21%|██▏       | 251/1172 [00:00<00:03, 266.93 examples/s]Map:  24%|██▍       | 279/1172 [00:01<00:03, 266.31 examples/s]Map:  26%|██▌       | 307/1172 [00:01<00:03, 267.05 examples/s]Map:  29%|██▊       | 335/1172 [00:01<00:03, 267.48 examples/s]Map:  31%|███       | 362/1172 [00:01<00:03, 265.83 examples/s]Map:  33%|███▎      | 390/1172 [00:01<00:02, 266.44 examples/s]Map:  36%|███▌      | 417/1172 [00:01<00:02, 264.27 examples/s]Map:  38%|███▊      | 445/1172 [00:01<00:02, 263.74 examples/s]Map:  40%|████      | 473/1172 [00:01<00:02, 263.61 examples/s]Map:  43%|████▎     | 501/1172 [00:01<00:02, 264.65 examples/s]Map:  45%|████▌     | 528/1172 [00:01<00:02, 263.11 examples/s]Map:  47%|████▋     | 556/1172 [00:02<00:02, 263.95 examples/s]Map:  50%|████▉     | 584/1172 [00:02<00:02, 263.65 examples/s]Map:  52%|█████▏    | 612/1172 [00:02<00:02, 264.88 examples/s]Map:  55%|█████▍    | 640/1172 [00:02<00:02, 264.97 examples/s]Map:  57%|█████▋    | 668/1172 [00:02<00:01, 265.45 examples/s]Map:  59%|█████▉    | 695/1172 [00:02<00:01, 262.96 examples/s]Map:  62%|██████▏   | 722/1172 [00:02<00:01, 262.45 examples/s]Map:  64%|██████▍   | 750/1172 [00:02<00:01, 263.59 examples/s]Map:  66%|██████▋   | 778/1172 [00:02<00:01, 264.24 examples/s]Map:  69%|██████▉   | 806/1172 [00:03<00:01, 264.35 examples/s]Map:  71%|███████   | 833/1172 [00:03<00:01, 261.08 examples/s]Map:  73%|███████▎  | 861/1172 [00:03<00:01, 261.47 examples/s]Map:  76%|███████▌  | 889/1172 [00:03<00:01, 262.41 examples/s]Map:  78%|███████▊  | 917/1172 [00:03<00:00, 261.90 examples/s]Map:  81%|████████  | 944/1172 [00:03<00:00, 261.42 examples/s]Map:  83%|████████▎ | 972/1172 [00:03<00:00, 263.40 examples/s]Map:  85%|████████▌ | 999/1172 [00:03<00:00, 262.44 examples/s]Map:  88%|████████▊ | 1026/1172 [00:04<00:01, 123.28 examples/s]Map:  90%|████████▉ | 1054/1172 [00:04<00:00, 146.99 examples/s]Map:  92%|█████████▏| 1082/1172 [00:04<00:00, 169.96 examples/s]Map:  95%|█████████▍| 1110/1172 [00:04<00:00, 190.99 examples/s]Map:  97%|█████████▋| 1136/1172 [00:04<00:00, 205.65 examples/s]Map:  99%|█████████▉| 1164/1172 [00:04<00:00, 220.94 examples/s]Map: 100%|██████████| 1172/1172 [00:04<00:00, 239.03 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 45/14042 [00:00<00:32, 433.98 examples/s]Map:   1%|          | 110/14042 [00:00<00:32, 426.01 examples/s]Map:   1%|          | 154/14042 [00:00<00:32, 427.26 examples/s]Map:   1%|▏         | 197/14042 [00:00<00:32, 427.96 examples/s]Map:   2%|▏         | 244/14042 [00:00<00:31, 439.74 examples/s]Map:   2%|▏         | 289/14042 [00:00<00:31, 439.35 examples/s]Map:   2%|▏         | 335/14042 [00:00<00:30, 445.04 examples/s]Map:   3%|▎         | 384/14042 [00:01<00:48, 281.35 examples/s]Map:   3%|▎         | 427/14042 [00:01<00:43, 310.98 examples/s]Map:   3%|▎         | 471/14042 [00:01<00:39, 339.94 examples/s]Map:   4%|▎         | 515/14042 [00:01<00:37, 363.33 examples/s]Map:   4%|▍         | 559/14042 [00:01<00:35, 381.76 examples/s]Map:   4%|▍         | 604/14042 [00:01<00:33, 398.63 examples/s]Map:   5%|▍         | 648/14042 [00:01<00:32, 407.97 examples/s]Map:   5%|▍         | 692/14042 [00:01<00:32, 414.67 examples/s]Map:   5%|▌         | 736/14042 [00:01<00:31, 419.11 examples/s]Map:   6%|▌         | 782/14042 [00:01<00:30, 429.02 examples/s]Map:   6%|▌         | 827/14042 [00:02<00:30, 429.68 examples/s]Map:   6%|▌         | 871/14042 [00:02<00:30, 430.34 examples/s]Map:   7%|▋         | 917/14042 [00:02<00:30, 435.00 examples/s]Map:   7%|▋         | 966/14042 [00:02<00:29, 448.38 examples/s]Map:   7%|▋         | 1021/14042 [00:02<01:00, 215.38 examples/s]Map:   8%|▊         | 1070/14042 [00:03<00:50, 258.25 examples/s]Map:   8%|▊         | 1120/14042 [00:03<00:42, 301.92 examples/s]Map:   8%|▊         | 1169/14042 [00:03<00:37, 339.66 examples/s]Map:   9%|▊         | 1217/14042 [00:03<00:34, 369.82 examples/s]Map:   9%|▉         | 1266/14042 [00:03<00:32, 395.98 examples/s]Map:   9%|▉         | 1313/14042 [00:03<00:30, 413.56 examples/s]Map:  10%|▉         | 1361/14042 [00:03<00:29, 428.22 examples/s]Map:  10%|█         | 1430/14042 [00:03<00:28, 436.75 examples/s]Map:  11%|█         | 1477/14042 [00:03<00:28, 442.28 examples/s]Map:  11%|█         | 1525/14042 [00:03<00:27, 448.55 examples/s]Map:  11%|█▏        | 1593/14042 [00:04<00:27, 447.37 examples/s]Map:  12%|█▏        | 1639/14042 [00:04<00:27, 448.14 examples/s]Map:  12%|█▏        | 1688/14042 [00:04<00:27, 454.50 examples/s]Map:  12%|█▏        | 1734/14042 [00:04<00:27, 452.96 examples/s]Map:  13%|█▎        | 1801/14042 [00:04<00:27, 448.50 examples/s]Map:  13%|█▎        | 1870/14042 [00:04<00:27, 449.55 examples/s]Map:  14%|█▍        | 1938/14042 [00:04<00:27, 447.22 examples/s]Map:  14%|█▍        | 1985/14042 [00:05<00:26, 450.67 examples/s]Map:  15%|█▍        | 2042/14042 [00:05<00:42, 282.18 examples/s]Map:  15%|█▍        | 2088/14042 [00:05<00:38, 312.34 examples/s]Map:  15%|█▌        | 2136/14042 [00:05<00:34, 343.83 examples/s]Map:  16%|█▌        | 2184/14042 [00:05<00:31, 372.57 examples/s]Map:  16%|█▌        | 2233/14042 [00:05<00:29, 398.80 examples/s]Map:  16%|█▌        | 2281/14042 [00:05<00:28, 417.40 examples/s]Map:  17%|█▋        | 2330/14042 [00:05<00:26, 435.46 examples/s]Map:  17%|█▋        | 2390/14042 [00:06<00:27, 419.72 examples/s]Map:  17%|█▋        | 2437/14042 [00:06<00:26, 431.27 examples/s]Map:  18%|█▊        | 2483/14042 [00:06<00:26, 436.81 examples/s]Map:  18%|█▊        | 2529/14042 [00:06<00:26, 438.44 examples/s]Map:  18%|█▊        | 2577/14042 [00:06<00:25, 444.62 examples/s]Map:  19%|█▊        | 2625/14042 [00:06<00:25, 451.39 examples/s]Map:  19%|█▉        | 2672/14042 [00:06<00:25, 453.48 examples/s]Map:  19%|█▉        | 2722/14042 [00:06<00:24, 463.39 examples/s]Map:  20%|█▉        | 2769/14042 [00:06<00:24, 461.87 examples/s]Map:  20%|██        | 2816/14042 [00:07<00:24, 462.87 examples/s]Map:  21%|██        | 2886/14042 [00:07<00:24, 459.79 examples/s]Map:  21%|██        | 2936/14042 [00:07<00:23, 465.31 examples/s]Map:  21%|██▏       | 2985/14042 [00:07<00:23, 468.10 examples/s]Map:  22%|██▏       | 3046/14042 [00:07<00:37, 296.78 examples/s]Map:  22%|██▏       | 3094/14042 [00:07<00:33, 329.91 examples/s]Map:  22%|██▏       | 3143/14042 [00:07<00:30, 361.27 examples/s]Map:  23%|██▎       | 3186/14042 [00:08<00:28, 375.12 examples/s]Map:  23%|██▎       | 3231/14042 [00:08<00:27, 390.20 examples/s]Map:  23%|██▎       | 3277/14042 [00:08<00:26, 406.16 examples/s]Map:  24%|██▎       | 3326/14042 [00:08<00:25, 424.47 examples/s]Map:  24%|██▍       | 3374/14042 [00:08<00:24, 436.60 examples/s]Map:  24%|██▍       | 3422/14042 [00:08<00:23, 446.50 examples/s]Map:  25%|██▍       | 3469/14042 [00:08<00:23, 449.59 examples/s]Map:  25%|██▌       | 3519/14042 [00:08<00:22, 461.12 examples/s]Map:  25%|██▌       | 3566/14042 [00:08<00:22, 462.41 examples/s]Map:  26%|██▌       | 3635/14042 [00:09<00:22, 457.96 examples/s]Map:  26%|██▋       | 3704/14042 [00:09<00:22, 455.57 examples/s]Map:  27%|██▋       | 3752/14042 [00:09<00:22, 458.32 examples/s]Map:  27%|██▋       | 3800/14042 [00:09<00:22, 461.13 examples/s]Map:  28%|██▊       | 3870/14042 [00:09<00:22, 461.48 examples/s]Map:  28%|██▊       | 3939/14042 [00:09<00:22, 458.02 examples/s]Map:  28%|██▊       | 3985/14042 [00:09<00:22, 456.50 examples/s]Map:  29%|██▉       | 4045/14042 [00:10<00:33, 296.37 examples/s]Map:  29%|██▉       | 4091/14042 [00:10<00:30, 324.34 examples/s]Map:  29%|██▉       | 4138/14042 [00:10<00:28, 352.38 examples/s]Map:  30%|██▉       | 4186/14042 [00:10<00:25, 380.09 examples/s]Map:  30%|███       | 4236/14042 [00:10<00:24, 404.09 examples/s]Map:  30%|███       | 4281/14042 [00:10<00:23, 413.10 examples/s]Map:  31%|███       | 4327/14042 [00:10<00:22, 422.80 examples/s]Map:  31%|███       | 4374/14042 [00:10<00:22, 432.52 examples/s]Map:  32%|███▏      | 4440/14042 [00:11<00:22, 432.61 examples/s]Map:  32%|███▏      | 4489/14042 [00:11<00:21, 444.98 examples/s]Map:  32%|███▏      | 4550/14042 [00:11<00:22, 427.45 examples/s]Map:  33%|███▎      | 4609/14042 [00:11<00:22, 414.11 examples/s]Map:  33%|███▎      | 4668/14042 [00:11<00:23, 402.46 examples/s]Map:  34%|███▎      | 4727/14042 [00:11<00:23, 396.45 examples/s]Map:  34%|███▍      | 4774/14042 [00:11<00:22, 411.01 examples/s]Map:  34%|███▍      | 4821/14042 [00:11<00:21, 423.59 examples/s]Map:  35%|███▍      | 4870/14042 [00:12<00:20, 437.07 examples/s]Map:  35%|███▌      | 4920/14042 [00:12<00:20, 450.26 examples/s]Map:  35%|███▌      | 4967/14042 [00:12<00:20, 452.98 examples/s]Map:  36%|███▌      | 5022/14042 [00:12<00:42, 212.97 examples/s]Map:  36%|███▌      | 5068/14042 [00:12<00:35, 249.48 examples/s]Map:  36%|███▋      | 5107/14042 [00:13<00:32, 272.38 examples/s]Map:  37%|███▋      | 5147/14042 [00:13<00:30, 295.42 examples/s]Map:  37%|███▋      | 5204/14042 [00:13<00:27, 319.06 examples/s]Map:  37%|███▋      | 5245/14042 [00:13<00:26, 337.43 examples/s]Map:  38%|███▊      | 5294/14042 [00:13<00:23, 371.41 examples/s]Map:  38%|███▊      | 5344/14042 [00:13<00:21, 400.13 examples/s]Map:  38%|███▊      | 5390/14042 [00:13<00:20, 413.04 examples/s]Map:  39%|███▊      | 5435/14042 [00:13<00:20, 420.38 examples/s]Map:  39%|███▉      | 5482/14042 [00:13<00:19, 429.85 examples/s]Map:  39%|███▉      | 5533/14042 [00:14<00:18, 447.86 examples/s]Map:  40%|███▉      | 5581/14042 [00:14<00:18, 454.49 examples/s]Map:  40%|████      | 5629/14042 [00:14<00:18, 459.72 examples/s]Map:  40%|████      | 5676/14042 [00:14<00:18, 458.35 examples/s]Map:  41%|████      | 5725/14042 [00:14<00:17, 464.27 examples/s]Map:  41%|████▏     | 5793/14042 [00:14<00:18, 457.50 examples/s]Map:  42%|████▏     | 5862/14042 [00:14<00:17, 454.86 examples/s]Map:  42%|████▏     | 5928/14042 [00:14<00:18, 446.38 examples/s]Map:  43%|████▎     | 5988/14042 [00:15<00:18, 425.43 examples/s]Map:  43%|████▎     | 6042/14042 [00:15<00:28, 282.43 examples/s]Map:  43%|████▎     | 6083/14042 [00:15<00:26, 303.11 examples/s]Map:  44%|████▎     | 6123/14042 [00:15<00:24, 319.90 examples/s]Map:  44%|████▍     | 6164/14042 [00:15<00:23, 336.95 examples/s]Map:  44%|████▍     | 6204/14042 [00:15<00:22, 349.52 examples/s]Map:  44%|████▍     | 6243/14042 [00:15<00:21, 357.63 examples/s]Map:  45%|████▍     | 6283/14042 [00:16<00:21, 366.22 examples/s]Map:  45%|████▌     | 6323/14042 [00:16<00:20, 373.42 examples/s]Map:  45%|████▌     | 6364/14042 [00:16<00:20, 380.45 examples/s]Map:  46%|████▌     | 6407/14042 [00:16<00:19, 390.13 examples/s]Map:  46%|████▌     | 6449/14042 [00:16<00:19, 395.38 examples/s]Map:  46%|████▋     | 6508/14042 [00:16<00:19, 391.32 examples/s]Map:  47%|████▋     | 6549/14042 [00:16<00:18, 395.12 examples/s]Map:  47%|████▋     | 6591/14042 [00:16<00:18, 398.32 examples/s]Map:  47%|████▋     | 6650/14042 [00:16<00:18, 389.39 examples/s]Map:  48%|████▊     | 6690/14042 [00:17<00:18, 391.00 examples/s]Map:  48%|████▊     | 6730/14042 [00:17<00:18, 390.13 examples/s]Map:  48%|████▊     | 6771/14042 [00:17<00:18, 391.39 examples/s]Map:  49%|████▊     | 6832/14042 [00:17<00:18, 391.75 examples/s]Map:  49%|████▉     | 6873/14042 [00:17<00:18, 393.48 examples/s]Map:  49%|████▉     | 6933/14042 [00:17<00:18, 394.16 examples/s]Map:  50%|████▉     | 6974/14042 [00:17<00:17, 394.27 examples/s]Map:  50%|████▉     | 7019/14042 [00:18<00:28, 248.35 examples/s]Map:  50%|█████     | 7060/14042 [00:18<00:25, 276.17 examples/s]Map:  51%|█████     | 7102/14042 [00:18<00:22, 304.89 examples/s]Map:  51%|█████     | 7142/14042 [00:18<00:21, 324.19 examples/s]Map:  51%|█████     | 7185/14042 [00:18<00:19, 347.72 examples/s]Map:  51%|█████▏    | 7229/14042 [00:18<00:18, 368.82 examples/s]Map:  52%|█████▏    | 7283/14042 [00:18<00:18, 362.98 examples/s]Map:  52%|█████▏    | 7324/14042 [00:18<00:20, 330.49 examples/s]Map:  52%|█████▏    | 7365/14042 [00:19<00:21, 308.33 examples/s]Map:  53%|█████▎    | 7409/14042 [00:19<00:22, 300.29 examples/s]Map:  53%|█████▎    | 7460/14042 [00:19<00:21, 308.58 examples/s]Map:  53%|█████▎    | 7508/14042 [00:19<00:18, 344.18 examples/s]Map:  54%|█████▍    | 7554/14042 [00:19<00:17, 371.42 examples/s]Map:  54%|█████▍    | 7603/14042 [00:19<00:16, 399.10 examples/s]Map:  54%|█████▍    | 7651/14042 [00:19<00:15, 417.31 examples/s]Map:  55%|█████▍    | 7701/14042 [00:19<00:14, 434.35 examples/s]Map:  55%|█████▌    | 7749/14042 [00:20<00:14, 445.16 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2179 > 2048). Running this sequence through the model will result in indexing errors
Map:  56%|█████▌    | 7795/14042 [00:20<00:13, 446.56 examples/s]Map:  56%|█████▌    | 7842/14042 [00:20<00:13, 450.85 examples/s]Map:  56%|█████▌    | 7891/14042 [00:20<00:13, 457.64 examples/s]Map:  57%|█████▋    | 7941/14042 [00:20<00:13, 464.28 examples/s]Map:  57%|█████▋    | 7988/14042 [00:20<00:13, 463.53 examples/s]Map:  57%|█████▋    | 8046/14042 [00:20<00:21, 284.46 examples/s]Map:  58%|█████▊    | 8094/14042 [00:21<00:18, 321.20 examples/s]Map:  58%|█████▊    | 8140/14042 [00:21<00:16, 350.47 examples/s]Map:  58%|█████▊    | 8190/14042 [00:21<00:15, 383.69 examples/s]Map:  59%|█████▊    | 8239/14042 [00:21<00:14, 407.60 examples/s]Map:  59%|█████▉    | 8287/14042 [00:21<00:13, 424.31 examples/s]Map:  59%|█████▉    | 8334/14042 [00:21<00:13, 434.14 examples/s]Map:  60%|█████▉    | 8382/14042 [00:21<00:12, 444.38 examples/s]Map:  60%|██████    | 8429/14042 [00:21<00:12, 450.80 examples/s]Map:  60%|██████    | 8477/14042 [00:21<00:12, 454.78 examples/s]Map:  61%|██████    | 8524/14042 [00:21<00:12, 453.76 examples/s]Map:  61%|██████    | 8571/14042 [00:22<00:11, 456.14 examples/s]Map:  61%|██████▏   | 8619/14042 [00:22<00:11, 461.34 examples/s]Map:  62%|██████▏   | 8688/14042 [00:22<00:11, 455.82 examples/s]Map:  62%|██████▏   | 8734/14042 [00:22<00:11, 451.88 examples/s]Map:  63%|██████▎   | 8780/14042 [00:22<00:11, 450.65 examples/s]Map:  63%|██████▎   | 8827/14042 [00:22<00:11, 454.02 examples/s]Map:  63%|██████▎   | 8875/14042 [00:22<00:11, 459.19 examples/s]Map:  64%|██████▎   | 8923/14042 [00:22<00:11, 464.22 examples/s]Map:  64%|██████▍   | 8972/14042 [00:22<00:10, 468.60 examples/s]Map:  64%|██████▍   | 9021/14042 [00:23<00:17, 287.55 examples/s]Map:  65%|██████▍   | 9069/14042 [00:23<00:15, 324.55 examples/s]Map:  65%|██████▍   | 9118/14042 [00:23<00:13, 359.13 examples/s]Map:  65%|██████▌   | 9165/14042 [00:23<00:12, 382.93 examples/s]Map:  66%|██████▌   | 9213/14042 [00:23<00:11, 406.79 examples/s]Map:  66%|██████▌   | 9259/14042 [00:23<00:11, 419.47 examples/s]Map:  66%|██████▋   | 9307/14042 [00:23<00:10, 433.85 examples/s]Map:  67%|██████▋   | 9356/14042 [00:23<00:10, 447.40 examples/s]Map:  67%|██████▋   | 9414/14042 [00:24<00:10, 422.31 examples/s]Map:  67%|██████▋   | 9463/14042 [00:24<00:10, 436.96 examples/s]Map:  68%|██████▊   | 9513/14042 [00:24<00:10, 452.18 examples/s]Map:  68%|██████▊   | 9577/14042 [00:24<00:10, 437.30 examples/s]Map:  69%|██████▊   | 9636/14042 [00:24<00:10, 418.13 examples/s]Map:  69%|██████▉   | 9694/14042 [00:24<00:10, 405.19 examples/s]Map:  69%|██████▉   | 9747/14042 [00:25<00:15, 283.92 examples/s]Map:  70%|██████▉   | 9787/14042 [00:25<00:14, 303.19 examples/s]Map:  70%|██████▉   | 9829/14042 [00:25<00:12, 326.73 examples/s]Map:  70%|███████   | 9872/14042 [00:25<00:11, 349.11 examples/s]Map:  71%|███████   | 9916/14042 [00:25<00:11, 369.20 examples/s]Map:  71%|███████   | 9961/14042 [00:25<00:10, 387.11 examples/s]Map:  71%|███████▏  | 10020/14042 [00:25<00:16, 247.40 examples/s]Map:  72%|███████▏  | 10068/14042 [00:26<00:13, 286.70 examples/s]Map:  72%|███████▏  | 10118/14042 [00:26<00:11, 327.50 examples/s]Map:  72%|███████▏  | 10164/14042 [00:26<00:10, 353.54 examples/s]Map:  73%|███████▎  | 10212/14042 [00:26<00:10, 380.03 examples/s]Map:  73%|███████▎  | 10259/14042 [00:26<00:09, 399.89 examples/s]Map:  73%|███████▎  | 10306/14042 [00:26<00:08, 417.95 examples/s]Map:  74%|███████▎  | 10352/14042 [00:26<00:08, 425.88 examples/s]Map:  74%|███████▍  | 10398/14042 [00:26<00:08, 431.97 examples/s]Map:  75%|███████▍  | 10463/14042 [00:26<00:08, 431.17 examples/s]Map:  75%|███████▍  | 10508/14042 [00:27<00:08, 434.18 examples/s]Map:  75%|███████▌  | 10554/14042 [00:27<00:07, 437.56 examples/s]Map:  76%|███████▌  | 10602/14042 [00:27<00:07, 446.57 examples/s]Map:  76%|███████▌  | 10651/14042 [00:27<00:07, 453.49 examples/s]Map:  76%|███████▌  | 10698/14042 [00:27<00:07, 455.55 examples/s]Map:  77%|███████▋  | 10746/14042 [00:27<00:07, 459.19 examples/s]Map:  77%|███████▋  | 10793/14042 [00:27<00:07, 457.60 examples/s]Map:  77%|███████▋  | 10841/14042 [00:27<00:06, 461.63 examples/s]Map:  78%|███████▊  | 10889/14042 [00:27<00:06, 462.75 examples/s]Map:  78%|███████▊  | 10959/14042 [00:28<00:06, 460.99 examples/s]Map:  78%|███████▊  | 11022/14042 [00:28<00:10, 297.09 examples/s]Map:  79%|███████▉  | 11070/14042 [00:28<00:09, 328.28 examples/s]Map:  79%|███████▉  | 11119/14042 [00:28<00:08, 360.21 examples/s]Map:  80%|███████▉  | 11167/14042 [00:28<00:07, 385.35 examples/s]Map:  80%|███████▉  | 11215/14042 [00:28<00:06, 406.54 examples/s]Map:  80%|████████  | 11279/14042 [00:28<00:06, 410.44 examples/s]Map:  81%|████████  | 11323/14042 [00:29<00:06, 416.31 examples/s]Map:  81%|████████  | 11387/14042 [00:29<00:06, 414.90 examples/s]Map:  82%|████████▏ | 11452/14042 [00:29<00:06, 416.53 examples/s]Map:  82%|████████▏ | 11498/14042 [00:29<00:05, 424.62 examples/s]Map:  82%|████████▏ | 11546/14042 [00:29<00:05, 436.19 examples/s]Map:  83%|████████▎ | 11593/14042 [00:29<00:05, 443.71 examples/s]Map:  83%|████████▎ | 11639/14042 [00:29<00:05, 447.73 examples/s]Map:  83%|████████▎ | 11689/14042 [00:29<00:05, 460.96 examples/s]Map:  84%|████████▎ | 11740/14042 [00:29<00:04, 472.19 examples/s]Map:  84%|████████▍ | 11788/14042 [00:30<00:04, 472.05 examples/s]Map:  84%|████████▍ | 11837/14042 [00:30<00:04, 474.49 examples/s]Map:  85%|████████▍ | 11885/14042 [00:30<00:04, 472.37 examples/s]Map:  85%|████████▍ | 11933/14042 [00:30<00:04, 468.02 examples/s]Map:  85%|████████▌ | 11985/14042 [00:30<00:04, 479.24 examples/s]Map:  86%|████████▌ | 12045/14042 [00:30<00:06, 296.98 examples/s]Map:  86%|████████▌ | 12094/14042 [00:30<00:05, 333.67 examples/s]Map:  86%|████████▋ | 12140/14042 [00:31<00:05, 359.57 examples/s]Map:  87%|████████▋ | 12188/14042 [00:31<00:04, 385.61 examples/s]Map:  87%|████████▋ | 12236/14042 [00:31<00:04, 406.30 examples/s]Map:  87%|████████▋ | 12285/14042 [00:31<00:04, 425.08 examples/s]Map:  88%|████████▊ | 12332/14042 [00:31<00:03, 434.33 examples/s]Map:  88%|████████▊ | 12380/14042 [00:31<00:03, 445.36 examples/s]Map:  88%|████████▊ | 12427/14042 [00:31<00:03, 448.52 examples/s]Map:  89%|████████▉ | 12476/14042 [00:31<00:03, 456.28 examples/s]Map:  89%|████████▉ | 12524/14042 [00:31<00:03, 460.50 examples/s]Map:  90%|████████▉ | 12594/14042 [00:32<00:03, 457.83 examples/s]Map:  90%|█████████ | 12642/14042 [00:32<00:03, 460.01 examples/s]Map:  90%|█████████ | 12690/14042 [00:32<00:02, 462.33 examples/s]Map:  91%|█████████ | 12737/14042 [00:32<00:02, 460.18 examples/s]Map:  91%|█████████ | 12806/14042 [00:32<00:02, 456.48 examples/s]Map:  92%|█████████▏| 12855/14042 [00:32<00:02, 462.81 examples/s]Map:  92%|█████████▏| 12903/14042 [00:32<00:02, 464.64 examples/s]Map:  92%|█████████▏| 12950/14042 [00:32<00:02, 465.08 examples/s]Map:  93%|█████████▎| 12998/14042 [00:32<00:02, 465.55 examples/s]Map:  93%|█████████▎| 13047/14042 [00:33<00:03, 289.70 examples/s]Map:  93%|█████████▎| 13095/14042 [00:33<00:02, 326.64 examples/s]Map:  94%|█████████▎| 13142/14042 [00:33<00:02, 356.80 examples/s]Map:  94%|█████████▍| 13192/14042 [00:33<00:02, 388.46 examples/s]Map:  94%|█████████▍| 13239/14042 [00:33<00:01, 406.60 examples/s]Map:  95%|█████████▍| 13288/14042 [00:33<00:01, 426.55 examples/s]Map:  95%|█████████▍| 13335/14042 [00:33<00:01, 435.70 examples/s]Map:  95%|█████████▌| 13384/14042 [00:33<00:01, 448.36 examples/s]Map:  96%|█████████▌| 13447/14042 [00:34<00:01, 434.54 examples/s]Map:  96%|█████████▌| 13495/14042 [00:34<00:01, 442.39 examples/s]Map:  97%|█████████▋| 13564/14042 [00:34<00:01, 444.95 examples/s]Map:  97%|█████████▋| 13615/14042 [00:34<00:00, 458.41 examples/s]Map:  97%|█████████▋| 13686/14042 [00:34<00:00, 459.77 examples/s]Map:  98%|█████████▊| 13734/14042 [00:34<00:00, 461.85 examples/s]Map:  98%|█████████▊| 13782/14042 [00:34<00:00, 465.57 examples/s]Map:  99%|█████████▊| 13832/14042 [00:34<00:00, 469.64 examples/s]Map:  99%|█████████▉| 13880/14042 [00:34<00:00, 471.36 examples/s]Map:  99%|█████████▉| 13930/14042 [00:35<00:00, 476.34 examples/s]Map: 100%|█████████▉| 14000/14042 [00:35<00:00, 302.51 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 321.20 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 394.62 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 35/10042 [00:00<00:30, 329.38 examples/s]Map:   1%|          | 84/10042 [00:00<00:31, 320.81 examples/s]Map:   1%|          | 118/10042 [00:00<00:30, 324.72 examples/s]Map:   2%|▏         | 152/10042 [00:00<00:30, 325.66 examples/s]Map:   2%|▏         | 187/10042 [00:00<00:29, 330.74 examples/s]Map:   2%|▏         | 221/10042 [00:00<00:29, 329.10 examples/s]Map:   3%|▎         | 255/10042 [00:00<00:29, 329.64 examples/s]Map:   3%|▎         | 292/10042 [00:01<00:45, 215.75 examples/s]Map:   3%|▎         | 327/10042 [00:01<00:39, 243.56 examples/s]Map:   4%|▎         | 364/10042 [00:01<00:35, 270.53 examples/s]Map:   4%|▍         | 400/10042 [00:01<00:33, 289.70 examples/s]Map:   4%|▍         | 436/10042 [00:01<00:31, 304.61 examples/s]Map:   5%|▍         | 472/10042 [00:01<00:30, 317.01 examples/s]Map:   5%|▌         | 508/10042 [00:01<00:29, 326.40 examples/s]Map:   5%|▌         | 544/10042 [00:01<00:28, 332.18 examples/s]Map:   6%|▌         | 580/10042 [00:01<00:28, 337.50 examples/s]Map:   6%|▌         | 615/10042 [00:01<00:27, 339.52 examples/s]Map:   6%|▋         | 650/10042 [00:02<00:27, 338.63 examples/s]Map:   7%|▋         | 700/10042 [00:02<00:27, 334.62 examples/s]Map:   7%|▋         | 735/10042 [00:02<00:27, 336.38 examples/s]Map:   8%|▊         | 771/10042 [00:02<00:27, 337.55 examples/s]Map:   8%|▊         | 806/10042 [00:02<00:27, 339.39 examples/s]Map:   8%|▊         | 841/10042 [00:02<00:27, 340.14 examples/s]Map:   9%|▊         | 877/10042 [00:02<00:26, 342.26 examples/s]Map:   9%|▉         | 913/10042 [00:02<00:26, 342.75 examples/s]Map:   9%|▉         | 948/10042 [00:02<00:26, 342.89 examples/s]Map:  10%|▉         | 983/10042 [00:03<00:26, 342.14 examples/s]Map:  10%|█         | 1034/10042 [00:03<00:51, 175.07 examples/s]Map:  11%|█         | 1070/10042 [00:03<00:44, 203.12 examples/s]Map:  11%|█         | 1106/10042 [00:03<00:38, 230.35 examples/s]Map:  11%|█▏        | 1142/10042 [00:03<00:34, 256.14 examples/s]Map:  12%|█▏        | 1178/10042 [00:04<00:31, 277.09 examples/s]Map:  12%|█▏        | 1214/10042 [00:04<00:29, 295.92 examples/s]Map:  12%|█▏        | 1250/10042 [00:04<00:28, 310.13 examples/s]Map:  13%|█▎        | 1286/10042 [00:04<00:27, 320.16 examples/s]Map:  13%|█▎        | 1321/10042 [00:04<00:26, 326.18 examples/s]Map:  14%|█▎        | 1357/10042 [00:04<00:26, 331.56 examples/s]Map:  14%|█▍        | 1393/10042 [00:04<00:25, 336.75 examples/s]Map:  14%|█▍        | 1428/10042 [00:04<00:25, 336.71 examples/s]Map:  15%|█▍        | 1464/10042 [00:04<00:25, 338.68 examples/s]Map:  15%|█▍        | 1500/10042 [00:04<00:24, 342.00 examples/s]Map:  15%|█▌        | 1536/10042 [00:05<00:24, 343.10 examples/s]Map:  16%|█▌        | 1571/10042 [00:05<00:24, 343.03 examples/s]Map:  16%|█▌        | 1607/10042 [00:05<00:24, 343.56 examples/s]Map:  16%|█▋        | 1643/10042 [00:05<00:24, 343.88 examples/s]Map:  17%|█▋        | 1678/10042 [00:05<00:24, 342.98 examples/s]Map:  17%|█▋        | 1714/10042 [00:05<00:24, 343.07 examples/s]Map:  17%|█▋        | 1750/10042 [00:05<00:24, 342.97 examples/s]Map:  18%|█▊        | 1801/10042 [00:05<00:24, 340.08 examples/s]Map:  18%|█▊        | 1836/10042 [00:05<00:24, 339.82 examples/s]Map:  19%|█▊        | 1872/10042 [00:06<00:23, 342.29 examples/s]Map:  19%|█▉        | 1908/10042 [00:06<00:23, 343.15 examples/s]Map:  19%|█▉        | 1944/10042 [00:06<00:23, 342.50 examples/s]Map:  20%|█▉        | 1980/10042 [00:06<00:23, 343.93 examples/s]Map:  20%|██        | 2016/10042 [00:06<00:38, 210.27 examples/s]Map:  20%|██        | 2052/10042 [00:06<00:33, 238.46 examples/s]Map:  21%|██        | 2087/10042 [00:06<00:30, 261.15 examples/s]Map:  21%|██        | 2122/10042 [00:06<00:28, 281.80 examples/s]Map:  21%|██▏       | 2157/10042 [00:07<00:26, 297.56 examples/s]Map:  22%|██▏       | 2192/10042 [00:07<00:25, 309.95 examples/s]Map:  22%|██▏       | 2226/10042 [00:07<00:24, 316.01 examples/s]Map:  23%|██▎       | 2261/10042 [00:07<00:24, 322.62 examples/s]Map:  23%|██▎       | 2297/10042 [00:07<00:23, 331.84 examples/s]Map:  23%|██▎       | 2333/10042 [00:07<00:22, 336.02 examples/s]Map:  24%|██▎       | 2369/10042 [00:07<00:22, 340.90 examples/s]Map:  24%|██▍       | 2404/10042 [00:07<00:22, 341.71 examples/s]Map:  24%|██▍       | 2440/10042 [00:07<00:22, 343.16 examples/s]Map:  25%|██▍       | 2476/10042 [00:08<00:21, 343.92 examples/s]Map:  25%|██▌       | 2512/10042 [00:08<00:21, 347.02 examples/s]Map:  25%|██▌       | 2548/10042 [00:08<00:21, 346.29 examples/s]Map:  26%|██▌       | 2583/10042 [00:08<00:21, 345.18 examples/s]Map:  26%|██▌       | 2634/10042 [00:08<00:21, 342.28 examples/s]Map:  27%|██▋       | 2686/10042 [00:08<00:21, 340.00 examples/s]Map:  27%|██▋       | 2737/10042 [00:08<00:21, 337.32 examples/s]Map:  28%|██▊       | 2773/10042 [00:08<00:21, 339.31 examples/s]Map:  28%|██▊       | 2808/10042 [00:08<00:21, 340.78 examples/s]Map:  28%|██▊       | 2843/10042 [00:09<00:21, 339.81 examples/s]Map:  29%|██▊       | 2879/10042 [00:09<00:20, 341.74 examples/s]Map:  29%|██▉       | 2915/10042 [00:09<00:20, 341.39 examples/s]Map:  30%|██▉       | 2966/10042 [00:09<00:20, 340.11 examples/s]Map:  30%|███       | 3016/10042 [00:09<00:31, 226.22 examples/s]Map:  30%|███       | 3052/10042 [00:09<00:28, 248.84 examples/s]Map:  31%|███       | 3088/10042 [00:10<00:25, 268.43 examples/s]Map:  31%|███       | 3124/10042 [00:10<00:24, 286.70 examples/s]Map:  31%|███▏      | 3159/10042 [00:10<00:22, 299.72 examples/s]Map:  32%|███▏      | 3195/10042 [00:10<00:22, 311.01 examples/s]Map:  32%|███▏      | 3230/10042 [00:10<00:21, 318.78 examples/s]Map:  33%|███▎      | 3279/10042 [00:10<00:21, 316.69 examples/s]Map:  33%|███▎      | 3328/10042 [00:10<00:21, 315.81 examples/s]Map:  33%|███▎      | 3361/10042 [00:10<00:21, 316.54 examples/s]Map:  34%|███▍      | 3409/10042 [00:11<00:20, 317.10 examples/s]Map:  34%|███▍      | 3442/10042 [00:11<00:20, 318.06 examples/s]Map:  35%|███▍      | 3475/10042 [00:11<00:20, 318.80 examples/s]Map:  35%|███▍      | 3508/10042 [00:11<00:20, 318.59 examples/s]Map:  35%|███▌      | 3557/10042 [00:11<00:20, 319.19 examples/s]Map:  36%|███▌      | 3591/10042 [00:11<00:20, 319.73 examples/s]Map:  36%|███▌      | 3624/10042 [00:11<00:20, 319.20 examples/s]Map:  36%|███▋      | 3656/10042 [00:11<00:20, 316.58 examples/s]Map:  37%|███▋      | 3689/10042 [00:11<00:20, 314.99 examples/s]Map:  37%|███▋      | 3721/10042 [00:11<00:20, 314.46 examples/s]Map:  38%|███▊      | 3768/10042 [00:12<00:20, 311.40 examples/s]Map:  38%|███▊      | 3800/10042 [00:12<00:19, 312.46 examples/s]Map:  38%|███▊      | 3833/10042 [00:12<00:19, 313.41 examples/s]Map:  38%|███▊      | 3865/10042 [00:12<00:19, 312.98 examples/s]Map:  39%|███▉      | 3898/10042 [00:12<00:19, 313.88 examples/s]Map:  39%|███▉      | 3930/10042 [00:12<00:19, 312.85 examples/s]Map:  39%|███▉      | 3962/10042 [00:12<00:19, 311.39 examples/s]Map:  40%|███▉      | 3995/10042 [00:12<00:19, 312.97 examples/s]Map:  40%|████      | 4031/10042 [00:13<00:31, 190.63 examples/s]Map:  40%|████      | 4063/10042 [00:13<00:27, 215.26 examples/s]Map:  41%|████      | 4095/10042 [00:13<00:25, 236.99 examples/s]Map:  41%|████      | 4127/10042 [00:13<00:23, 255.62 examples/s]Map:  41%|████▏     | 4160/10042 [00:13<00:21, 271.82 examples/s]Map:  42%|████▏     | 4192/10042 [00:13<00:20, 281.92 examples/s]Map:  42%|████▏     | 4225/10042 [00:13<00:19, 291.41 examples/s]Map:  42%|████▏     | 4258/10042 [00:13<00:19, 299.20 examples/s]Map:  43%|████▎     | 4290/10042 [00:14<00:18, 304.22 examples/s]Map:  43%|████▎     | 4322/10042 [00:14<00:18, 307.77 examples/s]Map:  43%|████▎     | 4354/10042 [00:14<00:18, 309.83 examples/s]Map:  44%|████▎     | 4387/10042 [00:14<00:18, 311.82 examples/s]Map:  44%|████▍     | 4420/10042 [00:14<00:17, 313.49 examples/s]Map:  44%|████▍     | 4452/10042 [00:14<00:17, 313.65 examples/s]Map:  45%|████▍     | 4485/10042 [00:14<00:17, 315.76 examples/s]Map:  45%|████▍     | 4518/10042 [00:14<00:17, 317.43 examples/s]Map:  45%|████▌     | 4550/10042 [00:14<00:17, 316.31 examples/s]Map:  46%|████▌     | 4582/10042 [00:14<00:17, 316.68 examples/s]Map:  46%|████▌     | 4615/10042 [00:15<00:17, 316.99 examples/s]Map:  46%|████▋     | 4647/10042 [00:15<00:17, 316.35 examples/s]Map:  47%|████▋     | 4680/10042 [00:15<00:16, 317.44 examples/s]Map:  47%|████▋     | 4713/10042 [00:15<00:16, 317.26 examples/s]Map:  47%|████▋     | 4746/10042 [00:15<00:16, 317.50 examples/s]Map:  48%|████▊     | 4779/10042 [00:15<00:16, 319.60 examples/s]Map:  48%|████▊     | 4811/10042 [00:15<00:16, 319.02 examples/s]Map:  48%|████▊     | 4844/10042 [00:15<00:16, 318.24 examples/s]Map:  49%|████▊     | 4876/10042 [00:15<00:16, 318.14 examples/s]Map:  49%|████▉     | 4909/10042 [00:15<00:16, 318.99 examples/s]Map:  49%|████▉     | 4942/10042 [00:16<00:16, 318.45 examples/s]Map:  50%|████▉     | 4974/10042 [00:16<00:15, 318.07 examples/s]Map:  50%|████▉     | 5015/10042 [00:16<00:34, 145.62 examples/s]Map:  50%|█████     | 5046/10042 [00:16<00:29, 169.37 examples/s]Map:  51%|█████     | 5078/10042 [00:16<00:25, 195.11 examples/s]Map:  51%|█████     | 5110/10042 [00:17<00:22, 219.65 examples/s]Map:  51%|█████     | 5142/10042 [00:17<00:20, 241.51 examples/s]Map:  52%|█████▏    | 5175/10042 [00:17<00:18, 260.70 examples/s]Map:  52%|█████▏    | 5208/10042 [00:17<00:17, 275.83 examples/s]Map:  52%|█████▏    | 5242/10042 [00:17<00:16, 288.88 examples/s]Map:  53%|█████▎    | 5276/10042 [00:17<00:15, 300.54 examples/s]Map:  53%|█████▎    | 5308/10042 [00:17<00:15, 304.86 examples/s]Map:  53%|█████▎    | 5341/10042 [00:17<00:15, 308.24 examples/s]Map:  54%|█████▎    | 5373/10042 [00:17<00:15, 309.22 examples/s]Map:  54%|█████▍    | 5406/10042 [00:17<00:14, 310.81 examples/s]Map:  54%|█████▍    | 5439/10042 [00:18<00:14, 313.50 examples/s]Map:  54%|█████▍    | 5472/10042 [00:18<00:14, 315.27 examples/s]Map:  55%|█████▍    | 5504/10042 [00:18<00:14, 315.08 examples/s]Map:  55%|█████▌    | 5537/10042 [00:18<00:14, 315.45 examples/s]Map:  55%|█████▌    | 5570/10042 [00:18<00:14, 316.82 examples/s]Map:  56%|█████▌    | 5603/10042 [00:18<00:14, 316.16 examples/s]Map:  56%|█████▌    | 5635/10042 [00:18<00:13, 315.82 examples/s]Map:  56%|█████▋    | 5667/10042 [00:18<00:13, 314.59 examples/s]Map:  57%|█████▋    | 5699/10042 [00:18<00:13, 314.00 examples/s]Map:  57%|█████▋    | 5732/10042 [00:19<00:13, 314.84 examples/s]Map:  58%|█████▊    | 5779/10042 [00:19<00:13, 310.95 examples/s]Map:  58%|█████▊    | 5812/10042 [00:19<00:13, 312.52 examples/s]Map:  58%|█████▊    | 5844/10042 [00:19<00:13, 312.22 examples/s]Map:  59%|█████▊    | 5876/10042 [00:19<00:13, 311.71 examples/s]Map:  59%|█████▉    | 5908/10042 [00:19<00:13, 312.22 examples/s]Map:  59%|█████▉    | 5940/10042 [00:19<00:13, 313.26 examples/s]Map:  59%|█████▉    | 5973/10042 [00:19<00:12, 314.81 examples/s]Map:  60%|█████▉    | 6014/10042 [00:20<00:20, 192.06 examples/s]Map:  60%|██████    | 6046/10042 [00:20<00:18, 215.81 examples/s]Map:  61%|██████    | 6080/10042 [00:20<00:16, 239.25 examples/s]Map:  61%|██████    | 6112/10042 [00:20<00:15, 257.38 examples/s]Map:  61%|██████    | 6144/10042 [00:20<00:14, 271.68 examples/s]Map:  62%|██████▏   | 6177/10042 [00:20<00:13, 284.94 examples/s]Map:  62%|██████▏   | 6209/10042 [00:20<00:13, 292.75 examples/s]Map:  62%|██████▏   | 6241/10042 [00:20<00:12, 299.24 examples/s]Map:  62%|██████▏   | 6273/10042 [00:20<00:12, 304.87 examples/s]Map:  63%|██████▎   | 6306/10042 [00:21<00:12, 309.01 examples/s]Map:  63%|██████▎   | 6339/10042 [00:21<00:11, 313.11 examples/s]Map:  63%|██████▎   | 6372/10042 [00:21<00:11, 314.80 examples/s]Map:  64%|██████▍   | 6405/10042 [00:21<00:11, 316.51 examples/s]Map:  64%|██████▍   | 6438/10042 [00:21<00:11, 317.48 examples/s]Map:  64%|██████▍   | 6472/10042 [00:21<00:11, 320.16 examples/s]Map:  65%|██████▍   | 6505/10042 [00:21<00:11, 318.16 examples/s]Map:  65%|██████▌   | 6537/10042 [00:21<00:11, 318.09 examples/s]Map:  65%|██████▌   | 6570/10042 [00:21<00:10, 319.51 examples/s]Map:  66%|██████▌   | 6603/10042 [00:22<00:10, 320.72 examples/s]Map:  66%|██████▌   | 6652/10042 [00:22<00:10, 319.42 examples/s]Map:  67%|██████▋   | 6684/10042 [00:22<00:10, 319.10 examples/s]Map:  67%|██████▋   | 6716/10042 [00:22<00:10, 318.12 examples/s]Map:  67%|██████▋   | 6749/10042 [00:22<00:10, 317.71 examples/s]Map:  68%|██████▊   | 6783/10042 [00:22<00:10, 319.57 examples/s]Map:  68%|██████▊   | 6816/10042 [00:22<00:10, 319.37 examples/s]Map:  68%|██████▊   | 6849/10042 [00:22<00:09, 319.47 examples/s]Map:  69%|██████▊   | 6882/10042 [00:22<00:09, 319.35 examples/s]Map:  69%|██████▉   | 6914/10042 [00:22<00:09, 316.61 examples/s]Map:  69%|██████▉   | 6946/10042 [00:23<00:09, 314.14 examples/s]Map:  69%|██████▉   | 6978/10042 [00:23<00:09, 314.67 examples/s]Map:  70%|██████▉   | 7015/10042 [00:23<00:15, 190.93 examples/s]Map:  70%|███████   | 7047/10042 [00:23<00:13, 215.18 examples/s]Map:  70%|███████   | 7079/10042 [00:23<00:12, 237.70 examples/s]Map:  71%|███████   | 7112/10042 [00:23<00:11, 255.26 examples/s]Map:  71%|███████   | 7144/10042 [00:23<00:10, 268.83 examples/s]Map:  71%|███████▏  | 7176/10042 [00:24<00:10, 281.08 examples/s]Map:  72%|███████▏  | 7209/10042 [00:24<00:09, 291.25 examples/s]Map:  72%|███████▏  | 7243/10042 [00:24<00:09, 300.29 examples/s]Map:  72%|███████▏  | 7275/10042 [00:24<00:09, 304.32 examples/s]Map:  73%|███████▎  | 7307/10042 [00:24<00:08, 307.06 examples/s]Map:  73%|███████▎  | 7340/10042 [00:24<00:08, 309.85 examples/s]Map:  73%|███████▎  | 7372/10042 [00:24<00:08, 310.27 examples/s]Map:  74%|███████▎  | 7404/10042 [00:24<00:08, 311.24 examples/s]Map:  74%|███████▍  | 7436/10042 [00:24<00:08, 312.14 examples/s]Map:  74%|███████▍  | 7468/10042 [00:24<00:08, 312.45 examples/s]Map:  75%|███████▍  | 7501/10042 [00:25<00:08, 314.62 examples/s]Map:  75%|███████▌  | 7533/10042 [00:25<00:07, 314.63 examples/s]Map:  75%|███████▌  | 7566/10042 [00:25<00:07, 316.92 examples/s]Map:  76%|███████▌  | 7599/10042 [00:25<00:07, 317.23 examples/s]Map:  76%|███████▌  | 7631/10042 [00:25<00:07, 317.81 examples/s]Map:  76%|███████▋  | 7664/10042 [00:25<00:07, 317.90 examples/s]Map:  77%|███████▋  | 7697/10042 [00:25<00:07, 319.28 examples/s]Map:  77%|███████▋  | 7729/10042 [00:25<00:07, 315.88 examples/s]Map:  77%|███████▋  | 7762/10042 [00:25<00:07, 316.09 examples/s]Map:  78%|███████▊  | 7794/10042 [00:26<00:07, 315.63 examples/s]Map:  78%|███████▊  | 7827/10042 [00:26<00:07, 316.02 examples/s]Map:  78%|███████▊  | 7859/10042 [00:26<00:06, 316.01 examples/s]Map:  79%|███████▊  | 7891/10042 [00:26<00:06, 316.39 examples/s]Map:  79%|███████▉  | 7924/10042 [00:26<00:06, 316.18 examples/s]Map:  79%|███████▉  | 7956/10042 [00:26<00:06, 316.38 examples/s]Map:  80%|███████▉  | 7988/10042 [00:26<00:06, 315.53 examples/s]Map:  80%|███████▉  | 8032/10042 [00:26<00:10, 195.68 examples/s]Map:  80%|████████  | 8065/10042 [00:27<00:08, 220.10 examples/s]Map:  81%|████████  | 8097/10042 [00:27<00:08, 240.58 examples/s]Map:  81%|████████  | 8129/10042 [00:27<00:07, 257.95 examples/s]Map:  81%|████████▏ | 8163/10042 [00:27<00:06, 275.02 examples/s]Map:  82%|████████▏ | 8195/10042 [00:27<00:06, 284.77 examples/s]Map:  82%|████████▏ | 8227/10042 [00:27<00:06, 292.93 examples/s]Map:  82%|████████▏ | 8259/10042 [00:27<00:05, 298.88 examples/s]Map:  83%|████████▎ | 8292/10042 [00:27<00:05, 303.90 examples/s]Map:  83%|████████▎ | 8324/10042 [00:27<00:05, 305.91 examples/s]Map:  83%|████████▎ | 8356/10042 [00:28<00:05, 308.62 examples/s]Map:  84%|████████▎ | 8388/10042 [00:28<00:05, 310.74 examples/s]Map:  84%|████████▍ | 8420/10042 [00:28<00:05, 312.16 examples/s]Map:  84%|████████▍ | 8453/10042 [00:28<00:05, 313.05 examples/s]Map:  85%|████████▍ | 8486/10042 [00:28<00:04, 316.13 examples/s]Map:  85%|████████▍ | 8518/10042 [00:28<00:04, 315.12 examples/s]Map:  85%|████████▌ | 8550/10042 [00:28<00:04, 315.05 examples/s]Map:  85%|████████▌ | 8582/10042 [00:28<00:04, 314.95 examples/s]Map:  86%|████████▌ | 8614/10042 [00:28<00:04, 312.98 examples/s]Map:  86%|████████▌ | 8646/10042 [00:28<00:04, 313.09 examples/s]Map:  86%|████████▋ | 8679/10042 [00:29<00:04, 314.09 examples/s]Map:  87%|████████▋ | 8711/10042 [00:29<00:04, 314.18 examples/s]Map:  87%|████████▋ | 8743/10042 [00:29<00:04, 313.89 examples/s]Map:  87%|████████▋ | 8775/10042 [00:29<00:04, 313.79 examples/s]Map:  88%|████████▊ | 8807/10042 [00:29<00:03, 314.43 examples/s]Map:  88%|████████▊ | 8839/10042 [00:29<00:03, 314.66 examples/s]Map:  88%|████████▊ | 8871/10042 [00:29<00:03, 315.74 examples/s]Map:  89%|████████▊ | 8903/10042 [00:29<00:03, 314.42 examples/s]Map:  89%|████████▉ | 8935/10042 [00:29<00:03, 314.94 examples/s]Map:  89%|████████▉ | 8967/10042 [00:29<00:03, 313.08 examples/s]Map:  90%|████████▉ | 8999/10042 [00:30<00:03, 313.33 examples/s]Map:  90%|████████▉ | 9031/10042 [00:30<00:05, 183.49 examples/s]Map:  90%|█████████ | 9064/10042 [00:30<00:04, 210.80 examples/s]Map:  91%|█████████ | 9098/10042 [00:30<00:03, 236.10 examples/s]Map:  91%|█████████ | 9130/10042 [00:30<00:03, 254.41 examples/s]Map:  91%|█████████ | 9162/10042 [00:30<00:03, 270.47 examples/s]Map:  92%|█████████▏| 9194/10042 [00:30<00:03, 280.60 examples/s]Map:  92%|█████████▏| 9228/10042 [00:31<00:02, 292.40 examples/s]Map:  92%|█████████▏| 9261/10042 [00:31<00:02, 300.26 examples/s]Map:  93%|█████████▎| 9294/10042 [00:31<00:02, 304.40 examples/s]Map:  93%|█████████▎| 9326/10042 [00:31<00:02, 307.20 examples/s]Map:  93%|█████████▎| 9358/10042 [00:31<00:02, 309.84 examples/s]Map:  94%|█████████▎| 9390/10042 [00:31<00:02, 311.18 examples/s]Map:  94%|█████████▍| 9422/10042 [00:31<00:01, 311.34 examples/s]Map:  94%|█████████▍| 9455/10042 [00:31<00:01, 313.77 examples/s]Map:  94%|█████████▍| 9487/10042 [00:31<00:01, 312.25 examples/s]Map:  95%|█████████▍| 9519/10042 [00:31<00:01, 311.61 examples/s]Map:  95%|█████████▌| 9551/10042 [00:32<00:01, 312.56 examples/s]Map:  95%|█████████▌| 9583/10042 [00:32<00:01, 312.40 examples/s]Map:  96%|█████████▌| 9616/10042 [00:32<00:01, 314.50 examples/s]Map:  96%|█████████▌| 9648/10042 [00:32<00:01, 312.51 examples/s]Map:  96%|█████████▋| 9680/10042 [00:32<00:01, 313.18 examples/s]Map:  97%|█████████▋| 9712/10042 [00:32<00:01, 314.21 examples/s]Map:  97%|█████████▋| 9759/10042 [00:32<00:00, 312.05 examples/s]Map:  98%|█████████▊| 9791/10042 [00:32<00:00, 312.34 examples/s]Map:  98%|█████████▊| 9823/10042 [00:32<00:00, 312.33 examples/s]Map:  98%|█████████▊| 9855/10042 [00:33<00:00, 313.27 examples/s]Map:  98%|█████████▊| 9887/10042 [00:33<00:00, 312.10 examples/s]Map:  99%|█████████▉| 9919/10042 [00:33<00:00, 312.29 examples/s]Map:  99%|█████████▉| 9951/10042 [00:33<00:00, 313.32 examples/s]Map:  99%|█████████▉| 9983/10042 [00:33<00:00, 313.13 examples/s]Map: 100%|█████████▉| 10015/10042 [00:33<00:00, 138.60 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 72.91 examples/s] Map: 100%|██████████| 10042/10042 [00:34<00:00, 288.33 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   8%|▊         | 97/1267 [00:00<00:01, 958.31 examples/s]Map:  15%|█▌        | 196/1267 [00:00<00:01, 974.41 examples/s]Map:  23%|██▎       | 296/1267 [00:00<00:00, 985.91 examples/s]Map:  35%|███▌      | 444/1267 [00:00<00:00, 979.12 examples/s]Map:  43%|████▎     | 548/1267 [00:00<00:00, 994.28 examples/s]Map:  51%|█████▏    | 652/1267 [00:00<00:00, 1004.93 examples/s]Map:  60%|█████▉    | 756/1267 [00:00<00:00, 1012.28 examples/s]Map:  68%|██████▊   | 860/1267 [00:00<00:00, 1016.07 examples/s]Map:  76%|███████▌  | 964/1267 [00:00<00:00, 1021.11 examples/s]Map:  87%|████████▋ | 1102/1267 [00:01<00:00, 656.69 examples/s]Map:  95%|█████████▌| 1205/1267 [00:01<00:00, 730.23 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 843.11 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  3.52it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  3.68it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  3.99it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  3.88it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:15<00:31, 15.58s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:30<00:15, 15.32s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:40<00:00, 12.60s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:40<00:00, 13.36s/it]
2024-04-27 16:54:50,623: rank0[3868616][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-04-27 16:54:50,625: rank0[3868616][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-04-27 16:54:51,888: rank0[3868616][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-04-27 16:54:51,902: rank0[3868616][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-04-27 16:55:16,928: rank0[3868616][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-04-27 16:55:16,929: rank0[3868616][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-04-27 16:55:16,929: rank0[3868616][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/eldar/llmfoundry_checkpoints/llama2_7b_cosmopedia_alldownstream/oneshot_sp70_fromConverged24_amp_bf16_maxseq4096_1ep_cosineLR1e-4_warmup1500ba_noGradClip_globalBS256_evalInterval10000ba_finetunedTeacher
models:
- model_name: /network/eldar/llmfoundry_checkpoints/llama2_7b_cosmopedia_alldownstream/oneshot_sp70_fromConverged24_amp_bf16_maxseq4096_1ep_cosineLR1e-4_warmup1500ba_noGradClip_globalBS256_evalInterval10000ba_finetunedTeacher
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/eldar/llmfoundry_checkpoints/llama2_7b_cosmopedia_alldownstream/oneshot_sp70_fromConverged24_amp_bf16_maxseq4096_1ep_cosineLR1e-4_warmup1500ba_noGradClip_globalBS256_evalInterval10000ba_finetunedTeacher
    use_auth_token: true
  tokenizer:
    name: /network/eldar/llmfoundry_checkpoints/llama2_7b_cosmopedia_alldownstream/oneshot_sp70_fromConverged24_amp_bf16_maxseq4096_1ep_cosineLR1e-4_warmup1500ba_noGradClip_globalBS256_evalInterval10000ba_finetunedTeacher
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-04-27 16:55:16,935: rank0[3868616][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.4710
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.4890
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7543
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7261
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                                                                                                                                                               |
|:-----------|:--------------|:----------|-----------:|:------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.47099  | 25-shot           | /network/eldar/llmfoundry_checkpoints/llama2_7b_cosmopedia_alldownstream/oneshot_sp70_fromConverged24_amp_bf16_maxseq4096_1ep_cosineLR1e-4_warmup1500ba_noGradClip_globalBS256_evalInterval10000ba_finetunedTeacher |
|            | mmlu          |           |   0.489033 | 5-shot            | /network/eldar/llmfoundry_checkpoints/llama2_7b_cosmopedia_alldownstream/oneshot_sp70_fromConverged24_amp_bf16_maxseq4096_1ep_cosineLR1e-4_warmup1500ba_noGradClip_globalBS256_evalInterval10000ba_finetunedTeacher |
|            | winogrande    |           |   0.726125 | 5-shot            | /network/eldar/llmfoundry_checkpoints/llama2_7b_cosmopedia_alldownstream/oneshot_sp70_fromConverged24_amp_bf16_maxseq4096_1ep_cosineLR1e-4_warmup1500ba_noGradClip_globalBS256_evalInterval10000ba_finetunedTeacher |
|            | hellaswag     |           |   0.754332 | 10-shot           | /network/eldar/llmfoundry_checkpoints/llama2_7b_cosmopedia_alldownstream/oneshot_sp70_fromConverged24_amp_bf16_maxseq4096_1ep_cosineLR1e-4_warmup1500ba_noGradClip_globalBS256_evalInterval10000ba_finetunedTeacher |
2024-04-27 17:55:35,569: rank0[3868616][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-04-27 17:55:35,569: rank0[3868616][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-04-27 17:55:35,569: rank0[3868616][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-04-27 17:55:35,569: rank0[3868616][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
