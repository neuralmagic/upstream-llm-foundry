----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-05-04 04:27:27,286: rank0[533746][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 27/1172 [00:00<00:04, 254.10 examples/s]Map:   5%|▍         | 55/1172 [00:00<00:04, 260.49 examples/s]Map:   7%|▋         | 82/1172 [00:00<00:04, 260.80 examples/s]Map:   9%|▉         | 110/1172 [00:00<00:04, 261.78 examples/s]Map:  12%|█▏        | 137/1172 [00:00<00:03, 262.58 examples/s]Map:  14%|█▍        | 164/1172 [00:00<00:03, 261.35 examples/s]Map:  16%|█▋        | 192/1172 [00:00<00:03, 263.75 examples/s]Map:  19%|█▉        | 220/1172 [00:00<00:03, 265.09 examples/s]Map:  21%|██        | 248/1172 [00:00<00:03, 264.63 examples/s]Map:  25%|██▍       | 288/1172 [00:01<00:03, 263.35 examples/s]Map:  27%|██▋       | 316/1172 [00:01<00:03, 263.68 examples/s]Map:  29%|██▉       | 344/1172 [00:01<00:03, 265.66 examples/s]Map:  33%|███▎      | 384/1172 [00:01<00:03, 261.64 examples/s]Map:  35%|███▌      | 411/1172 [00:01<00:02, 261.36 examples/s]Map:  37%|███▋      | 439/1172 [00:01<00:02, 261.46 examples/s]Map:  40%|███▉      | 467/1172 [00:01<00:02, 261.74 examples/s]Map:  43%|████▎     | 507/1172 [00:01<00:02, 259.06 examples/s]Map:  46%|████▌     | 535/1172 [00:02<00:02, 261.85 examples/s]Map:  48%|████▊     | 562/1172 [00:02<00:02, 262.06 examples/s]Map:  50%|█████     | 589/1172 [00:02<00:02, 262.44 examples/s]Map:  53%|█████▎    | 617/1172 [00:02<00:02, 264.19 examples/s]Map:  55%|█████▍    | 644/1172 [00:02<00:02, 263.13 examples/s]Map:  57%|█████▋    | 672/1172 [00:02<00:01, 264.51 examples/s]Map:  60%|█████▉    | 700/1172 [00:02<00:01, 266.15 examples/s]Map:  62%|██████▏   | 727/1172 [00:02<00:01, 264.66 examples/s]Map:  64%|██████▍   | 754/1172 [00:02<00:01, 263.39 examples/s]Map:  67%|██████▋   | 782/1172 [00:02<00:01, 264.37 examples/s]Map:  70%|███████   | 822/1172 [00:03<00:01, 263.77 examples/s]Map:  72%|███████▏  | 849/1172 [00:03<00:01, 262.92 examples/s]Map:  75%|███████▍  | 877/1172 [00:03<00:01, 261.68 examples/s]Map:  77%|███████▋  | 904/1172 [00:03<00:01, 261.26 examples/s]Map:  79%|███████▉  | 931/1172 [00:03<00:00, 261.28 examples/s]Map:  82%|████████▏ | 959/1172 [00:03<00:00, 262.00 examples/s]Map:  84%|████████▍ | 987/1172 [00:03<00:00, 263.75 examples/s]Map:  88%|████████▊ | 1027/1172 [00:04<00:01, 132.06 examples/s]Map:  90%|████████▉ | 1054/1172 [00:04<00:00, 152.05 examples/s]Map:  92%|█████████▏| 1082/1172 [00:04<00:00, 172.82 examples/s]Map:  95%|█████████▍| 1110/1172 [00:04<00:00, 192.33 examples/s]Map:  97%|█████████▋| 1136/1172 [00:04<00:00, 206.77 examples/s]Map:  99%|█████████▉| 1164/1172 [00:04<00:00, 221.06 examples/s]Map: 100%|██████████| 1172/1172 [00:04<00:00, 237.40 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 47/14042 [00:00<00:30, 458.26 examples/s]Map:   1%|          | 113/14042 [00:00<00:32, 434.28 examples/s]Map:   1%|▏         | 176/14042 [00:00<00:32, 420.33 examples/s]Map:   2%|▏         | 224/14042 [00:00<00:31, 434.51 examples/s]Map:   2%|▏         | 268/14042 [00:00<00:31, 432.53 examples/s]Map:   2%|▏         | 314/14042 [00:00<00:31, 435.58 examples/s]Map:   3%|▎         | 359/14042 [00:00<00:31, 435.28 examples/s]Map:   3%|▎         | 404/14042 [00:01<00:59, 227.96 examples/s]Map:   3%|▎         | 448/14042 [00:01<00:51, 264.17 examples/s]Map:   4%|▎         | 492/14042 [00:01<00:45, 298.97 examples/s]Map:   4%|▍         | 538/14042 [00:01<00:40, 332.68 examples/s]Map:   4%|▍         | 581/14042 [00:01<00:38, 354.22 examples/s]Map:   4%|▍         | 627/14042 [00:01<00:35, 377.44 examples/s]Map:   5%|▍         | 670/14042 [00:01<00:34, 388.39 examples/s]Map:   5%|▌         | 733/14042 [00:02<00:33, 398.22 examples/s]Map:   6%|▌         | 779/14042 [00:02<00:32, 409.81 examples/s]Map:   6%|▌         | 824/14042 [00:02<00:31, 418.85 examples/s]Map:   6%|▋         | 889/14042 [00:02<00:31, 421.18 examples/s]Map:   7%|▋         | 936/14042 [00:02<00:30, 431.07 examples/s]Map:   7%|▋         | 982/14042 [00:02<00:29, 435.73 examples/s]Map:   7%|▋         | 1045/14042 [00:03<00:59, 220.09 examples/s]Map:   8%|▊         | 1093/14042 [00:03<00:50, 257.54 examples/s]Map:   8%|▊         | 1142/14042 [00:03<00:43, 298.04 examples/s]Map:   8%|▊         | 1189/14042 [00:03<00:38, 331.66 examples/s]Map:   9%|▉         | 1236/14042 [00:03<00:35, 359.08 examples/s]Map:   9%|▉         | 1284/14042 [00:03<00:33, 385.54 examples/s]Map:   9%|▉         | 1329/14042 [00:03<00:31, 401.19 examples/s]Map:  10%|▉         | 1375/14042 [00:03<00:30, 413.25 examples/s]Map:  10%|█         | 1421/14042 [00:03<00:29, 423.75 examples/s]Map:  10%|█         | 1466/14042 [00:04<00:29, 428.12 examples/s]Map:  11%|█         | 1513/14042 [00:04<00:28, 436.97 examples/s]Map:  11%|█         | 1579/14042 [00:04<00:28, 434.80 examples/s]Map:  12%|█▏        | 1624/14042 [00:04<00:28, 437.48 examples/s]Map:  12%|█▏        | 1671/14042 [00:04<00:27, 442.99 examples/s]Map:  12%|█▏        | 1718/14042 [00:04<00:27, 447.11 examples/s]Map:  13%|█▎        | 1785/14042 [00:04<00:27, 445.45 examples/s]Map:  13%|█▎        | 1831/14042 [00:04<00:27, 447.77 examples/s]Map:  14%|█▎        | 1899/14042 [00:05<00:27, 442.54 examples/s]Map:  14%|█▍        | 1944/14042 [00:05<00:27, 442.14 examples/s]Map:  14%|█▍        | 1989/14042 [00:05<00:27, 443.27 examples/s]Map:  15%|█▍        | 2042/14042 [00:05<00:44, 269.06 examples/s]Map:  15%|█▍        | 2088/14042 [00:05<00:39, 302.87 examples/s]Map:  15%|█▌        | 2136/14042 [00:05<00:35, 336.95 examples/s]Map:  16%|█▌        | 2184/14042 [00:05<00:32, 367.44 examples/s]Map:  16%|█▌        | 2232/14042 [00:05<00:30, 391.80 examples/s]Map:  16%|█▌        | 2280/14042 [00:06<00:28, 410.32 examples/s]Map:  17%|█▋        | 2329/14042 [00:06<00:27, 429.09 examples/s]Map:  17%|█▋        | 2375/14042 [00:06<00:26, 435.27 examples/s]Map:  17%|█▋        | 2423/14042 [00:06<00:26, 445.17 examples/s]Map:  18%|█▊        | 2471/14042 [00:06<00:25, 449.42 examples/s]Map:  18%|█▊        | 2521/14042 [00:06<00:25, 459.88 examples/s]Map:  18%|█▊        | 2570/14042 [00:06<00:24, 465.87 examples/s]Map:  19%|█▉        | 2641/14042 [00:06<00:24, 465.10 examples/s]Map:  19%|█▉        | 2688/14042 [00:06<00:24, 463.48 examples/s]Map:  19%|█▉        | 2735/14042 [00:07<00:24, 462.74 examples/s]Map:  20%|█▉        | 2782/14042 [00:07<00:24, 461.08 examples/s]Map:  20%|██        | 2829/14042 [00:07<00:24, 459.02 examples/s]Map:  20%|██        | 2875/14042 [00:07<00:24, 456.24 examples/s]Map:  21%|██        | 2923/14042 [00:07<00:24, 461.45 examples/s]Map:  21%|██▏       | 2994/14042 [00:07<00:23, 461.76 examples/s]Map:  22%|██▏       | 3045/14042 [00:07<00:38, 283.15 examples/s]Map:  22%|██▏       | 3092/14042 [00:08<00:34, 316.96 examples/s]Map:  22%|██▏       | 3140/14042 [00:08<00:31, 348.81 examples/s]Map:  23%|██▎       | 3183/14042 [00:08<00:29, 366.35 examples/s]Map:  23%|██▎       | 3227/14042 [00:08<00:28, 381.34 examples/s]Map:  23%|██▎       | 3273/14042 [00:08<00:26, 398.92 examples/s]Map:  24%|██▎       | 3321/14042 [00:08<00:25, 418.94 examples/s]Map:  24%|██▍       | 3368/14042 [00:08<00:24, 432.80 examples/s]Map:  24%|██▍       | 3416/14042 [00:08<00:23, 443.79 examples/s]Map:  25%|██▍       | 3463/14042 [00:08<00:23, 448.51 examples/s]Map:  25%|██▌       | 3513/14042 [00:09<00:22, 459.69 examples/s]Map:  25%|██▌       | 3561/14042 [00:09<00:22, 462.64 examples/s]Map:  26%|██▌       | 3608/14042 [00:09<00:22, 461.10 examples/s]Map:  26%|██▌       | 3677/14042 [00:09<00:22, 455.01 examples/s]Map:  27%|██▋       | 3723/14042 [00:09<00:22, 452.03 examples/s]Map:  27%|██▋       | 3772/14042 [00:09<00:22, 456.53 examples/s]Map:  27%|██▋       | 3819/14042 [00:09<00:22, 456.27 examples/s]Map:  28%|██▊       | 3865/14042 [00:09<00:22, 455.77 examples/s]Map:  28%|██▊       | 3933/14042 [00:09<00:22, 451.29 examples/s]Map:  28%|██▊       | 3979/14042 [00:10<00:22, 450.95 examples/s]Map:  29%|██▉       | 4043/14042 [00:10<00:36, 274.93 examples/s]Map:  29%|██▉       | 4089/14042 [00:10<00:32, 306.35 examples/s]Map:  29%|██▉       | 4135/14042 [00:10<00:29, 335.38 examples/s]Map:  30%|██▉       | 4183/14042 [00:10<00:26, 365.27 examples/s]Map:  30%|███       | 4231/14042 [00:10<00:25, 391.32 examples/s]Map:  30%|███       | 4276/14042 [00:10<00:24, 403.75 examples/s]Map:  31%|███       | 4322/14042 [00:11<00:23, 415.93 examples/s]Map:  31%|███       | 4367/14042 [00:11<00:22, 424.22 examples/s]Map:  32%|███▏      | 4427/14042 [00:11<00:23, 409.67 examples/s]Map:  32%|███▏      | 4474/14042 [00:11<00:22, 424.19 examples/s]Map:  32%|███▏      | 4520/14042 [00:11<00:22, 430.41 examples/s]Map:  33%|███▎      | 4578/14042 [00:11<00:22, 411.93 examples/s]Map:  33%|███▎      | 4636/14042 [00:11<00:23, 399.52 examples/s]Map:  33%|███▎      | 4694/14042 [00:11<00:24, 389.25 examples/s]Map:  34%|███▍      | 4757/14042 [00:12<00:23, 397.96 examples/s]Map:  34%|███▍      | 4802/14042 [00:12<00:22, 406.58 examples/s]Map:  35%|███▍      | 4850/14042 [00:12<00:21, 420.85 examples/s]Map:  35%|███▍      | 4899/14042 [00:12<00:20, 436.53 examples/s]Map:  35%|███▌      | 4947/14042 [00:12<00:20, 445.73 examples/s]Map:  36%|███▌      | 4995/14042 [00:12<00:20, 451.08 examples/s]Map:  36%|███▌      | 5044/14042 [00:13<00:43, 208.46 examples/s]Map:  36%|███▌      | 5085/14042 [00:13<00:37, 239.25 examples/s]Map:  36%|███▋      | 5123/14042 [00:13<00:34, 262.23 examples/s]Map:  37%|███▋      | 5162/14042 [00:13<00:30, 286.92 examples/s]Map:  37%|███▋      | 5199/14042 [00:13<00:29, 303.74 examples/s]Map:  37%|███▋      | 5238/14042 [00:13<00:27, 322.79 examples/s]Map:  38%|███▊      | 5286/14042 [00:13<00:24, 361.28 examples/s]Map:  38%|███▊      | 5335/14042 [00:13<00:22, 392.50 examples/s]Map:  38%|███▊      | 5381/14042 [00:13<00:21, 409.71 examples/s]Map:  39%|███▊      | 5425/14042 [00:14<00:20, 415.44 examples/s]Map:  39%|███▉      | 5472/14042 [00:14<00:19, 429.08 examples/s]Map:  39%|███▉      | 5518/14042 [00:14<00:19, 436.57 examples/s]Map:  40%|███▉      | 5568/14042 [00:14<00:18, 452.54 examples/s]Map:  40%|███▉      | 5616/14042 [00:14<00:18, 456.84 examples/s]Map:  40%|████      | 5664/14042 [00:14<00:18, 458.24 examples/s]Map:  41%|████      | 5712/14042 [00:14<00:18, 461.64 examples/s]Map:  41%|████      | 5761/14042 [00:14<00:17, 462.79 examples/s]Map:  42%|████▏     | 5831/14042 [00:14<00:17, 458.94 examples/s]Map:  42%|████▏     | 5898/14042 [00:15<00:18, 448.91 examples/s]Map:  42%|████▏     | 5960/14042 [00:15<00:18, 431.81 examples/s]Map:  43%|████▎     | 6019/14042 [00:15<00:29, 270.43 examples/s]Map:  43%|████▎     | 6061/14042 [00:15<00:27, 292.72 examples/s]Map:  43%|████▎     | 6101/14042 [00:15<00:25, 311.90 examples/s]Map:  44%|████▎     | 6142/14042 [00:16<00:23, 331.36 examples/s]Map:  44%|████▍     | 6181/14042 [00:16<00:22, 342.80 examples/s]Map:  44%|████▍     | 6220/14042 [00:16<00:22, 352.94 examples/s]Map:  45%|████▍     | 6259/14042 [00:16<00:21, 360.74 examples/s]Map:  45%|████▍     | 6299/14042 [00:16<00:21, 366.73 examples/s]Map:  45%|████▌     | 6338/14042 [00:16<00:20, 372.56 examples/s]Map:  45%|████▌     | 6379/14042 [00:16<00:20, 380.59 examples/s]Map:  46%|████▌     | 6420/14042 [00:16<00:19, 386.37 examples/s]Map:  46%|████▌     | 6461/14042 [00:16<00:19, 390.97 examples/s]Map:  46%|████▋     | 6521/14042 [00:16<00:19, 388.75 examples/s]Map:  47%|████▋     | 6562/14042 [00:17<00:19, 392.03 examples/s]Map:  47%|████▋     | 6603/14042 [00:17<00:18, 394.64 examples/s]Map:  47%|████▋     | 6661/14042 [00:17<00:19, 386.58 examples/s]Map:  48%|████▊     | 6702/14042 [00:17<00:18, 390.71 examples/s]Map:  48%|████▊     | 6760/14042 [00:17<00:18, 383.74 examples/s]Map:  48%|████▊     | 6801/14042 [00:17<00:18, 388.75 examples/s]Map:  49%|████▊     | 6841/14042 [00:17<00:18, 387.17 examples/s]Map:  49%|████▉     | 6881/14042 [00:17<00:18, 386.31 examples/s]Map:  49%|████▉     | 6940/14042 [00:18<00:18, 387.06 examples/s]Map:  50%|████▉     | 6980/14042 [00:18<00:18, 388.14 examples/s]Map:  50%|████▉     | 7019/14042 [00:18<00:29, 241.33 examples/s]Map:  50%|█████     | 7059/14042 [00:18<00:25, 269.95 examples/s]Map:  51%|█████     | 7100/14042 [00:18<00:23, 297.87 examples/s]Map:  51%|█████     | 7140/14042 [00:18<00:21, 318.36 examples/s]Map:  51%|█████     | 7182/14042 [00:18<00:20, 341.16 examples/s]Map:  51%|█████▏    | 7225/14042 [00:19<00:18, 360.58 examples/s]Map:  52%|█████▏    | 7265/14042 [00:19<00:18, 367.55 examples/s]Map:  52%|█████▏    | 7305/14042 [00:19<00:18, 372.23 examples/s]Map:  52%|█████▏    | 7344/14042 [00:19<00:17, 374.36 examples/s]Map:  53%|█████▎    | 7385/14042 [00:19<00:17, 382.34 examples/s]Map:  53%|█████▎    | 7424/14042 [00:19<00:17, 382.68 examples/s]Map:  53%|█████▎    | 7468/14042 [00:19<00:16, 397.54 examples/s]Map:  54%|█████▎    | 7516/14042 [00:19<00:15, 418.23 examples/s]Map:  54%|█████▍    | 7563/14042 [00:19<00:15, 430.07 examples/s]Map:  54%|█████▍    | 7613/14042 [00:19<00:14, 446.38 examples/s]Map:  55%|█████▍    | 7660/14042 [00:20<00:14, 451.98 examples/s]Map:  55%|█████▍    | 7709/14042 [00:20<00:13, 457.53 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2179 > 2048). Running this sequence through the model will result in indexing errors
Map:  55%|█████▌    | 7755/14042 [00:20<00:13, 454.91 examples/s]Map:  56%|█████▌    | 7801/14042 [00:20<00:13, 456.00 examples/s]Map:  56%|█████▌    | 7849/14042 [00:20<00:13, 459.58 examples/s]Map:  56%|█████▌    | 7896/14042 [00:20<00:13, 458.17 examples/s]Map:  57%|█████▋    | 7944/14042 [00:20<00:13, 463.28 examples/s]Map:  57%|█████▋    | 8000/14042 [00:21<00:22, 266.03 examples/s]Map:  57%|█████▋    | 8044/14042 [00:21<00:20, 297.60 examples/s]Map:  58%|█████▊    | 8092/14042 [00:21<00:17, 334.98 examples/s]Map:  58%|█████▊    | 8138/14042 [00:21<00:16, 361.37 examples/s]Map:  58%|█████▊    | 8188/14042 [00:21<00:14, 392.27 examples/s]Map:  59%|█████▊    | 8236/14042 [00:21<00:14, 412.16 examples/s]Map:  59%|█████▉    | 8284/14042 [00:21<00:13, 426.68 examples/s]Map:  59%|█████▉    | 8330/14042 [00:21<00:13, 433.11 examples/s]Map:  60%|█████▉    | 8377/14042 [00:21<00:12, 440.10 examples/s]Map:  60%|█████▉    | 8424/14042 [00:21<00:12, 446.04 examples/s]Map:  60%|██████    | 8471/14042 [00:22<00:12, 450.42 examples/s]Map:  61%|██████    | 8517/14042 [00:22<00:12, 449.62 examples/s]Map:  61%|██████    | 8565/14042 [00:22<00:11, 458.06 examples/s]Map:  61%|██████▏   | 8635/14042 [00:22<00:11, 460.46 examples/s]Map:  62%|██████▏   | 8703/14042 [00:22<00:11, 455.69 examples/s]Map:  62%|██████▏   | 8770/14042 [00:22<00:11, 448.51 examples/s]Map:  63%|██████▎   | 8818/14042 [00:22<00:11, 454.20 examples/s]Map:  63%|██████▎   | 8864/14042 [00:22<00:11, 453.89 examples/s]Map:  63%|██████▎   | 8913/14042 [00:23<00:11, 461.66 examples/s]Map:  64%|██████▍   | 8963/14042 [00:23<00:10, 468.86 examples/s]Map:  64%|██████▍   | 9021/14042 [00:23<00:17, 279.75 examples/s]Map:  65%|██████▍   | 9067/14042 [00:23<00:15, 312.40 examples/s]Map:  65%|██████▍   | 9114/14042 [00:23<00:14, 344.46 examples/s]Map:  65%|██████▌   | 9159/14042 [00:23<00:13, 367.00 examples/s]Map:  66%|██████▌   | 9207/14042 [00:23<00:12, 394.10 examples/s]Map:  66%|██████▌   | 9254/14042 [00:24<00:11, 411.25 examples/s]Map:  66%|██████▌   | 9302/14042 [00:24<00:11, 426.06 examples/s]Map:  67%|██████▋   | 9351/14042 [00:24<00:10, 439.73 examples/s]Map:  67%|██████▋   | 9398/14042 [00:24<00:10, 445.88 examples/s]Map:  67%|██████▋   | 9444/14042 [00:24<00:10, 448.49 examples/s]Map:  68%|██████▊   | 9493/14042 [00:24<00:09, 459.32 examples/s]Map:  68%|██████▊   | 9542/14042 [00:24<00:09, 462.96 examples/s]Map:  68%|██████▊   | 9600/14042 [00:24<00:10, 429.42 examples/s]Map:  69%|██████▉   | 9658/14042 [00:24<00:10, 410.79 examples/s]Map:  69%|██████▉   | 9710/14042 [00:25<00:15, 281.75 examples/s]Map:  69%|██████▉   | 9747/14042 [00:25<00:14, 296.12 examples/s]Map:  70%|██████▉   | 9787/14042 [00:25<00:13, 315.47 examples/s]Map:  70%|███████   | 9830/14042 [00:25<00:12, 339.86 examples/s]Map:  70%|███████   | 9873/14042 [00:25<00:11, 360.38 examples/s]Map:  71%|███████   | 9917/14042 [00:25<00:10, 378.27 examples/s]Map:  71%|███████   | 9962/14042 [00:25<00:10, 394.68 examples/s]Map:  71%|███████▏  | 10020/14042 [00:26<00:16, 244.60 examples/s]Map:  72%|███████▏  | 10066/14042 [00:26<00:14, 282.77 examples/s]Map:  72%|███████▏  | 10115/14042 [00:26<00:12, 322.72 examples/s]Map:  72%|███████▏  | 10159/14042 [00:26<00:11, 347.78 examples/s]Map:  73%|███████▎  | 10205/14042 [00:26<00:10, 372.46 examples/s]Map:  73%|███████▎  | 10251/14042 [00:26<00:09, 393.08 examples/s]Map:  73%|███████▎  | 10299/14042 [00:26<00:09, 413.65 examples/s]Map:  74%|███████▎  | 10344/14042 [00:26<00:08, 421.02 examples/s]Map:  74%|███████▍  | 10389/14042 [00:27<00:08, 427.98 examples/s]Map:  74%|███████▍  | 10455/14042 [00:27<00:08, 427.86 examples/s]Map:  75%|███████▍  | 10500/14042 [00:27<00:08, 430.64 examples/s]Map:  75%|███████▌  | 10544/14042 [00:27<00:08, 430.26 examples/s]Map:  75%|███████▌  | 10591/14042 [00:27<00:07, 439.70 examples/s]Map:  76%|███████▌  | 10640/14042 [00:27<00:07, 452.05 examples/s]Map:  76%|███████▌  | 10687/14042 [00:27<00:07, 452.72 examples/s]Map:  76%|███████▋  | 10734/14042 [00:27<00:07, 454.66 examples/s]Map:  77%|███████▋  | 10801/14042 [00:28<00:07, 448.43 examples/s]Map:  77%|███████▋  | 10850/14042 [00:28<00:06, 456.36 examples/s]Map:  78%|███████▊  | 10918/14042 [00:28<00:06, 453.52 examples/s]Map:  78%|███████▊  | 10964/14042 [00:28<00:06, 452.21 examples/s]Map:  78%|███████▊  | 11022/14042 [00:28<00:11, 272.00 examples/s]Map:  79%|███████▉  | 11068/14042 [00:28<00:09, 304.47 examples/s]Map:  79%|███████▉  | 11117/14042 [00:28<00:08, 339.20 examples/s]Map:  80%|███████▉  | 11165/14042 [00:29<00:07, 369.17 examples/s]Map:  80%|███████▉  | 11213/14042 [00:29<00:07, 392.94 examples/s]Map:  80%|████████  | 11277/14042 [00:29<00:06, 400.87 examples/s]Map:  81%|████████  | 11321/14042 [00:29<00:06, 408.31 examples/s]Map:  81%|████████  | 11385/14042 [00:29<00:06, 410.92 examples/s]Map:  81%|████████▏ | 11428/14042 [00:29<00:06, 411.84 examples/s]Map:  82%|████████▏ | 11492/14042 [00:29<00:06, 412.32 examples/s]Map:  82%|████████▏ | 11539/14042 [00:29<00:05, 423.82 examples/s]Map:  83%|████████▎ | 11587/14042 [00:30<00:05, 434.94 examples/s]Map:  83%|████████▎ | 11634/14042 [00:30<00:05, 441.39 examples/s]Map:  83%|████████▎ | 11683/14042 [00:30<00:05, 454.19 examples/s]Map:  84%|████████▎ | 11732/14042 [00:30<00:04, 462.46 examples/s]Map:  84%|████████▍ | 11780/14042 [00:30<00:04, 466.68 examples/s]Map:  84%|████████▍ | 11851/14042 [00:30<00:04, 467.59 examples/s]Map:  85%|████████▍ | 11900/14042 [00:30<00:04, 470.67 examples/s]Map:  85%|████████▌ | 11973/14042 [00:30<00:04, 470.67 examples/s]Map:  86%|████████▌ | 12022/14042 [00:31<00:06, 296.23 examples/s]Map:  86%|████████▌ | 12069/14042 [00:31<00:06, 327.19 examples/s]Map:  86%|████████▋ | 12118/14042 [00:31<00:05, 358.16 examples/s]Map:  87%|████████▋ | 12165/14042 [00:31<00:04, 381.28 examples/s]Map:  87%|████████▋ | 12212/14042 [00:31<00:04, 400.59 examples/s]Map:  87%|████████▋ | 12261/14042 [00:31<00:04, 419.73 examples/s]Map:  88%|████████▊ | 12329/14042 [00:31<00:03, 429.29 examples/s]Map:  88%|████████▊ | 12377/14042 [00:31<00:03, 437.94 examples/s]Map:  89%|████████▊ | 12445/14042 [00:32<00:03, 442.19 examples/s]Map:  89%|████████▉ | 12492/14042 [00:32<00:03, 447.84 examples/s]Map:  89%|████████▉ | 12538/14042 [00:32<00:03, 448.42 examples/s]Map:  90%|████████▉ | 12584/14042 [00:32<00:03, 448.42 examples/s]Map:  90%|████████▉ | 12633/14042 [00:32<00:03, 457.61 examples/s]Map:  90%|█████████ | 12680/14042 [00:32<00:02, 455.94 examples/s]Map:  91%|█████████ | 12727/14042 [00:32<00:02, 454.30 examples/s]Map:  91%|█████████ | 12774/14042 [00:32<00:02, 455.83 examples/s]Map:  91%|█████████▏| 12823/14042 [00:32<00:02, 459.21 examples/s]Map:  92%|█████████▏| 12873/14042 [00:33<00:02, 470.07 examples/s]Map:  92%|█████████▏| 12943/14042 [00:33<00:02, 466.29 examples/s]Map:  93%|█████████▎| 12990/14042 [00:33<00:02, 466.93 examples/s]Map:  93%|█████████▎| 13045/14042 [00:33<00:03, 283.22 examples/s]Map:  93%|█████████▎| 13092/14042 [00:33<00:03, 316.57 examples/s]Map:  94%|█████████▎| 13137/14042 [00:33<00:02, 342.63 examples/s]Map:  94%|█████████▍| 13186/14042 [00:33<00:02, 375.84 examples/s]Map:  94%|█████████▍| 13232/14042 [00:34<00:02, 394.08 examples/s]Map:  95%|█████████▍| 13280/14042 [00:34<00:01, 413.79 examples/s]Map:  95%|█████████▍| 13327/14042 [00:34<00:01, 427.61 examples/s]Map:  95%|█████████▌| 13375/14042 [00:34<00:01, 438.26 examples/s]Map:  96%|█████████▌| 13423/14042 [00:34<00:01, 448.86 examples/s]Map:  96%|█████████▌| 13472/14042 [00:34<00:01, 458.29 examples/s]Map:  96%|█████████▋| 13541/14042 [00:34<00:01, 455.48 examples/s]Map:  97%|█████████▋| 13590/14042 [00:34<00:00, 460.49 examples/s]Map:  97%|█████████▋| 13639/14042 [00:34<00:00, 466.33 examples/s]Map:  97%|█████████▋| 13687/14042 [00:35<00:00, 465.86 examples/s]Map:  98%|█████████▊| 13734/14042 [00:35<00:00, 465.17 examples/s]Map:  98%|█████████▊| 13782/14042 [00:35<00:00, 467.45 examples/s]Map:  99%|█████████▊| 13832/14042 [00:35<00:00, 470.29 examples/s]Map:  99%|█████████▉| 13880/14042 [00:35<00:00, 469.87 examples/s]Map:  99%|█████████▉| 13929/14042 [00:35<00:00, 472.25 examples/s]Map: 100%|█████████▉| 13998/14042 [00:35<00:00, 463.54 examples/s]Map: 100%|██████████| 14042/14042 [00:36<00:00, 389.41 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 33/10042 [00:00<00:31, 320.93 examples/s]Map:   1%|          | 68/10042 [00:00<00:30, 328.39 examples/s]Map:   1%|          | 102/10042 [00:00<00:30, 331.25 examples/s]Map:   1%|▏         | 136/10042 [00:00<00:29, 333.60 examples/s]Map:   2%|▏         | 171/10042 [00:00<00:29, 335.71 examples/s]Map:   2%|▏         | 207/10042 [00:00<00:29, 338.67 examples/s]Map:   2%|▏         | 241/10042 [00:00<00:28, 338.76 examples/s]Map:   3%|▎         | 276/10042 [00:01<00:47, 204.94 examples/s]Map:   3%|▎         | 309/10042 [00:01<00:42, 230.52 examples/s]Map:   3%|▎         | 345/10042 [00:01<00:37, 257.78 examples/s]Map:   4%|▍         | 381/10042 [00:01<00:34, 280.82 examples/s]Map:   4%|▍         | 416/10042 [00:01<00:32, 296.36 examples/s]Map:   5%|▍         | 452/10042 [00:01<00:30, 309.72 examples/s]Map:   5%|▍         | 487/10042 [00:01<00:30, 318.39 examples/s]Map:   5%|▌         | 522/10042 [00:01<00:29, 325.12 examples/s]Map:   6%|▌         | 557/10042 [00:01<00:28, 330.29 examples/s]Map:   6%|▌         | 593/10042 [00:01<00:28, 335.21 examples/s]Map:   6%|▋         | 628/10042 [00:02<00:27, 336.65 examples/s]Map:   7%|▋         | 663/10042 [00:02<00:27, 336.56 examples/s]Map:   7%|▋         | 697/10042 [00:02<00:27, 334.81 examples/s]Map:   7%|▋         | 731/10042 [00:02<00:27, 335.80 examples/s]Map:   8%|▊         | 766/10042 [00:02<00:27, 338.05 examples/s]Map:   8%|▊         | 801/10042 [00:02<00:27, 339.86 examples/s]Map:   8%|▊         | 836/10042 [00:02<00:27, 340.42 examples/s]Map:   9%|▊         | 871/10042 [00:02<00:26, 341.33 examples/s]Map:   9%|▉         | 923/10042 [00:02<00:26, 340.44 examples/s]Map:  10%|▉         | 958/10042 [00:03<00:26, 340.33 examples/s]Map:  10%|▉         | 993/10042 [00:03<00:26, 340.08 examples/s]Map:  10%|█         | 1035/10042 [00:03<00:54, 164.50 examples/s]Map:  11%|█         | 1071/10042 [00:03<00:46, 193.35 examples/s]Map:  11%|█         | 1107/10042 [00:03<00:40, 221.66 examples/s]Map:  11%|█▏        | 1143/10042 [00:03<00:35, 248.65 examples/s]Map:  12%|█▏        | 1177/10042 [00:04<00:32, 268.79 examples/s]Map:  12%|█▏        | 1213/10042 [00:04<00:30, 288.02 examples/s]Map:  12%|█▏        | 1248/10042 [00:04<00:29, 302.08 examples/s]Map:  13%|█▎        | 1284/10042 [00:04<00:27, 313.16 examples/s]Map:  13%|█▎        | 1319/10042 [00:04<00:27, 320.15 examples/s]Map:  13%|█▎        | 1354/10042 [00:04<00:26, 325.25 examples/s]Map:  14%|█▍        | 1390/10042 [00:04<00:26, 330.74 examples/s]Map:  14%|█▍        | 1425/10042 [00:04<00:25, 333.86 examples/s]Map:  15%|█▍        | 1460/10042 [00:04<00:25, 336.34 examples/s]Map:  15%|█▍        | 1496/10042 [00:05<00:25, 339.96 examples/s]Map:  15%|█▌        | 1531/10042 [00:05<00:24, 340.59 examples/s]Map:  16%|█▌        | 1566/10042 [00:05<00:24, 340.36 examples/s]Map:  16%|█▌        | 1616/10042 [00:05<00:25, 335.14 examples/s]Map:  16%|█▋        | 1652/10042 [00:05<00:24, 336.68 examples/s]Map:  17%|█▋        | 1687/10042 [00:05<00:24, 338.48 examples/s]Map:  17%|█▋        | 1723/10042 [00:05<00:24, 339.65 examples/s]Map:  18%|█▊        | 1774/10042 [00:05<00:24, 337.96 examples/s]Map:  18%|█▊        | 1809/10042 [00:05<00:24, 337.32 examples/s]Map:  18%|█▊        | 1844/10042 [00:06<00:24, 336.92 examples/s]Map:  19%|█▊        | 1880/10042 [00:06<00:24, 339.63 examples/s]Map:  19%|█▉        | 1915/10042 [00:06<00:23, 340.48 examples/s]Map:  19%|█▉        | 1950/10042 [00:06<00:23, 339.92 examples/s]Map:  20%|█▉        | 1986/10042 [00:06<00:23, 340.33 examples/s]Map:  20%|██        | 2034/10042 [00:06<00:38, 205.67 examples/s]Map:  21%|██        | 2069/10042 [00:06<00:34, 230.32 examples/s]Map:  21%|██        | 2103/10042 [00:07<00:31, 251.89 examples/s]Map:  21%|██▏       | 2138/10042 [00:07<00:28, 272.57 examples/s]Map:  22%|██▏       | 2174/10042 [00:07<00:27, 290.23 examples/s]Map:  22%|██▏       | 2208/10042 [00:07<00:25, 301.82 examples/s]Map:  22%|██▏       | 2243/10042 [00:07<00:24, 312.64 examples/s]Map:  23%|██▎       | 2277/10042 [00:07<00:24, 316.20 examples/s]Map:  23%|██▎       | 2312/10042 [00:07<00:23, 322.40 examples/s]Map:  23%|██▎       | 2347/10042 [00:07<00:23, 327.77 examples/s]Map:  24%|██▎       | 2382/10042 [00:07<00:23, 331.47 examples/s]Map:  24%|██▍       | 2417/10042 [00:07<00:22, 333.72 examples/s]Map:  24%|██▍       | 2452/10042 [00:08<00:22, 337.06 examples/s]Map:  25%|██▍       | 2487/10042 [00:08<00:22, 338.29 examples/s]Map:  25%|██▌       | 2523/10042 [00:08<00:22, 341.00 examples/s]Map:  26%|██▌       | 2574/10042 [00:08<00:21, 339.54 examples/s]Map:  26%|██▌       | 2625/10042 [00:08<00:21, 338.98 examples/s]Map:  26%|██▋       | 2659/10042 [00:08<00:21, 337.19 examples/s]Map:  27%|██▋       | 2694/10042 [00:08<00:21, 338.08 examples/s]Map:  27%|██▋       | 2728/10042 [00:08<00:21, 335.96 examples/s]Map:  28%|██▊       | 2763/10042 [00:09<00:21, 335.74 examples/s]Map:  28%|██▊       | 2797/10042 [00:09<00:21, 336.80 examples/s]Map:  28%|██▊       | 2832/10042 [00:09<00:21, 338.05 examples/s]Map:  29%|██▊       | 2867/10042 [00:09<00:21, 339.82 examples/s]Map:  29%|██▉       | 2901/10042 [00:09<00:21, 339.40 examples/s]Map:  29%|██▉       | 2936/10042 [00:09<00:20, 339.28 examples/s]Map:  30%|██▉       | 2971/10042 [00:09<00:20, 338.94 examples/s]Map:  30%|███       | 3016/10042 [00:10<00:35, 196.90 examples/s]Map:  30%|███       | 3051/10042 [00:10<00:31, 223.76 examples/s]Map:  31%|███       | 3085/10042 [00:10<00:28, 247.57 examples/s]Map:  31%|███       | 3120/10042 [00:10<00:25, 269.10 examples/s]Map:  31%|███▏      | 3154/10042 [00:10<00:24, 285.33 examples/s]Map:  32%|███▏      | 3189/10042 [00:10<00:22, 299.48 examples/s]Map:  32%|███▏      | 3223/10042 [00:10<00:22, 307.92 examples/s]Map:  32%|███▏      | 3257/10042 [00:10<00:21, 313.32 examples/s]Map:  33%|███▎      | 3305/10042 [00:10<00:21, 312.13 examples/s]Map:  33%|███▎      | 3353/10042 [00:11<00:21, 313.59 examples/s]Map:  34%|███▍      | 3401/10042 [00:11<00:21, 313.54 examples/s]Map:  34%|███▍      | 3433/10042 [00:11<00:21, 314.67 examples/s]Map:  35%|███▍      | 3465/10042 [00:11<00:20, 315.00 examples/s]Map:  35%|███▍      | 3497/10042 [00:11<00:20, 314.10 examples/s]Map:  35%|███▌      | 3529/10042 [00:11<00:20, 313.28 examples/s]Map:  35%|███▌      | 3562/10042 [00:11<00:20, 315.22 examples/s]Map:  36%|███▌      | 3595/10042 [00:11<00:20, 315.93 examples/s]Map:  36%|███▌      | 3627/10042 [00:11<00:20, 315.29 examples/s]Map:  36%|███▋      | 3659/10042 [00:12<00:20, 312.46 examples/s]Map:  37%|███▋      | 3705/10042 [00:12<00:20, 307.99 examples/s]Map:  37%|███▋      | 3737/10042 [00:12<00:20, 309.06 examples/s]Map:  38%|███▊      | 3784/10042 [00:12<00:20, 306.34 examples/s]Map:  38%|███▊      | 3816/10042 [00:12<00:20, 307.61 examples/s]Map:  38%|███▊      | 3848/10042 [00:12<00:20, 308.64 examples/s]Map:  39%|███▊      | 3880/10042 [00:12<00:19, 308.95 examples/s]Map:  39%|███▉      | 3913/10042 [00:12<00:19, 310.22 examples/s]Map:  39%|███▉      | 3945/10042 [00:12<00:19, 310.65 examples/s]Map:  40%|███▉      | 3977/10042 [00:13<00:19, 311.31 examples/s]Map:  40%|███▉      | 4015/10042 [00:13<00:33, 181.15 examples/s]Map:  40%|████      | 4047/10042 [00:13<00:29, 205.43 examples/s]Map:  41%|████      | 4079/10042 [00:13<00:26, 227.63 examples/s]Map:  41%|████      | 4111/10042 [00:13<00:23, 247.87 examples/s]Map:  41%|████▏     | 4143/10042 [00:13<00:22, 263.71 examples/s]Map:  42%|████▏     | 4175/10042 [00:13<00:21, 275.98 examples/s]Map:  42%|████▏     | 4208/10042 [00:14<00:20, 288.10 examples/s]Map:  42%|████▏     | 4240/10042 [00:14<00:19, 294.76 examples/s]Map:  43%|████▎     | 4272/10042 [00:14<00:19, 301.12 examples/s]Map:  43%|████▎     | 4305/10042 [00:14<00:18, 305.10 examples/s]Map:  43%|████▎     | 4337/10042 [00:14<00:18, 308.25 examples/s]Map:  44%|████▎     | 4369/10042 [00:14<00:18, 309.00 examples/s]Map:  44%|████▍     | 4403/10042 [00:14<00:17, 314.59 examples/s]Map:  44%|████▍     | 4436/10042 [00:14<00:17, 315.15 examples/s]Map:  44%|████▍     | 4468/10042 [00:14<00:17, 313.65 examples/s]Map:  45%|████▍     | 4501/10042 [00:14<00:17, 314.49 examples/s]Map:  45%|████▌     | 4533/10042 [00:15<00:17, 312.19 examples/s]Map:  45%|████▌     | 4565/10042 [00:15<00:17, 311.45 examples/s]Map:  46%|████▌     | 4597/10042 [00:15<00:17, 311.70 examples/s]Map:  46%|████▌     | 4630/10042 [00:15<00:17, 312.84 examples/s]Map:  46%|████▋     | 4662/10042 [00:15<00:17, 312.29 examples/s]Map:  47%|████▋     | 4695/10042 [00:15<00:16, 315.09 examples/s]Map:  47%|████▋     | 4727/10042 [00:15<00:16, 313.57 examples/s]Map:  47%|████▋     | 4761/10042 [00:15<00:16, 317.75 examples/s]Map:  48%|████▊     | 4793/10042 [00:15<00:16, 317.17 examples/s]Map:  48%|████▊     | 4826/10042 [00:16<00:16, 317.37 examples/s]Map:  48%|████▊     | 4858/10042 [00:16<00:16, 315.81 examples/s]Map:  49%|████▊     | 4891/10042 [00:16<00:16, 317.24 examples/s]Map:  49%|████▉     | 4923/10042 [00:16<00:16, 316.07 examples/s]Map:  49%|████▉     | 4955/10042 [00:16<00:16, 316.34 examples/s]Map:  50%|████▉     | 4988/10042 [00:16<00:16, 315.10 examples/s]Map:  50%|█████     | 5029/10042 [00:17<00:36, 138.35 examples/s]Map:  50%|█████     | 5061/10042 [00:17<00:30, 163.84 examples/s]Map:  51%|█████     | 5093/10042 [00:17<00:26, 189.53 examples/s]Map:  51%|█████     | 5125/10042 [00:17<00:22, 214.02 examples/s]Map:  51%|█████▏    | 5157/10042 [00:17<00:20, 235.90 examples/s]Map:  52%|█████▏    | 5189/10042 [00:17<00:19, 254.28 examples/s]Map:  52%|█████▏    | 5222/10042 [00:17<00:17, 270.93 examples/s]Map:  52%|█████▏    | 5255/10042 [00:17<00:16, 283.94 examples/s]Map:  53%|█████▎    | 5288/10042 [00:17<00:16, 294.06 examples/s]Map:  53%|█████▎    | 5321/10042 [00:18<00:15, 299.88 examples/s]Map:  53%|█████▎    | 5353/10042 [00:18<00:15, 303.58 examples/s]Map:  54%|█████▎    | 5385/10042 [00:18<00:15, 306.24 examples/s]Map:  54%|█████▍    | 5419/10042 [00:18<00:14, 311.51 examples/s]Map:  54%|█████▍    | 5452/10042 [00:18<00:14, 313.61 examples/s]Map:  55%|█████▍    | 5484/10042 [00:18<00:14, 313.62 examples/s]Map:  55%|█████▍    | 5516/10042 [00:18<00:14, 313.93 examples/s]Map:  55%|█████▌    | 5549/10042 [00:18<00:14, 314.70 examples/s]Map:  56%|█████▌    | 5581/10042 [00:18<00:14, 314.71 examples/s]Map:  56%|█████▌    | 5613/10042 [00:18<00:14, 314.65 examples/s]Map:  56%|█████▌    | 5645/10042 [00:19<00:13, 314.85 examples/s]Map:  57%|█████▋    | 5677/10042 [00:19<00:13, 314.16 examples/s]Map:  57%|█████▋    | 5710/10042 [00:19<00:13, 314.58 examples/s]Map:  57%|█████▋    | 5742/10042 [00:19<00:13, 312.73 examples/s]Map:  57%|█████▋    | 5774/10042 [00:19<00:13, 313.33 examples/s]Map:  58%|█████▊    | 5807/10042 [00:19<00:13, 314.97 examples/s]Map:  58%|█████▊    | 5839/10042 [00:19<00:13, 314.39 examples/s]Map:  58%|█████▊    | 5871/10042 [00:19<00:13, 311.40 examples/s]Map:  59%|█████▉    | 5903/10042 [00:19<00:13, 310.79 examples/s]Map:  59%|█████▉    | 5935/10042 [00:20<00:13, 312.03 examples/s]Map:  59%|█████▉    | 5968/10042 [00:20<00:12, 314.12 examples/s]Map:  60%|█████▉    | 6000/10042 [00:20<00:23, 174.41 examples/s]Map:  60%|██████    | 6031/10042 [00:20<00:20, 199.11 examples/s]Map:  60%|██████    | 6063/10042 [00:20<00:17, 223.77 examples/s]Map:  61%|██████    | 6095/10042 [00:20<00:16, 245.67 examples/s]Map:  61%|██████    | 6127/10042 [00:20<00:14, 261.86 examples/s]Map:  61%|██████▏   | 6160/10042 [00:21<00:14, 276.79 examples/s]Map:  62%|██████▏   | 6192/10042 [00:21<00:13, 287.05 examples/s]Map:  62%|██████▏   | 6224/10042 [00:21<00:12, 293.82 examples/s]Map:  62%|██████▏   | 6256/10042 [00:21<00:12, 299.68 examples/s]Map:  63%|██████▎   | 6288/10042 [00:21<00:12, 303.95 examples/s]Map:  63%|██████▎   | 6321/10042 [00:21<00:12, 308.20 examples/s]Map:  63%|██████▎   | 6354/10042 [00:21<00:11, 311.64 examples/s]Map:  64%|██████▎   | 6387/10042 [00:21<00:11, 312.99 examples/s]Map:  64%|██████▍   | 6419/10042 [00:21<00:11, 314.44 examples/s]Map:  64%|██████▍   | 6452/10042 [00:21<00:11, 317.38 examples/s]Map:  65%|██████▍   | 6484/10042 [00:22<00:11, 317.33 examples/s]Map:  65%|██████▍   | 6516/10042 [00:22<00:11, 314.74 examples/s]Map:  65%|██████▌   | 6548/10042 [00:22<00:11, 315.64 examples/s]Map:  66%|██████▌   | 6582/10042 [00:22<00:10, 317.52 examples/s]Map:  66%|██████▌   | 6615/10042 [00:22<00:10, 316.88 examples/s]Map:  66%|██████▋   | 6662/10042 [00:22<00:10, 313.24 examples/s]Map:  67%|██████▋   | 6694/10042 [00:22<00:10, 312.57 examples/s]Map:  67%|██████▋   | 6726/10042 [00:22<00:10, 311.55 examples/s]Map:  67%|██████▋   | 6758/10042 [00:22<00:10, 311.58 examples/s]Map:  68%|██████▊   | 6791/10042 [00:23<00:10, 313.40 examples/s]Map:  68%|██████▊   | 6824/10042 [00:23<00:10, 313.56 examples/s]Map:  68%|██████▊   | 6856/10042 [00:23<00:10, 313.27 examples/s]Map:  69%|██████▊   | 6888/10042 [00:23<00:10, 313.51 examples/s]Map:  69%|██████▉   | 6920/10042 [00:23<00:10, 311.59 examples/s]Map:  69%|██████▉   | 6967/10042 [00:23<00:09, 309.79 examples/s]Map:  70%|██████▉   | 6999/10042 [00:23<00:09, 309.87 examples/s]Map:  70%|███████   | 7031/10042 [00:24<00:16, 177.73 examples/s]Map:  70%|███████   | 7063/10042 [00:24<00:14, 202.85 examples/s]Map:  71%|███████   | 7095/10042 [00:24<00:13, 226.13 examples/s]Map:  71%|███████   | 7127/10042 [00:24<00:11, 245.34 examples/s]Map:  71%|███████▏  | 7159/10042 [00:24<00:11, 261.59 examples/s]Map:  72%|███████▏  | 7191/10042 [00:24<00:10, 275.19 examples/s]Map:  72%|███████▏  | 7224/10042 [00:24<00:09, 286.98 examples/s]Map:  72%|███████▏  | 7256/10042 [00:24<00:09, 295.10 examples/s]Map:  73%|███████▎  | 7288/10042 [00:24<00:09, 299.59 examples/s]Map:  73%|███████▎  | 7320/10042 [00:24<00:08, 303.00 examples/s]Map:  73%|███████▎  | 7352/10042 [00:25<00:08, 304.97 examples/s]Map:  74%|███████▎  | 7384/10042 [00:25<00:08, 307.09 examples/s]Map:  74%|███████▍  | 7431/10042 [00:25<00:08, 306.19 examples/s]Map:  74%|███████▍  | 7463/10042 [00:25<00:08, 305.68 examples/s]Map:  75%|███████▍  | 7495/10042 [00:25<00:08, 307.64 examples/s]Map:  75%|███████▍  | 7527/10042 [00:25<00:08, 308.20 examples/s]Map:  75%|███████▌  | 7559/10042 [00:25<00:08, 309.66 examples/s]Map:  76%|███████▌  | 7591/10042 [00:25<00:07, 312.11 examples/s]Map:  76%|███████▌  | 7623/10042 [00:25<00:07, 313.92 examples/s]Map:  76%|███████▌  | 7655/10042 [00:26<00:07, 314.94 examples/s]Map:  77%|███████▋  | 7687/10042 [00:26<00:07, 315.38 examples/s]Map:  77%|███████▋  | 7720/10042 [00:26<00:07, 315.17 examples/s]Map:  77%|███████▋  | 7752/10042 [00:26<00:07, 314.44 examples/s]Map:  78%|███████▊  | 7784/10042 [00:26<00:07, 314.43 examples/s]Map:  78%|███████▊  | 7816/10042 [00:26<00:07, 314.11 examples/s]Map:  78%|███████▊  | 7849/10042 [00:26<00:06, 314.80 examples/s]Map:  79%|███████▊  | 7883/10042 [00:26<00:06, 316.96 examples/s]Map:  79%|███████▉  | 7915/10042 [00:26<00:06, 316.83 examples/s]Map:  79%|███████▉  | 7948/10042 [00:26<00:06, 317.83 examples/s]Map:  79%|███████▉  | 7980/10042 [00:27<00:06, 316.82 examples/s]Map:  80%|███████▉  | 8015/10042 [00:27<00:11, 175.45 examples/s]Map:  80%|████████  | 8047/10042 [00:27<00:09, 201.47 examples/s]Map:  80%|████████  | 8079/10042 [00:27<00:08, 225.35 examples/s]Map:  81%|████████  | 8111/10042 [00:27<00:07, 244.69 examples/s]Map:  81%|████████  | 8143/10042 [00:27<00:07, 262.78 examples/s]Map:  81%|████████▏ | 8176/10042 [00:27<00:06, 276.45 examples/s]Map:  82%|████████▏ | 8209/10042 [00:28<00:06, 287.14 examples/s]Map:  82%|████████▏ | 8242/10042 [00:28<00:06, 296.30 examples/s]Map:  82%|████████▏ | 8274/10042 [00:28<00:05, 299.41 examples/s]Map:  83%|████████▎ | 8319/10042 [00:28<00:05, 298.49 examples/s]Map:  83%|████████▎ | 8351/10042 [00:28<00:05, 300.91 examples/s]Map:  83%|████████▎ | 8383/10042 [00:28<00:05, 302.90 examples/s]Map:  84%|████████▍ | 8415/10042 [00:28<00:05, 304.55 examples/s]Map:  84%|████████▍ | 8447/10042 [00:28<00:05, 305.99 examples/s]Map:  84%|████████▍ | 8480/10042 [00:28<00:05, 309.01 examples/s]Map:  85%|████████▍ | 8527/10042 [00:29<00:04, 308.63 examples/s]Map:  85%|████████▌ | 8559/10042 [00:29<00:04, 308.81 examples/s]Map:  86%|████████▌ | 8591/10042 [00:29<00:04, 308.23 examples/s]Map:  86%|████████▌ | 8623/10042 [00:29<00:04, 307.42 examples/s]Map:  86%|████████▌ | 8655/10042 [00:29<00:04, 307.94 examples/s]Map:  87%|████████▋ | 8687/10042 [00:29<00:04, 309.71 examples/s]Map:  87%|████████▋ | 8719/10042 [00:29<00:04, 310.56 examples/s]Map:  87%|████████▋ | 8751/10042 [00:29<00:04, 311.21 examples/s]Map:  87%|████████▋ | 8783/10042 [00:29<00:04, 311.37 examples/s]Map:  88%|████████▊ | 8815/10042 [00:30<00:03, 312.41 examples/s]Map:  88%|████████▊ | 8847/10042 [00:30<00:03, 312.97 examples/s]Map:  88%|████████▊ | 8879/10042 [00:30<00:03, 314.52 examples/s]Map:  89%|████████▉ | 8927/10042 [00:30<00:03, 313.09 examples/s]Map:  89%|████████▉ | 8974/10042 [00:30<00:03, 312.28 examples/s]Map:  90%|████████▉ | 9016/10042 [00:30<00:05, 194.06 examples/s]Map:  90%|█████████ | 9048/10042 [00:31<00:04, 214.48 examples/s]Map:  90%|█████████ | 9081/10042 [00:31<00:04, 235.18 examples/s]Map:  91%|█████████ | 9113/10042 [00:31<00:03, 252.22 examples/s]Map:  91%|█████████ | 9145/10042 [00:31<00:03, 266.40 examples/s]Map:  91%|█████████▏| 9177/10042 [00:31<00:03, 278.21 examples/s]Map:  92%|█████████▏| 9209/10042 [00:31<00:02, 286.65 examples/s]Map:  92%|█████████▏| 9242/10042 [00:31<00:02, 294.78 examples/s]Map:  92%|█████████▏| 9275/10042 [00:31<00:02, 300.63 examples/s]Map:  93%|█████████▎| 9308/10042 [00:31<00:02, 303.60 examples/s]Map:  93%|█████████▎| 9340/10042 [00:31<00:02, 306.97 examples/s]Map:  93%|█████████▎| 9373/10042 [00:32<00:02, 310.14 examples/s]Map:  94%|█████████▎| 9405/10042 [00:32<00:02, 310.90 examples/s]Map:  94%|█████████▍| 9438/10042 [00:32<00:01, 312.83 examples/s]Map:  94%|█████████▍| 9470/10042 [00:32<00:01, 311.61 examples/s]Map:  95%|█████████▍| 9502/10042 [00:32<00:01, 311.51 examples/s]Map:  95%|█████████▍| 9534/10042 [00:32<00:01, 311.65 examples/s]Map:  95%|█████████▌| 9566/10042 [00:32<00:01, 310.95 examples/s]Map:  96%|█████████▌| 9599/10042 [00:32<00:01, 312.91 examples/s]Map:  96%|█████████▌| 9631/10042 [00:32<00:01, 311.67 examples/s]Map:  96%|█████████▋| 9678/10042 [00:33<00:01, 310.76 examples/s]Map:  97%|█████████▋| 9710/10042 [00:33<00:01, 311.97 examples/s]Map:  97%|█████████▋| 9742/10042 [00:33<00:00, 311.38 examples/s]Map:  97%|█████████▋| 9774/10042 [00:33<00:00, 312.03 examples/s]Map:  98%|█████████▊| 9806/10042 [00:33<00:00, 311.75 examples/s]Map:  98%|█████████▊| 9839/10042 [00:33<00:00, 313.53 examples/s]Map:  98%|█████████▊| 9871/10042 [00:33<00:00, 313.07 examples/s]Map:  99%|█████████▊| 9903/10042 [00:33<00:00, 313.10 examples/s]Map:  99%|█████████▉| 9935/10042 [00:33<00:00, 314.05 examples/s]Map:  99%|█████████▉| 9967/10042 [00:33<00:00, 315.11 examples/s]Map: 100%|█████████▉| 10000/10042 [00:34<00:00, 137.37 examples/s]Map: 100%|█████████▉| 10031/10042 [00:34<00:00, 163.51 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 289.17 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   8%|▊         | 98/1267 [00:00<00:01, 959.00 examples/s]Map:  16%|█▌        | 197/1267 [00:00<00:01, 976.43 examples/s]Map:  24%|██▎       | 298/1267 [00:00<00:00, 988.05 examples/s]Map:  35%|███▌      | 446/1267 [00:00<00:00, 981.45 examples/s]Map:  43%|████▎     | 546/1267 [00:00<00:00, 982.79 examples/s]Map:  51%|█████     | 647/1267 [00:00<00:00, 986.97 examples/s]Map:  63%|██████▎   | 792/1267 [00:00<00:00, 973.91 examples/s]Map:  71%|███████   | 894/1267 [00:00<00:00, 983.78 examples/s]Map:  79%|███████▊  | 995/1267 [00:01<00:00, 987.78 examples/s]Map:  87%|████████▋ | 1101/1267 [00:01<00:00, 632.49 examples/s]Map:  95%|█████████▍| 1203/1267 [00:01<00:00, 710.59 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 820.56 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.62it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  4.77it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.17it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  5.04it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:09<00:18,  9.29s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:20<00:10, 10.21s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:26<00:00,  8.33s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:26<00:00,  8.74s/it]
2024-05-04 04:29:14,705: rank0[533746][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-05-04 04:29:14,708: rank0[533746][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-05-04 04:29:16,013: rank0[533746][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-05-04 04:29:16,026: rank0[533746][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-05-04 04:29:30,175: rank0[533746][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-05-04 04:29:30,176: rank0[533746][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-05-04 04:29:30,176: rank0[533746][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp24_uniform_noKD_2ep_lr1e-5_bs512_noGradClip_warmup100ba_seqlen1024
models:
- model_name: /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp24_uniform_noKD_2ep_lr1e-5_bs512_noGradClip_warmup100ba_seqlen1024
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp24_uniform_noKD_2ep_lr1e-5_bs512_noGradClip_warmup100ba_seqlen1024
    use_auth_token: true
  tokenizer:
    name: /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp24_uniform_noKD_2ep_lr1e-5_bs512_noGradClip_warmup100ba_seqlen1024
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-05-04 04:29:30,183: rank0[533746][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.5265
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.4956
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7873
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7490
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                                                                 |
|:-----------|:--------------|:----------|-----------:|:------------------|:----------------------------------------------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.526451 | 25-shot           | /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp24_uniform_noKD_2ep_lr1e-5_bs512_noGradClip_warmup100ba_seqlen1024 |
|            | mmlu          |           |   0.495585 | 5-shot            | /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp24_uniform_noKD_2ep_lr1e-5_bs512_noGradClip_warmup100ba_seqlen1024 |
|            | winogrande    |           |   0.749013 | 5-shot            | /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp24_uniform_noKD_2ep_lr1e-5_bs512_noGradClip_warmup100ba_seqlen1024 |
|            | hellaswag     |           |   0.787293 | 10-shot           | /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp24_uniform_noKD_2ep_lr1e-5_bs512_noGradClip_warmup100ba_seqlen1024 |
2024-05-04 05:30:38,470: rank0[533746][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-05-04 05:30:38,471: rank0[533746][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-05-04 05:30:38,471: rank0[533746][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-05-04 05:30:38,471: rank0[533746][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
