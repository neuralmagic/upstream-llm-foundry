----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-05-04 05:30:53,518: rank0[538999][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 27/1172 [00:00<00:04, 254.15 examples/s]Map:   5%|▍         | 55/1172 [00:00<00:04, 263.38 examples/s]Map:   7%|▋         | 82/1172 [00:00<00:04, 262.35 examples/s]Map:  10%|█         | 121/1172 [00:00<00:04, 256.56 examples/s]Map:  13%|█▎        | 148/1172 [00:00<00:03, 258.12 examples/s]Map:  15%|█▌        | 176/1172 [00:00<00:03, 261.45 examples/s]Map:  17%|█▋        | 203/1172 [00:00<00:03, 260.15 examples/s]Map:  20%|█▉        | 231/1172 [00:00<00:03, 261.78 examples/s]Map:  22%|██▏       | 258/1172 [00:00<00:03, 261.67 examples/s]Map:  24%|██▍       | 285/1172 [00:01<00:03, 262.80 examples/s]Map:  27%|██▋       | 313/1172 [00:01<00:03, 263.55 examples/s]Map:  29%|██▉       | 341/1172 [00:01<00:03, 266.00 examples/s]Map:  31%|███▏      | 368/1172 [00:01<00:03, 265.54 examples/s]Map:  34%|███▍      | 396/1172 [00:01<00:02, 265.94 examples/s]Map:  36%|███▌      | 424/1172 [00:01<00:02, 265.11 examples/s]Map:  39%|███▊      | 452/1172 [00:01<00:02, 264.44 examples/s]Map:  41%|████      | 480/1172 [00:01<00:02, 264.33 examples/s]Map:  43%|████▎     | 508/1172 [00:01<00:02, 264.66 examples/s]Map:  46%|████▌     | 536/1172 [00:02<00:02, 266.36 examples/s]Map:  48%|████▊     | 564/1172 [00:02<00:02, 266.49 examples/s]Map:  51%|█████     | 592/1172 [00:02<00:02, 266.32 examples/s]Map:  53%|█████▎    | 619/1172 [00:02<00:02, 266.06 examples/s]Map:  55%|█████▌    | 647/1172 [00:02<00:01, 265.61 examples/s]Map:  58%|█████▊    | 675/1172 [00:02<00:01, 266.41 examples/s]Map:  60%|█████▉    | 703/1172 [00:02<00:01, 265.78 examples/s]Map:  62%|██████▏   | 730/1172 [00:02<00:01, 264.96 examples/s]Map:  65%|██████▍   | 758/1172 [00:02<00:01, 265.72 examples/s]Map:  67%|██████▋   | 785/1172 [00:02<00:01, 263.58 examples/s]Map:  69%|██████▉   | 813/1172 [00:03<00:01, 263.04 examples/s]Map:  72%|███████▏  | 841/1172 [00:03<00:01, 263.92 examples/s]Map:  74%|███████▍  | 868/1172 [00:03<00:01, 263.87 examples/s]Map:  76%|███████▋  | 896/1172 [00:03<00:01, 263.41 examples/s]Map:  79%|███████▉  | 924/1172 [00:03<00:00, 262.92 examples/s]Map:  81%|████████  | 952/1172 [00:03<00:00, 263.44 examples/s]Map:  84%|████████▎ | 980/1172 [00:03<00:00, 265.04 examples/s]Map:  86%|████████▋ | 1013/1172 [00:04<00:01, 124.49 examples/s]Map:  89%|████████▊ | 1040/1172 [00:04<00:00, 145.91 examples/s]Map:  91%|█████████ | 1068/1172 [00:04<00:00, 168.18 examples/s]Map:  94%|█████████▎| 1096/1172 [00:04<00:00, 188.13 examples/s]Map:  96%|█████████▌| 1123/1172 [00:04<00:00, 205.61 examples/s]Map:  98%|█████████▊| 1151/1172 [00:04<00:00, 220.13 examples/s]Map: 100%|██████████| 1172/1172 [00:04<00:00, 237.49 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 45/14042 [00:00<00:31, 445.85 examples/s]Map:   1%|          | 111/14042 [00:00<00:32, 431.90 examples/s]Map:   1%|          | 155/14042 [00:00<00:32, 427.42 examples/s]Map:   2%|▏         | 222/14042 [00:00<00:32, 431.47 examples/s]Map:   2%|▏         | 286/14042 [00:00<00:32, 422.92 examples/s]Map:   2%|▏         | 332/14042 [00:00<00:31, 430.79 examples/s]Map:   3%|▎         | 383/14042 [00:01<00:52, 261.64 examples/s]Map:   3%|▎         | 423/14042 [00:01<00:47, 285.79 examples/s]Map:   3%|▎         | 468/14042 [00:01<00:42, 318.95 examples/s]Map:   4%|▎         | 514/14042 [00:01<00:38, 348.10 examples/s]Map:   4%|▍         | 556/14042 [00:01<00:37, 363.21 examples/s]Map:   4%|▍         | 601/14042 [00:01<00:35, 383.99 examples/s]Map:   5%|▍         | 645/14042 [00:01<00:33, 397.55 examples/s]Map:   5%|▌         | 708/14042 [00:01<00:33, 402.71 examples/s]Map:   5%|▌         | 753/14042 [00:02<00:32, 411.42 examples/s]Map:   6%|▌         | 797/14042 [00:02<00:31, 415.54 examples/s]Map:   6%|▌         | 844/14042 [00:02<00:31, 424.50 examples/s]Map:   6%|▋         | 910/14042 [00:02<00:30, 426.01 examples/s]Map:   7%|▋         | 959/14042 [00:02<00:29, 439.78 examples/s]Map:   7%|▋         | 1020/14042 [00:03<00:59, 220.44 examples/s]Map:   8%|▊         | 1068/14042 [00:03<00:50, 258.27 examples/s]Map:   8%|▊         | 1116/14042 [00:03<00:43, 295.90 examples/s]Map:   8%|▊         | 1165/14042 [00:03<00:38, 332.69 examples/s]Map:   9%|▊         | 1214/14042 [00:03<00:35, 364.44 examples/s]Map:   9%|▉         | 1260/14042 [00:03<00:33, 385.22 examples/s]Map:   9%|▉         | 1308/14042 [00:03<00:31, 404.66 examples/s]Map:  10%|▉         | 1355/14042 [00:03<00:30, 419.17 examples/s]Map:  10%|▉         | 1401/14042 [00:03<00:29, 427.22 examples/s]Map:  10%|█         | 1447/14042 [00:03<00:28, 434.50 examples/s]Map:  11%|█         | 1494/14042 [00:04<00:28, 442.05 examples/s]Map:  11%|█         | 1560/14042 [00:04<00:28, 439.49 examples/s]Map:  11%|█▏        | 1605/14042 [00:04<00:28, 438.96 examples/s]Map:  12%|█▏        | 1652/14042 [00:04<00:27, 444.28 examples/s]Map:  12%|█▏        | 1699/14042 [00:04<00:27, 447.12 examples/s]Map:  12%|█▏        | 1745/14042 [00:04<00:27, 448.62 examples/s]Map:  13%|█▎        | 1791/14042 [00:04<00:27, 449.05 examples/s]Map:  13%|█▎        | 1838/14042 [00:04<00:27, 450.45 examples/s]Map:  14%|█▎        | 1904/14042 [00:04<00:27, 441.06 examples/s]Map:  14%|█▍        | 1952/14042 [00:05<00:26, 449.49 examples/s]Map:  14%|█▍        | 1999/14042 [00:05<00:26, 453.48 examples/s]Map:  15%|█▍        | 2067/14042 [00:05<00:44, 272.11 examples/s]Map:  15%|█▌        | 2115/14042 [00:05<00:38, 306.46 examples/s]Map:  15%|█▌        | 2163/14042 [00:05<00:34, 339.68 examples/s]Map:  16%|█▌        | 2213/14042 [00:05<00:31, 371.21 examples/s]Map:  16%|█▌        | 2261/14042 [00:06<00:29, 395.19 examples/s]Map:  16%|█▋        | 2311/14042 [00:06<00:28, 418.89 examples/s]Map:  17%|█▋        | 2357/14042 [00:06<00:27, 426.82 examples/s]Map:  17%|█▋        | 2405/14042 [00:06<00:26, 439.31 examples/s]Map:  17%|█▋        | 2453/14042 [00:06<00:25, 446.15 examples/s]Map:  18%|█▊        | 2503/14042 [00:06<00:25, 457.70 examples/s]Map:  18%|█▊        | 2553/14042 [00:06<00:24, 468.32 examples/s]Map:  19%|█▊        | 2601/14042 [00:06<00:24, 469.53 examples/s]Map:  19%|█▉        | 2649/14042 [00:06<00:24, 469.72 examples/s]Map:  19%|█▉        | 2697/14042 [00:06<00:24, 469.39 examples/s]Map:  20%|█▉        | 2768/14042 [00:07<00:24, 469.15 examples/s]Map:  20%|██        | 2817/14042 [00:07<00:23, 467.95 examples/s]Map:  21%|██        | 2887/14042 [00:07<00:24, 464.32 examples/s]Map:  21%|██        | 2936/14042 [00:07<00:23, 468.05 examples/s]Map:  21%|██▏       | 2985/14042 [00:07<00:23, 469.87 examples/s]Map:  22%|██▏       | 3045/14042 [00:07<00:38, 287.88 examples/s]Map:  22%|██▏       | 3093/14042 [00:08<00:34, 321.89 examples/s]Map:  22%|██▏       | 3141/14042 [00:08<00:30, 353.17 examples/s]Map:  23%|██▎       | 3184/14042 [00:08<00:29, 369.22 examples/s]Map:  23%|██▎       | 3229/14042 [00:08<00:28, 385.81 examples/s]Map:  23%|██▎       | 3276/14042 [00:08<00:26, 404.56 examples/s]Map:  24%|██▎       | 3325/14042 [00:08<00:25, 424.30 examples/s]Map:  24%|██▍       | 3373/14042 [00:08<00:24, 437.30 examples/s]Map:  24%|██▍       | 3421/14042 [00:08<00:23, 446.28 examples/s]Map:  25%|██▍       | 3468/14042 [00:08<00:23, 450.38 examples/s]Map:  25%|██▌       | 3516/14042 [00:08<00:22, 457.87 examples/s]Map:  25%|██▌       | 3565/14042 [00:09<00:22, 462.56 examples/s]Map:  26%|██▌       | 3612/14042 [00:09<00:22, 461.91 examples/s]Map:  26%|██▌       | 3683/14042 [00:09<00:22, 461.14 examples/s]Map:  27%|██▋       | 3753/14042 [00:09<00:22, 460.66 examples/s]Map:  27%|██▋       | 3801/14042 [00:09<00:22, 462.66 examples/s]Map:  28%|██▊       | 3872/14042 [00:09<00:22, 461.84 examples/s]Map:  28%|██▊       | 3941/14042 [00:09<00:21, 459.39 examples/s]Map:  28%|██▊       | 4000/14042 [00:10<00:33, 302.28 examples/s]Map:  29%|██▉       | 4044/14042 [00:10<00:30, 325.21 examples/s]Map:  29%|██▉       | 4091/14042 [00:10<00:28, 352.59 examples/s]Map:  29%|██▉       | 4138/14042 [00:10<00:26, 376.13 examples/s]Map:  30%|██▉       | 4186/14042 [00:10<00:24, 399.39 examples/s]Map:  30%|███       | 4236/14042 [00:10<00:23, 419.03 examples/s]Map:  31%|███       | 4304/14042 [00:10<00:22, 427.16 examples/s]Map:  31%|███       | 4349/14042 [00:10<00:22, 429.32 examples/s]Map:  31%|███▏      | 4416/14042 [00:11<00:23, 415.35 examples/s]Map:  32%|███▏      | 4462/14042 [00:11<00:22, 424.98 examples/s]Map:  32%|███▏      | 4509/14042 [00:11<00:21, 434.57 examples/s]Map:  33%|███▎      | 4568/14042 [00:11<00:22, 416.53 examples/s]Map:  33%|███▎      | 4628/14042 [00:11<00:23, 406.96 examples/s]Map:  33%|███▎      | 4685/14042 [00:11<00:23, 395.36 examples/s]Map:  34%|███▍      | 4748/14042 [00:11<00:23, 399.12 examples/s]Map:  34%|███▍      | 4794/14042 [00:12<00:22, 410.75 examples/s]Map:  34%|███▍      | 4842/14042 [00:12<00:21, 426.99 examples/s]Map:  35%|███▍      | 4889/14042 [00:12<00:20, 436.96 examples/s]Map:  35%|███▌      | 4938/14042 [00:12<00:20, 448.72 examples/s]Map:  36%|███▌      | 4985/14042 [00:12<00:19, 453.47 examples/s]Map:  36%|███▌      | 5046/14042 [00:13<00:41, 214.90 examples/s]Map:  36%|███▌      | 5086/14042 [00:13<00:37, 241.64 examples/s]Map:  36%|███▋      | 5123/14042 [00:13<00:33, 263.28 examples/s]Map:  37%|███▋      | 5162/14042 [00:13<00:31, 286.31 examples/s]Map:  37%|███▋      | 5200/14042 [00:13<00:29, 304.36 examples/s]Map:  37%|███▋      | 5241/14042 [00:13<00:26, 326.63 examples/s]Map:  38%|███▊      | 5290/14042 [00:13<00:23, 365.19 examples/s]Map:  38%|███▊      | 5340/14042 [00:13<00:21, 397.68 examples/s]Map:  38%|███▊      | 5386/14042 [00:13<00:21, 412.09 examples/s]Map:  39%|███▊      | 5431/14042 [00:13<00:20, 419.63 examples/s]Map:  39%|███▉      | 5477/14042 [00:14<00:20, 427.19 examples/s]Map:  39%|███▉      | 5527/14042 [00:14<00:19, 445.02 examples/s]Map:  40%|███▉      | 5576/14042 [00:14<00:18, 457.66 examples/s]Map:  40%|████      | 5624/14042 [00:14<00:18, 459.92 examples/s]Map:  40%|████      | 5672/14042 [00:14<00:18, 463.50 examples/s]Map:  41%|████      | 5720/14042 [00:14<00:17, 466.07 examples/s]Map:  41%|████      | 5767/14042 [00:14<00:17, 464.05 examples/s]Map:  41%|████▏     | 5814/14042 [00:14<00:17, 463.74 examples/s]Map:  42%|████▏     | 5881/14042 [00:14<00:18, 453.11 examples/s]Map:  42%|████▏     | 5943/14042 [00:15<00:18, 435.15 examples/s]Map:  43%|████▎     | 6000/14042 [00:15<00:29, 269.18 examples/s]Map:  43%|████▎     | 6041/14042 [00:15<00:27, 292.13 examples/s]Map:  43%|████▎     | 6083/14042 [00:15<00:25, 315.51 examples/s]Map:  44%|████▎     | 6123/14042 [00:15<00:23, 331.89 examples/s]Map:  44%|████▍     | 6162/14042 [00:15<00:22, 343.03 examples/s]Map:  44%|████▍     | 6203/14042 [00:16<00:22, 356.03 examples/s]Map:  44%|████▍     | 6242/14042 [00:16<00:21, 363.12 examples/s]Map:  45%|████▍     | 6282/14042 [00:16<00:20, 370.56 examples/s]Map:  45%|████▌     | 6323/14042 [00:16<00:20, 377.81 examples/s]Map:  45%|████▌     | 6364/14042 [00:16<00:19, 384.02 examples/s]Map:  46%|████▌     | 6407/14042 [00:16<00:19, 392.79 examples/s]Map:  46%|████▌     | 6450/14042 [00:16<00:18, 400.43 examples/s]Map:  46%|████▋     | 6509/14042 [00:16<00:19, 394.87 examples/s]Map:  47%|████▋     | 6552/14042 [00:16<00:18, 400.80 examples/s]Map:  47%|████▋     | 6594/14042 [00:16<00:18, 401.29 examples/s]Map:  47%|████▋     | 6653/14042 [00:17<00:18, 393.42 examples/s]Map:  48%|████▊     | 6694/14042 [00:17<00:18, 395.76 examples/s]Map:  48%|████▊     | 6753/14042 [00:17<00:18, 391.28 examples/s]Map:  48%|████▊     | 6794/14042 [00:17<00:18, 393.85 examples/s]Map:  49%|████▊     | 6834/14042 [00:17<00:18, 394.05 examples/s]Map:  49%|████▉     | 6874/14042 [00:17<00:18, 393.94 examples/s]Map:  49%|████▉     | 6935/14042 [00:17<00:17, 395.10 examples/s]Map:  50%|████▉     | 6976/14042 [00:17<00:17, 396.14 examples/s]Map:  50%|████▉     | 7019/14042 [00:18<00:28, 243.18 examples/s]Map:  50%|█████     | 7060/14042 [00:18<00:25, 272.13 examples/s]Map:  51%|█████     | 7102/14042 [00:18<00:23, 301.49 examples/s]Map:  51%|█████     | 7142/14042 [00:18<00:21, 321.16 examples/s]Map:  51%|█████     | 7185/14042 [00:18<00:19, 345.37 examples/s]Map:  51%|█████▏    | 7228/14042 [00:18<00:18, 366.09 examples/s]Map:  52%|█████▏    | 7268/14042 [00:18<00:18, 373.00 examples/s]Map:  52%|█████▏    | 7309/14042 [00:19<00:17, 377.73 examples/s]Map:  52%|█████▏    | 7350/14042 [00:19<00:17, 383.22 examples/s]Map:  53%|█████▎    | 7392/14042 [00:19<00:17, 390.04 examples/s]Map:  53%|█████▎    | 7453/14042 [00:19<00:16, 395.12 examples/s]Map:  53%|█████▎    | 7499/14042 [00:19<00:15, 410.55 examples/s]Map:  54%|█████▎    | 7545/14042 [00:19<00:15, 423.14 examples/s]Map:  54%|█████▍    | 7594/14042 [00:19<00:14, 441.05 examples/s]Map:  54%|█████▍    | 7642/14042 [00:19<00:14, 448.83 examples/s]Map:  55%|█████▍    | 7691/14042 [00:19<00:13, 459.08 examples/s]Map:  55%|█████▌    | 7738/14042 [00:20<00:13, 460.28 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2179 > 2048). Running this sequence through the model will result in indexing errors
Map:  56%|█████▌    | 7807/14042 [00:20<00:13, 457.02 examples/s]Map:  56%|█████▌    | 7855/14042 [00:20<00:13, 461.83 examples/s]Map:  56%|█████▋    | 7902/14042 [00:20<00:13, 461.97 examples/s]Map:  57%|█████▋    | 7951/14042 [00:20<00:13, 465.80 examples/s]Map:  57%|█████▋    | 7998/14042 [00:20<00:13, 464.31 examples/s]Map:  57%|█████▋    | 8046/14042 [00:20<00:21, 273.87 examples/s]Map:  58%|█████▊    | 8095/14042 [00:21<00:18, 313.85 examples/s]Map:  58%|█████▊    | 8143/14042 [00:21<00:16, 347.02 examples/s]Map:  58%|█████▊    | 8191/14042 [00:21<00:15, 376.06 examples/s]Map:  59%|█████▊    | 8240/14042 [00:21<00:14, 402.21 examples/s]Map:  59%|█████▉    | 8288/14042 [00:21<00:13, 418.42 examples/s]Map:  59%|█████▉    | 8335/14042 [00:21<00:13, 429.72 examples/s]Map:  60%|█████▉    | 8383/14042 [00:21<00:12, 441.36 examples/s]Map:  60%|██████    | 8431/14042 [00:21<00:12, 449.02 examples/s]Map:  61%|██████    | 8500/14042 [00:21<00:12, 451.12 examples/s]Map:  61%|██████    | 8547/14042 [00:21<00:12, 453.49 examples/s]Map:  61%|██████    | 8595/14042 [00:22<00:11, 458.41 examples/s]Map:  62%|██████▏   | 8643/14042 [00:22<00:11, 461.56 examples/s]Map:  62%|██████▏   | 8713/14042 [00:22<00:11, 459.77 examples/s]Map:  63%|██████▎   | 8780/14042 [00:22<00:11, 452.55 examples/s]Map:  63%|██████▎   | 8828/14042 [00:22<00:11, 456.17 examples/s]Map:  63%|██████▎   | 8877/14042 [00:22<00:11, 463.69 examples/s]Map:  64%|██████▎   | 8926/14042 [00:22<00:10, 468.46 examples/s]Map:  64%|██████▍   | 8975/14042 [00:22<00:10, 473.44 examples/s]Map:  64%|██████▍   | 9044/14042 [00:23<00:16, 294.56 examples/s]Map:  65%|██████▍   | 9091/14042 [00:23<00:15, 324.79 examples/s]Map:  65%|██████▌   | 9138/14042 [00:23<00:13, 352.38 examples/s]Map:  65%|██████▌   | 9185/14042 [00:23<00:12, 378.42 examples/s]Map:  66%|██████▌   | 9231/14042 [00:23<00:12, 396.45 examples/s]Map:  66%|██████▌   | 9281/14042 [00:23<00:11, 420.09 examples/s]Map:  66%|██████▋   | 9331/14042 [00:23<00:10, 438.24 examples/s]Map:  67%|██████▋   | 9378/14042 [00:24<00:10, 442.87 examples/s]Map:  67%|██████▋   | 9448/14042 [00:24<00:10, 449.06 examples/s]Map:  68%|██████▊   | 9498/14042 [00:24<00:09, 459.48 examples/s]Map:  68%|██████▊   | 9545/14042 [00:24<00:09, 460.75 examples/s]Map:  68%|██████▊   | 9603/14042 [00:24<00:10, 431.48 examples/s]Map:  69%|██████▉   | 9661/14042 [00:24<00:10, 411.20 examples/s]Map:  69%|██████▉   | 9710/14042 [00:24<00:15, 281.74 examples/s]Map:  69%|██████▉   | 9747/14042 [00:25<00:14, 296.67 examples/s]Map:  70%|██████▉   | 9787/14042 [00:25<00:13, 316.53 examples/s]Map:  70%|███████   | 9830/14042 [00:25<00:12, 341.42 examples/s]Map:  70%|███████   | 9873/14042 [00:25<00:11, 361.77 examples/s]Map:  71%|███████   | 9916/14042 [00:25<00:10, 379.05 examples/s]Map:  71%|███████   | 9961/14042 [00:25<00:10, 395.06 examples/s]Map:  71%|███████▏  | 10020/14042 [00:25<00:15, 255.43 examples/s]Map:  72%|███████▏  | 10065/14042 [00:26<00:13, 290.20 examples/s]Map:  72%|███████▏  | 10114/14042 [00:26<00:11, 330.48 examples/s]Map:  72%|███████▏  | 10159/14042 [00:26<00:10, 355.13 examples/s]Map:  73%|███████▎  | 10207/14042 [00:26<00:10, 381.62 examples/s]Map:  73%|███████▎  | 10255/14042 [00:26<00:09, 403.26 examples/s]Map:  73%|███████▎  | 10304/14042 [00:26<00:08, 423.33 examples/s]Map:  74%|███████▎  | 10349/14042 [00:26<00:08, 428.70 examples/s]Map:  74%|███████▍  | 10395/14042 [00:26<00:08, 434.08 examples/s]Map:  74%|███████▍  | 10440/14042 [00:26<00:08, 436.29 examples/s]Map:  75%|███████▍  | 10506/14042 [00:27<00:08, 435.02 examples/s]Map:  75%|███████▌  | 10551/14042 [00:27<00:07, 437.67 examples/s]Map:  75%|███████▌  | 10600/14042 [00:27<00:07, 447.04 examples/s]Map:  76%|███████▌  | 10648/14042 [00:27<00:07, 454.08 examples/s]Map:  76%|███████▌  | 10696/14042 [00:27<00:07, 456.97 examples/s]Map:  77%|███████▋  | 10744/14042 [00:27<00:07, 459.83 examples/s]Map:  77%|███████▋  | 10813/14042 [00:27<00:07, 454.24 examples/s]Map:  77%|███████▋  | 10863/14042 [00:27<00:06, 463.65 examples/s]Map:  78%|███████▊  | 10931/14042 [00:27<00:06, 456.62 examples/s]Map:  78%|███████▊  | 10977/14042 [00:28<00:06, 456.23 examples/s]Map:  79%|███████▊  | 11045/14042 [00:28<00:10, 293.63 examples/s]Map:  79%|███████▉  | 11094/14042 [00:28<00:09, 327.29 examples/s]Map:  79%|███████▉  | 11142/14042 [00:28<00:08, 357.05 examples/s]Map:  80%|███████▉  | 11192/14042 [00:28<00:07, 386.92 examples/s]Map:  80%|████████  | 11257/14042 [00:28<00:06, 400.95 examples/s]Map:  81%|████████  | 11324/14042 [00:29<00:06, 412.28 examples/s]Map:  81%|████████  | 11388/14042 [00:29<00:06, 413.89 examples/s]Map:  82%|████████▏ | 11453/14042 [00:29<00:06, 415.47 examples/s]Map:  82%|████████▏ | 11499/14042 [00:29<00:06, 423.42 examples/s]Map:  82%|████████▏ | 11547/14042 [00:29<00:05, 432.96 examples/s]Map:  83%|████████▎ | 11594/14042 [00:29<00:05, 440.87 examples/s]Map:  83%|████████▎ | 11640/14042 [00:29<00:05, 443.98 examples/s]Map:  83%|████████▎ | 11691/14042 [00:29<00:05, 457.68 examples/s]Map:  84%|████████▎ | 11742/14042 [00:29<00:04, 468.70 examples/s]Map:  84%|████████▍ | 11790/14042 [00:30<00:04, 470.16 examples/s]Map:  84%|████████▍ | 11838/14042 [00:30<00:04, 472.54 examples/s]Map:  85%|████████▍ | 11887/14042 [00:30<00:04, 473.60 examples/s]Map:  85%|████████▌ | 11959/14042 [00:30<00:04, 471.77 examples/s]Map:  86%|████████▌ | 12022/14042 [00:30<00:06, 302.96 examples/s]Map:  86%|████████▌ | 12069/14042 [00:30<00:05, 332.93 examples/s]Map:  86%|████████▋ | 12118/14042 [00:31<00:05, 363.29 examples/s]Map:  87%|████████▋ | 12165/14042 [00:31<00:04, 385.51 examples/s]Map:  87%|████████▋ | 12212/14042 [00:31<00:04, 403.71 examples/s]Map:  87%|████████▋ | 12259/14042 [00:31<00:04, 418.35 examples/s]Map:  88%|████████▊ | 12306/14042 [00:31<00:04, 428.62 examples/s]Map:  88%|████████▊ | 12354/14042 [00:31<00:03, 439.04 examples/s]Map:  88%|████████▊ | 12423/14042 [00:31<00:03, 444.47 examples/s]Map:  89%|████████▉ | 12471/14042 [00:31<00:03, 449.58 examples/s]Map:  89%|████████▉ | 12519/14042 [00:31<00:03, 455.44 examples/s]Map:  90%|████████▉ | 12588/14042 [00:32<00:03, 451.00 examples/s]Map:  90%|████████▉ | 12636/14042 [00:32<00:03, 456.18 examples/s]Map:  90%|█████████ | 12683/14042 [00:32<00:02, 456.19 examples/s]Map:  91%|█████████ | 12729/14042 [00:32<00:02, 455.92 examples/s]Map:  91%|█████████ | 12776/14042 [00:32<00:02, 457.60 examples/s]Map:  91%|█████████▏| 12823/14042 [00:32<00:02, 459.19 examples/s]Map:  92%|█████████▏| 12874/14042 [00:32<00:02, 470.33 examples/s]Map:  92%|█████████▏| 12943/14042 [00:32<00:02, 465.28 examples/s]Map:  93%|█████████▎| 12990/14042 [00:32<00:02, 466.22 examples/s]Map:  93%|█████████▎| 13047/14042 [00:33<00:03, 291.14 examples/s]Map:  93%|█████████▎| 13095/14042 [00:33<00:02, 325.64 examples/s]Map:  94%|█████████▎| 13142/14042 [00:33<00:02, 354.48 examples/s]Map:  94%|█████████▍| 13192/14042 [00:33<00:02, 385.00 examples/s]Map:  94%|█████████▍| 13238/14042 [00:33<00:01, 402.73 examples/s]Map:  95%|█████████▍| 13287/14042 [00:33<00:01, 423.00 examples/s]Map:  95%|█████████▍| 13335/14042 [00:33<00:01, 433.13 examples/s]Map:  95%|█████████▌| 13384/14042 [00:33<00:01, 446.20 examples/s]Map:  96%|█████████▌| 13434/14042 [00:34<00:01, 459.35 examples/s]Map:  96%|█████████▌| 13483/14042 [00:34<00:01, 463.95 examples/s]Map:  97%|█████████▋| 13554/14042 [00:34<00:01, 459.84 examples/s]Map:  97%|█████████▋| 13605/14042 [00:34<00:00, 471.04 examples/s]Map:  97%|█████████▋| 13676/14042 [00:34<00:00, 469.47 examples/s]Map:  98%|█████████▊| 13747/14042 [00:34<00:00, 470.45 examples/s]Map:  98%|█████████▊| 13796/14042 [00:34<00:00, 472.62 examples/s]Map:  99%|█████████▊| 13845/14042 [00:34<00:00, 473.57 examples/s]Map:  99%|█████████▉| 13893/14042 [00:35<00:00, 474.35 examples/s]Map:  99%|█████████▉| 13943/14042 [00:35<00:00, 478.19 examples/s]Map: 100%|█████████▉| 14000/14042 [00:35<00:00, 291.84 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 300.06 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 394.00 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 32/10042 [00:00<00:32, 311.51 examples/s]Map:   1%|          | 66/10042 [00:00<00:31, 321.60 examples/s]Map:   1%|          | 101/10042 [00:00<00:30, 329.49 examples/s]Map:   1%|▏         | 136/10042 [00:00<00:29, 333.12 examples/s]Map:   2%|▏         | 171/10042 [00:00<00:29, 334.76 examples/s]Map:   2%|▏         | 207/10042 [00:00<00:29, 338.14 examples/s]Map:   2%|▏         | 241/10042 [00:00<00:29, 336.83 examples/s]Map:   3%|▎         | 276/10042 [00:01<00:46, 209.93 examples/s]Map:   3%|▎         | 307/10042 [00:01<00:42, 230.19 examples/s]Map:   3%|▎         | 342/10042 [00:01<00:37, 256.55 examples/s]Map:   4%|▎         | 375/10042 [00:01<00:35, 274.52 examples/s]Map:   4%|▍         | 411/10042 [00:01<00:32, 293.24 examples/s]Map:   4%|▍         | 446/10042 [00:01<00:31, 307.09 examples/s]Map:   5%|▍         | 481/10042 [00:01<00:30, 316.50 examples/s]Map:   5%|▌         | 516/10042 [00:01<00:29, 324.24 examples/s]Map:   5%|▌         | 550/10042 [00:01<00:29, 325.65 examples/s]Map:   6%|▌         | 586/10042 [00:01<00:28, 331.15 examples/s]Map:   6%|▌         | 620/10042 [00:02<00:28, 330.25 examples/s]Map:   7%|▋         | 655/10042 [00:02<00:28, 333.28 examples/s]Map:   7%|▋         | 705/10042 [00:02<00:28, 329.77 examples/s]Map:   7%|▋         | 740/10042 [00:02<00:28, 331.75 examples/s]Map:   8%|▊         | 775/10042 [00:02<00:27, 333.67 examples/s]Map:   8%|▊         | 811/10042 [00:02<00:27, 337.50 examples/s]Map:   8%|▊         | 845/10042 [00:02<00:27, 336.61 examples/s]Map:   9%|▉         | 881/10042 [00:02<00:27, 338.94 examples/s]Map:   9%|▉         | 916/10042 [00:02<00:26, 340.34 examples/s]Map:  10%|▉         | 967/10042 [00:03<00:26, 337.86 examples/s]Map:  10%|█         | 1015/10042 [00:03<00:54, 164.80 examples/s]Map:  10%|█         | 1050/10042 [00:03<00:47, 190.81 examples/s]Map:  11%|█         | 1085/10042 [00:03<00:41, 216.51 examples/s]Map:  11%|█         | 1120/10042 [00:03<00:36, 241.32 examples/s]Map:  12%|█▏        | 1156/10042 [00:04<00:33, 265.20 examples/s]Map:  12%|█▏        | 1191/10042 [00:04<00:31, 283.03 examples/s]Map:  12%|█▏        | 1227/10042 [00:04<00:29, 298.47 examples/s]Map:  13%|█▎        | 1262/10042 [00:04<00:28, 309.70 examples/s]Map:  13%|█▎        | 1296/10042 [00:04<00:27, 317.18 examples/s]Map:  13%|█▎        | 1347/10042 [00:04<00:26, 322.94 examples/s]Map:  14%|█▍        | 1381/10042 [00:04<00:26, 326.35 examples/s]Map:  14%|█▍        | 1417/10042 [00:04<00:26, 331.72 examples/s]Map:  14%|█▍        | 1452/10042 [00:04<00:25, 332.52 examples/s]Map:  15%|█▍        | 1488/10042 [00:05<00:25, 336.21 examples/s]Map:  15%|█▌        | 1524/10042 [00:05<00:25, 338.62 examples/s]Map:  16%|█▌        | 1560/10042 [00:05<00:24, 340.67 examples/s]Map:  16%|█▌        | 1595/10042 [00:05<00:24, 338.79 examples/s]Map:  16%|█▌        | 1630/10042 [00:05<00:24, 338.49 examples/s]Map:  17%|█▋        | 1665/10042 [00:05<00:24, 338.53 examples/s]Map:  17%|█▋        | 1701/10042 [00:05<00:24, 340.87 examples/s]Map:  17%|█▋        | 1736/10042 [00:05<00:24, 340.02 examples/s]Map:  18%|█▊        | 1787/10042 [00:05<00:24, 336.26 examples/s]Map:  18%|█▊        | 1822/10042 [00:06<00:24, 337.33 examples/s]Map:  18%|█▊        | 1856/10042 [00:06<00:24, 337.56 examples/s]Map:  19%|█▉        | 1891/10042 [00:06<00:24, 338.95 examples/s]Map:  19%|█▉        | 1926/10042 [00:06<00:23, 339.03 examples/s]Map:  20%|█▉        | 1962/10042 [00:06<00:23, 340.35 examples/s]Map:  20%|█▉        | 1998/10042 [00:06<00:23, 341.16 examples/s]Map:  20%|██        | 2034/10042 [00:06<00:41, 194.35 examples/s]Map:  21%|██        | 2069/10042 [00:07<00:35, 222.54 examples/s]Map:  21%|██        | 2103/10042 [00:07<00:32, 246.86 examples/s]Map:  21%|██▏       | 2138/10042 [00:07<00:29, 268.92 examples/s]Map:  22%|██▏       | 2174/10042 [00:07<00:27, 288.79 examples/s]Map:  22%|██▏       | 2209/10042 [00:07<00:25, 302.77 examples/s]Map:  22%|██▏       | 2245/10042 [00:07<00:24, 314.51 examples/s]Map:  23%|██▎       | 2280/10042 [00:07<00:24, 322.17 examples/s]Map:  23%|██▎       | 2316/10042 [00:07<00:23, 329.97 examples/s]Map:  23%|██▎       | 2351/10042 [00:07<00:23, 333.52 examples/s]Map:  24%|██▍       | 2386/10042 [00:07<00:22, 335.11 examples/s]Map:  24%|██▍       | 2422/10042 [00:08<00:22, 337.87 examples/s]Map:  24%|██▍       | 2458/10042 [00:08<00:22, 339.71 examples/s]Map:  25%|██▍       | 2494/10042 [00:08<00:22, 342.69 examples/s]Map:  25%|██▌       | 2530/10042 [00:08<00:21, 344.11 examples/s]Map:  26%|██▌       | 2565/10042 [00:08<00:21, 340.07 examples/s]Map:  26%|██▌       | 2600/10042 [00:08<00:21, 340.08 examples/s]Map:  26%|██▌       | 2636/10042 [00:08<00:21, 340.40 examples/s]Map:  27%|██▋       | 2671/10042 [00:08<00:21, 339.66 examples/s]Map:  27%|██▋       | 2706/10042 [00:08<00:21, 339.67 examples/s]Map:  27%|██▋       | 2757/10042 [00:09<00:21, 336.38 examples/s]Map:  28%|██▊       | 2792/10042 [00:09<00:21, 337.29 examples/s]Map:  28%|██▊       | 2827/10042 [00:09<00:21, 339.53 examples/s]Map:  29%|██▊       | 2863/10042 [00:09<00:20, 342.01 examples/s]Map:  29%|██▉       | 2899/10042 [00:09<00:20, 342.96 examples/s]Map:  29%|██▉       | 2935/10042 [00:09<00:20, 343.43 examples/s]Map:  30%|██▉       | 2970/10042 [00:09<00:20, 342.96 examples/s]Map:  30%|███       | 3016/10042 [00:10<00:34, 205.90 examples/s]Map:  30%|███       | 3052/10042 [00:10<00:30, 232.80 examples/s]Map:  31%|███       | 3088/10042 [00:10<00:27, 256.41 examples/s]Map:  31%|███       | 3124/10042 [00:10<00:24, 277.64 examples/s]Map:  31%|███▏      | 3159/10042 [00:10<00:23, 292.87 examples/s]Map:  32%|███▏      | 3194/10042 [00:10<00:22, 303.63 examples/s]Map:  32%|███▏      | 3229/10042 [00:10<00:21, 313.27 examples/s]Map:  32%|███▏      | 3263/10042 [00:10<00:21, 316.28 examples/s]Map:  33%|███▎      | 3311/10042 [00:10<00:21, 314.44 examples/s]Map:  33%|███▎      | 3345/10042 [00:11<00:21, 317.44 examples/s]Map:  34%|███▍      | 3393/10042 [00:11<00:20, 316.75 examples/s]Map:  34%|███▍      | 3441/10042 [00:11<00:20, 314.80 examples/s]Map:  35%|███▍      | 3473/10042 [00:11<00:20, 315.61 examples/s]Map:  35%|███▍      | 3505/10042 [00:11<00:20, 314.57 examples/s]Map:  35%|███▌      | 3537/10042 [00:11<00:20, 314.33 examples/s]Map:  36%|███▌      | 3570/10042 [00:11<00:20, 316.29 examples/s]Map:  36%|███▌      | 3602/10042 [00:11<00:20, 316.28 examples/s]Map:  36%|███▌      | 3634/10042 [00:11<00:20, 315.26 examples/s]Map:  37%|███▋      | 3681/10042 [00:12<00:20, 310.13 examples/s]Map:  37%|███▋      | 3713/10042 [00:12<00:20, 310.79 examples/s]Map:  37%|███▋      | 3745/10042 [00:12<00:20, 310.32 examples/s]Map:  38%|███▊      | 3792/10042 [00:12<00:20, 308.73 examples/s]Map:  38%|███▊      | 3825/10042 [00:12<00:20, 310.29 examples/s]Map:  38%|███▊      | 3857/10042 [00:12<00:19, 310.29 examples/s]Map:  39%|███▊      | 3889/10042 [00:12<00:19, 311.53 examples/s]Map:  39%|███▉      | 3921/10042 [00:12<00:19, 312.02 examples/s]Map:  39%|███▉      | 3953/10042 [00:12<00:19, 311.40 examples/s]Map:  40%|███▉      | 3985/10042 [00:13<00:19, 311.69 examples/s]Map:  40%|████      | 4032/10042 [00:13<00:31, 189.36 examples/s]Map:  40%|████      | 4064/10042 [00:13<00:28, 212.47 examples/s]Map:  41%|████      | 4097/10042 [00:13<00:25, 234.24 examples/s]Map:  41%|████      | 4129/10042 [00:13<00:23, 252.05 examples/s]Map:  41%|████▏     | 4162/10042 [00:13<00:21, 268.66 examples/s]Map:  42%|████▏     | 4194/10042 [00:14<00:20, 279.57 examples/s]Map:  42%|████▏     | 4227/10042 [00:14<00:20, 289.42 examples/s]Map:  42%|████▏     | 4260/10042 [00:14<00:19, 297.95 examples/s]Map:  43%|████▎     | 4293/10042 [00:14<00:18, 303.64 examples/s]Map:  43%|████▎     | 4326/10042 [00:14<00:18, 308.36 examples/s]Map:  43%|████▎     | 4358/10042 [00:14<00:18, 309.82 examples/s]Map:  44%|████▎     | 4391/10042 [00:14<00:18, 313.39 examples/s]Map:  44%|████▍     | 4424/10042 [00:14<00:17, 316.09 examples/s]Map:  44%|████▍     | 4456/10042 [00:14<00:17, 316.42 examples/s]Map:  45%|████▍     | 4488/10042 [00:14<00:17, 315.42 examples/s]Map:  45%|████▌     | 4520/10042 [00:15<00:17, 314.34 examples/s]Map:  45%|████▌     | 4552/10042 [00:15<00:17, 312.50 examples/s]Map:  46%|████▌     | 4584/10042 [00:15<00:17, 312.05 examples/s]Map:  46%|████▌     | 4616/10042 [00:15<00:17, 312.13 examples/s]Map:  46%|████▋     | 4648/10042 [00:15<00:17, 311.56 examples/s]Map:  47%|████▋     | 4681/10042 [00:15<00:17, 312.18 examples/s]Map:  47%|████▋     | 4713/10042 [00:15<00:17, 312.51 examples/s]Map:  47%|████▋     | 4746/10042 [00:15<00:16, 313.23 examples/s]Map:  48%|████▊     | 4779/10042 [00:15<00:16, 316.59 examples/s]Map:  48%|████▊     | 4811/10042 [00:15<00:16, 314.49 examples/s]Map:  48%|████▊     | 4844/10042 [00:16<00:16, 314.91 examples/s]Map:  49%|████▊     | 4876/10042 [00:16<00:16, 316.07 examples/s]Map:  49%|████▉     | 4910/10042 [00:16<00:16, 318.04 examples/s]Map:  49%|████▉     | 4943/10042 [00:16<00:16, 318.41 examples/s]Map:  50%|████▉     | 4975/10042 [00:16<00:15, 316.72 examples/s]Map:  50%|████▉     | 5015/10042 [00:17<00:35, 142.06 examples/s]Map:  50%|█████     | 5046/10042 [00:17<00:29, 166.72 examples/s]Map:  51%|█████     | 5077/10042 [00:17<00:26, 190.85 examples/s]Map:  51%|█████     | 5109/10042 [00:17<00:22, 215.56 examples/s]Map:  51%|█████     | 5141/10042 [00:17<00:20, 237.67 examples/s]Map:  52%|█████▏    | 5173/10042 [00:17<00:18, 257.04 examples/s]Map:  52%|█████▏    | 5206/10042 [00:17<00:17, 272.30 examples/s]Map:  52%|█████▏    | 5239/10042 [00:17<00:16, 285.17 examples/s]Map:  53%|█████▎    | 5273/10042 [00:17<00:16, 297.73 examples/s]Map:  53%|█████▎    | 5305/10042 [00:17<00:15, 302.56 examples/s]Map:  53%|█████▎    | 5338/10042 [00:18<00:15, 307.56 examples/s]Map:  53%|█████▎    | 5371/10042 [00:18<00:15, 309.70 examples/s]Map:  54%|█████▍    | 5404/10042 [00:18<00:14, 312.88 examples/s]Map:  54%|█████▍    | 5437/10042 [00:18<00:14, 315.08 examples/s]Map:  54%|█████▍    | 5469/10042 [00:18<00:14, 313.76 examples/s]Map:  55%|█████▍    | 5501/10042 [00:18<00:14, 313.44 examples/s]Map:  55%|█████▌    | 5533/10042 [00:18<00:14, 313.65 examples/s]Map:  55%|█████▌    | 5565/10042 [00:18<00:14, 314.71 examples/s]Map:  56%|█████▌    | 5598/10042 [00:18<00:14, 315.83 examples/s]Map:  56%|█████▌    | 5631/10042 [00:19<00:13, 316.14 examples/s]Map:  56%|█████▋    | 5663/10042 [00:19<00:13, 316.93 examples/s]Map:  57%|█████▋    | 5696/10042 [00:19<00:13, 316.98 examples/s]Map:  57%|█████▋    | 5729/10042 [00:19<00:13, 317.20 examples/s]Map:  58%|█████▊    | 5776/10042 [00:19<00:13, 313.76 examples/s]Map:  58%|█████▊    | 5809/10042 [00:19<00:13, 314.67 examples/s]Map:  58%|█████▊    | 5841/10042 [00:19<00:13, 314.07 examples/s]Map:  59%|█████▊    | 5888/10042 [00:19<00:13, 311.96 examples/s]Map:  59%|█████▉    | 5920/10042 [00:19<00:13, 311.19 examples/s]Map:  59%|█████▉    | 5952/10042 [00:20<00:13, 311.69 examples/s]Map:  60%|█████▉    | 5986/10042 [00:20<00:12, 315.20 examples/s]Map:  60%|██████    | 6032/10042 [00:20<00:21, 190.22 examples/s]Map:  60%|██████    | 6065/10042 [00:20<00:18, 213.52 examples/s]Map:  61%|██████    | 6098/10042 [00:20<00:16, 235.26 examples/s]Map:  61%|██████    | 6130/10042 [00:20<00:15, 253.01 examples/s]Map:  61%|██████▏   | 6163/10042 [00:20<00:14, 270.41 examples/s]Map:  62%|██████▏   | 6195/10042 [00:21<00:13, 278.83 examples/s]Map:  62%|██████▏   | 6227/10042 [00:21<00:13, 289.13 examples/s]Map:  62%|██████▏   | 6260/10042 [00:21<00:12, 297.56 examples/s]Map:  63%|██████▎   | 6292/10042 [00:21<00:12, 302.36 examples/s]Map:  63%|██████▎   | 6325/10042 [00:21<00:12, 307.70 examples/s]Map:  63%|██████▎   | 6359/10042 [00:21<00:11, 311.31 examples/s]Map:  64%|██████▎   | 6391/10042 [00:21<00:11, 312.05 examples/s]Map:  64%|██████▍   | 6424/10042 [00:21<00:11, 314.00 examples/s]Map:  64%|██████▍   | 6458/10042 [00:21<00:11, 317.00 examples/s]Map:  65%|██████▍   | 6490/10042 [00:21<00:11, 315.03 examples/s]Map:  65%|██████▍   | 6522/10042 [00:22<00:11, 315.40 examples/s]Map:  65%|██████▌   | 6554/10042 [00:22<00:11, 315.91 examples/s]Map:  66%|██████▌   | 6587/10042 [00:22<00:10, 316.79 examples/s]Map:  66%|██████▌   | 6620/10042 [00:22<00:10, 316.69 examples/s]Map:  66%|██████▌   | 6652/10042 [00:22<00:10, 316.23 examples/s]Map:  67%|██████▋   | 6684/10042 [00:22<00:10, 315.71 examples/s]Map:  67%|██████▋   | 6731/10042 [00:22<00:10, 312.22 examples/s]Map:  67%|██████▋   | 6764/10042 [00:22<00:10, 314.47 examples/s]Map:  68%|██████▊   | 6796/10042 [00:22<00:10, 314.37 examples/s]Map:  68%|██████▊   | 6828/10042 [00:23<00:10, 314.45 examples/s]Map:  68%|██████▊   | 6861/10042 [00:23<00:10, 316.59 examples/s]Map:  69%|██████▊   | 6893/10042 [00:23<00:09, 316.84 examples/s]Map:  69%|██████▉   | 6925/10042 [00:23<00:09, 315.71 examples/s]Map:  69%|██████▉   | 6958/10042 [00:23<00:09, 315.08 examples/s]Map:  70%|██████▉   | 6990/10042 [00:23<00:09, 314.36 examples/s]Map:  70%|███████   | 7031/10042 [00:23<00:16, 185.05 examples/s]Map:  70%|███████   | 7064/10042 [00:24<00:14, 210.31 examples/s]Map:  71%|███████   | 7096/10042 [00:24<00:12, 232.13 examples/s]Map:  71%|███████   | 7128/10042 [00:24<00:11, 249.82 examples/s]Map:  71%|███████▏  | 7160/10042 [00:24<00:10, 265.90 examples/s]Map:  72%|███████▏  | 7192/10042 [00:24<00:10, 279.01 examples/s]Map:  72%|███████▏  | 7225/10042 [00:24<00:09, 290.24 examples/s]Map:  72%|███████▏  | 7257/10042 [00:24<00:09, 297.54 examples/s]Map:  73%|███████▎  | 7289/10042 [00:24<00:09, 302.44 examples/s]Map:  73%|███████▎  | 7321/10042 [00:24<00:08, 306.15 examples/s]Map:  73%|███████▎  | 7353/10042 [00:24<00:08, 308.51 examples/s]Map:  74%|███████▎  | 7385/10042 [00:25<00:08, 310.85 examples/s]Map:  74%|███████▍  | 7418/10042 [00:25<00:08, 313.48 examples/s]Map:  74%|███████▍  | 7451/10042 [00:25<00:08, 314.87 examples/s]Map:  75%|███████▍  | 7483/10042 [00:25<00:08, 315.37 examples/s]Map:  75%|███████▍  | 7515/10042 [00:25<00:07, 315.88 examples/s]Map:  75%|███████▌  | 7547/10042 [00:25<00:07, 315.56 examples/s]Map:  75%|███████▌  | 7580/10042 [00:25<00:07, 315.60 examples/s]Map:  76%|███████▌  | 7612/10042 [00:25<00:07, 314.51 examples/s]Map:  76%|███████▌  | 7644/10042 [00:25<00:07, 314.05 examples/s]Map:  76%|███████▋  | 7676/10042 [00:26<00:07, 313.30 examples/s]Map:  77%|███████▋  | 7709/10042 [00:26<00:07, 314.76 examples/s]Map:  77%|███████▋  | 7756/10042 [00:26<00:07, 311.10 examples/s]Map:  78%|███████▊  | 7788/10042 [00:26<00:07, 310.77 examples/s]Map:  78%|███████▊  | 7820/10042 [00:26<00:07, 312.83 examples/s]Map:  78%|███████▊  | 7853/10042 [00:26<00:06, 313.93 examples/s]Map:  79%|███████▊  | 7886/10042 [00:26<00:06, 316.04 examples/s]Map:  79%|███████▉  | 7918/10042 [00:26<00:06, 316.04 examples/s]Map:  79%|███████▉  | 7952/10042 [00:26<00:06, 317.69 examples/s]Map:  80%|███████▉  | 7984/10042 [00:26<00:06, 316.87 examples/s]Map:  80%|███████▉  | 8032/10042 [00:27<00:10, 187.94 examples/s]Map:  80%|████████  | 8065/10042 [00:27<00:09, 212.13 examples/s]Map:  81%|████████  | 8097/10042 [00:27<00:08, 233.27 examples/s]Map:  81%|████████  | 8129/10042 [00:27<00:07, 251.29 examples/s]Map:  81%|████████▏ | 8163/10042 [00:27<00:06, 269.42 examples/s]Map:  82%|████████▏ | 8195/10042 [00:27<00:06, 280.60 examples/s]Map:  82%|████████▏ | 8229/10042 [00:28<00:06, 292.65 examples/s]Map:  82%|████████▏ | 8262/10042 [00:28<00:05, 299.13 examples/s]Map:  83%|████████▎ | 8295/10042 [00:28<00:05, 305.22 examples/s]Map:  83%|████████▎ | 8328/10042 [00:28<00:05, 308.55 examples/s]Map:  83%|████████▎ | 8361/10042 [00:28<00:05, 311.51 examples/s]Map:  84%|████████▎ | 8394/10042 [00:28<00:05, 314.03 examples/s]Map:  84%|████████▍ | 8427/10042 [00:28<00:05, 315.99 examples/s]Map:  84%|████████▍ | 8459/10042 [00:28<00:05, 316.15 examples/s]Map:  85%|████████▍ | 8492/10042 [00:28<00:04, 317.35 examples/s]Map:  85%|████████▍ | 8524/10042 [00:28<00:04, 317.70 examples/s]Map:  85%|████████▌ | 8556/10042 [00:29<00:04, 316.25 examples/s]Map:  86%|████████▌ | 8588/10042 [00:29<00:04, 315.22 examples/s]Map:  86%|████████▌ | 8635/10042 [00:29<00:04, 312.34 examples/s]Map:  86%|████████▋ | 8667/10042 [00:29<00:04, 312.50 examples/s]Map:  87%|████████▋ | 8701/10042 [00:29<00:04, 315.97 examples/s]Map:  87%|████████▋ | 8733/10042 [00:29<00:04, 315.42 examples/s]Map:  87%|████████▋ | 8765/10042 [00:29<00:04, 315.63 examples/s]Map:  88%|████████▊ | 8798/10042 [00:29<00:03, 316.98 examples/s]Map:  88%|████████▊ | 8832/10042 [00:29<00:03, 318.08 examples/s]Map:  88%|████████▊ | 8865/10042 [00:30<00:03, 318.98 examples/s]Map:  89%|████████▊ | 8898/10042 [00:30<00:03, 317.87 examples/s]Map:  89%|████████▉ | 8931/10042 [00:30<00:03, 318.33 examples/s]Map:  89%|████████▉ | 8963/10042 [00:30<00:03, 316.51 examples/s]Map:  90%|████████▉ | 8995/10042 [00:30<00:03, 316.41 examples/s]Map:  90%|████████▉ | 9031/10042 [00:30<00:05, 185.33 examples/s]Map:  90%|█████████ | 9064/10042 [00:30<00:04, 211.32 examples/s]Map:  91%|█████████ | 9098/10042 [00:31<00:04, 235.90 examples/s]Map:  91%|█████████ | 9130/10042 [00:31<00:03, 254.26 examples/s]Map:  91%|█████████ | 9163/10042 [00:31<00:03, 269.85 examples/s]Map:  92%|█████████▏| 9195/10042 [00:31<00:03, 279.48 examples/s]Map:  92%|█████████▏| 9228/10042 [00:31<00:02, 290.36 examples/s]Map:  92%|█████████▏| 9261/10042 [00:31<00:02, 299.12 examples/s]Map:  93%|█████████▎| 9293/10042 [00:31<00:02, 303.17 examples/s]Map:  93%|█████████▎| 9326/10042 [00:31<00:02, 308.01 examples/s]Map:  93%|█████████▎| 9359/10042 [00:31<00:02, 311.10 examples/s]Map:  94%|█████████▎| 9391/10042 [00:31<00:02, 312.11 examples/s]Map:  94%|█████████▍| 9423/10042 [00:32<00:01, 312.89 examples/s]Map:  94%|█████████▍| 9456/10042 [00:32<00:01, 314.33 examples/s]Map:  94%|█████████▍| 9488/10042 [00:32<00:01, 313.91 examples/s]Map:  95%|█████████▍| 9520/10042 [00:32<00:01, 313.48 examples/s]Map:  95%|█████████▌| 9552/10042 [00:32<00:01, 312.80 examples/s]Map:  95%|█████████▌| 9584/10042 [00:32<00:01, 311.52 examples/s]Map:  96%|█████████▌| 9617/10042 [00:32<00:01, 313.19 examples/s]Map:  96%|█████████▌| 9649/10042 [00:32<00:01, 310.80 examples/s]Map:  96%|█████████▋| 9681/10042 [00:32<00:01, 311.97 examples/s]Map:  97%|█████████▋| 9713/10042 [00:32<00:01, 311.79 examples/s]Map:  97%|█████████▋| 9745/10042 [00:33<00:00, 313.18 examples/s]Map:  97%|█████████▋| 9777/10042 [00:33<00:00, 313.41 examples/s]Map:  98%|█████████▊| 9809/10042 [00:33<00:00, 312.29 examples/s]Map:  98%|█████████▊| 9842/10042 [00:33<00:00, 314.04 examples/s]Map:  98%|█████████▊| 9874/10042 [00:33<00:00, 313.71 examples/s]Map:  99%|█████████▊| 9906/10042 [00:33<00:00, 314.20 examples/s]Map:  99%|█████████▉| 9938/10042 [00:33<00:00, 314.65 examples/s]Map:  99%|█████████▉| 9970/10042 [00:33<00:00, 315.74 examples/s]Map: 100%|█████████▉| 10015/10042 [00:34<00:00, 144.00 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 157.12 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 290.92 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   7%|▋         | 86/1267 [00:00<00:01, 846.46 examples/s]Map:  14%|█▍        | 182/1267 [00:00<00:01, 904.77 examples/s]Map:  22%|██▏       | 279/1267 [00:00<00:01, 930.65 examples/s]Map:  33%|███▎      | 415/1267 [00:00<00:00, 912.05 examples/s]Map:  40%|████      | 511/1267 [00:00<00:00, 926.51 examples/s]Map:  48%|████▊     | 611/1267 [00:00<00:00, 945.75 examples/s]Map:  56%|█████▋    | 713/1267 [00:00<00:00, 966.15 examples/s]Map:  64%|██████▍   | 813/1267 [00:00<00:00, 974.49 examples/s]Map:  72%|███████▏  | 915/1267 [00:00<00:00, 985.38 examples/s]Map:  82%|████████▏ | 1045/1267 [00:01<00:00, 564.03 examples/s]Map:  90%|█████████ | 1146/1267 [00:01<00:00, 645.31 examples/s]Map:  98%|█████████▊| 1247/1267 [00:01<00:00, 719.26 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 772.06 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.85it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  3.19it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  3.45it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  3.34it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:17<00:35, 17.79s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:35<00:17, 17.65s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:46<00:00, 14.54s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:46<00:00, 15.40s/it]
2024-05-04 05:33:02,022: rank0[538999][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-05-04 05:33:02,024: rank0[538999][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-05-04 05:33:03,291: rank0[538999][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-05-04 05:33:03,309: rank0[538999][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-05-04 05:33:22,399: rank0[538999][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-05-04 05:33:22,400: rank0[538999][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-05-04 05:33:22,400: rank0[538999][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp70_uniform_noKD_2ep_lr3e-5_bs512_noGradClip_warmup100ba_seqlen1024
models:
- model_name: /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp70_uniform_noKD_2ep_lr3e-5_bs512_noGradClip_warmup100ba_seqlen1024
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp70_uniform_noKD_2ep_lr3e-5_bs512_noGradClip_warmup100ba_seqlen1024
    use_auth_token: true
  tokenizer:
    name: /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp70_uniform_noKD_2ep_lr3e-5_bs512_noGradClip_warmup100ba_seqlen1024
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-05-04 05:33:22,406: rank0[538999][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.5094
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.4845
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7849
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7309
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                                                                 |
|:-----------|:--------------|:----------|-----------:|:------------------|:----------------------------------------------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.509386 | 25-shot           | /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp70_uniform_noKD_2ep_lr3e-5_bs512_noGradClip_warmup100ba_seqlen1024 |
|            | mmlu          |           |   0.484475 | 5-shot            | /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp70_uniform_noKD_2ep_lr3e-5_bs512_noGradClip_warmup100ba_seqlen1024 |
|            | winogrande    |           |   0.73086  | 5-shot            | /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp70_uniform_noKD_2ep_lr3e-5_bs512_noGradClip_warmup100ba_seqlen1024 |
|            | hellaswag     |           |   0.784903 | 10-shot           | /network/eldar/llama2_7b_platydolphin1m/nm/NMmdl_sp70_uniform_noKD_2ep_lr3e-5_bs512_noGradClip_warmup100ba_seqlen1024 |
2024-05-04 06:33:48,246: rank0[538999][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-05-04 06:33:48,246: rank0[538999][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-05-04 06:33:48,246: rank0[538999][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-05-04 06:33:48,246: rank0[538999][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
