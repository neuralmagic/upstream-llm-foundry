[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:284: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:284: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-04-27 06:16:42,125: rank0[3832644][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map: 100%|██████████| 1172/1172 [00:00<00:00, 22160.87 examples/s]
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 27/1172 [00:00<00:04, 260.20 examples/s]Map:   6%|▌         | 66/1172 [00:00<00:04, 255.76 examples/s]Map:   8%|▊         | 93/1172 [00:00<00:04, 255.86 examples/s]Map:  10%|█         | 121/1172 [00:00<00:04, 260.04 examples/s]Map:  13%|█▎        | 149/1172 [00:00<00:03, 261.78 examples/s]Map:  15%|█▌        | 177/1172 [00:00<00:03, 263.69 examples/s]Map:  17%|█▋        | 205/1172 [00:00<00:03, 265.29 examples/s]Map:  20%|█▉        | 233/1172 [00:00<00:03, 264.41 examples/s]Map:  22%|██▏       | 261/1172 [00:00<00:03, 264.46 examples/s]Map:  25%|██▍       | 288/1172 [00:01<00:03, 262.55 examples/s]Map:  27%|██▋       | 316/1172 [00:01<00:03, 263.07 examples/s]Map:  29%|██▉       | 344/1172 [00:01<00:03, 264.05 examples/s]Map:  32%|███▏      | 372/1172 [00:01<00:03, 263.03 examples/s]Map:  34%|███▍      | 400/1172 [00:01<00:02, 263.29 examples/s]Map:  37%|███▋      | 428/1172 [00:01<00:02, 262.75 examples/s]Map:  39%|███▉      | 455/1172 [00:01<00:02, 261.77 examples/s]Map:  41%|████      | 483/1172 [00:01<00:02, 262.72 examples/s]Map:  44%|████▎     | 511/1172 [00:01<00:02, 262.77 examples/s]Map:  46%|████▌     | 539/1172 [00:02<00:02, 264.41 examples/s]Map:  48%|████▊     | 567/1172 [00:02<00:02, 264.02 examples/s]Map:  51%|█████     | 595/1172 [00:02<00:02, 265.47 examples/s]Map:  53%|█████▎    | 623/1172 [00:02<00:02, 265.45 examples/s]Map:  57%|█████▋    | 663/1172 [00:02<00:01, 263.17 examples/s]Map:  59%|█████▉    | 690/1172 [00:02<00:01, 261.99 examples/s]Map:  61%|██████    | 717/1172 [00:02<00:01, 260.94 examples/s]Map:  64%|██████▎   | 745/1172 [00:02<00:01, 261.97 examples/s]Map:  66%|██████▌   | 772/1172 [00:02<00:01, 262.41 examples/s]Map:  68%|██████▊   | 799/1172 [00:03<00:01, 262.89 examples/s]Map:  70%|███████   | 826/1172 [00:03<00:01, 262.16 examples/s]Map:  73%|███████▎  | 853/1172 [00:03<00:01, 261.48 examples/s]Map:  75%|███████▌  | 880/1172 [00:03<00:01, 261.70 examples/s]Map:  77%|███████▋  | 907/1172 [00:03<00:01, 261.21 examples/s]Map:  80%|███████▉  | 934/1172 [00:03<00:00, 260.80 examples/s]Map:  82%|████████▏ | 962/1172 [00:03<00:00, 261.52 examples/s]Map:  84%|████████▍ | 990/1172 [00:03<00:00, 262.87 examples/s]Map:  88%|████████▊ | 1027/1172 [00:04<00:01, 122.46 examples/s]Map:  90%|████████▉ | 1054/1172 [00:04<00:00, 143.33 examples/s]Map:  92%|█████████▏| 1082/1172 [00:04<00:00, 165.04 examples/s]Map:  95%|█████████▍| 1109/1172 [00:04<00:00, 184.94 examples/s]Map:  97%|█████████▋| 1135/1172 [00:04<00:00, 200.59 examples/s]Map:  99%|█████████▉| 1163/1172 [00:04<00:00, 216.21 examples/s]Map: 100%|██████████| 1172/1172 [00:04<00:00, 235.24 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 14042 examples [00:00, 489856.42 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:  15%|█▍        | 2054/14042 [00:00<00:00, 20429.45 examples/s]Map:  31%|███       | 4295/14042 [00:00<00:00, 21587.22 examples/s]Map:  46%|████▋     | 6510/14042 [00:00<00:00, 21838.12 examples/s]Map:  62%|██████▏   | 8703/14042 [00:00<00:00, 21868.71 examples/s]Map:  78%|███████▊  | 10952/14042 [00:00<00:00, 22089.19 examples/s]Map: 100%|██████████| 14042/14042 [00:00<00:00, 21723.96 examples/s]Map: 100%|██████████| 14042/14042 [00:00<00:00, 21683.23 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 48/14042 [00:00<00:30, 463.37 examples/s]Map:   1%|          | 115/14042 [00:00<00:31, 441.39 examples/s]Map:   1%|▏         | 179/14042 [00:00<00:32, 428.89 examples/s]Map:   2%|▏         | 225/14042 [00:00<00:31, 436.48 examples/s]Map:   2%|▏         | 290/14042 [00:00<00:31, 432.40 examples/s]Map:   2%|▏         | 337/14042 [00:00<00:31, 438.65 examples/s]Map:   3%|▎         | 382/14042 [00:00<00:31, 439.39 examples/s]Map:   3%|▎         | 447/14042 [00:01<00:31, 434.04 examples/s]Map:   3%|▎         | 491/14042 [00:01<00:31, 434.85 examples/s]Map:   4%|▍         | 537/14042 [00:01<00:30, 439.64 examples/s]Map:   4%|▍         | 603/14042 [00:01<00:30, 436.80 examples/s]Map:   5%|▍         | 647/14042 [00:01<00:30, 434.38 examples/s]Map:   5%|▍         | 692/14042 [00:01<00:30, 434.03 examples/s]Map:   5%|▌         | 736/14042 [00:01<00:30, 431.93 examples/s]Map:   6%|▌         | 781/14042 [00:01<00:30, 435.56 examples/s]Map:   6%|▌         | 845/14042 [00:01<00:30, 429.84 examples/s]Map:   6%|▋         | 896/14042 [00:02<00:44, 293.46 examples/s]Map:   7%|▋         | 944/14042 [00:02<00:39, 328.49 examples/s]Map:   7%|▋         | 991/14042 [00:02<00:36, 357.13 examples/s]Map:   7%|▋         | 1046/14042 [00:02<01:06, 196.15 examples/s]Map:   8%|▊         | 1095/14042 [00:03<00:54, 236.85 examples/s]Map:   8%|▊         | 1146/14042 [00:03<00:45, 281.45 examples/s]Map:   9%|▊         | 1194/14042 [00:03<00:40, 318.85 examples/s]Map:   9%|▉         | 1240/14042 [00:03<00:36, 347.76 examples/s]Map:   9%|▉         | 1289/14042 [00:03<00:33, 379.69 examples/s]Map:  10%|▉         | 1335/14042 [00:03<00:31, 398.87 examples/s]Map:  10%|▉         | 1382/14042 [00:03<00:30, 415.64 examples/s]Map:  10%|█         | 1429/14042 [00:03<00:29, 429.30 examples/s]Map:  11%|█         | 1498/14042 [00:03<00:28, 438.99 examples/s]Map:  11%|█         | 1566/14042 [00:04<00:28, 442.56 examples/s]Map:  12%|█▏        | 1634/14042 [00:04<00:28, 443.13 examples/s]Map:  12%|█▏        | 1682/14042 [00:04<00:27, 448.55 examples/s]Map:  12%|█▏        | 1729/14042 [00:04<00:27, 452.59 examples/s]Map:  13%|█▎        | 1798/14042 [00:04<00:27, 450.26 examples/s]Map:  13%|█▎        | 1867/14042 [00:04<00:27, 449.54 examples/s]Map:  14%|█▍        | 1933/14042 [00:04<00:27, 444.46 examples/s]Map:  14%|█▍        | 1981/14042 [00:05<00:26, 449.95 examples/s]Map:  15%|█▍        | 2043/14042 [00:05<00:42, 285.68 examples/s]Map:  15%|█▍        | 2090/14042 [00:05<00:37, 315.71 examples/s]Map:  15%|█▌        | 2138/14042 [00:05<00:34, 346.23 examples/s]Map:  16%|█▌        | 2186/14042 [00:05<00:31, 373.79 examples/s]Map:  16%|█▌        | 2236/14042 [00:05<00:29, 399.68 examples/s]Map:  16%|█▋        | 2285/14042 [00:05<00:27, 420.36 examples/s]Map:  17%|█▋        | 2334/14042 [00:06<00:26, 435.98 examples/s]Map:  17%|█▋        | 2381/14042 [00:06<00:26, 442.63 examples/s]Map:  17%|█▋        | 2430/14042 [00:06<00:25, 454.56 examples/s]Map:  18%|█▊        | 2501/14042 [00:06<00:25, 459.23 examples/s]Map:  18%|█▊        | 2551/14042 [00:06<00:24, 468.75 examples/s]Map:  19%|█▊        | 2601/14042 [00:06<00:24, 473.07 examples/s]Map:  19%|█▉        | 2649/14042 [00:06<00:24, 470.38 examples/s]Map:  19%|█▉        | 2697/14042 [00:06<00:24, 470.70 examples/s]Map:  20%|█▉        | 2745/14042 [00:06<00:23, 470.72 examples/s]Map:  20%|█▉        | 2793/14042 [00:07<00:23, 471.93 examples/s]Map:  20%|██        | 2864/14042 [00:07<00:23, 468.97 examples/s]Map:  21%|██        | 2914/14042 [00:07<00:23, 472.36 examples/s]Map:  21%|██▏       | 2986/14042 [00:07<00:23, 470.65 examples/s]Map:  22%|██▏       | 3046/14042 [00:07<00:37, 297.03 examples/s]Map:  22%|██▏       | 3094/14042 [00:07<00:33, 327.89 examples/s]Map:  22%|██▏       | 3143/14042 [00:08<00:30, 357.18 examples/s]Map:  23%|██▎       | 3187/14042 [00:08<00:29, 373.17 examples/s]Map:  23%|██▎       | 3231/14042 [00:08<00:27, 387.48 examples/s]Map:  23%|██▎       | 3278/14042 [00:08<00:26, 404.08 examples/s]Map:  24%|██▎       | 3327/14042 [00:08<00:25, 423.59 examples/s]Map:  24%|██▍       | 3375/14042 [00:08<00:24, 437.19 examples/s]Map:  24%|██▍       | 3424/14042 [00:08<00:23, 447.53 examples/s]Map:  25%|██▍       | 3471/14042 [00:08<00:23, 451.21 examples/s]Map:  25%|██▌       | 3522/14042 [00:08<00:22, 464.90 examples/s]Map:  25%|██▌       | 3570/14042 [00:08<00:22, 463.27 examples/s]Map:  26%|██▌       | 3639/14042 [00:09<00:22, 457.74 examples/s]Map:  26%|██▌       | 3686/14042 [00:09<00:22, 459.65 examples/s]Map:  27%|██▋       | 3757/14042 [00:09<00:22, 460.70 examples/s]Map:  27%|██▋       | 3805/14042 [00:09<00:22, 462.12 examples/s]Map:  27%|██▋       | 3852/14042 [00:09<00:22, 459.82 examples/s]Map:  28%|██▊       | 3899/14042 [00:09<00:22, 459.51 examples/s]Map:  28%|██▊       | 3946/14042 [00:09<00:21, 459.76 examples/s]Map:  28%|██▊       | 3994/14042 [00:09<00:21, 457.48 examples/s]Map:  29%|██▉       | 4045/14042 [00:10<00:37, 269.44 examples/s]Map:  29%|██▉       | 4092/14042 [00:10<00:32, 304.94 examples/s]Map:  29%|██▉       | 4139/14042 [00:10<00:29, 338.37 examples/s]Map:  30%|██▉       | 4187/14042 [00:10<00:26, 369.78 examples/s]Map:  30%|███       | 4236/14042 [00:10<00:24, 395.87 examples/s]Map:  31%|███       | 4304/14042 [00:10<00:23, 411.03 examples/s]Map:  31%|███       | 4349/14042 [00:10<00:23, 418.83 examples/s]Map:  31%|███▏      | 4394/14042 [00:10<00:22, 425.22 examples/s]Map:  32%|███▏      | 4439/14042 [00:11<00:22, 429.01 examples/s]Map:  32%|███▏      | 4488/14042 [00:11<00:21, 442.80 examples/s]Map:  32%|███▏      | 4550/14042 [00:11<00:22, 428.41 examples/s]Map:  33%|███▎      | 4610/14042 [00:11<00:22, 415.49 examples/s]Map:  33%|███▎      | 4668/14042 [00:11<00:23, 403.12 examples/s]Map:  34%|███▎      | 4727/14042 [00:11<00:23, 396.08 examples/s]Map:  34%|███▍      | 4774/14042 [00:11<00:22, 410.94 examples/s]Map:  34%|███▍      | 4821/14042 [00:12<00:21, 423.75 examples/s]Map:  35%|███▍      | 4870/14042 [00:12<00:20, 437.89 examples/s]Map:  35%|███▌      | 4920/14042 [00:12<00:20, 451.74 examples/s]Map:  35%|███▌      | 4967/14042 [00:12<00:19, 454.85 examples/s]Map:  36%|███▌      | 5022/14042 [00:12<00:33, 271.55 examples/s]Map:  36%|███▌      | 5066/14042 [00:12<00:29, 301.40 examples/s]Map:  36%|███▋      | 5123/14042 [00:12<00:27, 321.41 examples/s]Map:  37%|███▋      | 5162/14042 [00:13<00:26, 335.23 examples/s]Map:  37%|███▋      | 5220/14042 [00:13<00:25, 345.81 examples/s]Map:  37%|███▋      | 5264/14042 [00:13<00:24, 365.20 examples/s]Map:  38%|███▊      | 5311/14042 [00:13<00:22, 389.68 examples/s]Map:  38%|███▊      | 5360/14042 [00:13<00:20, 413.92 examples/s]Map:  39%|███▊      | 5412/14042 [00:13<00:30, 284.72 examples/s]Map:  39%|███▉      | 5460/14042 [00:13<00:26, 320.17 examples/s]Map:  39%|███▉      | 5507/14042 [00:14<00:24, 351.78 examples/s]Map:  40%|███▉      | 5555/14042 [00:14<00:22, 380.71 examples/s]Map:  40%|███▉      | 5603/14042 [00:14<00:20, 405.41 examples/s]Map:  40%|████      | 5651/14042 [00:14<00:19, 424.10 examples/s]Map:  41%|████      | 5699/14042 [00:14<00:19, 435.92 examples/s]Map:  41%|████      | 5746/14042 [00:14<00:18, 443.44 examples/s]Map:  41%|████▏     | 5816/14042 [00:14<00:18, 447.44 examples/s]Map:  42%|████▏     | 5882/14042 [00:14<00:18, 440.41 examples/s]Map:  42%|████▏     | 5945/14042 [00:14<00:18, 430.17 examples/s]Map:  43%|████▎     | 6000/14042 [00:15<00:31, 259.39 examples/s]Map:  43%|████▎     | 6041/14042 [00:15<00:28, 282.09 examples/s]Map:  43%|████▎     | 6083/14042 [00:15<00:26, 305.63 examples/s]Map:  44%|████▎     | 6123/14042 [00:15<00:24, 322.86 examples/s]Map:  44%|████▍     | 6164/14042 [00:15<00:23, 339.69 examples/s]Map:  44%|████▍     | 6204/14042 [00:15<00:22, 351.90 examples/s]Map:  44%|████▍     | 6243/14042 [00:16<00:21, 360.01 examples/s]Map:  45%|████▍     | 6283/14042 [00:16<00:21, 368.24 examples/s]Map:  45%|████▌     | 6324/14042 [00:16<00:20, 375.60 examples/s]Map:  45%|████▌     | 6365/14042 [00:16<00:20, 382.63 examples/s]Map:  46%|████▌     | 6407/14042 [00:16<00:19, 390.75 examples/s]Map:  46%|████▌     | 6449/14042 [00:16<00:19, 397.01 examples/s]Map:  46%|████▋     | 6507/14042 [00:16<00:19, 388.58 examples/s]Map:  47%|████▋     | 6566/14042 [00:16<00:19, 387.29 examples/s]Map:  47%|████▋     | 6608/14042 [00:16<00:19, 391.15 examples/s]Map:  47%|████▋     | 6666/14042 [00:17<00:19, 386.02 examples/s]Map:  48%|████▊     | 6706/14042 [00:17<00:18, 388.27 examples/s]Map:  48%|████▊     | 6764/14042 [00:17<00:18, 384.55 examples/s]Map:  48%|████▊     | 6805/14042 [00:17<00:18, 387.26 examples/s]Map:  49%|████▉     | 6846/14042 [00:17<00:18, 387.44 examples/s]Map:  49%|████▉     | 6886/14042 [00:17<00:18, 389.15 examples/s]Map:  49%|████▉     | 6944/14042 [00:17<00:18, 385.69 examples/s]Map:  50%|████▉     | 6984/14042 [00:17<00:18, 387.22 examples/s]Map:  50%|█████     | 7039/14042 [00:18<00:29, 240.41 examples/s]Map:  50%|█████     | 7080/14042 [00:18<00:25, 269.43 examples/s]Map:  51%|█████     | 7120/14042 [00:18<00:23, 294.22 examples/s]Map:  51%|█████     | 7161/14042 [00:18<00:21, 316.59 examples/s]Map:  51%|█████▏    | 7204/14042 [00:18<00:20, 340.30 examples/s]Map:  52%|█████▏    | 7246/14042 [00:18<00:18, 358.57 examples/s]Map:  52%|█████▏    | 7286/14042 [00:18<00:18, 365.67 examples/s]Map:  52%|█████▏    | 7325/14042 [00:19<00:18, 371.28 examples/s]Map:  52%|█████▏    | 7365/14042 [00:19<00:17, 376.58 examples/s]Map:  53%|█████▎    | 7407/14042 [00:19<00:17, 386.58 examples/s]Map:  53%|█████▎    | 7449/14042 [00:19<00:16, 391.97 examples/s]Map:  53%|█████▎    | 7497/14042 [00:19<00:15, 412.40 examples/s]Map:  54%|█████▎    | 7543/14042 [00:19<00:15, 424.65 examples/s]Map:  54%|█████▍    | 7592/14042 [00:19<00:14, 442.29 examples/s]Map:  54%|█████▍    | 7640/14042 [00:19<00:14, 450.73 examples/s]Map:  55%|█████▍    | 7690/14042 [00:19<00:13, 461.38 examples/s]Map:  55%|█████▌    | 7738/14042 [00:19<00:13, 462.83 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2179 > 2048). Running this sequence through the model will result in indexing errors
Map:  56%|█████▌    | 7807/14042 [00:20<00:13, 458.63 examples/s]Map:  56%|█████▌    | 7856/14042 [00:20<00:13, 461.96 examples/s]Map:  56%|█████▋    | 7905/14042 [00:20<00:13, 465.98 examples/s]Map:  57%|█████▋    | 7954/14042 [00:20<00:12, 470.73 examples/s]Map:  57%|█████▋    | 8022/14042 [00:20<00:21, 282.13 examples/s]Map:  57%|█████▋    | 8067/14042 [00:20<00:19, 310.41 examples/s]Map:  58%|█████▊    | 8115/14042 [00:21<00:17, 343.53 examples/s]Map:  58%|█████▊    | 8162/14042 [00:21<00:15, 370.03 examples/s]Map:  58%|█████▊    | 8211/14042 [00:21<00:14, 396.68 examples/s]Map:  59%|█████▉    | 8259/14042 [00:21<00:13, 416.35 examples/s]Map:  59%|█████▉    | 8305/14042 [00:21<00:13, 427.17 examples/s]Map:  59%|█████▉    | 8354/14042 [00:21<00:12, 440.38 examples/s]Map:  60%|█████▉    | 8424/14042 [00:21<00:12, 448.79 examples/s]Map:  60%|██████    | 8471/14042 [00:21<00:12, 453.20 examples/s]Map:  61%|██████    | 8541/14042 [00:21<00:12, 454.84 examples/s]Map:  61%|██████    | 8591/14042 [00:22<00:11, 463.94 examples/s]Map:  62%|██████▏   | 8638/14042 [00:22<00:11, 462.52 examples/s]Map:  62%|██████▏   | 8707/14042 [00:22<00:11, 457.99 examples/s]Map:  62%|██████▏   | 8773/14042 [00:22<00:11, 449.12 examples/s]Map:  63%|██████▎   | 8820/14042 [00:22<00:11, 453.28 examples/s]Map:  63%|██████▎   | 8867/14042 [00:22<00:11, 455.70 examples/s]Map:  63%|██████▎   | 8916/14042 [00:22<00:11, 461.79 examples/s]Map:  64%|██████▍   | 8965/14042 [00:22<00:10, 466.09 examples/s]Map:  64%|██████▍   | 9021/14042 [00:23<00:17, 281.54 examples/s]Map:  65%|██████▍   | 9069/14042 [00:23<00:15, 316.76 examples/s]Map:  65%|██████▍   | 9118/14042 [00:23<00:14, 351.18 examples/s]Map:  65%|██████▌   | 9164/14042 [00:23<00:13, 371.30 examples/s]Map:  66%|██████▌   | 9212/14042 [00:23<00:12, 396.37 examples/s]Map:  66%|██████▌   | 9259/14042 [00:23<00:11, 414.44 examples/s]Map:  66%|██████▋   | 9308/14042 [00:23<00:11, 430.23 examples/s]Map:  67%|██████▋   | 9357/14042 [00:23<00:10, 444.70 examples/s]Map:  67%|██████▋   | 9425/14042 [00:24<00:10, 445.86 examples/s]Map:  67%|██████▋   | 9473/14042 [00:24<00:10, 453.63 examples/s]Map:  68%|██████▊   | 9524/14042 [00:24<00:09, 467.53 examples/s]Map:  68%|██████▊   | 9585/14042 [00:24<00:10, 441.27 examples/s]Map:  69%|██████▊   | 9644/14042 [00:24<00:10, 420.62 examples/s]Map:  69%|██████▉   | 9703/14042 [00:24<00:10, 407.66 examples/s]Map:  70%|██████▉   | 9760/14042 [00:24<00:10, 393.62 examples/s]Map:  70%|██████▉   | 9802/14042 [00:25<00:10, 397.96 examples/s]Map:  70%|███████   | 9846/14042 [00:25<00:10, 404.60 examples/s]Map:  70%|███████   | 9891/14042 [00:25<00:10, 411.62 examples/s]Map:  71%|███████   | 9935/14042 [00:25<00:09, 416.00 examples/s]Map:  71%|███████   | 9979/14042 [00:25<00:09, 420.88 examples/s]Map:  72%|███████▏  | 10043/14042 [00:26<00:18, 212.18 examples/s]Map:  72%|███████▏  | 10091/14042 [00:26<00:15, 252.06 examples/s]Map:  72%|███████▏  | 10138/14042 [00:26<00:13, 289.48 examples/s]Map:  73%|███████▎  | 10183/14042 [00:26<00:12, 319.48 examples/s]Map:  73%|███████▎  | 10231/14042 [00:26<00:10, 352.76 examples/s]Map:  73%|███████▎  | 10278/14042 [00:26<00:09, 378.87 examples/s]Map:  74%|███████▎  | 10324/14042 [00:26<00:09, 397.42 examples/s]Map:  74%|███████▍  | 10370/14042 [00:26<00:08, 411.65 examples/s]Map:  74%|███████▍  | 10436/14042 [00:26<00:08, 418.82 examples/s]Map:  75%|███████▍  | 10502/14042 [00:27<00:08, 423.51 examples/s]Map:  75%|███████▌  | 10546/14042 [00:27<00:08, 425.93 examples/s]Map:  75%|███████▌  | 10594/14042 [00:27<00:07, 438.10 examples/s]Map:  76%|███████▌  | 10643/14042 [00:27<00:07, 449.86 examples/s]Map:  76%|███████▌  | 10690/14042 [00:27<00:07, 451.82 examples/s]Map:  76%|███████▋  | 10738/14042 [00:27<00:07, 456.60 examples/s]Map:  77%|███████▋  | 10806/14042 [00:27<00:07, 452.33 examples/s]Map:  77%|███████▋  | 10855/14042 [00:27<00:06, 460.24 examples/s]Map:  78%|███████▊  | 10902/14042 [00:27<00:06, 457.88 examples/s]Map:  78%|███████▊  | 10950/14042 [00:28<00:06, 462.21 examples/s]Map:  78%|███████▊  | 10998/14042 [00:28<00:06, 462.99 examples/s]Map:  79%|███████▊  | 11045/14042 [00:28<00:11, 271.08 examples/s]Map:  79%|███████▉  | 11094/14042 [00:28<00:09, 312.21 examples/s]Map:  79%|███████▉  | 11143/14042 [00:28<00:08, 348.36 examples/s]Map:  80%|███████▉  | 11193/14042 [00:28<00:07, 381.16 examples/s]Map:  80%|████████  | 11258/14042 [00:28<00:07, 395.12 examples/s]Map:  80%|████████  | 11302/14042 [00:29<00:06, 403.78 examples/s]Map:  81%|████████  | 11366/14042 [00:29<00:06, 410.22 examples/s]Map:  81%|████████▏ | 11430/14042 [00:29<00:06, 411.15 examples/s]Map:  82%|████████▏ | 11473/14042 [00:29<00:06, 411.76 examples/s]Map:  82%|████████▏ | 11519/14042 [00:29<00:05, 421.10 examples/s]Map:  82%|████████▏ | 11567/14042 [00:29<00:05, 434.47 examples/s]Map:  83%|████████▎ | 11615/14042 [00:29<00:05, 442.34 examples/s]Map:  83%|████████▎ | 11663/14042 [00:29<00:05, 451.83 examples/s]Map:  83%|████████▎ | 11712/14042 [00:29<00:05, 460.15 examples/s]Map:  84%|████████▍ | 11762/14042 [00:30<00:04, 469.53 examples/s]Map:  84%|████████▍ | 11832/14042 [00:30<00:04, 465.21 examples/s]Map:  85%|████████▍ | 11881/14042 [00:30<00:04, 469.76 examples/s]Map:  85%|████████▌ | 11952/14042 [00:30<00:04, 465.91 examples/s]Map:  85%|████████▌ | 12000/14042 [00:30<00:06, 298.00 examples/s]Map:  86%|████████▌ | 12045/14042 [00:30<00:06, 324.75 examples/s]Map:  86%|████████▌ | 12094/14042 [00:30<00:05, 357.67 examples/s]Map:  86%|████████▋ | 12141/14042 [00:31<00:04, 380.60 examples/s]Map:  87%|████████▋ | 12188/14042 [00:31<00:04, 400.80 examples/s]Map:  87%|████████▋ | 12236/14042 [00:31<00:04, 417.43 examples/s]Map:  87%|████████▋ | 12285/14042 [00:31<00:04, 433.12 examples/s]Map:  88%|████████▊ | 12332/14042 [00:31<00:03, 439.23 examples/s]Map:  88%|████████▊ | 12380/14042 [00:31<00:03, 447.72 examples/s]Map:  88%|████████▊ | 12427/14042 [00:31<00:03, 449.15 examples/s]Map:  89%|████████▉ | 12474/14042 [00:31<00:03, 454.52 examples/s]Map:  89%|████████▉ | 12522/14042 [00:31<00:03, 459.68 examples/s]Map:  90%|████████▉ | 12591/14042 [00:32<00:03, 454.94 examples/s]Map:  90%|█████████ | 12638/14042 [00:32<00:03, 457.75 examples/s]Map:  90%|█████████ | 12686/14042 [00:32<00:02, 459.70 examples/s]Map:  91%|█████████ | 12733/14042 [00:32<00:02, 457.41 examples/s]Map:  91%|█████████ | 12781/14042 [00:32<00:02, 461.33 examples/s]Map:  91%|█████████▏| 12828/14042 [00:32<00:02, 461.75 examples/s]Map:  92%|█████████▏| 12879/14042 [00:32<00:02, 471.56 examples/s]Map:  92%|█████████▏| 12950/14042 [00:32<00:02, 470.15 examples/s]Map:  93%|█████████▎| 13000/14042 [00:33<00:03, 285.16 examples/s]Map:  93%|█████████▎| 13046/14042 [00:33<00:03, 315.62 examples/s]Map:  93%|█████████▎| 13094/14042 [00:33<00:02, 348.50 examples/s]Map:  94%|█████████▎| 13140/14042 [00:33<00:02, 372.83 examples/s]Map:  94%|█████████▍| 13190/14042 [00:33<00:02, 401.91 examples/s]Map:  94%|█████████▍| 13237/14042 [00:33<00:01, 414.95 examples/s]Map:  95%|█████████▍| 13285/14042 [00:33<00:01, 430.76 examples/s]Map:  95%|█████████▍| 13332/14042 [00:33<00:01, 439.23 examples/s]Map:  95%|█████████▌| 13380/14042 [00:33<00:01, 448.47 examples/s]Map:  96%|█████████▌| 13427/14042 [00:34<00:01, 453.56 examples/s]Map:  96%|█████████▌| 13476/14042 [00:34<00:01, 460.89 examples/s]Map:  96%|█████████▋| 13545/14042 [00:34<00:01, 457.60 examples/s]Map:  97%|█████████▋| 13595/14042 [00:34<00:00, 464.66 examples/s]Map:  97%|█████████▋| 13644/14042 [00:34<00:00, 466.94 examples/s]Map:  98%|█████████▊| 13713/14042 [00:34<00:00, 461.99 examples/s]Map:  98%|█████████▊| 13763/14042 [00:34<00:00, 466.30 examples/s]Map:  98%|█████████▊| 13810/14042 [00:34<00:00, 466.77 examples/s]Map:  99%|█████████▊| 13858/14042 [00:35<00:00, 469.11 examples/s]Map:  99%|█████████▉| 13906/14042 [00:35<00:00, 470.07 examples/s]Map: 100%|█████████▉| 13976/14042 [00:35<00:00, 465.52 examples/s]Map: 100%|█████████▉| 14023/14042 [00:35<00:00, 290.93 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 393.76 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 10042 examples [00:00, 433597.22 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:  25%|██▍       | 2467/10042 [00:00<00:00, 24542.99 examples/s]Map:  50%|█████     | 5042/10042 [00:00<00:00, 25248.11 examples/s]Map:  76%|███████▋  | 7674/10042 [00:00<00:00, 25733.92 examples/s]Map: 100%|██████████| 10042/10042 [00:00<00:00, 25119.98 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 35/10042 [00:00<00:29, 340.04 examples/s]Map:   1%|          | 70/10042 [00:00<00:29, 337.81 examples/s]Map:   1%|          | 105/10042 [00:00<00:29, 339.21 examples/s]Map:   1%|▏         | 141/10042 [00:00<00:29, 341.37 examples/s]Map:   2%|▏         | 193/10042 [00:00<00:29, 339.42 examples/s]Map:   2%|▏         | 229/10042 [00:00<00:28, 340.23 examples/s]Map:   3%|▎         | 264/10042 [00:00<00:28, 340.06 examples/s]Map:   3%|▎         | 299/10042 [00:00<00:28, 340.63 examples/s]Map:   3%|▎         | 335/10042 [00:00<00:28, 342.40 examples/s]Map:   4%|▎         | 371/10042 [00:01<00:28, 344.61 examples/s]Map:   4%|▍         | 407/10042 [00:01<00:27, 344.76 examples/s]Map:   4%|▍         | 443/10042 [00:01<00:27, 343.73 examples/s]Map:   5%|▍         | 493/10042 [00:01<00:39, 239.53 examples/s]Map:   5%|▌         | 528/10042 [00:01<00:36, 260.05 examples/s]Map:   6%|▌         | 564/10042 [00:01<00:33, 280.61 examples/s]Map:   6%|▌         | 599/10042 [00:01<00:31, 296.37 examples/s]Map:   6%|▋         | 635/10042 [00:02<00:30, 309.87 examples/s]Map:   7%|▋         | 670/10042 [00:02<00:29, 317.80 examples/s]Map:   7%|▋         | 704/10042 [00:02<00:29, 321.88 examples/s]Map:   7%|▋         | 740/10042 [00:02<00:28, 329.13 examples/s]Map:   8%|▊         | 775/10042 [00:02<00:27, 332.69 examples/s]Map:   8%|▊         | 811/10042 [00:02<00:27, 336.64 examples/s]Map:   8%|▊         | 847/10042 [00:02<00:27, 338.75 examples/s]Map:   9%|▉         | 882/10042 [00:02<00:26, 340.53 examples/s]Map:   9%|▉         | 918/10042 [00:02<00:26, 341.65 examples/s]Map:  10%|▉         | 954/10042 [00:02<00:26, 341.54 examples/s]Map:  10%|▉         | 990/10042 [00:03<00:26, 342.99 examples/s]Map:  10%|█         | 1035/10042 [00:03<00:53, 167.84 examples/s]Map:  11%|█         | 1071/10042 [00:03<00:45, 196.52 examples/s]Map:  11%|█         | 1107/10042 [00:03<00:39, 224.29 examples/s]Map:  11%|█▏        | 1143/10042 [00:03<00:35, 250.76 examples/s]Map:  12%|█▏        | 1178/10042 [00:03<00:32, 271.46 examples/s]Map:  12%|█▏        | 1214/10042 [00:04<00:30, 290.46 examples/s]Map:  12%|█▏        | 1250/10042 [00:04<00:28, 304.82 examples/s]Map:  13%|█▎        | 1285/10042 [00:04<00:27, 314.86 examples/s]Map:  13%|█▎        | 1320/10042 [00:04<00:27, 322.17 examples/s]Map:  13%|█▎        | 1355/10042 [00:04<00:26, 326.43 examples/s]Map:  14%|█▍        | 1391/10042 [00:04<00:26, 332.03 examples/s]Map:  14%|█▍        | 1426/10042 [00:04<00:25, 335.05 examples/s]Map:  15%|█▍        | 1461/10042 [00:04<00:25, 337.17 examples/s]Map:  15%|█▍        | 1497/10042 [00:04<00:25, 339.32 examples/s]Map:  15%|█▌        | 1549/10042 [00:05<00:25, 338.26 examples/s]Map:  16%|█▌        | 1584/10042 [00:05<00:24, 338.72 examples/s]Map:  16%|█▌        | 1619/10042 [00:05<00:24, 338.82 examples/s]Map:  16%|█▋        | 1655/10042 [00:05<00:24, 340.20 examples/s]Map:  17%|█▋        | 1690/10042 [00:05<00:24, 341.60 examples/s]Map:  17%|█▋        | 1726/10042 [00:05<00:24, 342.87 examples/s]Map:  18%|█▊        | 1761/10042 [00:05<00:24, 342.11 examples/s]Map:  18%|█▊        | 1796/10042 [00:05<00:24, 340.43 examples/s]Map:  18%|█▊        | 1831/10042 [00:05<00:24, 340.78 examples/s]Map:  19%|█▊        | 1866/10042 [00:06<00:23, 341.57 examples/s]Map:  19%|█▉        | 1902/10042 [00:06<00:23, 342.60 examples/s]Map:  19%|█▉        | 1938/10042 [00:06<00:23, 341.79 examples/s]Map:  20%|█▉        | 1974/10042 [00:06<00:23, 342.49 examples/s]Map:  20%|██        | 2016/10042 [00:06<00:38, 208.55 examples/s]Map:  20%|██        | 2052/10042 [00:06<00:33, 235.61 examples/s]Map:  21%|██        | 2086/10042 [00:06<00:30, 257.32 examples/s]Map:  21%|██        | 2121/10042 [00:06<00:28, 278.02 examples/s]Map:  21%|██▏       | 2156/10042 [00:07<00:26, 293.77 examples/s]Map:  22%|██▏       | 2191/10042 [00:07<00:25, 306.84 examples/s]Map:  22%|██▏       | 2227/10042 [00:07<00:24, 317.65 examples/s]Map:  23%|██▎       | 2262/10042 [00:07<00:24, 323.31 examples/s]Map:  23%|██▎       | 2298/10042 [00:07<00:23, 330.04 examples/s]Map:  23%|██▎       | 2334/10042 [00:07<00:23, 334.05 examples/s]Map:  24%|██▎       | 2370/10042 [00:07<00:22, 338.41 examples/s]Map:  24%|██▍       | 2405/10042 [00:07<00:22, 339.10 examples/s]Map:  24%|██▍       | 2440/10042 [00:07<00:22, 340.05 examples/s]Map:  25%|██▍       | 2476/10042 [00:08<00:22, 340.85 examples/s]Map:  25%|██▌       | 2512/10042 [00:08<00:21, 343.51 examples/s]Map:  25%|██▌       | 2548/10042 [00:08<00:21, 344.59 examples/s]Map:  26%|██▌       | 2583/10042 [00:08<00:21, 343.63 examples/s]Map:  26%|██▌       | 2634/10042 [00:08<00:21, 339.09 examples/s]Map:  27%|██▋       | 2669/10042 [00:08<00:21, 337.97 examples/s]Map:  27%|██▋       | 2703/10042 [00:08<00:21, 337.72 examples/s]Map:  27%|██▋       | 2737/10042 [00:08<00:21, 333.42 examples/s]Map:  28%|██▊       | 2773/10042 [00:08<00:21, 336.76 examples/s]Map:  28%|██▊       | 2808/10042 [00:09<00:21, 339.32 examples/s]Map:  28%|██▊       | 2843/10042 [00:09<00:21, 339.45 examples/s]Map:  29%|██▊       | 2879/10042 [00:09<00:20, 342.30 examples/s]Map:  29%|██▉       | 2915/10042 [00:09<00:20, 342.79 examples/s]Map:  29%|██▉       | 2950/10042 [00:09<00:20, 342.26 examples/s]Map:  30%|██▉       | 2986/10042 [00:09<00:20, 343.21 examples/s]Map:  30%|███       | 3034/10042 [00:09<00:33, 209.76 examples/s]Map:  31%|███       | 3069/10042 [00:10<00:29, 235.15 examples/s]Map:  31%|███       | 3103/10042 [00:10<00:27, 256.98 examples/s]Map:  31%|███       | 3138/10042 [00:10<00:24, 277.14 examples/s]Map:  32%|███▏      | 3173/10042 [00:10<00:23, 293.00 examples/s]Map:  32%|███▏      | 3208/10042 [00:10<00:22, 304.49 examples/s]Map:  32%|███▏      | 3242/10042 [00:10<00:21, 311.68 examples/s]Map:  33%|███▎      | 3290/10042 [00:10<00:21, 313.33 examples/s]Map:  33%|███▎      | 3323/10042 [00:10<00:21, 315.50 examples/s]Map:  33%|███▎      | 3356/10042 [00:10<00:21, 315.74 examples/s]Map:  34%|███▎      | 3389/10042 [00:10<00:20, 316.95 examples/s]Map:  34%|███▍      | 3422/10042 [00:11<00:20, 317.76 examples/s]Map:  35%|███▍      | 3471/10042 [00:11<00:20, 318.09 examples/s]Map:  35%|███▌      | 3520/10042 [00:11<00:20, 316.85 examples/s]Map:  35%|███▌      | 3553/10042 [00:11<00:20, 316.64 examples/s]Map:  36%|███▌      | 3586/10042 [00:11<00:20, 317.56 examples/s]Map:  36%|███▌      | 3618/10042 [00:11<00:20, 317.82 examples/s]Map:  36%|███▋      | 3650/10042 [00:11<00:20, 316.06 examples/s]Map:  37%|███▋      | 3697/10042 [00:11<00:20, 311.71 examples/s]Map:  37%|███▋      | 3729/10042 [00:12<00:20, 311.78 examples/s]Map:  37%|███▋      | 3761/10042 [00:12<00:20, 310.10 examples/s]Map:  38%|███▊      | 3793/10042 [00:12<00:20, 311.44 examples/s]Map:  38%|███▊      | 3825/10042 [00:12<00:19, 311.99 examples/s]Map:  38%|███▊      | 3857/10042 [00:12<00:19, 311.11 examples/s]Map:  39%|███▊      | 3889/10042 [00:12<00:19, 311.81 examples/s]Map:  39%|███▉      | 3921/10042 [00:12<00:19, 312.01 examples/s]Map:  39%|███▉      | 3953/10042 [00:12<00:19, 311.86 examples/s]Map:  40%|███▉      | 3985/10042 [00:12<00:19, 312.26 examples/s]Map:  40%|████      | 4031/10042 [00:13<00:32, 186.08 examples/s]Map:  40%|████      | 4063/10042 [00:13<00:28, 209.18 examples/s]Map:  41%|████      | 4095/10042 [00:13<00:25, 230.56 examples/s]Map:  41%|████      | 4127/10042 [00:13<00:23, 249.27 examples/s]Map:  41%|████▏     | 4159/10042 [00:13<00:22, 265.57 examples/s]Map:  42%|████▏     | 4192/10042 [00:13<00:20, 279.01 examples/s]Map:  42%|████▏     | 4225/10042 [00:13<00:20, 290.45 examples/s]Map:  42%|████▏     | 4258/10042 [00:14<00:19, 299.17 examples/s]Map:  43%|████▎     | 4291/10042 [00:14<00:18, 304.80 examples/s]Map:  43%|████▎     | 4323/10042 [00:14<00:18, 308.97 examples/s]Map:  43%|████▎     | 4356/10042 [00:14<00:18, 311.38 examples/s]Map:  44%|████▎     | 4389/10042 [00:14<00:17, 314.94 examples/s]Map:  44%|████▍     | 4422/10042 [00:14<00:17, 316.89 examples/s]Map:  44%|████▍     | 4455/10042 [00:14<00:17, 317.42 examples/s]Map:  45%|████▍     | 4488/10042 [00:14<00:17, 319.59 examples/s]Map:  45%|████▌     | 4521/10042 [00:14<00:17, 319.54 examples/s]Map:  45%|████▌     | 4554/10042 [00:14<00:17, 318.78 examples/s]Map:  46%|████▌     | 4587/10042 [00:15<00:17, 318.04 examples/s]Map:  46%|████▌     | 4620/10042 [00:15<00:16, 319.29 examples/s]Map:  46%|████▋     | 4653/10042 [00:15<00:16, 318.88 examples/s]Map:  47%|████▋     | 4686/10042 [00:15<00:16, 319.68 examples/s]Map:  47%|████▋     | 4719/10042 [00:15<00:16, 318.71 examples/s]Map:  47%|████▋     | 4752/10042 [00:15<00:16, 319.49 examples/s]Map:  48%|████▊     | 4785/10042 [00:15<00:16, 319.86 examples/s]Map:  48%|████▊     | 4819/10042 [00:15<00:16, 321.54 examples/s]Map:  48%|████▊     | 4867/10042 [00:15<00:16, 318.96 examples/s]Map:  49%|████▉     | 4901/10042 [00:16<00:16, 321.03 examples/s]Map:  49%|████▉     | 4934/10042 [00:16<00:15, 320.64 examples/s]Map:  49%|████▉     | 4967/10042 [00:16<00:15, 320.11 examples/s]Map:  50%|████▉     | 5000/10042 [00:16<00:26, 191.93 examples/s]Map:  50%|█████     | 5031/10042 [00:16<00:23, 212.80 examples/s]Map:  50%|█████     | 5063/10042 [00:16<00:21, 234.90 examples/s]Map:  51%|█████     | 5095/10042 [00:16<00:19, 253.90 examples/s]Map:  51%|█████     | 5127/10042 [00:16<00:18, 269.28 examples/s]Map:  51%|█████▏    | 5159/10042 [00:17<00:17, 281.46 examples/s]Map:  52%|█████▏    | 5191/10042 [00:17<00:16, 290.06 examples/s]Map:  52%|█████▏    | 5225/10042 [00:17<00:16, 298.69 examples/s]Map:  52%|█████▏    | 5258/10042 [00:17<00:15, 306.36 examples/s]Map:  53%|█████▎    | 5292/10042 [00:17<00:15, 311.76 examples/s]Map:  53%|█████▎    | 5325/10042 [00:17<00:15, 313.99 examples/s]Map:  53%|█████▎    | 5358/10042 [00:17<00:14, 314.86 examples/s]Map:  54%|█████▎    | 5390/10042 [00:17<00:14, 314.30 examples/s]Map:  54%|█████▍    | 5424/10042 [00:17<00:14, 317.83 examples/s]Map:  54%|█████▍    | 5457/10042 [00:18<00:14, 318.00 examples/s]Map:  55%|█████▍    | 5489/10042 [00:18<00:14, 315.74 examples/s]Map:  55%|█████▍    | 5521/10042 [00:18<00:14, 315.65 examples/s]Map:  55%|█████▌    | 5556/10042 [00:18<00:20, 219.01 examples/s]Map:  56%|█████▌    | 5588/10042 [00:18<00:18, 240.52 examples/s]Map:  56%|█████▌    | 5620/10042 [00:18<00:17, 258.07 examples/s]Map:  56%|█████▋    | 5652/10042 [00:18<00:16, 272.75 examples/s]Map:  57%|█████▋    | 5684/10042 [00:18<00:15, 283.53 examples/s]Map:  57%|█████▋    | 5716/10042 [00:18<00:14, 292.03 examples/s]Map:  57%|█████▋    | 5749/10042 [00:19<00:14, 298.68 examples/s]Map:  58%|█████▊    | 5781/10042 [00:19<00:14, 303.33 examples/s]Map:  58%|█████▊    | 5814/10042 [00:19<00:13, 308.37 examples/s]Map:  58%|█████▊    | 5846/10042 [00:19<00:13, 310.57 examples/s]Map:  59%|█████▊    | 5878/10042 [00:19<00:13, 310.63 examples/s]Map:  59%|█████▉    | 5910/10042 [00:19<00:13, 312.22 examples/s]Map:  59%|█████▉    | 5942/10042 [00:19<00:13, 314.17 examples/s]Map:  60%|█████▉    | 5975/10042 [00:19<00:12, 315.87 examples/s]Map:  60%|█████▉    | 6015/10042 [00:20<00:21, 189.53 examples/s]Map:  60%|██████    | 6047/10042 [00:20<00:18, 213.60 examples/s]Map:  61%|██████    | 6079/10042 [00:20<00:16, 235.77 examples/s]Map:  61%|██████    | 6111/10042 [00:20<00:15, 253.88 examples/s]Map:  61%|██████    | 6142/10042 [00:20<00:14, 266.34 examples/s]Map:  62%|██████▏   | 6176/10042 [00:20<00:13, 282.15 examples/s]Map:  62%|██████▏   | 6208/10042 [00:20<00:13, 291.45 examples/s]Map:  62%|██████▏   | 6241/10042 [00:20<00:12, 298.93 examples/s]Map:  62%|██████▏   | 6274/10042 [00:20<00:12, 304.71 examples/s]Map:  63%|██████▎   | 6307/10042 [00:21<00:12, 308.87 examples/s]Map:  63%|██████▎   | 6341/10042 [00:21<00:11, 313.41 examples/s]Map:  63%|██████▎   | 6375/10042 [00:21<00:11, 315.49 examples/s]Map:  64%|██████▍   | 6408/10042 [00:21<00:11, 316.76 examples/s]Map:  64%|██████▍   | 6441/10042 [00:21<00:11, 318.00 examples/s]Map:  64%|██████▍   | 6475/10042 [00:21<00:11, 319.68 examples/s]Map:  65%|██████▍   | 6508/10042 [00:21<00:11, 319.15 examples/s]Map:  65%|██████▌   | 6541/10042 [00:21<00:10, 320.04 examples/s]Map:  65%|██████▌   | 6575/10042 [00:21<00:10, 321.47 examples/s]Map:  66%|██████▌   | 6608/10042 [00:22<00:10, 321.14 examples/s]Map:  66%|██████▋   | 6656/10042 [00:22<00:10, 317.50 examples/s]Map:  67%|██████▋   | 6689/10042 [00:22<00:10, 317.89 examples/s]Map:  67%|██████▋   | 6721/10042 [00:22<00:10, 316.88 examples/s]Map:  67%|██████▋   | 6753/10042 [00:22<00:10, 316.46 examples/s]Map:  68%|██████▊   | 6786/10042 [00:22<00:10, 317.78 examples/s]Map:  68%|██████▊   | 6819/10042 [00:22<00:10, 318.82 examples/s]Map:  68%|██████▊   | 6852/10042 [00:22<00:10, 317.70 examples/s]Map:  69%|██████▊   | 6885/10042 [00:22<00:09, 318.51 examples/s]Map:  69%|██████▉   | 6917/10042 [00:23<00:09, 317.19 examples/s]Map:  69%|██████▉   | 6949/10042 [00:23<00:09, 315.37 examples/s]Map:  70%|██████▉   | 6981/10042 [00:23<00:09, 316.19 examples/s]Map:  70%|██████▉   | 7015/10042 [00:23<00:16, 186.65 examples/s]Map:  70%|███████   | 7047/10042 [00:23<00:14, 211.62 examples/s]Map:  70%|███████   | 7079/10042 [00:23<00:12, 234.49 examples/s]Map:  71%|███████   | 7112/10042 [00:23<00:11, 255.06 examples/s]Map:  71%|███████   | 7144/10042 [00:23<00:10, 269.02 examples/s]Map:  71%|███████▏  | 7177/10042 [00:24<00:10, 282.86 examples/s]Map:  72%|███████▏  | 7210/10042 [00:24<00:09, 292.69 examples/s]Map:  72%|███████▏  | 7243/10042 [00:24<00:09, 300.28 examples/s]Map:  72%|███████▏  | 7276/10042 [00:24<00:09, 305.09 examples/s]Map:  73%|███████▎  | 7308/10042 [00:24<00:08, 307.89 examples/s]Map:  73%|███████▎  | 7341/10042 [00:24<00:08, 311.29 examples/s]Map:  73%|███████▎  | 7373/10042 [00:24<00:08, 312.38 examples/s]Map:  74%|███████▍  | 7406/10042 [00:24<00:08, 314.89 examples/s]Map:  74%|███████▍  | 7438/10042 [00:24<00:08, 314.57 examples/s]Map:  74%|███████▍  | 7470/10042 [00:25<00:08, 314.53 examples/s]Map:  75%|███████▍  | 7503/10042 [00:25<00:08, 315.59 examples/s]Map:  75%|███████▌  | 7535/10042 [00:25<00:07, 315.63 examples/s]Map:  75%|███████▌  | 7568/10042 [00:25<00:07, 316.75 examples/s]Map:  76%|███████▌  | 7601/10042 [00:25<00:07, 316.29 examples/s]Map:  76%|███████▌  | 7634/10042 [00:25<00:07, 316.82 examples/s]Map:  76%|███████▋  | 7681/10042 [00:25<00:07, 314.05 examples/s]Map:  77%|███████▋  | 7714/10042 [00:25<00:07, 316.31 examples/s]Map:  77%|███████▋  | 7747/10042 [00:25<00:07, 316.27 examples/s]Map:  77%|███████▋  | 7781/10042 [00:25<00:07, 317.35 examples/s]Map:  78%|███████▊  | 7813/10042 [00:26<00:07, 316.29 examples/s]Map:  78%|███████▊  | 7846/10042 [00:26<00:06, 318.06 examples/s]Map:  78%|███████▊  | 7878/10042 [00:26<00:06, 317.27 examples/s]Map:  79%|███████▉  | 7910/10042 [00:26<00:06, 317.51 examples/s]Map:  79%|███████▉  | 7943/10042 [00:26<00:06, 318.34 examples/s]Map:  79%|███████▉  | 7975/10042 [00:26<00:06, 318.19 examples/s]Map:  80%|███████▉  | 8015/10042 [00:26<00:10, 191.02 examples/s]Map:  80%|████████  | 8048/10042 [00:27<00:09, 216.19 examples/s]Map:  80%|████████  | 8080/10042 [00:27<00:08, 237.87 examples/s]Map:  81%|████████  | 8112/10042 [00:27<00:07, 255.03 examples/s]Map:  81%|████████  | 8145/10042 [00:27<00:06, 271.75 examples/s]Map:  81%|████████▏ | 8178/10042 [00:27<00:06, 282.99 examples/s]Map:  82%|████████▏ | 8210/10042 [00:27<00:06, 291.18 examples/s]Map:  82%|████████▏ | 8244/10042 [00:27<00:05, 300.18 examples/s]Map:  82%|████████▏ | 8276/10042 [00:27<00:05, 303.94 examples/s]Map:  83%|████████▎ | 8309/10042 [00:27<00:05, 308.49 examples/s]Map:  83%|████████▎ | 8341/10042 [00:27<00:05, 309.93 examples/s]Map:  83%|████████▎ | 8375/10042 [00:28<00:05, 313.66 examples/s]Map:  84%|████████▎ | 8408/10042 [00:28<00:05, 314.52 examples/s]Map:  84%|████████▍ | 8441/10042 [00:28<00:05, 316.13 examples/s]Map:  84%|████████▍ | 8473/10042 [00:28<00:04, 315.88 examples/s]Map:  85%|████████▍ | 8507/10042 [00:28<00:04, 318.42 examples/s]Map:  85%|████████▌ | 8539/10042 [00:28<00:04, 316.52 examples/s]Map:  85%|████████▌ | 8571/10042 [00:28<00:04, 316.97 examples/s]Map:  86%|████████▌ | 8603/10042 [00:28<00:04, 313.95 examples/s]Map:  86%|████████▌ | 8635/10042 [00:28<00:04, 314.66 examples/s]Map:  86%|████████▋ | 8667/10042 [00:29<00:04, 312.92 examples/s]Map:  87%|████████▋ | 8701/10042 [00:29<00:04, 316.21 examples/s]Map:  87%|████████▋ | 8733/10042 [00:29<00:04, 315.03 examples/s]Map:  87%|████████▋ | 8765/10042 [00:29<00:04, 315.16 examples/s]Map:  88%|████████▊ | 8798/10042 [00:29<00:03, 316.22 examples/s]Map:  88%|████████▊ | 8831/10042 [00:29<00:03, 317.02 examples/s]Map:  88%|████████▊ | 8864/10042 [00:29<00:03, 317.69 examples/s]Map:  89%|████████▊ | 8897/10042 [00:29<00:03, 317.01 examples/s]Map:  89%|████████▉ | 8929/10042 [00:29<00:03, 314.67 examples/s]Map:  89%|████████▉ | 8962/10042 [00:29<00:03, 315.05 examples/s]Map:  90%|████████▉ | 8994/10042 [00:30<00:03, 315.86 examples/s]Map:  90%|████████▉ | 9031/10042 [00:30<00:05, 187.95 examples/s]Map:  90%|█████████ | 9063/10042 [00:30<00:04, 211.69 examples/s]Map:  91%|█████████ | 9096/10042 [00:30<00:04, 235.07 examples/s]Map:  91%|█████████ | 9128/10042 [00:30<00:03, 253.05 examples/s]Map:  91%|█████████ | 9161/10042 [00:30<00:03, 269.46 examples/s]Map:  92%|█████████▏| 9193/10042 [00:30<00:03, 279.15 examples/s]Map:  92%|█████████▏| 9226/10042 [00:31<00:02, 290.17 examples/s]Map:  92%|█████████▏| 9259/10042 [00:31<00:02, 298.06 examples/s]Map:  93%|█████████▎| 9292/10042 [00:31<00:02, 303.82 examples/s]Map:  93%|█████████▎| 9325/10042 [00:31<00:02, 308.74 examples/s]Map:  93%|█████████▎| 9358/10042 [00:31<00:02, 312.10 examples/s]Map:  94%|█████████▎| 9390/10042 [00:31<00:02, 313.56 examples/s]Map:  94%|█████████▍| 9422/10042 [00:31<00:01, 312.47 examples/s]Map:  94%|█████████▍| 9455/10042 [00:31<00:01, 315.29 examples/s]Map:  94%|█████████▍| 9487/10042 [00:31<00:01, 314.26 examples/s]Map:  95%|█████████▍| 9520/10042 [00:31<00:01, 315.62 examples/s]Map:  95%|█████████▌| 9553/10042 [00:32<00:01, 315.80 examples/s]Map:  95%|█████████▌| 9585/10042 [00:32<00:01, 315.43 examples/s]Map:  96%|█████████▌| 9618/10042 [00:32<00:01, 317.30 examples/s]Map:  96%|█████████▌| 9650/10042 [00:32<00:01, 315.46 examples/s]Map:  96%|█████████▋| 9682/10042 [00:32<00:01, 315.18 examples/s]Map:  97%|█████████▋| 9715/10042 [00:32<00:01, 317.16 examples/s]Map:  97%|█████████▋| 9747/10042 [00:32<00:00, 316.37 examples/s]Map:  97%|█████████▋| 9781/10042 [00:32<00:00, 317.96 examples/s]Map:  98%|█████████▊| 9813/10042 [00:32<00:00, 317.19 examples/s]Map:  98%|█████████▊| 9846/10042 [00:32<00:00, 318.68 examples/s]Map:  98%|█████████▊| 9878/10042 [00:33<00:00, 316.32 examples/s]Map:  99%|█████████▊| 9911/10042 [00:33<00:00, 316.47 examples/s]Map:  99%|█████████▉| 9943/10042 [00:33<00:00, 316.95 examples/s]Map:  99%|█████████▉| 9977/10042 [00:33<00:00, 318.56 examples/s]Map: 100%|█████████▉| 10015/10042 [00:33<00:00, 186.51 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 148.00 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 294.67 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 1267 examples [00:00, 343249.14 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map: 100%|██████████| 1267/1267 [00:00<00:00, 24678.33 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   7%|▋         | 93/1267 [00:00<00:01, 919.48 examples/s]Map:  15%|█▌        | 191/1267 [00:00<00:01, 953.92 examples/s]Map:  23%|██▎       | 291/1267 [00:00<00:01, 966.89 examples/s]Map:  31%|███       | 390/1267 [00:00<00:00, 972.05 examples/s]Map:  42%|████▏     | 538/1267 [00:00<00:00, 972.18 examples/s]Map:  51%|█████     | 640/1267 [00:00<00:00, 982.51 examples/s]Map:  59%|█████▊    | 742/1267 [00:00<00:00, 989.57 examples/s]Map:  67%|██████▋   | 844/1267 [00:00<00:00, 996.44 examples/s]Map:  77%|███████▋  | 979/1267 [00:01<00:00, 667.73 examples/s]Map:  87%|████████▋ | 1100/1267 [00:01<00:00, 532.01 examples/s]Map:  95%|█████████▍| 1203/1267 [00:01<00:00, 614.03 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 741.99 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:01,  4.30it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  4.45it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  4.51it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  4.51it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:01<00:00,  4.60it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:01<00:00,  5.01it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:01<00:00,  4.74it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:35<02:57, 35.46s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [01:09<02:18, 34.55s/it]Loading checkpoint shards:  50%|█████     | 3/6 [01:44<01:44, 34.96s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [02:27<01:16, 38.17s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [03:07<00:38, 38.58s/it]Loading checkpoint shards: 100%|██████████| 6/6 [03:28<00:00, 32.64s/it]Loading checkpoint shards: 100%|██████████| 6/6 [03:28<00:00, 34.72s/it]
2024-04-27 06:21:31,043: rank0[3832644][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-04-27 06:21:31,045: rank0[3832644][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-04-27 06:21:32,297: rank0[3832644][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-04-27 06:21:32,349: rank0[3832644][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-04-27 06:21:50,526: rank0[3832644][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-04-27 06:21:50,527: rank0[3832644][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-04-27 06:21:50,527: rank0[3832644][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned50/combined
models:
- model_name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned50/combined
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned50/combined
    use_auth_token: true
  tokenizer:
    name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned50/combined
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-04-27 06:21:50,533: rank0[3832644][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.4966
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.4401
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7733
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7316
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                                             |
|:-----------|:--------------|:----------|-----------:|:------------------|:--------------------------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.496587 | 25-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned50/combined |
|            | mmlu          |           |   0.440108 | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned50/combined |
|            | winogrande    |           |   0.73165  | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned50/combined |
|            | hellaswag     |           |   0.773252 | 10-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned50/combined |
2024-04-27 07:22:43,144: rank0[3832644][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-04-27 07:22:43,144: rank0[3832644][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-04-27 07:22:43,144: rank0[3832644][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-04-27 07:22:43,144: rank0[3832644][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
