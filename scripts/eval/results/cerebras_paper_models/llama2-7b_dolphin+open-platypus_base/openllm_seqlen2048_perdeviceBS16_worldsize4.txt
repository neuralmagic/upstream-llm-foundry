----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-05-04 04:01:11,288: rank0[529473][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 27/1172 [00:00<00:04, 264.44 examples/s]Map:   5%|▍         | 55/1172 [00:00<00:04, 270.12 examples/s]Map:   8%|▊         | 96/1172 [00:00<00:04, 264.68 examples/s]Map:  11%|█         | 124/1172 [00:00<00:03, 265.32 examples/s]Map:  13%|█▎        | 151/1172 [00:00<00:03, 263.98 examples/s]Map:  15%|█▌        | 179/1172 [00:00<00:03, 264.76 examples/s]Map:  18%|█▊        | 207/1172 [00:00<00:03, 264.75 examples/s]Map:  20%|██        | 235/1172 [00:00<00:03, 265.68 examples/s]Map:  22%|██▏       | 263/1172 [00:00<00:03, 265.77 examples/s]Map:  25%|██▍       | 290/1172 [00:01<00:03, 263.30 examples/s]Map:  27%|██▋       | 318/1172 [00:01<00:03, 264.10 examples/s]Map:  30%|██▉       | 346/1172 [00:01<00:03, 265.95 examples/s]Map:  32%|███▏      | 373/1172 [00:01<00:03, 263.96 examples/s]Map:  34%|███▍      | 401/1172 [00:01<00:02, 265.04 examples/s]Map:  37%|███▋      | 428/1172 [00:01<00:02, 264.18 examples/s]Map:  39%|███▉      | 455/1172 [00:01<00:02, 262.18 examples/s]Map:  41%|████      | 483/1172 [00:01<00:02, 263.71 examples/s]Map:  44%|████▎     | 511/1172 [00:01<00:02, 264.02 examples/s]Map:  46%|████▌     | 538/1172 [00:02<00:02, 263.38 examples/s]Map:  48%|████▊     | 566/1172 [00:02<00:02, 263.90 examples/s]Map:  51%|█████     | 594/1172 [00:02<00:02, 265.02 examples/s]Map:  53%|█████▎    | 622/1172 [00:02<00:02, 266.19 examples/s]Map:  55%|█████▌    | 649/1172 [00:02<00:01, 264.31 examples/s]Map:  58%|█████▊    | 677/1172 [00:02<00:01, 264.84 examples/s]Map:  60%|██████    | 705/1172 [00:02<00:01, 265.34 examples/s]Map:  62%|██████▏   | 732/1172 [00:02<00:01, 262.91 examples/s]Map:  65%|██████▍   | 760/1172 [00:02<00:01, 264.32 examples/s]Map:  67%|██████▋   | 788/1172 [00:02<00:01, 265.46 examples/s]Map:  70%|██████▉   | 816/1172 [00:03<00:01, 265.24 examples/s]Map:  72%|███████▏  | 843/1172 [00:03<00:01, 264.08 examples/s]Map:  74%|███████▍  | 870/1172 [00:03<00:01, 264.68 examples/s]Map:  77%|███████▋  | 898/1172 [00:03<00:01, 264.73 examples/s]Map:  79%|███████▉  | 926/1172 [00:03<00:00, 263.67 examples/s]Map:  81%|████████▏ | 954/1172 [00:03<00:00, 264.19 examples/s]Map:  84%|████████▍ | 982/1172 [00:03<00:00, 264.48 examples/s]Map:  86%|████████▋ | 1013/1172 [00:04<00:01, 125.72 examples/s]Map:  89%|████████▉ | 1041/1172 [00:04<00:00, 148.85 examples/s]Map:  91%|█████████ | 1069/1172 [00:04<00:00, 171.17 examples/s]Map:  94%|█████████▎| 1097/1172 [00:04<00:00, 191.19 examples/s]Map:  96%|█████████▌| 1125/1172 [00:04<00:00, 209.03 examples/s]Map:  98%|█████████▊| 1153/1172 [00:04<00:00, 222.91 examples/s]Map: 100%|██████████| 1172/1172 [00:04<00:00, 238.77 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 46/14042 [00:00<00:30, 455.44 examples/s]Map:   1%|          | 112/14042 [00:00<00:32, 434.42 examples/s]Map:   1%|▏         | 176/14042 [00:00<00:32, 425.85 examples/s]Map:   2%|▏         | 221/14042 [00:00<00:32, 430.16 examples/s]Map:   2%|▏         | 284/14042 [00:00<00:32, 423.02 examples/s]Map:   2%|▏         | 330/14042 [00:00<00:31, 428.66 examples/s]Map:   3%|▎         | 383/14042 [00:01<00:48, 284.18 examples/s]Map:   3%|▎         | 424/14042 [00:01<00:44, 307.65 examples/s]Map:   3%|▎         | 469/14042 [00:01<00:40, 337.39 examples/s]Map:   4%|▎         | 513/14042 [00:01<00:37, 361.13 examples/s]Map:   4%|▍         | 556/14042 [00:01<00:35, 377.19 examples/s]Map:   4%|▍         | 599/14042 [00:01<00:34, 389.45 examples/s]Map:   5%|▍         | 642/14042 [00:01<00:33, 400.19 examples/s]Map:   5%|▍         | 684/14042 [00:01<00:33, 403.19 examples/s]Map:   5%|▌         | 727/14042 [00:01<00:32, 408.09 examples/s]Map:   6%|▌         | 773/14042 [00:02<00:31, 418.61 examples/s]Map:   6%|▌         | 818/14042 [00:02<00:31, 423.22 examples/s]Map:   6%|▌         | 861/14042 [00:02<00:31, 423.47 examples/s]Map:   7%|▋         | 927/14042 [00:02<00:30, 426.05 examples/s]Map:   7%|▋         | 976/14042 [00:02<00:29, 438.83 examples/s]Map:   7%|▋         | 1021/14042 [00:02<01:03, 206.51 examples/s]Map:   8%|▊         | 1070/14042 [00:03<00:52, 249.37 examples/s]Map:   8%|▊         | 1119/14042 [00:03<00:44, 291.45 examples/s]Map:   8%|▊         | 1168/14042 [00:03<00:39, 329.78 examples/s]Map:   9%|▊         | 1216/14042 [00:03<00:35, 361.75 examples/s]Map:   9%|▉         | 1263/14042 [00:03<00:33, 384.28 examples/s]Map:   9%|▉         | 1309/14042 [00:03<00:31, 402.26 examples/s]Map:  10%|▉         | 1356/14042 [00:03<00:30, 417.48 examples/s]Map:  10%|█         | 1425/14042 [00:03<00:29, 430.54 examples/s]Map:  11%|█         | 1494/14042 [00:04<00:28, 436.89 examples/s]Map:  11%|█         | 1560/14042 [00:04<00:28, 435.84 examples/s]Map:  11%|█▏        | 1605/14042 [00:04<00:28, 435.76 examples/s]Map:  12%|█▏        | 1652/14042 [00:04<00:28, 441.81 examples/s]Map:  12%|█▏        | 1699/14042 [00:04<00:27, 447.44 examples/s]Map:  12%|█▏        | 1745/14042 [00:04<00:27, 446.93 examples/s]Map:  13%|█▎        | 1791/14042 [00:04<00:27, 446.26 examples/s]Map:  13%|█▎        | 1837/14042 [00:04<00:27, 447.36 examples/s]Map:  14%|█▎        | 1902/14042 [00:04<00:27, 439.10 examples/s]Map:  14%|█▍        | 1948/14042 [00:05<00:27, 442.40 examples/s]Map:  14%|█▍        | 1995/14042 [00:05<00:26, 447.97 examples/s]Map:  15%|█▍        | 2043/14042 [00:05<00:46, 258.19 examples/s]Map:  15%|█▍        | 2089/14042 [00:05<00:40, 294.65 examples/s]Map:  15%|█▌        | 2137/14042 [00:05<00:35, 331.22 examples/s]Map:  16%|█▌        | 2185/14042 [00:05<00:32, 361.79 examples/s]Map:  16%|█▌        | 2233/14042 [00:05<00:30, 389.91 examples/s]Map:  16%|█▌        | 2281/14042 [00:06<00:28, 411.46 examples/s]Map:  17%|█▋        | 2330/14042 [00:06<00:27, 431.92 examples/s]Map:  17%|█▋        | 2399/14042 [00:06<00:26, 439.72 examples/s]Map:  17%|█▋        | 2448/14042 [00:06<00:25, 450.91 examples/s]Map:  18%|█▊        | 2495/14042 [00:06<00:25, 454.02 examples/s]Map:  18%|█▊        | 2544/14042 [00:06<00:24, 462.85 examples/s]Map:  18%|█▊        | 2593/14042 [00:06<00:24, 467.48 examples/s]Map:  19%|█▉        | 2641/14042 [00:06<00:24, 468.30 examples/s]Map:  19%|█▉        | 2712/14042 [00:06<00:24, 467.01 examples/s]Map:  20%|█▉        | 2760/14042 [00:07<00:24, 467.30 examples/s]Map:  20%|█▉        | 2808/14042 [00:07<00:24, 465.97 examples/s]Map:  20%|██        | 2876/14042 [00:07<00:24, 457.33 examples/s]Map:  21%|██        | 2926/14042 [00:07<00:23, 465.26 examples/s]Map:  21%|██        | 2973/14042 [00:07<00:23, 464.54 examples/s]Map:  22%|██▏       | 3022/14042 [00:07<00:39, 280.48 examples/s]Map:  22%|██▏       | 3068/14042 [00:07<00:34, 313.77 examples/s]Map:  22%|██▏       | 3117/14042 [00:08<00:31, 349.29 examples/s]Map:  23%|██▎       | 3164/14042 [00:08<00:28, 375.96 examples/s]Map:  23%|██▎       | 3208/14042 [00:08<00:27, 390.39 examples/s]Map:  23%|██▎       | 3252/14042 [00:08<00:26, 402.74 examples/s]Map:  24%|██▎       | 3300/14042 [00:08<00:25, 419.77 examples/s]Map:  24%|██▍       | 3349/14042 [00:08<00:24, 436.09 examples/s]Map:  24%|██▍       | 3396/14042 [00:08<00:24, 443.15 examples/s]Map:  25%|██▍       | 3444/14042 [00:08<00:23, 451.35 examples/s]Map:  25%|██▍       | 3492/14042 [00:08<00:23, 458.50 examples/s]Map:  25%|██▌       | 3539/14042 [00:08<00:22, 460.38 examples/s]Map:  26%|██▌       | 3587/14042 [00:09<00:22, 463.47 examples/s]Map:  26%|██▌       | 3655/14042 [00:09<00:22, 457.52 examples/s]Map:  26%|██▋       | 3703/14042 [00:09<00:22, 459.87 examples/s]Map:  27%|██▋       | 3750/14042 [00:09<00:22, 460.08 examples/s]Map:  27%|██▋       | 3798/14042 [00:09<00:22, 462.96 examples/s]Map:  28%|██▊       | 3868/14042 [00:09<00:22, 462.35 examples/s]Map:  28%|██▊       | 3938/14042 [00:09<00:22, 459.08 examples/s]Map:  28%|██▊       | 3985/14042 [00:09<00:21, 457.28 examples/s]Map:  29%|██▉       | 4044/14042 [00:10<00:34, 289.79 examples/s]Map:  29%|██▉       | 4091/14042 [00:10<00:31, 320.62 examples/s]Map:  29%|██▉       | 4138/14042 [00:10<00:28, 348.76 examples/s]Map:  30%|██▉       | 4186/14042 [00:10<00:26, 376.77 examples/s]Map:  30%|███       | 4236/14042 [00:10<00:24, 401.31 examples/s]Map:  31%|███       | 4304/14042 [00:10<00:23, 414.66 examples/s]Map:  31%|███       | 4349/14042 [00:10<00:23, 420.38 examples/s]Map:  31%|███▏      | 4416/14042 [00:11<00:23, 409.93 examples/s]Map:  32%|███▏      | 4463/14042 [00:11<00:22, 421.62 examples/s]Map:  32%|███▏      | 4509/14042 [00:11<00:22, 430.81 examples/s]Map:  33%|███▎      | 4568/14042 [00:11<00:22, 412.66 examples/s]Map:  33%|███▎      | 4628/14042 [00:11<00:23, 405.09 examples/s]Map:  33%|███▎      | 4685/14042 [00:11<00:23, 393.24 examples/s]Map:  34%|███▍      | 4748/14042 [00:11<00:23, 396.07 examples/s]Map:  34%|███▍      | 4793/14042 [00:12<00:22, 407.41 examples/s]Map:  34%|███▍      | 4841/14042 [00:12<00:21, 422.70 examples/s]Map:  35%|███▍      | 4888/14042 [00:12<00:21, 432.62 examples/s]Map:  35%|███▌      | 4938/14042 [00:12<00:20, 446.74 examples/s]Map:  36%|███▌      | 4986/14042 [00:12<00:19, 453.66 examples/s]Map:  36%|███▌      | 5044/14042 [00:13<00:41, 214.32 examples/s]Map:  36%|███▌      | 5086/14042 [00:13<00:36, 244.23 examples/s]Map:  36%|███▋      | 5124/14042 [00:13<00:33, 267.00 examples/s]Map:  37%|███▋      | 5163/14042 [00:13<00:30, 291.07 examples/s]Map:  37%|███▋      | 5220/14042 [00:13<00:28, 314.36 examples/s]Map:  37%|███▋      | 5265/14042 [00:13<00:25, 341.75 examples/s]Map:  38%|███▊      | 5313/14042 [00:13<00:23, 372.94 examples/s]Map:  38%|███▊      | 5362/14042 [00:13<00:21, 401.50 examples/s]Map:  39%|███▊      | 5407/14042 [00:13<00:21, 410.13 examples/s]Map:  39%|███▉      | 5453/14042 [00:14<00:20, 423.04 examples/s]Map:  39%|███▉      | 5500/14042 [00:14<00:19, 433.41 examples/s]Map:  40%|███▉      | 5550/14042 [00:14<00:18, 447.70 examples/s]Map:  40%|███▉      | 5599/14042 [00:14<00:18, 457.48 examples/s]Map:  40%|████      | 5647/14042 [00:14<00:18, 461.00 examples/s]Map:  41%|████      | 5695/14042 [00:14<00:18, 462.49 examples/s]Map:  41%|████      | 5743/14042 [00:14<00:17, 464.65 examples/s]Map:  41%|████▏     | 5811/14042 [00:14<00:18, 456.89 examples/s]Map:  42%|████▏     | 5879/14042 [00:14<00:18, 450.52 examples/s]Map:  42%|████▏     | 5942/14042 [00:15<00:18, 438.39 examples/s]Map:  43%|████▎     | 6000/14042 [00:15<00:28, 277.62 examples/s]Map:  43%|████▎     | 6039/14042 [00:15<00:27, 295.42 examples/s]Map:  43%|████▎     | 6081/14042 [00:15<00:25, 317.13 examples/s]Map:  44%|████▎     | 6120/14042 [00:15<00:23, 331.99 examples/s]Map:  44%|████▍     | 6161/14042 [00:15<00:22, 347.86 examples/s]Map:  44%|████▍     | 6201/14042 [00:15<00:21, 358.58 examples/s]Map:  45%|████▍     | 6259/14042 [00:16<00:21, 366.97 examples/s]Map:  45%|████▍     | 6299/14042 [00:16<00:20, 371.19 examples/s]Map:  45%|████▌     | 6340/14042 [00:16<00:20, 380.26 examples/s]Map:  45%|████▌     | 6381/14042 [00:16<00:19, 385.34 examples/s]Map:  46%|████▌     | 6422/14042 [00:16<00:19, 391.30 examples/s]Map:  46%|████▌     | 6464/14042 [00:16<00:19, 394.34 examples/s]Map:  46%|████▋     | 6523/14042 [00:16<00:19, 389.12 examples/s]Map:  47%|████▋     | 6564/14042 [00:16<00:19, 393.22 examples/s]Map:  47%|████▋     | 6606/14042 [00:17<00:18, 397.45 examples/s]Map:  47%|████▋     | 6665/14042 [00:17<00:18, 391.43 examples/s]Map:  48%|████▊     | 6706/14042 [00:17<00:18, 393.41 examples/s]Map:  48%|████▊     | 6764/14042 [00:17<00:18, 388.75 examples/s]Map:  48%|████▊     | 6805/14042 [00:17<00:18, 390.57 examples/s]Map:  49%|████▉     | 6846/14042 [00:17<00:18, 391.92 examples/s]Map:  49%|████▉     | 6886/14042 [00:17<00:18, 392.71 examples/s]Map:  49%|████▉     | 6947/14042 [00:17<00:18, 393.22 examples/s]Map:  50%|████▉     | 6988/14042 [00:17<00:17, 394.51 examples/s]Map:  50%|█████     | 7039/14042 [00:18<00:28, 243.82 examples/s]Map:  50%|█████     | 7080/14042 [00:18<00:25, 271.63 examples/s]Map:  51%|█████     | 7120/14042 [00:18<00:23, 296.16 examples/s]Map:  51%|█████     | 7161/14042 [00:18<00:21, 318.93 examples/s]Map:  51%|█████▏    | 7203/14042 [00:18<00:20, 341.01 examples/s]Map:  52%|█████▏    | 7246/14042 [00:18<00:18, 359.91 examples/s]Map:  52%|█████▏    | 7286/14042 [00:18<00:18, 367.32 examples/s]Map:  52%|█████▏    | 7325/14042 [00:19<00:18, 372.52 examples/s]Map:  52%|█████▏    | 7366/14042 [00:19<00:17, 378.57 examples/s]Map:  53%|█████▎    | 7408/14042 [00:19<00:17, 386.32 examples/s]Map:  53%|█████▎    | 7450/14042 [00:19<00:16, 393.79 examples/s]Map:  53%|█████▎    | 7497/14042 [00:19<00:15, 412.70 examples/s]Map:  54%|█████▎    | 7543/14042 [00:19<00:15, 424.30 examples/s]Map:  54%|█████▍    | 7593/14042 [00:19<00:14, 443.41 examples/s]Map:  54%|█████▍    | 7640/14042 [00:19<00:14, 448.92 examples/s]Map:  55%|█████▍    | 7689/14042 [00:19<00:13, 459.47 examples/s]Map:  55%|█████▌    | 7736/14042 [00:20<00:13, 459.96 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2179 > 2048). Running this sequence through the model will result in indexing errors
Map:  56%|█████▌    | 7805/14042 [00:20<00:13, 456.54 examples/s]Map:  56%|█████▌    | 7854/14042 [00:20<00:13, 463.27 examples/s]Map:  56%|█████▋    | 7901/14042 [00:20<00:13, 462.58 examples/s]Map:  57%|█████▋    | 7951/14042 [00:20<00:13, 468.43 examples/s]Map:  57%|█████▋    | 7998/14042 [00:20<00:12, 466.75 examples/s]Map:  57%|█████▋    | 8046/14042 [00:20<00:21, 279.69 examples/s]Map:  58%|█████▊    | 8094/14042 [00:21<00:18, 318.07 examples/s]Map:  58%|█████▊    | 8139/14042 [00:21<00:17, 345.69 examples/s]Map:  58%|█████▊    | 8189/14042 [00:21<00:15, 379.67 examples/s]Map:  59%|█████▊    | 8238/14042 [00:21<00:14, 404.19 examples/s]Map:  59%|█████▉    | 8286/14042 [00:21<00:13, 422.06 examples/s]Map:  59%|█████▉    | 8333/14042 [00:21<00:13, 432.09 examples/s]Map:  60%|█████▉    | 8381/14042 [00:21<00:12, 442.14 examples/s]Map:  60%|██████    | 8428/14042 [00:21<00:12, 448.70 examples/s]Map:  60%|██████    | 8475/14042 [00:21<00:12, 453.46 examples/s]Map:  61%|██████    | 8522/14042 [00:21<00:12, 454.76 examples/s]Map:  61%|██████    | 8570/14042 [00:22<00:11, 458.83 examples/s]Map:  61%|██████▏   | 8619/14042 [00:22<00:11, 464.87 examples/s]Map:  62%|██████▏   | 8688/14042 [00:22<00:11, 460.25 examples/s]Map:  62%|██████▏   | 8755/14042 [00:22<00:11, 451.77 examples/s]Map:  63%|██████▎   | 8804/14042 [00:22<00:11, 457.10 examples/s]Map:  63%|██████▎   | 8851/14042 [00:22<00:11, 457.44 examples/s]Map:  63%|██████▎   | 8901/14042 [00:22<00:10, 467.57 examples/s]Map:  64%|██████▎   | 8949/14042 [00:22<00:10, 469.14 examples/s]Map:  64%|██████▍   | 8998/14042 [00:22<00:10, 471.22 examples/s]Map:  64%|██████▍   | 9046/14042 [00:23<00:17, 281.62 examples/s]Map:  65%|██████▍   | 9094/14042 [00:23<00:15, 318.12 examples/s]Map:  65%|██████▌   | 9141/14042 [00:23<00:14, 348.70 examples/s]Map:  65%|██████▌   | 9189/14042 [00:23<00:12, 378.55 examples/s]Map:  66%|██████▌   | 9234/14042 [00:23<00:12, 395.12 examples/s]Map:  66%|██████▌   | 9284/14042 [00:23<00:11, 420.14 examples/s]Map:  66%|██████▋   | 9334/14042 [00:23<00:10, 439.57 examples/s]Map:  67%|██████▋   | 9403/14042 [00:24<00:10, 444.37 examples/s]Map:  67%|██████▋   | 9450/14042 [00:24<00:10, 450.17 examples/s]Map:  68%|██████▊   | 9499/14042 [00:24<00:09, 456.50 examples/s]Map:  68%|██████▊   | 9546/14042 [00:24<00:09, 457.19 examples/s]Map:  68%|██████▊   | 9604/14042 [00:24<00:10, 426.07 examples/s]Map:  69%|██████▉   | 9661/14042 [00:24<00:10, 408.34 examples/s]Map:  69%|██████▉   | 9710/14042 [00:25<00:16, 270.49 examples/s]Map:  69%|██████▉   | 9747/14042 [00:25<00:15, 285.94 examples/s]Map:  70%|██████▉   | 9787/14042 [00:25<00:13, 306.75 examples/s]Map:  70%|███████   | 9830/14042 [00:25<00:12, 332.15 examples/s]Map:  70%|███████   | 9873/14042 [00:25<00:11, 353.61 examples/s]Map:  71%|███████   | 9917/14042 [00:25<00:11, 372.33 examples/s]Map:  71%|███████   | 9962/14042 [00:25<00:10, 389.95 examples/s]Map:  71%|███████▏  | 10020/14042 [00:26<00:15, 251.85 examples/s]Map:  72%|███████▏  | 10067/14042 [00:26<00:13, 289.44 examples/s]Map:  72%|███████▏  | 10116/14042 [00:26<00:11, 329.78 examples/s]Map:  72%|███████▏  | 10161/14042 [00:26<00:10, 355.94 examples/s]Map:  73%|███████▎  | 10208/14042 [00:26<00:10, 380.74 examples/s]Map:  73%|███████▎  | 10256/14042 [00:26<00:09, 401.76 examples/s]Map:  73%|███████▎  | 10305/14042 [00:26<00:08, 420.72 examples/s]Map:  74%|███████▍  | 10373/14042 [00:26<00:08, 427.31 examples/s]Map:  74%|███████▍  | 10440/14042 [00:26<00:08, 429.17 examples/s]Map:  75%|███████▍  | 10506/14042 [00:27<00:08, 430.34 examples/s]Map:  75%|███████▌  | 10551/14042 [00:27<00:08, 432.85 examples/s]Map:  75%|███████▌  | 10599/14042 [00:27<00:07, 441.46 examples/s]Map:  76%|███████▌  | 10647/14042 [00:27<00:07, 449.53 examples/s]Map:  76%|███████▌  | 10693/14042 [00:27<00:07, 450.25 examples/s]Map:  76%|███████▋  | 10740/14042 [00:27<00:07, 453.02 examples/s]Map:  77%|███████▋  | 10786/14042 [00:27<00:07, 448.83 examples/s]Map:  77%|███████▋  | 10832/14042 [00:27<00:07, 450.52 examples/s]Map:  77%|███████▋  | 10881/14042 [00:27<00:06, 458.73 examples/s]Map:  78%|███████▊  | 10950/14042 [00:28<00:06, 455.03 examples/s]Map:  78%|███████▊  | 10997/14042 [00:28<00:06, 455.98 examples/s]Map:  79%|███████▊  | 11044/14042 [00:28<00:11, 270.70 examples/s]Map:  79%|███████▉  | 11093/14042 [00:28<00:09, 310.02 examples/s]Map:  79%|███████▉  | 11142/14042 [00:28<00:08, 345.47 examples/s]Map:  80%|███████▉  | 11192/14042 [00:28<00:07, 378.47 examples/s]Map:  80%|████████  | 11257/14042 [00:28<00:07, 395.39 examples/s]Map:  80%|████████  | 11301/14042 [00:29<00:06, 404.63 examples/s]Map:  81%|████████  | 11345/14042 [00:29<00:06, 410.95 examples/s]Map:  81%|████████  | 11407/14042 [00:29<00:06, 409.24 examples/s]Map:  82%|████████▏ | 11452/14042 [00:29<00:06, 415.43 examples/s]Map:  82%|████████▏ | 11498/14042 [00:29<00:06, 423.86 examples/s]Map:  82%|████████▏ | 11546/14042 [00:29<00:05, 436.81 examples/s]Map:  83%|████████▎ | 11593/14042 [00:29<00:05, 444.53 examples/s]Map:  83%|████████▎ | 11663/14042 [00:29<00:05, 450.53 examples/s]Map:  83%|████████▎ | 11712/14042 [00:29<00:05, 458.34 examples/s]Map:  84%|████████▍ | 11762/14042 [00:30<00:04, 468.72 examples/s]Map:  84%|████████▍ | 11831/14042 [00:30<00:04, 464.12 examples/s]Map:  85%|████████▍ | 11881/14042 [00:30<00:04, 470.26 examples/s]Map:  85%|████████▌ | 11952/14042 [00:30<00:04, 467.71 examples/s]Map:  85%|████████▌ | 12000/14042 [00:30<00:06, 301.80 examples/s]Map:  86%|████████▌ | 12044/14042 [00:30<00:06, 326.07 examples/s]Map:  86%|████████▌ | 12093/14042 [00:31<00:05, 358.74 examples/s]Map:  86%|████████▋ | 12140/14042 [00:31<00:04, 380.71 examples/s]Map:  87%|████████▋ | 12187/14042 [00:31<00:04, 400.80 examples/s]Map:  87%|████████▋ | 12234/14042 [00:31<00:04, 416.45 examples/s]Map:  87%|████████▋ | 12280/14042 [00:31<00:04, 426.78 examples/s]Map:  88%|████████▊ | 12328/14042 [00:31<00:03, 438.84 examples/s]Map:  88%|████████▊ | 12375/14042 [00:31<00:03, 446.59 examples/s]Map:  88%|████████▊ | 12421/14042 [00:31<00:03, 448.48 examples/s]Map:  89%|████████▉ | 12468/14042 [00:31<00:03, 453.09 examples/s]Map:  89%|████████▉ | 12517/14042 [00:31<00:03, 461.94 examples/s]Map:  90%|████████▉ | 12584/14042 [00:32<00:03, 453.60 examples/s]Map:  90%|████████▉ | 12633/14042 [00:32<00:03, 461.85 examples/s]Map:  90%|█████████ | 12680/14042 [00:32<00:02, 460.60 examples/s]Map:  91%|█████████ | 12727/14042 [00:32<00:02, 458.32 examples/s]Map:  91%|█████████ | 12774/14042 [00:32<00:02, 459.44 examples/s]Map:  91%|█████████▏| 12823/14042 [00:32<00:02, 461.03 examples/s]Map:  92%|█████████▏| 12873/14042 [00:32<00:02, 470.93 examples/s]Map:  92%|█████████▏| 12943/14042 [00:32<00:02, 466.31 examples/s]Map:  93%|█████████▎| 12990/14042 [00:32<00:02, 466.72 examples/s]Map:  93%|█████████▎| 13047/14042 [00:33<00:03, 293.48 examples/s]Map:  93%|█████████▎| 13095/14042 [00:33<00:02, 326.93 examples/s]Map:  94%|█████████▎| 13140/14042 [00:33<00:02, 350.67 examples/s]Map:  94%|█████████▍| 13187/14042 [00:33<00:02, 375.25 examples/s]Map:  94%|█████████▍| 13233/14042 [00:33<00:02, 393.29 examples/s]Map:  95%|█████████▍| 13282/14042 [00:33<00:01, 416.38 examples/s]Map:  95%|█████████▍| 13329/14042 [00:33<00:01, 428.88 examples/s]Map:  95%|█████████▌| 13377/14042 [00:34<00:01, 439.89 examples/s]Map:  96%|█████████▌| 13426/14042 [00:34<00:01, 451.29 examples/s]Map:  96%|█████████▌| 13476/14042 [00:34<00:01, 459.86 examples/s]Map:  96%|█████████▋| 13545/14042 [00:34<00:01, 456.80 examples/s]Map:  97%|█████████▋| 13595/14042 [00:34<00:00, 464.31 examples/s]Map:  97%|█████████▋| 13644/14042 [00:34<00:00, 466.65 examples/s]Map:  98%|█████████▊| 13692/14042 [00:34<00:00, 466.96 examples/s]Map:  98%|█████████▊| 13740/14042 [00:34<00:00, 468.44 examples/s]Map:  98%|█████████▊| 13790/14042 [00:34<00:00, 472.50 examples/s]Map:  99%|█████████▊| 13838/14042 [00:35<00:00, 472.10 examples/s]Map:  99%|█████████▉| 13886/14042 [00:35<00:00, 470.60 examples/s]Map:  99%|█████████▉| 13937/14042 [00:35<00:00, 478.79 examples/s]Map: 100%|█████████▉| 14000/14042 [00:35<00:00, 290.44 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 310.45 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 393.33 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 33/10042 [00:00<00:31, 317.89 examples/s]Map:   1%|          | 66/10042 [00:00<00:31, 317.29 examples/s]Map:   1%|          | 100/10042 [00:00<00:31, 319.91 examples/s]Map:   1%|▏         | 134/10042 [00:00<00:30, 323.27 examples/s]Map:   2%|▏         | 167/10042 [00:00<00:30, 324.68 examples/s]Map:   2%|▏         | 202/10042 [00:00<00:29, 329.35 examples/s]Map:   2%|▏         | 237/10042 [00:00<00:29, 332.26 examples/s]Map:   3%|▎         | 272/10042 [00:00<00:29, 333.77 examples/s]Map:   3%|▎         | 309/10042 [00:01<00:45, 214.49 examples/s]Map:   3%|▎         | 345/10042 [00:01<00:39, 243.63 examples/s]Map:   4%|▍         | 381/10042 [00:01<00:36, 267.15 examples/s]Map:   4%|▍         | 415/10042 [00:01<00:34, 282.79 examples/s]Map:   4%|▍         | 450/10042 [00:01<00:32, 299.16 examples/s]Map:   5%|▍         | 484/10042 [00:01<00:30, 308.75 examples/s]Map:   5%|▌         | 520/10042 [00:01<00:29, 318.77 examples/s]Map:   6%|▌         | 554/10042 [00:01<00:29, 321.54 examples/s]Map:   6%|▌         | 590/10042 [00:01<00:28, 327.91 examples/s]Map:   6%|▌         | 624/10042 [00:02<00:28, 328.02 examples/s]Map:   7%|▋         | 659/10042 [00:02<00:28, 330.10 examples/s]Map:   7%|▋         | 693/10042 [00:02<00:28, 328.22 examples/s]Map:   7%|▋         | 727/10042 [00:02<00:28, 330.20 examples/s]Map:   8%|▊         | 762/10042 [00:02<00:27, 332.44 examples/s]Map:   8%|▊         | 797/10042 [00:02<00:27, 335.92 examples/s]Map:   8%|▊         | 831/10042 [00:02<00:27, 334.90 examples/s]Map:   9%|▊         | 866/10042 [00:02<00:27, 337.05 examples/s]Map:   9%|▉         | 900/10042 [00:02<00:27, 336.42 examples/s]Map:   9%|▉         | 934/10042 [00:02<00:27, 335.99 examples/s]Map:  10%|▉         | 968/10042 [00:03<00:26, 336.55 examples/s]Map:  10%|█         | 1016/10042 [00:03<00:57, 156.13 examples/s]Map:  10%|█         | 1051/10042 [00:03<00:48, 183.68 examples/s]Map:  11%|█         | 1087/10042 [00:03<00:42, 212.60 examples/s]Map:  11%|█         | 1123/10042 [00:03<00:37, 239.86 examples/s]Map:  12%|█▏        | 1158/10042 [00:04<00:33, 261.95 examples/s]Map:  12%|█▏        | 1193/10042 [00:04<00:31, 281.83 examples/s]Map:  12%|█▏        | 1228/10042 [00:04<00:29, 297.48 examples/s]Map:  13%|█▎        | 1263/10042 [00:04<00:28, 307.07 examples/s]Map:  13%|█▎        | 1298/10042 [00:04<00:27, 315.34 examples/s]Map:  13%|█▎        | 1332/10042 [00:04<00:27, 318.72 examples/s]Map:  14%|█▎        | 1367/10042 [00:04<00:26, 324.58 examples/s]Map:  14%|█▍        | 1402/10042 [00:04<00:26, 328.65 examples/s]Map:  14%|█▍        | 1438/10042 [00:04<00:25, 333.12 examples/s]Map:  15%|█▍        | 1473/10042 [00:05<00:25, 334.06 examples/s]Map:  15%|█▌        | 1509/10042 [00:05<00:25, 337.37 examples/s]Map:  15%|█▌        | 1544/10042 [00:05<00:25, 339.10 examples/s]Map:  16%|█▌        | 1595/10042 [00:05<00:25, 337.63 examples/s]Map:  16%|█▌        | 1630/10042 [00:05<00:24, 337.49 examples/s]Map:  17%|█▋        | 1665/10042 [00:05<00:24, 337.64 examples/s]Map:  17%|█▋        | 1700/10042 [00:05<00:24, 337.33 examples/s]Map:  17%|█▋        | 1735/10042 [00:05<00:24, 338.83 examples/s]Map:  18%|█▊        | 1769/10042 [00:05<00:24, 336.85 examples/s]Map:  18%|█▊        | 1803/10042 [00:05<00:24, 335.19 examples/s]Map:  18%|█▊        | 1837/10042 [00:06<00:24, 333.23 examples/s]Map:  19%|█▊        | 1872/10042 [00:06<00:24, 337.31 examples/s]Map:  19%|█▉        | 1908/10042 [00:06<00:23, 338.98 examples/s]Map:  19%|█▉        | 1943/10042 [00:06<00:23, 339.33 examples/s]Map:  20%|█▉        | 1978/10042 [00:06<00:23, 338.53 examples/s]Map:  20%|██        | 2016/10042 [00:06<00:41, 195.59 examples/s]Map:  20%|██        | 2051/10042 [00:06<00:35, 223.60 examples/s]Map:  21%|██        | 2085/10042 [00:07<00:32, 247.41 examples/s]Map:  21%|██        | 2120/10042 [00:07<00:29, 269.61 examples/s]Map:  21%|██▏       | 2154/10042 [00:07<00:27, 285.59 examples/s]Map:  22%|██▏       | 2188/10042 [00:07<00:26, 299.04 examples/s]Map:  22%|██▏       | 2222/10042 [00:07<00:25, 309.69 examples/s]Map:  22%|██▏       | 2257/10042 [00:07<00:24, 317.58 examples/s]Map:  23%|██▎       | 2293/10042 [00:07<00:23, 326.61 examples/s]Map:  23%|██▎       | 2328/10042 [00:07<00:23, 329.43 examples/s]Map:  24%|██▎       | 2364/10042 [00:07<00:22, 334.67 examples/s]Map:  24%|██▍       | 2399/10042 [00:08<00:22, 336.62 examples/s]Map:  24%|██▍       | 2434/10042 [00:08<00:22, 339.10 examples/s]Map:  25%|██▍       | 2469/10042 [00:08<00:22, 339.56 examples/s]Map:  25%|██▍       | 2504/10042 [00:08<00:22, 339.72 examples/s]Map:  25%|██▌       | 2539/10042 [00:08<00:21, 341.27 examples/s]Map:  26%|██▌       | 2575/10042 [00:08<00:21, 341.71 examples/s]Map:  26%|██▌       | 2610/10042 [00:08<00:21, 341.08 examples/s]Map:  26%|██▋       | 2645/10042 [00:08<00:21, 338.19 examples/s]Map:  27%|██▋       | 2679/10042 [00:08<00:21, 337.11 examples/s]Map:  27%|██▋       | 2714/10042 [00:08<00:21, 337.87 examples/s]Map:  27%|██▋       | 2748/10042 [00:09<00:21, 335.74 examples/s]Map:  28%|██▊       | 2784/10042 [00:09<00:21, 337.71 examples/s]Map:  28%|██▊       | 2819/10042 [00:09<00:21, 338.44 examples/s]Map:  28%|██▊       | 2854/10042 [00:09<00:21, 339.08 examples/s]Map:  29%|██▉       | 2890/10042 [00:09<00:21, 340.04 examples/s]Map:  29%|██▉       | 2926/10042 [00:09<00:20, 341.22 examples/s]Map:  30%|██▉       | 2977/10042 [00:09<00:20, 339.23 examples/s]Map:  30%|███       | 3017/10042 [00:10<00:34, 205.71 examples/s]Map:  30%|███       | 3053/10042 [00:10<00:30, 232.10 examples/s]Map:  31%|███       | 3088/10042 [00:10<00:27, 254.81 examples/s]Map:  31%|███       | 3123/10042 [00:10<00:25, 274.04 examples/s]Map:  31%|███▏      | 3159/10042 [00:10<00:23, 290.56 examples/s]Map:  32%|███▏      | 3195/10042 [00:10<00:22, 303.76 examples/s]Map:  32%|███▏      | 3230/10042 [00:10<00:21, 313.18 examples/s]Map:  33%|███▎      | 3279/10042 [00:10<00:21, 315.88 examples/s]Map:  33%|███▎      | 3327/10042 [00:11<00:21, 314.39 examples/s]Map:  34%|███▎      | 3375/10042 [00:11<00:21, 314.88 examples/s]Map:  34%|███▍      | 3424/10042 [00:11<00:20, 315.78 examples/s]Map:  35%|███▍      | 3472/10042 [00:11<00:20, 315.88 examples/s]Map:  35%|███▌      | 3519/10042 [00:11<00:20, 313.41 examples/s]Map:  35%|███▌      | 3551/10042 [00:11<00:20, 313.17 examples/s]Map:  36%|███▌      | 3584/10042 [00:11<00:20, 315.10 examples/s]Map:  36%|███▌      | 3616/10042 [00:11<00:20, 315.07 examples/s]Map:  36%|███▋      | 3648/10042 [00:12<00:20, 313.96 examples/s]Map:  37%|███▋      | 3680/10042 [00:12<00:20, 311.87 examples/s]Map:  37%|███▋      | 3712/10042 [00:12<00:20, 310.86 examples/s]Map:  37%|███▋      | 3744/10042 [00:12<00:20, 310.61 examples/s]Map:  38%|███▊      | 3791/10042 [00:12<00:20, 307.82 examples/s]Map:  38%|███▊      | 3823/10042 [00:12<00:20, 309.58 examples/s]Map:  38%|███▊      | 3855/10042 [00:12<00:20, 309.23 examples/s]Map:  39%|███▊      | 3887/10042 [00:12<00:19, 310.58 examples/s]Map:  39%|███▉      | 3919/10042 [00:12<00:19, 309.85 examples/s]Map:  39%|███▉      | 3951/10042 [00:13<00:19, 311.52 examples/s]Map:  40%|███▉      | 3983/10042 [00:13<00:19, 311.71 examples/s]Map:  40%|███▉      | 4015/10042 [00:13<00:33, 178.80 examples/s]Map:  40%|████      | 4047/10042 [00:13<00:29, 204.89 examples/s]Map:  41%|████      | 4078/10042 [00:13<00:26, 225.90 examples/s]Map:  41%|████      | 4110/10042 [00:13<00:24, 246.73 examples/s]Map:  41%|████      | 4142/10042 [00:13<00:22, 262.64 examples/s]Map:  42%|████▏     | 4174/10042 [00:13<00:21, 275.61 examples/s]Map:  42%|████▏     | 4206/10042 [00:14<00:20, 287.55 examples/s]Map:  42%|████▏     | 4238/10042 [00:14<00:19, 294.39 examples/s]Map:  43%|████▎     | 4271/10042 [00:14<00:19, 301.34 examples/s]Map:  43%|████▎     | 4303/10042 [00:14<00:18, 304.14 examples/s]Map:  43%|████▎     | 4335/10042 [00:14<00:18, 306.56 examples/s]Map:  43%|████▎     | 4367/10042 [00:14<00:18, 307.79 examples/s]Map:  44%|████▍     | 4400/10042 [00:14<00:18, 311.44 examples/s]Map:  44%|████▍     | 4433/10042 [00:14<00:17, 313.43 examples/s]Map:  44%|████▍     | 4465/10042 [00:14<00:17, 313.49 examples/s]Map:  45%|████▍     | 4497/10042 [00:15<00:17, 313.02 examples/s]Map:  45%|████▌     | 4544/10042 [00:15<00:17, 309.63 examples/s]Map:  46%|████▌     | 4576/10042 [00:15<00:17, 309.77 examples/s]Map:  46%|████▌     | 4608/10042 [00:15<00:17, 309.65 examples/s]Map:  46%|████▌     | 4640/10042 [00:15<00:17, 310.81 examples/s]Map:  47%|████▋     | 4672/10042 [00:15<00:17, 312.30 examples/s]Map:  47%|████▋     | 4704/10042 [00:15<00:17, 313.21 examples/s]Map:  47%|████▋     | 4736/10042 [00:15<00:16, 312.53 examples/s]Map:  48%|████▊     | 4770/10042 [00:15<00:16, 316.09 examples/s]Map:  48%|████▊     | 4802/10042 [00:15<00:16, 315.21 examples/s]Map:  48%|████▊     | 4834/10042 [00:16<00:16, 313.29 examples/s]Map:  48%|████▊     | 4866/10042 [00:16<00:16, 312.70 examples/s]Map:  49%|████▉     | 4900/10042 [00:16<00:16, 316.04 examples/s]Map:  49%|████▉     | 4933/10042 [00:16<00:16, 316.03 examples/s]Map:  49%|████▉     | 4965/10042 [00:16<00:16, 316.52 examples/s]Map:  50%|████▉     | 4997/10042 [00:16<00:16, 313.66 examples/s]Map:  50%|█████     | 5030/10042 [00:17<00:36, 137.05 examples/s]Map:  50%|█████     | 5062/10042 [00:17<00:30, 164.33 examples/s]Map:  51%|█████     | 5094/10042 [00:17<00:25, 191.45 examples/s]Map:  51%|█████     | 5126/10042 [00:17<00:22, 217.01 examples/s]Map:  51%|█████▏    | 5159/10042 [00:17<00:20, 240.12 examples/s]Map:  52%|█████▏    | 5191/10042 [00:17<00:18, 257.65 examples/s]Map:  52%|█████▏    | 5225/10042 [00:17<00:17, 274.38 examples/s]Map:  52%|█████▏    | 5258/10042 [00:17<00:16, 287.54 examples/s]Map:  53%|█████▎    | 5290/10042 [00:17<00:16, 293.73 examples/s]Map:  53%|█████▎    | 5323/10042 [00:18<00:15, 300.60 examples/s]Map:  53%|█████▎    | 5355/10042 [00:18<00:15, 305.33 examples/s]Map:  54%|█████▎    | 5387/10042 [00:18<00:15, 306.50 examples/s]Map:  54%|█████▍    | 5421/10042 [00:18<00:14, 311.93 examples/s]Map:  54%|█████▍    | 5454/10042 [00:18<00:14, 313.88 examples/s]Map:  55%|█████▍    | 5486/10042 [00:18<00:14, 312.86 examples/s]Map:  55%|█████▍    | 5518/10042 [00:18<00:14, 313.07 examples/s]Map:  55%|█████▌    | 5550/10042 [00:18<00:14, 314.63 examples/s]Map:  56%|█████▌    | 5597/10042 [00:18<00:14, 311.55 examples/s]Map:  56%|█████▌    | 5629/10042 [00:19<00:14, 311.71 examples/s]Map:  56%|█████▋    | 5661/10042 [00:19<00:14, 312.70 examples/s]Map:  57%|█████▋    | 5694/10042 [00:19<00:13, 312.76 examples/s]Map:  57%|█████▋    | 5727/10042 [00:19<00:13, 313.17 examples/s]Map:  57%|█████▋    | 5774/10042 [00:19<00:13, 311.44 examples/s]Map:  58%|█████▊    | 5807/10042 [00:19<00:13, 312.65 examples/s]Map:  58%|█████▊    | 5839/10042 [00:19<00:13, 312.98 examples/s]Map:  58%|█████▊    | 5871/10042 [00:19<00:13, 312.91 examples/s]Map:  59%|█████▉    | 5903/10042 [00:19<00:13, 312.91 examples/s]Map:  59%|█████▉    | 5936/10042 [00:20<00:13, 314.53 examples/s]Map:  59%|█████▉    | 5969/10042 [00:20<00:12, 316.21 examples/s]Map:  60%|█████▉    | 6015/10042 [00:20<00:21, 191.16 examples/s]Map:  60%|██████    | 6048/10042 [00:20<00:18, 214.47 examples/s]Map:  61%|██████    | 6081/10042 [00:20<00:16, 236.63 examples/s]Map:  61%|██████    | 6113/10042 [00:20<00:15, 254.54 examples/s]Map:  61%|██████    | 6146/10042 [00:20<00:14, 269.98 examples/s]Map:  62%|██████▏   | 6179/10042 [00:21<00:13, 283.48 examples/s]Map:  62%|██████▏   | 6211/10042 [00:21<00:13, 291.60 examples/s]Map:  62%|██████▏   | 6243/10042 [00:21<00:12, 298.23 examples/s]Map:  62%|██████▏   | 6275/10042 [00:21<00:12, 302.34 examples/s]Map:  63%|██████▎   | 6307/10042 [00:21<00:12, 303.81 examples/s]Map:  63%|██████▎   | 6340/10042 [00:21<00:12, 308.24 examples/s]Map:  63%|██████▎   | 6372/10042 [00:21<00:11, 309.86 examples/s]Map:  64%|██████▍   | 6405/10042 [00:21<00:11, 312.17 examples/s]Map:  64%|██████▍   | 6438/10042 [00:21<00:11, 313.84 examples/s]Map:  64%|██████▍   | 6472/10042 [00:21<00:11, 317.01 examples/s]Map:  65%|██████▍   | 6504/10042 [00:22<00:11, 315.05 examples/s]Map:  65%|██████▌   | 6536/10042 [00:22<00:11, 315.63 examples/s]Map:  65%|██████▌   | 6570/10042 [00:22<00:10, 318.65 examples/s]Map:  66%|██████▌   | 6603/10042 [00:22<00:10, 319.78 examples/s]Map:  66%|██████▌   | 6651/10042 [00:22<00:10, 318.11 examples/s]Map:  67%|██████▋   | 6683/10042 [00:22<00:10, 316.85 examples/s]Map:  67%|██████▋   | 6715/10042 [00:22<00:10, 312.97 examples/s]Map:  67%|██████▋   | 6747/10042 [00:22<00:10, 312.94 examples/s]Map:  68%|██████▊   | 6780/10042 [00:22<00:10, 314.81 examples/s]Map:  68%|██████▊   | 6812/10042 [00:23<00:10, 314.14 examples/s]Map:  68%|██████▊   | 6844/10042 [00:23<00:10, 314.76 examples/s]Map:  68%|██████▊   | 6877/10042 [00:23<00:10, 315.92 examples/s]Map:  69%|██████▉   | 6909/10042 [00:23<00:09, 314.89 examples/s]Map:  69%|██████▉   | 6941/10042 [00:23<00:09, 312.56 examples/s]Map:  69%|██████▉   | 6973/10042 [00:23<00:09, 313.11 examples/s]Map:  70%|██████▉   | 7015/10042 [00:23<00:16, 183.25 examples/s]Map:  70%|███████   | 7047/10042 [00:24<00:14, 207.08 examples/s]Map:  70%|███████   | 7079/10042 [00:24<00:12, 229.87 examples/s]Map:  71%|███████   | 7113/10042 [00:24<00:11, 251.22 examples/s]Map:  71%|███████   | 7145/10042 [00:24<00:10, 266.49 examples/s]Map:  71%|███████▏  | 7178/10042 [00:24<00:10, 281.23 examples/s]Map:  72%|███████▏  | 7211/10042 [00:24<00:09, 291.71 examples/s]Map:  72%|███████▏  | 7244/10042 [00:24<00:09, 299.90 examples/s]Map:  72%|███████▏  | 7276/10042 [00:24<00:09, 304.29 examples/s]Map:  73%|███████▎  | 7308/10042 [00:24<00:08, 307.37 examples/s]Map:  73%|███████▎  | 7341/10042 [00:25<00:08, 310.92 examples/s]Map:  73%|███████▎  | 7373/10042 [00:25<00:08, 310.94 examples/s]Map:  74%|███████▍  | 7406/10042 [00:25<00:08, 313.03 examples/s]Map:  74%|███████▍  | 7439/10042 [00:25<00:08, 314.29 examples/s]Map:  75%|███████▍  | 7486/10042 [00:25<00:08, 312.04 examples/s]Map:  75%|███████▍  | 7519/10042 [00:25<00:08, 312.91 examples/s]Map:  75%|███████▌  | 7551/10042 [00:25<00:07, 313.40 examples/s]Map:  76%|███████▌  | 7584/10042 [00:25<00:07, 315.47 examples/s]Map:  76%|███████▌  | 7618/10042 [00:25<00:07, 317.13 examples/s]Map:  76%|███████▌  | 7651/10042 [00:25<00:07, 317.87 examples/s]Map:  77%|███████▋  | 7684/10042 [00:26<00:07, 318.26 examples/s]Map:  77%|███████▋  | 7717/10042 [00:26<00:07, 317.96 examples/s]Map:  77%|███████▋  | 7750/10042 [00:26<00:07, 316.47 examples/s]Map:  78%|███████▊  | 7783/10042 [00:26<00:07, 316.71 examples/s]Map:  78%|███████▊  | 7815/10042 [00:26<00:07, 316.09 examples/s]Map:  78%|███████▊  | 7848/10042 [00:26<00:06, 317.02 examples/s]Map:  78%|███████▊  | 7882/10042 [00:26<00:06, 318.76 examples/s]Map:  79%|███████▉  | 7914/10042 [00:26<00:06, 318.52 examples/s]Map:  79%|███████▉  | 7946/10042 [00:26<00:06, 317.12 examples/s]Map:  79%|███████▉  | 7978/10042 [00:27<00:06, 316.35 examples/s]Map:  80%|███████▉  | 8015/10042 [00:27<00:11, 176.88 examples/s]Map:  80%|████████  | 8048/10042 [00:27<00:09, 203.81 examples/s]Map:  80%|████████  | 8080/10042 [00:27<00:08, 227.25 examples/s]Map:  81%|████████  | 8112/10042 [00:27<00:07, 246.52 examples/s]Map:  81%|████████  | 8145/10042 [00:27<00:07, 265.19 examples/s]Map:  81%|████████▏ | 8178/10042 [00:27<00:06, 278.39 examples/s]Map:  82%|████████▏ | 8211/10042 [00:28<00:06, 289.11 examples/s]Map:  82%|████████▏ | 8244/10042 [00:28<00:06, 298.13 examples/s]Map:  82%|████████▏ | 8276/10042 [00:28<00:05, 301.69 examples/s]Map:  83%|████████▎ | 8309/10042 [00:28<00:05, 303.38 examples/s]Map:  83%|████████▎ | 8341/10042 [00:28<00:05, 304.60 examples/s]Map:  83%|████████▎ | 8373/10042 [00:28<00:05, 308.54 examples/s]Map:  84%|████████▎ | 8405/10042 [00:28<00:05, 309.92 examples/s]Map:  84%|████████▍ | 8438/10042 [00:28<00:05, 312.08 examples/s]Map:  84%|████████▍ | 8470/10042 [00:28<00:05, 312.06 examples/s]Map:  85%|████████▍ | 8517/10042 [00:29<00:04, 312.05 examples/s]Map:  85%|████████▌ | 8549/10042 [00:29<00:04, 312.22 examples/s]Map:  85%|████████▌ | 8581/10042 [00:29<00:04, 312.62 examples/s]Map:  86%|████████▌ | 8613/10042 [00:29<00:04, 310.92 examples/s]Map:  86%|████████▌ | 8645/10042 [00:29<00:04, 311.34 examples/s]Map:  86%|████████▋ | 8677/10042 [00:29<00:04, 311.43 examples/s]Map:  87%|████████▋ | 8709/10042 [00:29<00:04, 312.08 examples/s]Map:  87%|████████▋ | 8741/10042 [00:29<00:04, 311.96 examples/s]Map:  88%|████████▊ | 8788/10042 [00:29<00:04, 310.54 examples/s]Map:  88%|████████▊ | 8820/10042 [00:29<00:03, 311.88 examples/s]Map:  88%|████████▊ | 8852/10042 [00:30<00:03, 312.75 examples/s]Map:  88%|████████▊ | 8884/10042 [00:30<00:03, 313.84 examples/s]Map:  89%|████████▉ | 8916/10042 [00:30<00:03, 313.25 examples/s]Map:  89%|████████▉ | 8948/10042 [00:30<00:03, 312.11 examples/s]Map:  89%|████████▉ | 8980/10042 [00:30<00:03, 312.77 examples/s]Map:  90%|████████▉ | 9016/10042 [00:30<00:05, 183.64 examples/s]Map:  90%|█████████ | 9048/10042 [00:30<00:04, 208.89 examples/s]Map:  90%|█████████ | 9081/10042 [00:31<00:04, 233.35 examples/s]Map:  91%|█████████ | 9113/10042 [00:31<00:03, 252.86 examples/s]Map:  91%|█████████ | 9146/10042 [00:31<00:03, 269.33 examples/s]Map:  91%|█████████▏| 9179/10042 [00:31<00:03, 281.55 examples/s]Map:  92%|█████████▏| 9211/10042 [00:31<00:02, 290.18 examples/s]Map:  92%|█████████▏| 9243/10042 [00:31<00:02, 296.37 examples/s]Map:  92%|█████████▏| 9276/10042 [00:31<00:02, 301.97 examples/s]Map:  93%|█████████▎| 9308/10042 [00:31<00:02, 306.64 examples/s]Map:  93%|█████████▎| 9341/10042 [00:31<00:02, 311.37 examples/s]Map:  93%|█████████▎| 9374/10042 [00:31<00:02, 313.73 examples/s]Map:  94%|█████████▎| 9406/10042 [00:32<00:02, 314.39 examples/s]Map:  94%|█████████▍| 9439/10042 [00:32<00:01, 316.27 examples/s]Map:  94%|█████████▍| 9471/10042 [00:32<00:01, 315.74 examples/s]Map:  95%|█████████▍| 9504/10042 [00:32<00:01, 316.06 examples/s]Map:  95%|█████████▍| 9537/10042 [00:32<00:01, 317.20 examples/s]Map:  95%|█████████▌| 9569/10042 [00:32<00:01, 316.64 examples/s]Map:  96%|█████████▌| 9602/10042 [00:32<00:01, 317.30 examples/s]Map:  96%|█████████▌| 9634/10042 [00:32<00:01, 316.66 examples/s]Map:  96%|█████████▋| 9667/10042 [00:32<00:01, 316.90 examples/s]Map:  97%|█████████▋| 9700/10042 [00:33<00:01, 316.92 examples/s]Map:  97%|█████████▋| 9733/10042 [00:33<00:00, 317.58 examples/s]Map:  97%|█████████▋| 9766/10042 [00:33<00:00, 317.25 examples/s]Map:  98%|█████████▊| 9799/10042 [00:33<00:00, 316.27 examples/s]Map:  98%|█████████▊| 9832/10042 [00:33<00:00, 317.88 examples/s]Map:  98%|█████████▊| 9864/10042 [00:33<00:00, 316.69 examples/s]Map:  99%|█████████▊| 9896/10042 [00:33<00:00, 315.33 examples/s]Map:  99%|█████████▉| 9929/10042 [00:33<00:00, 315.08 examples/s]Map:  99%|█████████▉| 9962/10042 [00:33<00:00, 316.27 examples/s]Map: 100%|█████████▉| 9995/10042 [00:33<00:00, 317.40 examples/s]Map: 100%|█████████▉| 10032/10042 [00:34<00:00, 142.12 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 289.98 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   8%|▊         | 96/1267 [00:00<00:01, 940.63 examples/s]Map:  15%|█▌        | 194/1267 [00:00<00:01, 956.33 examples/s]Map:  23%|██▎       | 296/1267 [00:00<00:00, 979.66 examples/s]Map:  31%|███▏      | 397/1267 [00:00<00:00, 988.51 examples/s]Map:  39%|███▉      | 498/1267 [00:00<00:00, 988.77 examples/s]Map:  47%|████▋     | 597/1267 [00:00<00:00, 984.75 examples/s]Map:  55%|█████▍    | 696/1267 [00:00<00:00, 984.46 examples/s]Map:  63%|██████▎   | 795/1267 [00:00<00:00, 980.71 examples/s]Map:  71%|███████   | 897/1267 [00:00<00:00, 990.38 examples/s]Map:  79%|███████▉  | 1000/1267 [00:01<00:00, 611.23 examples/s]Map:  87%|████████▋ | 1100/1267 [00:01<00:00, 691.79 examples/s]Map:  95%|█████████▍| 1202/1267 [00:01<00:00, 765.78 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 828.45 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:01,  3.05it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:01,  3.58it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  3.77it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:01<00:00,  4.02it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:01<00:00,  3.79it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:01<00:00,  4.20it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:01<00:00,  3.93it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:44<03:41, 44.27s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [02:29<05:20, 80.13s/it]Loading checkpoint shards:  50%|█████     | 3/6 [05:21<06:06, 122.01s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [07:15<03:58, 119.10s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [08:02<01:32, 92.75s/it] Loading checkpoint shards: 100%|██████████| 6/6 [08:27<00:00, 69.90s/it]Loading checkpoint shards: 100%|██████████| 6/6 [08:27<00:00, 84.59s/it]
2024-05-04 04:11:00,702: rank0[529473][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-05-04 04:11:00,703: rank0[529473][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-05-04 04:11:01,957: rank0[529473][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-05-04 04:11:01,982: rank0[529473][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-05-04 04:11:14,004: rank0[529473][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-05-04 04:11:14,005: rank0[529473][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-05-04 04:11:14,005: rank0[529473][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_base/combined
models:
- model_name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_base/combined
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_base/combined
    use_auth_token: true
  tokenizer:
    name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_base/combined
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-05-04 04:11:14,011: rank0[529473][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.5290
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.4474
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7805
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7403
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                                |
|:-----------|:--------------|:----------|-----------:|:------------------|:-------------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.52901  | 25-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_base/combined |
|            | mmlu          |           |   0.447443 | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_base/combined |
|            | winogrande    |           |   0.740331 | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_base/combined |
|            | hellaswag     |           |   0.780522 | 10-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_base/combined |
2024-05-04 05:12:43,015: rank0[529473][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-05-04 05:12:43,015: rank0[529473][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-05-04 05:12:43,015: rank0[529473][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-05-04 05:12:43,016: rank0[529473][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
