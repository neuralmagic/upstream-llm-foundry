----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-05-04 05:12:58,032: rank0[536965][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 27/1172 [00:00<00:04, 261.77 examples/s]Map:   5%|▍         | 55/1172 [00:00<00:04, 266.98 examples/s]Map:   7%|▋         | 83/1172 [00:00<00:04, 264.75 examples/s]Map:   9%|▉         | 111/1172 [00:00<00:04, 264.34 examples/s]Map:  13%|█▎        | 149/1172 [00:00<00:03, 256.56 examples/s]Map:  15%|█▌        | 177/1172 [00:00<00:03, 258.89 examples/s]Map:  17%|█▋        | 205/1172 [00:00<00:03, 260.70 examples/s]Map:  20%|█▉        | 232/1172 [00:00<00:03, 261.10 examples/s]Map:  22%|██▏       | 260/1172 [00:00<00:03, 262.82 examples/s]Map:  24%|██▍       | 287/1172 [00:01<00:03, 262.41 examples/s]Map:  27%|██▋       | 315/1172 [00:01<00:03, 262.69 examples/s]Map:  29%|██▉       | 343/1172 [00:01<00:03, 265.13 examples/s]Map:  32%|███▏      | 370/1172 [00:01<00:03, 262.46 examples/s]Map:  34%|███▍      | 398/1172 [00:01<00:02, 263.00 examples/s]Map:  36%|███▋      | 426/1172 [00:01<00:02, 262.72 examples/s]Map:  39%|███▊      | 453/1172 [00:01<00:02, 259.88 examples/s]Map:  41%|████      | 481/1172 [00:01<00:02, 261.20 examples/s]Map:  43%|████▎     | 508/1172 [00:01<00:02, 261.98 examples/s]Map:  46%|████▌     | 536/1172 [00:02<00:02, 263.10 examples/s]Map:  48%|████▊     | 564/1172 [00:02<00:02, 263.69 examples/s]Map:  50%|█████     | 591/1172 [00:02<00:02, 263.69 examples/s]Map:  53%|█████▎    | 619/1172 [00:02<00:02, 264.78 examples/s]Map:  55%|█████▌    | 646/1172 [00:02<00:02, 262.15 examples/s]Map:  58%|█████▊    | 674/1172 [00:02<00:01, 263.34 examples/s]Map:  60%|█████▉    | 702/1172 [00:02<00:01, 264.30 examples/s]Map:  63%|██████▎   | 742/1172 [00:02<00:01, 261.74 examples/s]Map:  66%|██████▌   | 769/1172 [00:02<00:01, 261.98 examples/s]Map:  68%|██████▊   | 796/1172 [00:03<00:01, 262.71 examples/s]Map:  70%|███████   | 823/1172 [00:03<00:01, 261.91 examples/s]Map:  73%|███████▎  | 850/1172 [00:03<00:01, 261.09 examples/s]Map:  75%|███████▍  | 878/1172 [00:03<00:01, 261.41 examples/s]Map:  77%|███████▋  | 905/1172 [00:03<00:01, 260.47 examples/s]Map:  80%|███████▉  | 933/1172 [00:03<00:00, 260.83 examples/s]Map:  82%|████████▏ | 960/1172 [00:03<00:00, 260.36 examples/s]Map:  84%|████████▍ | 988/1172 [00:03<00:00, 261.72 examples/s]Map:  88%|████████▊ | 1027/1172 [00:04<00:01, 129.18 examples/s]Map:  90%|█████████ | 1055/1172 [00:04<00:00, 150.43 examples/s]Map:  92%|█████████▏| 1083/1172 [00:04<00:00, 171.14 examples/s]Map:  95%|█████████▍| 1111/1172 [00:04<00:00, 190.86 examples/s]Map:  97%|█████████▋| 1137/1172 [00:04<00:00, 205.68 examples/s]Map:  99%|█████████▉| 1165/1172 [00:04<00:00, 219.86 examples/s]Map: 100%|██████████| 1172/1172 [00:04<00:00, 236.61 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 47/14042 [00:00<00:30, 460.94 examples/s]Map:   1%|          | 112/14042 [00:00<00:32, 431.13 examples/s]Map:   1%|          | 174/14042 [00:00<00:32, 421.27 examples/s]Map:   2%|▏         | 222/14042 [00:00<00:31, 436.28 examples/s]Map:   2%|▏         | 287/14042 [00:00<00:32, 427.89 examples/s]Map:   2%|▏         | 332/14042 [00:00<00:31, 431.86 examples/s]Map:   3%|▎         | 383/14042 [00:01<00:47, 286.87 examples/s]Map:   3%|▎         | 422/14042 [00:01<00:44, 306.97 examples/s]Map:   3%|▎         | 468/14042 [00:01<00:40, 338.18 examples/s]Map:   4%|▎         | 512/14042 [00:01<00:37, 360.91 examples/s]Map:   4%|▍         | 556/14042 [00:01<00:35, 377.87 examples/s]Map:   4%|▍         | 600/14042 [00:01<00:34, 390.86 examples/s]Map:   5%|▍         | 645/14042 [00:01<00:33, 402.61 examples/s]Map:   5%|▍         | 687/14042 [00:01<00:32, 405.24 examples/s]Map:   5%|▌         | 730/14042 [00:01<00:32, 409.97 examples/s]Map:   6%|▌         | 775/14042 [00:02<00:31, 418.82 examples/s]Map:   6%|▌         | 820/14042 [00:02<00:30, 426.77 examples/s]Map:   6%|▋         | 885/14042 [00:02<00:30, 424.62 examples/s]Map:   7%|▋         | 931/14042 [00:02<00:30, 432.43 examples/s]Map:   7%|▋         | 979/14042 [00:02<00:29, 443.60 examples/s]Map:   7%|▋         | 1045/14042 [00:03<00:58, 222.96 examples/s]Map:   8%|▊         | 1093/14042 [00:03<00:49, 260.75 examples/s]Map:   8%|▊         | 1144/14042 [00:03<00:42, 302.55 examples/s]Map:   8%|▊         | 1192/14042 [00:03<00:38, 337.25 examples/s]Map:   9%|▉         | 1238/14042 [00:03<00:35, 361.38 examples/s]Map:   9%|▉         | 1286/14042 [00:03<00:32, 387.81 examples/s]Map:   9%|▉         | 1332/14042 [00:03<00:31, 403.91 examples/s]Map:  10%|▉         | 1379/14042 [00:03<00:30, 416.86 examples/s]Map:  10%|█         | 1426/14042 [00:03<00:29, 429.14 examples/s]Map:  11%|█         | 1495/14042 [00:03<00:28, 437.63 examples/s]Map:  11%|█         | 1561/14042 [00:04<00:28, 436.00 examples/s]Map:  11%|█▏        | 1607/14042 [00:04<00:28, 435.90 examples/s]Map:  12%|█▏        | 1655/14042 [00:04<00:27, 442.56 examples/s]Map:  12%|█▏        | 1701/14042 [00:04<00:27, 444.88 examples/s]Map:  12%|█▏        | 1747/14042 [00:04<00:27, 447.23 examples/s]Map:  13%|█▎        | 1816/14042 [00:04<00:27, 449.11 examples/s]Map:  13%|█▎        | 1882/14042 [00:04<00:27, 443.81 examples/s]Map:  14%|█▍        | 1949/14042 [00:05<00:27, 442.99 examples/s]Map:  14%|█▍        | 1997/14042 [00:05<00:26, 447.80 examples/s]Map:  15%|█▍        | 2043/14042 [00:05<00:44, 270.12 examples/s]Map:  15%|█▍        | 2090/14042 [00:05<00:39, 304.05 examples/s]Map:  15%|█▌        | 2137/14042 [00:05<00:35, 336.36 examples/s]Map:  16%|█▌        | 2185/14042 [00:05<00:32, 366.82 examples/s]Map:  16%|█▌        | 2233/14042 [00:05<00:29, 393.90 examples/s]Map:  16%|█▌        | 2281/14042 [00:05<00:28, 413.94 examples/s]Map:  17%|█▋        | 2330/14042 [00:06<00:27, 432.51 examples/s]Map:  17%|█▋        | 2399/14042 [00:06<00:26, 440.11 examples/s]Map:  17%|█▋        | 2448/14042 [00:06<00:25, 450.59 examples/s]Map:  18%|█▊        | 2496/14042 [00:06<00:25, 455.21 examples/s]Map:  18%|█▊        | 2546/14042 [00:06<00:24, 465.78 examples/s]Map:  18%|█▊        | 2594/14042 [00:06<00:24, 468.39 examples/s]Map:  19%|█▉        | 2643/14042 [00:06<00:24, 470.48 examples/s]Map:  19%|█▉        | 2691/14042 [00:06<00:24, 471.35 examples/s]Map:  20%|█▉        | 2763/14042 [00:07<00:23, 471.22 examples/s]Map:  20%|██        | 2833/14042 [00:07<00:24, 465.79 examples/s]Map:  21%|██        | 2880/14042 [00:07<00:24, 462.42 examples/s]Map:  21%|██        | 2930/14042 [00:07<00:23, 468.08 examples/s]Map:  21%|██        | 2978/14042 [00:07<00:23, 467.32 examples/s]Map:  22%|██▏       | 3046/14042 [00:07<00:37, 291.83 examples/s]Map:  22%|██▏       | 3094/14042 [00:07<00:33, 324.39 examples/s]Map:  22%|██▏       | 3143/14042 [00:08<00:30, 355.61 examples/s]Map:  23%|██▎       | 3187/14042 [00:08<00:29, 373.31 examples/s]Map:  23%|██▎       | 3231/14042 [00:08<00:27, 388.19 examples/s]Map:  23%|██▎       | 3277/14042 [00:08<00:26, 404.03 examples/s]Map:  24%|██▎       | 3326/14042 [00:08<00:25, 423.33 examples/s]Map:  24%|██▍       | 3374/14042 [00:08<00:24, 436.28 examples/s]Map:  24%|██▍       | 3421/14042 [00:08<00:23, 444.62 examples/s]Map:  25%|██▍       | 3468/14042 [00:08<00:23, 448.28 examples/s]Map:  25%|██▌       | 3516/14042 [00:08<00:23, 455.91 examples/s]Map:  25%|██▌       | 3564/14042 [00:08<00:22, 458.16 examples/s]Map:  26%|██▌       | 3611/14042 [00:09<00:22, 458.87 examples/s]Map:  26%|██▌       | 3681/14042 [00:09<00:22, 458.75 examples/s]Map:  27%|██▋       | 3751/14042 [00:09<00:22, 458.50 examples/s]Map:  27%|██▋       | 3799/14042 [00:09<00:22, 461.11 examples/s]Map:  28%|██▊       | 3869/14042 [00:09<00:22, 460.79 examples/s]Map:  28%|██▊       | 3937/14042 [00:09<00:22, 457.59 examples/s]Map:  28%|██▊       | 3983/14042 [00:09<00:22, 455.09 examples/s]Map:  29%|██▉       | 4044/14042 [00:10<00:34, 292.69 examples/s]Map:  29%|██▉       | 4091/14042 [00:10<00:30, 322.88 examples/s]Map:  29%|██▉       | 4138/14042 [00:10<00:28, 350.65 examples/s]Map:  30%|██▉       | 4186/14042 [00:10<00:26, 378.45 examples/s]Map:  30%|███       | 4236/14042 [00:10<00:24, 402.90 examples/s]Map:  31%|███       | 4304/14042 [00:10<00:23, 415.59 examples/s]Map:  31%|███       | 4349/14042 [00:10<00:23, 421.22 examples/s]Map:  31%|███▏      | 4416/14042 [00:11<00:23, 410.63 examples/s]Map:  32%|███▏      | 4461/14042 [00:11<00:22, 419.58 examples/s]Map:  32%|███▏      | 4508/14042 [00:11<00:22, 429.30 examples/s]Map:  33%|███▎      | 4566/14042 [00:11<00:23, 410.95 examples/s]Map:  33%|███▎      | 4626/14042 [00:11<00:23, 403.15 examples/s]Map:  33%|███▎      | 4683/14042 [00:11<00:23, 392.81 examples/s]Map:  34%|███▍      | 4745/14042 [00:11<00:23, 395.11 examples/s]Map:  34%|███▍      | 4791/14042 [00:12<00:22, 407.48 examples/s]Map:  34%|███▍      | 4839/14042 [00:12<00:21, 420.99 examples/s]Map:  35%|███▍      | 4887/14042 [00:12<00:21, 433.34 examples/s]Map:  35%|███▌      | 4937/14042 [00:12<00:20, 446.97 examples/s]Map:  35%|███▌      | 4984/14042 [00:12<00:20, 450.74 examples/s]Map:  36%|███▌      | 5045/14042 [00:12<00:41, 219.02 examples/s]Map:  36%|███▌      | 5086/14042 [00:13<00:36, 246.57 examples/s]Map:  36%|███▋      | 5123/14042 [00:13<00:33, 268.13 examples/s]Map:  37%|███▋      | 5163/14042 [00:13<00:30, 292.95 examples/s]Map:  37%|███▋      | 5201/14042 [00:13<00:28, 309.72 examples/s]Map:  37%|███▋      | 5243/14042 [00:13<00:26, 332.39 examples/s]Map:  38%|███▊      | 5292/14042 [00:13<00:23, 369.81 examples/s]Map:  38%|███▊      | 5341/14042 [00:13<00:21, 400.88 examples/s]Map:  38%|███▊      | 5387/14042 [00:13<00:20, 414.86 examples/s]Map:  39%|███▊      | 5432/14042 [00:13<00:20, 421.92 examples/s]Map:  39%|███▉      | 5478/14042 [00:14<00:20, 427.88 examples/s]Map:  39%|███▉      | 5528/14042 [00:14<00:19, 445.69 examples/s]Map:  40%|███▉      | 5577/14042 [00:14<00:18, 456.99 examples/s]Map:  40%|████      | 5626/14042 [00:14<00:18, 461.66 examples/s]Map:  40%|████      | 5674/14042 [00:14<00:18, 461.76 examples/s]Map:  41%|████      | 5723/14042 [00:14<00:17, 466.52 examples/s]Map:  41%|████      | 5791/14042 [00:14<00:17, 459.25 examples/s]Map:  42%|████▏     | 5838/14042 [00:14<00:17, 457.28 examples/s]Map:  42%|████▏     | 5904/14042 [00:14<00:18, 448.20 examples/s]Map:  42%|████▏     | 5963/14042 [00:15<00:18, 427.54 examples/s]Map:  43%|████▎     | 6019/14042 [00:15<00:29, 272.96 examples/s]Map:  43%|████▎     | 6061/14042 [00:15<00:26, 296.63 examples/s]Map:  43%|████▎     | 6101/14042 [00:15<00:25, 316.41 examples/s]Map:  44%|████▎     | 6143/14042 [00:15<00:23, 336.14 examples/s]Map:  44%|████▍     | 6200/14042 [00:15<00:22, 347.98 examples/s]Map:  44%|████▍     | 6239/14042 [00:16<00:21, 354.83 examples/s]Map:  45%|████▍     | 6279/14042 [00:16<00:21, 364.29 examples/s]Map:  45%|████▍     | 6318/14042 [00:16<00:20, 370.80 examples/s]Map:  45%|████▌     | 6359/14042 [00:16<00:20, 379.07 examples/s]Map:  46%|████▌     | 6402/14042 [00:16<00:19, 389.72 examples/s]Map:  46%|████▌     | 6444/14042 [00:16<00:19, 397.02 examples/s]Map:  46%|████▋     | 6503/14042 [00:16<00:19, 391.83 examples/s]Map:  47%|████▋     | 6545/14042 [00:16<00:18, 395.07 examples/s]Map:  47%|████▋     | 6587/14042 [00:16<00:18, 399.89 examples/s]Map:  47%|████▋     | 6645/14042 [00:17<00:18, 392.55 examples/s]Map:  48%|████▊     | 6685/14042 [00:17<00:18, 390.63 examples/s]Map:  48%|████▊     | 6725/14042 [00:17<00:18, 389.26 examples/s]Map:  48%|████▊     | 6785/14042 [00:17<00:18, 389.76 examples/s]Map:  49%|████▊     | 6826/14042 [00:17<00:18, 391.39 examples/s]Map:  49%|████▉     | 6867/14042 [00:17<00:18, 390.96 examples/s]Map:  49%|████▉     | 6907/14042 [00:17<00:18, 390.98 examples/s]Map:  49%|████▉     | 6948/14042 [00:17<00:17, 395.02 examples/s]Map:  50%|████▉     | 6989/14042 [00:17<00:17, 395.68 examples/s]Map:  50%|█████     | 7039/14042 [00:18<00:28, 244.05 examples/s]Map:  50%|█████     | 7081/14042 [00:18<00:25, 275.25 examples/s]Map:  51%|█████     | 7121/14042 [00:18<00:23, 300.59 examples/s]Map:  51%|█████     | 7162/14042 [00:18<00:21, 322.74 examples/s]Map:  51%|█████▏    | 7205/14042 [00:18<00:19, 346.70 examples/s]Map:  52%|█████▏    | 7247/14042 [00:18<00:18, 364.40 examples/s]Map:  52%|█████▏    | 7287/14042 [00:18<00:18, 371.49 examples/s]Map:  52%|█████▏    | 7346/14042 [00:19<00:17, 376.08 examples/s]Map:  53%|█████▎    | 7387/14042 [00:19<00:17, 383.02 examples/s]Map:  53%|█████▎    | 7448/14042 [00:19<00:17, 386.76 examples/s]Map:  53%|█████▎    | 7494/14042 [00:19<00:16, 403.38 examples/s]Map:  54%|█████▎    | 7541/14042 [00:19<00:15, 418.09 examples/s]Map:  54%|█████▍    | 7590/14042 [00:19<00:14, 433.94 examples/s]Map:  54%|█████▍    | 7637/14042 [00:19<00:14, 442.39 examples/s]Map:  55%|█████▍    | 7685/14042 [00:19<00:14, 451.04 examples/s]Map:  55%|█████▌    | 7733/14042 [00:19<00:13, 454.69 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2179 > 2048). Running this sequence through the model will result in indexing errors
Map:  56%|█████▌    | 7801/14042 [00:20<00:13, 451.60 examples/s]Map:  56%|█████▌    | 7849/14042 [00:20<00:13, 456.00 examples/s]Map:  56%|█████▌    | 7896/14042 [00:20<00:13, 456.99 examples/s]Map:  57%|█████▋    | 7945/14042 [00:20<00:13, 463.48 examples/s]Map:  57%|█████▋    | 7993/14042 [00:20<00:13, 462.99 examples/s]Map:  57%|█████▋    | 8045/14042 [00:20<00:21, 275.63 examples/s]Map:  58%|█████▊    | 8094/14042 [00:20<00:18, 313.94 examples/s]Map:  58%|█████▊    | 8140/14042 [00:21<00:17, 344.60 examples/s]Map:  58%|█████▊    | 8190/14042 [00:21<00:15, 378.45 examples/s]Map:  59%|█████▊    | 8238/14042 [00:21<00:14, 401.49 examples/s]Map:  59%|█████▉    | 8286/14042 [00:21<00:13, 419.36 examples/s]Map:  59%|█████▉    | 8333/14042 [00:21<00:13, 429.31 examples/s]Map:  60%|█████▉    | 8381/14042 [00:21<00:12, 440.65 examples/s]Map:  60%|██████    | 8428/14042 [00:21<00:12, 447.84 examples/s]Map:  61%|██████    | 8497/14042 [00:21<00:12, 449.92 examples/s]Map:  61%|██████    | 8544/14042 [00:21<00:12, 451.53 examples/s]Map:  61%|██████    | 8594/14042 [00:22<00:11, 459.17 examples/s]Map:  62%|██████▏   | 8641/14042 [00:22<00:11, 461.12 examples/s]Map:  62%|██████▏   | 8709/14042 [00:22<00:11, 457.59 examples/s]Map:  62%|██████▏   | 8774/14042 [00:22<00:11, 448.61 examples/s]Map:  63%|██████▎   | 8822/14042 [00:22<00:11, 453.98 examples/s]Map:  63%|██████▎   | 8869/14042 [00:22<00:11, 457.07 examples/s]Map:  64%|██████▎   | 8919/14042 [00:22<00:11, 463.90 examples/s]Map:  64%|██████▍   | 8968/14042 [00:22<00:10, 468.50 examples/s]Map:  64%|██████▍   | 9021/14042 [00:23<00:17, 283.98 examples/s]Map:  65%|██████▍   | 9069/14042 [00:23<00:15, 319.07 examples/s]Map:  65%|██████▍   | 9117/14042 [00:23<00:13, 352.53 examples/s]Map:  65%|██████▌   | 9162/14042 [00:23<00:13, 374.26 examples/s]Map:  66%|██████▌   | 9211/14042 [00:23<00:12, 400.90 examples/s]Map:  66%|██████▌   | 9259/14042 [00:23<00:11, 416.82 examples/s]Map:  66%|██████▋   | 9308/14042 [00:23<00:10, 433.20 examples/s]Map:  67%|██████▋   | 9357/14042 [00:23<00:10, 446.47 examples/s]Map:  67%|██████▋   | 9425/14042 [00:24<00:10, 447.47 examples/s]Map:  67%|██████▋   | 9473/14042 [00:24<00:10, 454.64 examples/s]Map:  68%|██████▊   | 9524/14042 [00:24<00:09, 468.24 examples/s]Map:  68%|██████▊   | 9585/14042 [00:24<00:10, 441.93 examples/s]Map:  69%|██████▊   | 9642/14042 [00:24<00:10, 418.63 examples/s]Map:  69%|██████▉   | 9700/14042 [00:24<00:10, 404.37 examples/s]Map:  69%|██████▉   | 9747/14042 [00:25<00:15, 278.94 examples/s]Map:  70%|██████▉   | 9787/14042 [00:25<00:14, 299.17 examples/s]Map:  70%|███████   | 9830/14042 [00:25<00:12, 324.06 examples/s]Map:  70%|███████   | 9873/14042 [00:25<00:12, 346.24 examples/s]Map:  71%|███████   | 9917/14042 [00:25<00:11, 366.35 examples/s]Map:  71%|███████   | 9962/14042 [00:25<00:10, 384.53 examples/s]Map:  71%|███████▏  | 10020/14042 [00:25<00:16, 246.36 examples/s]Map:  72%|███████▏  | 10066/14042 [00:26<00:14, 282.23 examples/s]Map:  72%|███████▏  | 10115/14042 [00:26<00:12, 322.40 examples/s]Map:  72%|███████▏  | 10161/14042 [00:26<00:11, 350.84 examples/s]Map:  73%|███████▎  | 10208/14042 [00:26<00:10, 377.32 examples/s]Map:  73%|███████▎  | 10256/14042 [00:26<00:09, 399.86 examples/s]Map:  73%|███████▎  | 10305/14042 [00:26<00:08, 419.62 examples/s]Map:  74%|███████▎  | 10351/14042 [00:26<00:08, 427.35 examples/s]Map:  74%|███████▍  | 10397/14042 [00:26<00:08, 432.00 examples/s]Map:  75%|███████▍  | 10463/14042 [00:26<00:08, 431.48 examples/s]Map:  75%|███████▍  | 10508/14042 [00:27<00:08, 433.46 examples/s]Map:  75%|███████▌  | 10553/14042 [00:27<00:08, 435.81 examples/s]Map:  75%|███████▌  | 10601/14042 [00:27<00:07, 443.15 examples/s]Map:  76%|███████▌  | 10649/14042 [00:27<00:07, 450.41 examples/s]Map:  76%|███████▌  | 10696/14042 [00:27<00:07, 453.92 examples/s]Map:  77%|███████▋  | 10744/14042 [00:27<00:07, 456.98 examples/s]Map:  77%|███████▋  | 10790/14042 [00:27<00:07, 453.37 examples/s]Map:  77%|███████▋  | 10837/14042 [00:27<00:07, 456.96 examples/s]Map:  78%|███████▊  | 10884/14042 [00:27<00:06, 460.54 examples/s]Map:  78%|███████▊  | 10953/14042 [00:28<00:06, 455.27 examples/s]Map:  78%|███████▊  | 11000/14042 [00:28<00:10, 284.93 examples/s]Map:  79%|███████▊  | 11045/14042 [00:28<00:09, 314.88 examples/s]Map:  79%|███████▉  | 11094/14042 [00:28<00:08, 350.56 examples/s]Map:  79%|███████▉  | 11142/14042 [00:28<00:07, 379.10 examples/s]Map:  80%|███████▉  | 11192/14042 [00:28<00:07, 406.25 examples/s]Map:  80%|████████  | 11257/14042 [00:28<00:06, 414.39 examples/s]Map:  81%|████████  | 11323/14042 [00:29<00:06, 421.57 examples/s]Map:  81%|████████  | 11387/14042 [00:29<00:06, 419.93 examples/s]Map:  82%|████████▏ | 11452/14042 [00:29<00:06, 419.96 examples/s]Map:  82%|████████▏ | 11498/14042 [00:29<00:05, 426.15 examples/s]Map:  82%|████████▏ | 11546/14042 [00:29<00:05, 436.81 examples/s]Map:  83%|████████▎ | 11593/14042 [00:29<00:05, 444.44 examples/s]Map:  83%|████████▎ | 11639/14042 [00:29<00:05, 448.15 examples/s]Map:  83%|████████▎ | 11689/14042 [00:29<00:05, 456.77 examples/s]Map:  84%|████████▎ | 11740/14042 [00:29<00:04, 467.63 examples/s]Map:  84%|████████▍ | 11788/14042 [00:30<00:04, 468.06 examples/s]Map:  84%|████████▍ | 11837/14042 [00:30<00:04, 470.41 examples/s]Map:  85%|████████▍ | 11886/14042 [00:30<00:04, 473.50 examples/s]Map:  85%|████████▌ | 11958/14042 [00:30<00:04, 471.41 examples/s]Map:  86%|████████▌ | 12021/14042 [00:30<00:06, 300.33 examples/s]Map:  86%|████████▌ | 12068/14042 [00:30<00:05, 329.43 examples/s]Map:  86%|████████▋ | 12117/14042 [00:30<00:05, 359.85 examples/s]Map:  87%|████████▋ | 12164/14042 [00:31<00:04, 381.09 examples/s]Map:  87%|████████▋ | 12210/14042 [00:31<00:04, 397.27 examples/s]Map:  87%|████████▋ | 12256/14042 [00:31<00:04, 412.72 examples/s]Map:  88%|████████▊ | 12303/14042 [00:31<00:04, 423.98 examples/s]Map:  88%|████████▊ | 12351/14042 [00:31<00:03, 435.34 examples/s]Map:  88%|████████▊ | 12398/14042 [00:31<00:03, 441.85 examples/s]Map:  89%|████████▊ | 12444/14042 [00:31<00:03, 441.23 examples/s]Map:  89%|████████▉ | 12491/14042 [00:31<00:03, 447.60 examples/s]Map:  89%|████████▉ | 12559/14042 [00:31<00:03, 444.75 examples/s]Map:  90%|████████▉ | 12607/14042 [00:32<00:03, 451.19 examples/s]Map:  90%|█████████ | 12654/14042 [00:32<00:03, 454.49 examples/s]Map:  90%|█████████ | 12701/14042 [00:32<00:02, 457.18 examples/s]Map:  91%|█████████ | 12747/14042 [00:32<00:02, 455.28 examples/s]Map:  91%|█████████ | 12794/14042 [00:32<00:02, 455.84 examples/s]Map:  91%|█████████▏| 12843/14042 [00:32<00:02, 465.12 examples/s]Map:  92%|█████████▏| 12891/14042 [00:32<00:02, 465.00 examples/s]Map:  92%|█████████▏| 12939/14042 [00:32<00:02, 465.90 examples/s]Map:  92%|█████████▏| 12986/14042 [00:32<00:02, 464.78 examples/s]Map:  93%|█████████▎| 13046/14042 [00:33<00:03, 287.56 examples/s]Map:  93%|█████████▎| 13093/14042 [00:33<00:02, 321.67 examples/s]Map:  94%|█████████▎| 13139/14042 [00:33<00:02, 350.57 examples/s]Map:  94%|█████████▍| 13187/14042 [00:33<00:02, 380.10 examples/s]Map:  94%|█████████▍| 13233/14042 [00:33<00:02, 398.77 examples/s]Map:  95%|█████████▍| 13282/14042 [00:33<00:01, 421.14 examples/s]Map:  95%|█████████▍| 13330/14042 [00:33<00:01, 434.10 examples/s]Map:  95%|█████████▌| 13379/14042 [00:33<00:01, 445.19 examples/s]Map:  96%|█████████▌| 13429/14042 [00:34<00:01, 457.22 examples/s]Map:  96%|█████████▌| 13477/14042 [00:34<00:01, 461.57 examples/s]Map:  96%|█████████▋| 13547/14042 [00:34<00:01, 457.21 examples/s]Map:  97%|█████████▋| 13597/14042 [00:34<00:00, 465.83 examples/s]Map:  97%|█████████▋| 13667/14042 [00:34<00:00, 463.84 examples/s]Map:  98%|█████████▊| 13714/14042 [00:34<00:00, 461.93 examples/s]Map:  98%|█████████▊| 13763/14042 [00:34<00:00, 466.23 examples/s]Map:  98%|█████████▊| 13810/14042 [00:34<00:00, 466.92 examples/s]Map:  99%|█████████▊| 13858/14042 [00:34<00:00, 469.54 examples/s]Map:  99%|█████████▉| 13906/14042 [00:35<00:00, 470.50 examples/s]Map: 100%|█████████▉| 13976/14042 [00:35<00:00, 465.71 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 280.43 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 393.75 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 32/10042 [00:00<00:31, 316.50 examples/s]Map:   1%|          | 65/10042 [00:00<00:31, 320.95 examples/s]Map:   1%|          | 99/10042 [00:00<00:30, 324.15 examples/s]Map:   1%|▏         | 133/10042 [00:00<00:30, 326.42 examples/s]Map:   2%|▏         | 167/10042 [00:00<00:30, 327.70 examples/s]Map:   2%|▏         | 201/10042 [00:00<00:29, 330.91 examples/s]Map:   2%|▏         | 235/10042 [00:00<00:29, 331.83 examples/s]Map:   3%|▎         | 269/10042 [00:00<00:29, 332.88 examples/s]Map:   3%|▎         | 309/10042 [00:01<00:45, 213.75 examples/s]Map:   3%|▎         | 344/10042 [00:01<00:40, 240.44 examples/s]Map:   4%|▍         | 380/10042 [00:01<00:36, 265.87 examples/s]Map:   4%|▍         | 413/10042 [00:01<00:34, 281.29 examples/s]Map:   4%|▍         | 447/10042 [00:01<00:32, 295.51 examples/s]Map:   5%|▍         | 483/10042 [00:01<00:30, 308.39 examples/s]Map:   5%|▌         | 517/10042 [00:01<00:30, 314.07 examples/s]Map:   5%|▌         | 552/10042 [00:01<00:29, 321.48 examples/s]Map:   6%|▌         | 588/10042 [00:01<00:28, 328.28 examples/s]Map:   6%|▌         | 622/10042 [00:02<00:28, 331.11 examples/s]Map:   7%|▋         | 657/10042 [00:02<00:28, 333.24 examples/s]Map:   7%|▋         | 691/10042 [00:02<00:28, 330.65 examples/s]Map:   7%|▋         | 726/10042 [00:02<00:28, 331.81 examples/s]Map:   8%|▊         | 761/10042 [00:02<00:27, 334.33 examples/s]Map:   8%|▊         | 796/10042 [00:02<00:27, 336.38 examples/s]Map:   8%|▊         | 830/10042 [00:02<00:27, 335.94 examples/s]Map:   9%|▊         | 865/10042 [00:02<00:27, 337.96 examples/s]Map:   9%|▉         | 899/10042 [00:02<00:27, 337.16 examples/s]Map:   9%|▉         | 934/10042 [00:02<00:26, 337.95 examples/s]Map:  10%|▉         | 968/10042 [00:03<00:26, 338.08 examples/s]Map:  10%|█         | 1016/10042 [00:03<00:56, 160.78 examples/s]Map:  10%|█         | 1052/10042 [00:03<00:47, 189.90 examples/s]Map:  11%|█         | 1088/10042 [00:03<00:41, 218.18 examples/s]Map:  11%|█         | 1124/10042 [00:03<00:36, 244.99 examples/s]Map:  12%|█▏        | 1160/10042 [00:04<00:33, 268.40 examples/s]Map:  12%|█▏        | 1196/10042 [00:04<00:30, 288.16 examples/s]Map:  12%|█▏        | 1232/10042 [00:04<00:29, 303.48 examples/s]Map:  13%|█▎        | 1268/10042 [00:04<00:27, 314.94 examples/s]Map:  13%|█▎        | 1302/10042 [00:04<00:27, 320.10 examples/s]Map:  13%|█▎        | 1337/10042 [00:04<00:26, 326.68 examples/s]Map:  14%|█▎        | 1372/10042 [00:04<00:26, 331.11 examples/s]Map:  14%|█▍        | 1407/10042 [00:04<00:25, 332.12 examples/s]Map:  14%|█▍        | 1442/10042 [00:04<00:25, 333.96 examples/s]Map:  15%|█▍        | 1478/10042 [00:04<00:25, 337.10 examples/s]Map:  15%|█▌        | 1514/10042 [00:05<00:25, 341.01 examples/s]Map:  15%|█▌        | 1549/10042 [00:05<00:24, 341.58 examples/s]Map:  16%|█▌        | 1584/10042 [00:05<00:24, 341.00 examples/s]Map:  16%|█▋        | 1636/10042 [00:05<00:24, 340.23 examples/s]Map:  17%|█▋        | 1671/10042 [00:05<00:24, 339.95 examples/s]Map:  17%|█▋        | 1707/10042 [00:05<00:24, 341.67 examples/s]Map:  17%|█▋        | 1742/10042 [00:05<00:24, 342.26 examples/s]Map:  18%|█▊        | 1793/10042 [00:05<00:24, 338.44 examples/s]Map:  18%|█▊        | 1829/10042 [00:06<00:24, 339.04 examples/s]Map:  19%|█▊        | 1864/10042 [00:06<00:24, 339.25 examples/s]Map:  19%|█▉        | 1900/10042 [00:06<00:23, 340.53 examples/s]Map:  19%|█▉        | 1935/10042 [00:06<00:23, 340.24 examples/s]Map:  20%|█▉        | 1971/10042 [00:06<00:23, 341.11 examples/s]Map:  20%|██        | 2015/10042 [00:06<00:40, 199.83 examples/s]Map:  20%|██        | 2051/10042 [00:06<00:35, 226.90 examples/s]Map:  21%|██        | 2086/10042 [00:07<00:31, 249.88 examples/s]Map:  21%|██        | 2121/10042 [00:07<00:29, 271.27 examples/s]Map:  21%|██▏       | 2156/10042 [00:07<00:27, 288.26 examples/s]Map:  22%|██▏       | 2191/10042 [00:07<00:25, 302.46 examples/s]Map:  22%|██▏       | 2227/10042 [00:07<00:24, 314.04 examples/s]Map:  23%|██▎       | 2262/10042 [00:07<00:24, 320.53 examples/s]Map:  23%|██▎       | 2298/10042 [00:07<00:23, 328.83 examples/s]Map:  23%|██▎       | 2334/10042 [00:07<00:23, 333.22 examples/s]Map:  24%|██▎       | 2370/10042 [00:07<00:22, 337.88 examples/s]Map:  24%|██▍       | 2405/10042 [00:07<00:22, 339.01 examples/s]Map:  24%|██▍       | 2441/10042 [00:08<00:22, 340.88 examples/s]Map:  25%|██▍       | 2477/10042 [00:08<00:22, 341.93 examples/s]Map:  25%|██▌       | 2513/10042 [00:08<00:21, 344.74 examples/s]Map:  25%|██▌       | 2549/10042 [00:08<00:21, 344.89 examples/s]Map:  26%|██▌       | 2584/10042 [00:08<00:21, 344.23 examples/s]Map:  26%|██▌       | 2636/10042 [00:08<00:21, 341.14 examples/s]Map:  27%|██▋       | 2688/10042 [00:08<00:21, 339.96 examples/s]Map:  27%|██▋       | 2723/10042 [00:08<00:21, 338.89 examples/s]Map:  27%|██▋       | 2758/10042 [00:09<00:21, 338.06 examples/s]Map:  28%|██▊       | 2793/10042 [00:09<00:21, 337.70 examples/s]Map:  28%|██▊       | 2828/10042 [00:09<00:21, 339.67 examples/s]Map:  29%|██▊       | 2863/10042 [00:09<00:21, 341.06 examples/s]Map:  29%|██▉       | 2899/10042 [00:09<00:20, 341.43 examples/s]Map:  29%|██▉       | 2935/10042 [00:09<00:20, 341.54 examples/s]Map:  30%|██▉       | 2970/10042 [00:09<00:20, 340.52 examples/s]Map:  30%|███       | 3016/10042 [00:09<00:33, 209.10 examples/s]Map:  30%|███       | 3051/10042 [00:10<00:29, 234.98 examples/s]Map:  31%|███       | 3087/10042 [00:10<00:26, 258.44 examples/s]Map:  31%|███       | 3123/10042 [00:10<00:24, 279.01 examples/s]Map:  31%|███▏      | 3159/10042 [00:10<00:23, 294.55 examples/s]Map:  32%|███▏      | 3194/10042 [00:10<00:22, 306.72 examples/s]Map:  32%|███▏      | 3229/10042 [00:10<00:21, 316.20 examples/s]Map:  32%|███▏      | 3263/10042 [00:10<00:21, 318.79 examples/s]Map:  33%|███▎      | 3311/10042 [00:10<00:21, 316.52 examples/s]Map:  33%|███▎      | 3345/10042 [00:10<00:21, 318.82 examples/s]Map:  34%|███▍      | 3393/10042 [00:11<00:20, 318.14 examples/s]Map:  34%|███▍      | 3441/10042 [00:11<00:20, 317.66 examples/s]Map:  35%|███▍      | 3489/10042 [00:11<00:20, 317.33 examples/s]Map:  35%|███▌      | 3521/10042 [00:11<00:20, 317.04 examples/s]Map:  35%|███▌      | 3554/10042 [00:11<00:20, 316.71 examples/s]Map:  36%|███▌      | 3587/10042 [00:11<00:20, 317.26 examples/s]Map:  36%|███▌      | 3619/10042 [00:11<00:20, 317.37 examples/s]Map:  36%|███▋      | 3665/10042 [00:11<00:20, 311.41 examples/s]Map:  37%|███▋      | 3697/10042 [00:12<00:20, 310.12 examples/s]Map:  37%|███▋      | 3729/10042 [00:12<00:20, 308.71 examples/s]Map:  37%|███▋      | 3760/10042 [00:12<00:20, 305.80 examples/s]Map:  38%|███▊      | 3791/10042 [00:12<00:20, 304.95 examples/s]Map:  38%|███▊      | 3823/10042 [00:12<00:20, 306.80 examples/s]Map:  38%|███▊      | 3855/10042 [00:12<00:20, 306.25 examples/s]Map:  39%|███▊      | 3887/10042 [00:12<00:20, 307.46 examples/s]Map:  39%|███▉      | 3919/10042 [00:12<00:19, 307.90 examples/s]Map:  39%|███▉      | 3951/10042 [00:12<00:19, 307.40 examples/s]Map:  40%|███▉      | 3983/10042 [00:13<00:19, 307.71 examples/s]Map:  40%|███▉      | 4014/10042 [00:13<00:34, 174.00 examples/s]Map:  40%|████      | 4046/10042 [00:13<00:29, 200.72 examples/s]Map:  41%|████      | 4078/10042 [00:13<00:26, 224.54 examples/s]Map:  41%|████      | 4110/10042 [00:13<00:24, 244.81 examples/s]Map:  41%|████      | 4142/10042 [00:13<00:22, 261.13 examples/s]Map:  42%|████▏     | 4174/10042 [00:13<00:21, 274.57 examples/s]Map:  42%|████▏     | 4207/10042 [00:14<00:20, 285.12 examples/s]Map:  42%|████▏     | 4239/10042 [00:14<00:19, 292.34 examples/s]Map:  43%|████▎     | 4271/10042 [00:14<00:19, 299.25 examples/s]Map:  43%|████▎     | 4303/10042 [00:14<00:18, 304.73 examples/s]Map:  43%|████▎     | 4335/10042 [00:14<00:18, 305.60 examples/s]Map:  43%|████▎     | 4367/10042 [00:14<00:18, 306.99 examples/s]Map:  44%|████▍     | 4401/10042 [00:14<00:18, 311.08 examples/s]Map:  44%|████▍     | 4433/10042 [00:14<00:18, 310.88 examples/s]Map:  44%|████▍     | 4465/10042 [00:14<00:17, 310.26 examples/s]Map:  45%|████▍     | 4497/10042 [00:14<00:17, 312.19 examples/s]Map:  45%|████▌     | 4544/10042 [00:15<00:17, 309.61 examples/s]Map:  46%|████▌     | 4576/10042 [00:15<00:17, 310.80 examples/s]Map:  46%|████▌     | 4608/10042 [00:15<00:17, 310.27 examples/s]Map:  46%|████▌     | 4640/10042 [00:15<00:17, 310.88 examples/s]Map:  47%|████▋     | 4672/10042 [00:15<00:17, 310.28 examples/s]Map:  47%|████▋     | 4704/10042 [00:15<00:17, 311.42 examples/s]Map:  47%|████▋     | 4736/10042 [00:15<00:17, 310.96 examples/s]Map:  48%|████▊     | 4770/10042 [00:15<00:16, 314.59 examples/s]Map:  48%|████▊     | 4802/10042 [00:15<00:16, 312.19 examples/s]Map:  48%|████▊     | 4835/10042 [00:16<00:16, 311.76 examples/s]Map:  48%|████▊     | 4867/10042 [00:16<00:16, 311.17 examples/s]Map:  49%|████▉     | 4900/10042 [00:16<00:16, 313.51 examples/s]Map:  49%|████▉     | 4933/10042 [00:16<00:16, 313.53 examples/s]Map:  49%|████▉     | 4965/10042 [00:16<00:16, 312.07 examples/s]Map:  50%|████▉     | 4997/10042 [00:16<00:16, 309.47 examples/s]Map:  50%|█████     | 5030/10042 [00:17<00:38, 130.46 examples/s]Map:  50%|█████     | 5062/10042 [00:17<00:31, 157.62 examples/s]Map:  51%|█████     | 5094/10042 [00:17<00:26, 185.01 examples/s]Map:  51%|█████     | 5126/10042 [00:17<00:23, 211.16 examples/s]Map:  51%|█████▏    | 5157/10042 [00:17<00:21, 231.72 examples/s]Map:  52%|█████▏    | 5189/10042 [00:17<00:19, 251.57 examples/s]Map:  52%|█████▏    | 5222/10042 [00:17<00:17, 269.28 examples/s]Map:  52%|█████▏    | 5255/10042 [00:17<00:16, 283.33 examples/s]Map:  53%|█████▎    | 5288/10042 [00:17<00:16, 294.20 examples/s]Map:  53%|█████▎    | 5320/10042 [00:18<00:15, 298.42 examples/s]Map:  53%|█████▎    | 5352/10042 [00:18<00:15, 302.52 examples/s]Map:  54%|█████▎    | 5384/10042 [00:18<00:15, 304.57 examples/s]Map:  54%|█████▍    | 5418/10042 [00:18<00:14, 310.13 examples/s]Map:  54%|█████▍    | 5451/10042 [00:18<00:14, 312.35 examples/s]Map:  55%|█████▍    | 5498/10042 [00:18<00:14, 310.58 examples/s]Map:  55%|█████▌    | 5530/10042 [00:18<00:14, 310.05 examples/s]Map:  55%|█████▌    | 5562/10042 [00:18<00:14, 310.81 examples/s]Map:  56%|█████▌    | 5594/10042 [00:18<00:14, 311.71 examples/s]Map:  56%|█████▌    | 5626/10042 [00:19<00:14, 312.66 examples/s]Map:  56%|█████▋    | 5673/10042 [00:19<00:14, 310.94 examples/s]Map:  57%|█████▋    | 5705/10042 [00:19<00:13, 310.38 examples/s]Map:  57%|█████▋    | 5737/10042 [00:19<00:13, 310.77 examples/s]Map:  57%|█████▋    | 5769/10042 [00:19<00:13, 310.57 examples/s]Map:  58%|█████▊    | 5801/10042 [00:19<00:13, 311.69 examples/s]Map:  58%|█████▊    | 5834/10042 [00:19<00:13, 313.23 examples/s]Map:  59%|█████▊    | 5880/10042 [00:19<00:13, 308.91 examples/s]Map:  59%|█████▉    | 5912/10042 [00:19<00:13, 309.40 examples/s]Map:  59%|█████▉    | 5944/10042 [00:20<00:13, 310.82 examples/s]Map:  60%|█████▉    | 5977/10042 [00:20<00:12, 313.45 examples/s]Map:  60%|█████▉    | 6014/10042 [00:20<00:22, 181.11 examples/s]Map:  60%|██████    | 6046/10042 [00:20<00:19, 205.56 examples/s]Map:  61%|██████    | 6078/10042 [00:20<00:17, 228.70 examples/s]Map:  61%|██████    | 6110/10042 [00:20<00:15, 247.92 examples/s]Map:  61%|██████    | 6142/10042 [00:20<00:14, 263.80 examples/s]Map:  62%|██████▏   | 6176/10042 [00:21<00:13, 279.44 examples/s]Map:  62%|██████▏   | 6208/10042 [00:21<00:13, 289.39 examples/s]Map:  62%|██████▏   | 6240/10042 [00:21<00:12, 297.19 examples/s]Map:  62%|██████▏   | 6272/10042 [00:21<00:12, 302.78 examples/s]Map:  63%|██████▎   | 6305/10042 [00:21<00:12, 307.48 examples/s]Map:  63%|██████▎   | 6338/10042 [00:21<00:11, 311.92 examples/s]Map:  63%|██████▎   | 6371/10042 [00:21<00:11, 313.88 examples/s]Map:  64%|██████▍   | 6403/10042 [00:21<00:11, 313.90 examples/s]Map:  64%|██████▍   | 6435/10042 [00:21<00:11, 313.49 examples/s]Map:  64%|██████▍   | 6468/10042 [00:21<00:11, 316.09 examples/s]Map:  65%|██████▍   | 6515/10042 [00:22<00:11, 313.71 examples/s]Map:  65%|██████▌   | 6548/10042 [00:22<00:11, 315.08 examples/s]Map:  66%|██████▌   | 6582/10042 [00:22<00:10, 317.36 examples/s]Map:  66%|██████▌   | 6615/10042 [00:22<00:10, 316.77 examples/s]Map:  66%|██████▌   | 6647/10042 [00:22<00:10, 315.09 examples/s]Map:  67%|██████▋   | 6679/10042 [00:22<00:10, 314.50 examples/s]Map:  67%|██████▋   | 6711/10042 [00:22<00:10, 313.53 examples/s]Map:  67%|██████▋   | 6743/10042 [00:22<00:10, 313.36 examples/s]Map:  67%|██████▋   | 6776/10042 [00:22<00:10, 315.92 examples/s]Map:  68%|██████▊   | 6808/10042 [00:23<00:10, 314.15 examples/s]Map:  68%|██████▊   | 6841/10042 [00:23<00:10, 315.18 examples/s]Map:  68%|██████▊   | 6874/10042 [00:23<00:10, 315.81 examples/s]Map:  69%|██████▉   | 6906/10042 [00:23<00:09, 313.97 examples/s]Map:  69%|██████▉   | 6938/10042 [00:23<00:10, 309.51 examples/s]Map:  69%|██████▉   | 6970/10042 [00:23<00:09, 308.87 examples/s]Map:  70%|██████▉   | 7014/10042 [00:23<00:16, 185.40 examples/s]Map:  70%|███████   | 7046/10042 [00:24<00:14, 208.90 examples/s]Map:  70%|███████   | 7079/10042 [00:24<00:12, 231.81 examples/s]Map:  71%|███████   | 7112/10042 [00:24<00:11, 251.97 examples/s]Map:  71%|███████   | 7144/10042 [00:24<00:10, 264.44 examples/s]Map:  71%|███████▏  | 7176/10042 [00:24<00:10, 277.99 examples/s]Map:  72%|███████▏  | 7208/10042 [00:24<00:09, 287.74 examples/s]Map:  72%|███████▏  | 7241/10042 [00:24<00:09, 296.28 examples/s]Map:  72%|███████▏  | 7273/10042 [00:24<00:09, 300.53 examples/s]Map:  73%|███████▎  | 7305/10042 [00:24<00:09, 303.34 examples/s]Map:  73%|███████▎  | 7337/10042 [00:25<00:08, 307.06 examples/s]Map:  73%|███████▎  | 7370/10042 [00:25<00:08, 309.20 examples/s]Map:  74%|███████▎  | 7402/10042 [00:25<00:08, 311.21 examples/s]Map:  74%|███████▍  | 7434/10042 [00:25<00:08, 310.95 examples/s]Map:  74%|███████▍  | 7466/10042 [00:25<00:08, 310.55 examples/s]Map:  75%|███████▍  | 7498/10042 [00:25<00:08, 311.60 examples/s]Map:  75%|███████▍  | 7530/10042 [00:25<00:08, 311.54 examples/s]Map:  75%|███████▌  | 7563/10042 [00:25<00:07, 312.93 examples/s]Map:  76%|███████▌  | 7595/10042 [00:25<00:07, 314.05 examples/s]Map:  76%|███████▌  | 7627/10042 [00:25<00:07, 314.20 examples/s]Map:  76%|███████▋  | 7659/10042 [00:26<00:07, 314.39 examples/s]Map:  77%|███████▋  | 7692/10042 [00:26<00:07, 315.67 examples/s]Map:  77%|███████▋  | 7739/10042 [00:26<00:07, 310.89 examples/s]Map:  77%|███████▋  | 7771/10042 [00:26<00:07, 311.94 examples/s]Map:  78%|███████▊  | 7803/10042 [00:26<00:07, 312.19 examples/s]Map:  78%|███████▊  | 7836/10042 [00:26<00:07, 313.07 examples/s]Map:  78%|███████▊  | 7869/10042 [00:26<00:06, 312.84 examples/s]Map:  79%|███████▊  | 7901/10042 [00:26<00:06, 313.04 examples/s]Map:  79%|███████▉  | 7934/10042 [00:26<00:06, 314.14 examples/s]Map:  79%|███████▉  | 7966/10042 [00:27<00:06, 314.48 examples/s]Map:  80%|███████▉  | 7998/10042 [00:27<00:06, 313.84 examples/s]Map:  80%|███████▉  | 8031/10042 [00:27<00:11, 176.76 examples/s]Map:  80%|████████  | 8064/10042 [00:27<00:09, 204.38 examples/s]Map:  81%|████████  | 8096/10042 [00:27<00:08, 227.70 examples/s]Map:  81%|████████  | 8128/10042 [00:27<00:07, 247.75 examples/s]Map:  81%|████████▏ | 8162/10042 [00:27<00:07, 266.80 examples/s]Map:  82%|████████▏ | 8194/10042 [00:28<00:06, 278.61 examples/s]Map:  82%|████████▏ | 8228/10042 [00:28<00:06, 291.29 examples/s]Map:  82%|████████▏ | 8260/10042 [00:28<00:05, 297.55 examples/s]Map:  83%|████████▎ | 8293/10042 [00:28<00:05, 303.88 examples/s]Map:  83%|████████▎ | 8325/10042 [00:28<00:05, 305.84 examples/s]Map:  83%|████████▎ | 8357/10042 [00:28<00:05, 306.94 examples/s]Map:  84%|████████▎ | 8389/10042 [00:28<00:05, 308.90 examples/s]Map:  84%|████████▍ | 8421/10042 [00:28<00:05, 310.91 examples/s]Map:  84%|████████▍ | 8454/10042 [00:28<00:05, 312.53 examples/s]Map:  85%|████████▍ | 8487/10042 [00:28<00:04, 315.13 examples/s]Map:  85%|████████▍ | 8519/10042 [00:29<00:04, 313.96 examples/s]Map:  85%|████████▌ | 8551/10042 [00:29<00:04, 313.99 examples/s]Map:  85%|████████▌ | 8583/10042 [00:29<00:04, 313.90 examples/s]Map:  86%|████████▌ | 8615/10042 [00:29<00:04, 312.61 examples/s]Map:  86%|████████▌ | 8647/10042 [00:29<00:04, 312.73 examples/s]Map:  86%|████████▋ | 8680/10042 [00:29<00:04, 313.61 examples/s]Map:  87%|████████▋ | 8712/10042 [00:29<00:04, 313.86 examples/s]Map:  87%|████████▋ | 8759/10042 [00:29<00:04, 310.96 examples/s]Map:  88%|████████▊ | 8791/10042 [00:29<00:04, 311.18 examples/s]Map:  88%|████████▊ | 8823/10042 [00:30<00:03, 311.27 examples/s]Map:  88%|████████▊ | 8855/10042 [00:30<00:03, 312.03 examples/s]Map:  88%|████████▊ | 8887/10042 [00:30<00:03, 312.22 examples/s]Map:  89%|████████▉ | 8919/10042 [00:30<00:03, 312.42 examples/s]Map:  89%|████████▉ | 8966/10042 [00:30<00:03, 310.85 examples/s]Map:  90%|████████▉ | 8998/10042 [00:30<00:03, 311.86 examples/s]Map:  90%|████████▉ | 9031/10042 [00:30<00:05, 180.08 examples/s]Map:  90%|█████████ | 9063/10042 [00:31<00:04, 204.81 examples/s]Map:  91%|█████████ | 9097/10042 [00:31<00:04, 229.70 examples/s]Map:  91%|█████████ | 9129/10042 [00:31<00:03, 248.43 examples/s]Map:  91%|█████████ | 9161/10042 [00:31<00:03, 265.25 examples/s]Map:  92%|█████████▏| 9193/10042 [00:31<00:03, 275.57 examples/s]Map:  92%|█████████▏| 9226/10042 [00:31<00:02, 287.20 examples/s]Map:  92%|█████████▏| 9259/10042 [00:31<00:02, 295.33 examples/s]Map:  93%|█████████▎| 9290/10042 [00:31<00:02, 298.21 examples/s]Map:  93%|█████████▎| 9323/10042 [00:31<00:02, 304.16 examples/s]Map:  93%|█████████▎| 9355/10042 [00:31<00:02, 308.18 examples/s]Map:  93%|█████████▎| 9387/10042 [00:32<00:02, 308.76 examples/s]Map:  94%|█████████▍| 9420/10042 [00:32<00:02, 309.83 examples/s]Map:  94%|█████████▍| 9453/10042 [00:32<00:01, 312.64 examples/s]Map:  94%|█████████▍| 9485/10042 [00:32<00:01, 311.97 examples/s]Map:  95%|█████████▍| 9517/10042 [00:32<00:01, 313.34 examples/s]Map:  95%|█████████▌| 9549/10042 [00:32<00:01, 313.52 examples/s]Map:  95%|█████████▌| 9581/10042 [00:32<00:01, 313.00 examples/s]Map:  96%|█████████▌| 9614/10042 [00:32<00:01, 314.85 examples/s]Map:  96%|█████████▌| 9646/10042 [00:32<00:01, 312.36 examples/s]Map:  96%|█████████▋| 9678/10042 [00:33<00:01, 312.64 examples/s]Map:  97%|█████████▋| 9710/10042 [00:33<00:01, 313.47 examples/s]Map:  97%|█████████▋| 9742/10042 [00:33<00:00, 312.29 examples/s]Map:  97%|█████████▋| 9774/10042 [00:33<00:00, 313.27 examples/s]Map:  98%|█████████▊| 9806/10042 [00:33<00:00, 312.80 examples/s]Map:  98%|█████████▊| 9839/10042 [00:33<00:00, 314.55 examples/s]Map:  98%|█████████▊| 9886/10042 [00:33<00:00, 310.65 examples/s]Map:  99%|█████████▉| 9918/10042 [00:33<00:00, 309.98 examples/s]Map:  99%|█████████▉| 9950/10042 [00:33<00:00, 311.08 examples/s]Map:  99%|█████████▉| 9982/10042 [00:34<00:00, 311.81 examples/s]Map: 100%|█████████▉| 10015/10042 [00:34<00:00, 137.37 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 156.96 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 289.68 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   8%|▊         | 96/1267 [00:00<00:01, 939.49 examples/s]Map:  15%|█▌        | 194/1267 [00:00<00:01, 962.86 examples/s]Map:  23%|██▎       | 292/1267 [00:00<00:01, 965.95 examples/s]Map:  34%|███▍      | 431/1267 [00:00<00:00, 942.49 examples/s]Map:  42%|████▏     | 531/1267 [00:00<00:00, 957.05 examples/s]Map:  50%|████▉     | 631/1267 [00:00<00:00, 969.36 examples/s]Map:  58%|█████▊    | 731/1267 [00:00<00:00, 976.05 examples/s]Map:  66%|██████▌   | 831/1267 [00:00<00:00, 978.12 examples/s]Map:  77%|███████▋  | 979/1267 [00:01<00:00, 975.94 examples/s]Map:  87%|████████▋ | 1099/1267 [00:01<00:00, 651.16 examples/s]Map:  95%|█████████▍| 1199/1267 [00:01<00:00, 718.64 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 819.22 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:01,  3.73it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  4.37it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  4.50it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  4.70it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:01<00:00,  4.83it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:01<00:00,  5.22it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:01<00:00,  4.84it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:41<03:25, 41.03s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [01:34<03:13, 48.37s/it]Loading checkpoint shards:  50%|█████     | 3/6 [02:20<02:21, 47.16s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [02:54<01:24, 42.14s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [03:26<00:38, 38.35s/it]Loading checkpoint shards: 100%|██████████| 6/6 [03:50<00:00, 33.64s/it]Loading checkpoint shards: 100%|██████████| 6/6 [03:50<00:00, 38.47s/it]
2024-05-04 05:18:11,029: rank0[536965][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-05-04 05:18:11,031: rank0[536965][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-05-04 05:18:12,475: rank0[536965][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-05-04 05:18:12,490: rank0[536965][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-05-04 05:18:27,984: rank0[536965][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-05-04 05:18:27,984: rank0[536965][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-05-04 05:18:27,984: rank0[536965][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned50-trained/combined
models:
- model_name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned50-trained/combined
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned50-trained/combined
    use_auth_token: true
  tokenizer:
    name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned50-trained/combined
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-05-04 05:18:27,991: rank0[536965][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.4957
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.4556
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7492
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7230
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                                                       |
|:-----------|:--------------|:----------|-----------:|:------------------|:------------------------------------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.495734 | 25-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned50-trained/combined |
|            | mmlu          |           |   0.455562 | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned50-trained/combined |
|            | winogrande    |           |   0.722968 | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned50-trained/combined |
|            | hellaswag     |           |   0.749154 | 10-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned50-trained/combined |
2024-05-04 06:19:12,508: rank0[536965][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-05-04 06:19:12,508: rank0[536965][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-05-04 06:19:12,508: rank0[536965][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-05-04 06:19:12,508: rank0[536965][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
