----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-05-04 06:19:27,411: rank0[543622][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 28/1172 [00:00<00:04, 264.49 examples/s]Map:   5%|▍         | 56/1172 [00:00<00:04, 270.32 examples/s]Map:   7%|▋         | 84/1172 [00:00<00:04, 269.67 examples/s]Map:   9%|▉         | 111/1172 [00:00<00:03, 267.38 examples/s]Map:  12%|█▏        | 139/1172 [00:00<00:03, 267.38 examples/s]Map:  14%|█▍        | 166/1172 [00:00<00:03, 264.35 examples/s]Map:  17%|█▋        | 194/1172 [00:00<00:03, 265.17 examples/s]Map:  19%|█▉        | 222/1172 [00:00<00:03, 265.80 examples/s]Map:  21%|██▏       | 250/1172 [00:00<00:03, 266.49 examples/s]Map:  24%|██▎       | 278/1172 [00:01<00:03, 266.75 examples/s]Map:  26%|██▌       | 306/1172 [00:01<00:03, 267.78 examples/s]Map:  28%|██▊       | 334/1172 [00:01<00:03, 268.47 examples/s]Map:  31%|███       | 361/1172 [00:01<00:03, 265.09 examples/s]Map:  33%|███▎      | 389/1172 [00:01<00:02, 266.66 examples/s]Map:  37%|███▋      | 428/1172 [00:01<00:02, 261.60 examples/s]Map:  39%|███▉      | 455/1172 [00:01<00:02, 261.68 examples/s]Map:  41%|████      | 482/1172 [00:01<00:02, 261.97 examples/s]Map:  44%|████▎     | 510/1172 [00:01<00:02, 263.27 examples/s]Map:  46%|████▌     | 538/1172 [00:02<00:02, 264.98 examples/s]Map:  48%|████▊     | 566/1172 [00:02<00:02, 264.42 examples/s]Map:  51%|█████     | 594/1172 [00:02<00:02, 265.97 examples/s]Map:  53%|█████▎    | 622/1172 [00:02<00:02, 266.12 examples/s]Map:  55%|█████▌    | 650/1172 [00:02<00:01, 266.42 examples/s]Map:  58%|█████▊    | 678/1172 [00:02<00:01, 267.37 examples/s]Map:  60%|██████    | 706/1172 [00:02<00:01, 266.99 examples/s]Map:  63%|██████▎   | 734/1172 [00:02<00:01, 266.44 examples/s]Map:  65%|██████▌   | 762/1172 [00:02<00:01, 267.22 examples/s]Map:  67%|██████▋   | 790/1172 [00:02<00:01, 267.31 examples/s]Map:  70%|██████▉   | 818/1172 [00:03<00:01, 267.13 examples/s]Map:  72%|███████▏  | 846/1172 [00:03<00:01, 266.32 examples/s]Map:  75%|███████▍  | 874/1172 [00:03<00:01, 265.84 examples/s]Map:  77%|███████▋  | 902/1172 [00:03<00:01, 265.84 examples/s]Map:  79%|███████▉  | 930/1172 [00:03<00:00, 265.08 examples/s]Map:  82%|████████▏ | 958/1172 [00:03<00:00, 265.35 examples/s]Map:  84%|████████▍ | 986/1172 [00:03<00:00, 266.50 examples/s]Map:  86%|████████▋ | 1013/1172 [00:04<00:01, 124.16 examples/s]Map:  89%|████████▉ | 1041/1172 [00:04<00:00, 148.12 examples/s]Map:  91%|█████████ | 1069/1172 [00:04<00:00, 171.09 examples/s]Map:  94%|█████████▎| 1097/1172 [00:04<00:00, 191.51 examples/s]Map:  96%|█████████▌| 1125/1172 [00:04<00:00, 209.46 examples/s]Map:  98%|█████████▊| 1153/1172 [00:04<00:00, 223.38 examples/s]Map: 100%|██████████| 1172/1172 [00:04<00:00, 240.19 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 47/14042 [00:00<00:30, 457.32 examples/s]Map:   1%|          | 112/14042 [00:00<00:32, 431.40 examples/s]Map:   1%|▏         | 176/14042 [00:00<00:32, 422.11 examples/s]Map:   2%|▏         | 223/14042 [00:00<00:31, 434.41 examples/s]Map:   2%|▏         | 288/14042 [00:00<00:32, 429.51 examples/s]Map:   3%|▎         | 354/14042 [00:00<00:31, 429.99 examples/s]Map:   3%|▎         | 403/14042 [00:01<00:48, 280.94 examples/s]Map:   3%|▎         | 446/14042 [00:01<00:44, 306.88 examples/s]Map:   3%|▎         | 486/14042 [00:01<00:41, 324.30 examples/s]Map:   4%|▍         | 531/14042 [00:01<00:38, 351.94 examples/s]Map:   4%|▍         | 573/14042 [00:01<00:36, 365.82 examples/s]Map:   4%|▍         | 619/14042 [00:01<00:34, 387.17 examples/s]Map:   5%|▍         | 681/14042 [00:01<00:33, 394.53 examples/s]Map:   5%|▌         | 725/14042 [00:01<00:33, 400.44 examples/s]Map:   5%|▌         | 772/14042 [00:02<00:32, 413.67 examples/s]Map:   6%|▌         | 816/14042 [00:02<00:31, 419.52 examples/s]Map:   6%|▌         | 859/14042 [00:02<00:31, 420.17 examples/s]Map:   6%|▋         | 903/14042 [00:02<00:30, 424.56 examples/s]Map:   7%|▋         | 951/14042 [00:02<00:29, 437.86 examples/s]Map:   7%|▋         | 1000/14042 [00:02<01:05, 200.20 examples/s]Map:   7%|▋         | 1043/14042 [00:03<00:55, 235.66 examples/s]Map:   8%|▊         | 1092/14042 [00:03<00:46, 280.64 examples/s]Map:   8%|▊         | 1142/14042 [00:03<00:39, 324.29 examples/s]Map:   8%|▊         | 1190/14042 [00:03<00:35, 357.58 examples/s]Map:   9%|▉         | 1237/14042 [00:03<00:33, 381.62 examples/s]Map:   9%|▉         | 1285/14042 [00:03<00:31, 405.34 examples/s]Map:   9%|▉         | 1331/14042 [00:03<00:30, 414.98 examples/s]Map:  10%|▉         | 1379/14042 [00:03<00:29, 427.82 examples/s]Map:  10%|█         | 1427/14042 [00:03<00:28, 439.65 examples/s]Map:  11%|█         | 1496/14042 [00:04<00:28, 441.71 examples/s]Map:  11%|█         | 1564/14042 [00:04<00:28, 442.43 examples/s]Map:  12%|█▏        | 1631/14042 [00:04<00:28, 438.50 examples/s]Map:  12%|█▏        | 1678/14042 [00:04<00:27, 443.35 examples/s]Map:  12%|█▏        | 1724/14042 [00:04<00:27, 444.08 examples/s]Map:  13%|█▎        | 1791/14042 [00:04<00:27, 442.39 examples/s]Map:  13%|█▎        | 1837/14042 [00:04<00:27, 443.62 examples/s]Map:  14%|█▎        | 1903/14042 [00:04<00:27, 437.92 examples/s]Map:  14%|█▍        | 1950/14042 [00:05<00:27, 442.38 examples/s]Map:  14%|█▍        | 1996/14042 [00:05<00:27, 445.46 examples/s]Map:  15%|█▍        | 2042/14042 [00:05<00:45, 262.46 examples/s]Map:  15%|█▍        | 2087/14042 [00:05<00:40, 295.47 examples/s]Map:  15%|█▌        | 2134/14042 [00:05<00:36, 329.86 examples/s]Map:  16%|█▌        | 2181/14042 [00:05<00:32, 360.83 examples/s]Map:  16%|█▌        | 2231/14042 [00:05<00:30, 392.52 examples/s]Map:  16%|█▌        | 2276/14042 [00:06<00:28, 406.19 examples/s]Map:  17%|█▋        | 2325/14042 [00:06<00:27, 426.34 examples/s]Map:  17%|█▋        | 2372/14042 [00:06<00:26, 435.37 examples/s]Map:  17%|█▋        | 2419/14042 [00:06<00:26, 444.19 examples/s]Map:  18%|█▊        | 2466/14042 [00:06<00:25, 448.98 examples/s]Map:  18%|█▊        | 2514/14042 [00:06<00:25, 455.54 examples/s]Map:  18%|█▊        | 2565/14042 [00:06<00:24, 466.96 examples/s]Map:  19%|█▉        | 2637/14042 [00:06<00:24, 468.60 examples/s]Map:  19%|█▉        | 2709/14042 [00:06<00:24, 467.87 examples/s]Map:  20%|█▉        | 2757/14042 [00:07<00:24, 466.33 examples/s]Map:  20%|█▉        | 2805/14042 [00:07<00:24, 466.31 examples/s]Map:  20%|██        | 2874/14042 [00:07<00:24, 459.89 examples/s]Map:  21%|██        | 2923/14042 [00:07<00:23, 465.67 examples/s]Map:  21%|██▏       | 2992/14042 [00:07<00:23, 461.34 examples/s]Map:  22%|██▏       | 3046/14042 [00:07<00:38, 286.84 examples/s]Map:  22%|██▏       | 3093/14042 [00:08<00:34, 316.97 examples/s]Map:  22%|██▏       | 3140/14042 [00:08<00:31, 346.64 examples/s]Map:  23%|██▎       | 3183/14042 [00:08<00:29, 364.02 examples/s]Map:  23%|██▎       | 3228/14042 [00:08<00:28, 380.70 examples/s]Map:  23%|██▎       | 3274/14042 [00:08<00:26, 399.68 examples/s]Map:  24%|██▎       | 3322/14042 [00:08<00:25, 418.60 examples/s]Map:  24%|██▍       | 3368/14042 [00:08<00:24, 427.55 examples/s]Map:  24%|██▍       | 3415/14042 [00:08<00:24, 437.78 examples/s]Map:  25%|██▍       | 3461/14042 [00:08<00:23, 443.89 examples/s]Map:  25%|██▍       | 3510/14042 [00:08<00:23, 453.72 examples/s]Map:  25%|██▌       | 3557/14042 [00:09<00:22, 458.09 examples/s]Map:  26%|██▌       | 3625/14042 [00:09<00:22, 453.94 examples/s]Map:  26%|██▌       | 3671/14042 [00:09<00:22, 452.92 examples/s]Map:  26%|██▋       | 3717/14042 [00:09<00:22, 451.80 examples/s]Map:  27%|██▋       | 3764/14042 [00:09<00:22, 454.14 examples/s]Map:  27%|██▋       | 3810/14042 [00:09<00:22, 455.19 examples/s]Map:  27%|██▋       | 3857/14042 [00:09<00:22, 457.23 examples/s]Map:  28%|██▊       | 3903/14042 [00:09<00:22, 455.44 examples/s]Map:  28%|██▊       | 3949/14042 [00:09<00:22, 453.62 examples/s]Map:  28%|██▊       | 3995/14042 [00:10<00:22, 453.32 examples/s]Map:  29%|██▉       | 4045/14042 [00:10<00:36, 271.55 examples/s]Map:  29%|██▉       | 4092/14042 [00:10<00:32, 308.27 examples/s]Map:  29%|██▉       | 4138/14042 [00:10<00:29, 339.10 examples/s]Map:  30%|██▉       | 4186/14042 [00:10<00:26, 370.70 examples/s]Map:  30%|███       | 4235/14042 [00:10<00:24, 396.37 examples/s]Map:  30%|███       | 4280/14042 [00:10<00:24, 406.42 examples/s]Map:  31%|███       | 4326/14042 [00:11<00:23, 418.66 examples/s]Map:  31%|███       | 4373/14042 [00:11<00:22, 430.05 examples/s]Map:  32%|███▏      | 4438/14042 [00:11<00:23, 410.91 examples/s]Map:  32%|███▏      | 4486/14042 [00:11<00:22, 425.08 examples/s]Map:  32%|███▏      | 4548/14042 [00:11<00:22, 416.09 examples/s]Map:  33%|███▎      | 4607/14042 [00:11<00:23, 404.74 examples/s]Map:  33%|███▎      | 4666/14042 [00:11<00:23, 396.97 examples/s]Map:  34%|███▎      | 4725/14042 [00:12<00:23, 391.57 examples/s]Map:  34%|███▍      | 4770/14042 [00:12<00:22, 403.45 examples/s]Map:  34%|███▍      | 4816/14042 [00:12<00:22, 414.20 examples/s]Map:  35%|███▍      | 4863/14042 [00:12<00:21, 428.04 examples/s]Map:  35%|███▍      | 4912/14042 [00:12<00:20, 442.01 examples/s]Map:  35%|███▌      | 4961/14042 [00:12<00:20, 451.57 examples/s]Map:  36%|███▌      | 5022/14042 [00:13<00:43, 209.12 examples/s]Map:  36%|███▌      | 5068/14042 [00:13<00:36, 244.46 examples/s]Map:  36%|███▋      | 5125/14042 [00:13<00:32, 275.45 examples/s]Map:  37%|███▋      | 5164/14042 [00:13<00:30, 295.84 examples/s]Map:  37%|███▋      | 5221/14042 [00:13<00:27, 316.48 examples/s]Map:  38%|███▊      | 5266/14042 [00:13<00:25, 342.94 examples/s]Map:  38%|███▊      | 5314/14042 [00:13<00:23, 372.22 examples/s]Map:  38%|███▊      | 5361/14042 [00:13<00:21, 395.24 examples/s]Map:  38%|███▊      | 5406/14042 [00:14<00:21, 407.23 examples/s]Map:  39%|███▉      | 5452/14042 [00:14<00:20, 419.45 examples/s]Map:  39%|███▉      | 5499/14042 [00:14<00:19, 429.24 examples/s]Map:  40%|███▉      | 5548/14042 [00:14<00:19, 443.22 examples/s]Map:  40%|███▉      | 5597/14042 [00:14<00:18, 453.39 examples/s]Map:  40%|████      | 5645/14042 [00:14<00:18, 456.82 examples/s]Map:  41%|████      | 5693/14042 [00:14<00:18, 460.60 examples/s]Map:  41%|████      | 5762/14042 [00:14<00:18, 457.65 examples/s]Map:  42%|████▏     | 5830/14042 [00:14<00:18, 453.89 examples/s]Map:  42%|████▏     | 5896/14042 [00:15<00:18, 447.68 examples/s]Map:  42%|████▏     | 5957/14042 [00:15<00:18, 430.83 examples/s]Map:  43%|████▎     | 6019/14042 [00:15<00:28, 277.20 examples/s]Map:  43%|████▎     | 6059/14042 [00:15<00:26, 296.74 examples/s]Map:  43%|████▎     | 6100/14042 [00:15<00:25, 316.13 examples/s]Map:  44%|████▎     | 6142/14042 [00:15<00:23, 335.22 examples/s]Map:  44%|████▍     | 6181/14042 [00:16<00:22, 345.97 examples/s]Map:  44%|████▍     | 6220/14042 [00:16<00:22, 354.98 examples/s]Map:  45%|████▍     | 6259/14042 [00:16<00:21, 361.69 examples/s]Map:  45%|████▍     | 6298/14042 [00:16<00:21, 366.96 examples/s]Map:  45%|████▌     | 6339/14042 [00:16<00:20, 377.79 examples/s]Map:  45%|████▌     | 6380/14042 [00:16<00:20, 383.09 examples/s]Map:  46%|████▌     | 6421/14042 [00:16<00:19, 387.85 examples/s]Map:  46%|████▌     | 6463/14042 [00:16<00:19, 392.70 examples/s]Map:  46%|████▋     | 6521/14042 [00:16<00:19, 388.27 examples/s]Map:  47%|████▋     | 6562/14042 [00:17<00:19, 392.44 examples/s]Map:  47%|████▋     | 6603/14042 [00:17<00:18, 396.33 examples/s]Map:  47%|████▋     | 6661/14042 [00:17<00:18, 388.68 examples/s]Map:  48%|████▊     | 6702/14042 [00:17<00:18, 392.82 examples/s]Map:  48%|████▊     | 6760/14042 [00:17<00:18, 385.00 examples/s]Map:  48%|████▊     | 6802/14042 [00:17<00:18, 388.62 examples/s]Map:  49%|████▊     | 6842/14042 [00:17<00:18, 388.03 examples/s]Map:  49%|████▉     | 6883/14042 [00:17<00:18, 390.06 examples/s]Map:  49%|████▉     | 6943/14042 [00:18<00:18, 391.41 examples/s]Map:  50%|████▉     | 6983/14042 [00:18<00:18, 391.83 examples/s]Map:  50%|█████     | 7039/14042 [00:18<00:27, 251.39 examples/s]Map:  50%|█████     | 7080/14042 [00:18<00:24, 279.18 examples/s]Map:  51%|█████     | 7119/14042 [00:18<00:23, 300.45 examples/s]Map:  51%|█████     | 7160/14042 [00:18<00:21, 322.45 examples/s]Map:  51%|█████▏    | 7202/14042 [00:18<00:19, 345.02 examples/s]Map:  52%|█████▏    | 7244/14042 [00:18<00:18, 362.83 examples/s]Map:  52%|█████▏    | 7284/14042 [00:19<00:18, 369.06 examples/s]Map:  52%|█████▏    | 7324/14042 [00:19<00:17, 374.31 examples/s]Map:  52%|█████▏    | 7364/14042 [00:19<00:17, 377.87 examples/s]Map:  53%|█████▎    | 7406/14042 [00:19<00:17, 387.30 examples/s]Map:  53%|█████▎    | 7447/14042 [00:19<00:16, 391.09 examples/s]Map:  53%|█████▎    | 7494/14042 [00:19<00:15, 410.62 examples/s]Map:  54%|█████▎    | 7541/14042 [00:19<00:15, 425.94 examples/s]Map:  54%|█████▍    | 7589/14042 [00:19<00:14, 438.08 examples/s]Map:  54%|█████▍    | 7636/14042 [00:19<00:14, 445.67 examples/s]Map:  55%|█████▍    | 7685/14042 [00:20<00:14, 453.18 examples/s]Map:  55%|█████▌    | 7733/14042 [00:20<00:13, 456.38 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2179 > 2048). Running this sequence through the model will result in indexing errors
Map:  56%|█████▌    | 7802/14042 [00:20<00:13, 453.28 examples/s]Map:  56%|█████▌    | 7851/14042 [00:20<00:13, 459.87 examples/s]Map:  56%|█████▋    | 7899/14042 [00:20<00:13, 461.33 examples/s]Map:  57%|█████▋    | 7950/14042 [00:20<00:12, 469.90 examples/s]Map:  57%|█████▋    | 8000/14042 [00:20<00:21, 281.73 examples/s]Map:  57%|█████▋    | 8044/14042 [00:21<00:19, 310.06 examples/s]Map:  58%|█████▊    | 8092/14042 [00:21<00:17, 345.48 examples/s]Map:  58%|█████▊    | 8137/14042 [00:21<00:15, 369.21 examples/s]Map:  58%|█████▊    | 8186/14042 [00:21<00:14, 398.66 examples/s]Map:  59%|█████▊    | 8233/14042 [00:21<00:14, 414.83 examples/s]Map:  59%|█████▉    | 8280/14042 [00:21<00:13, 429.12 examples/s]Map:  59%|█████▉    | 8327/14042 [00:21<00:13, 436.07 examples/s]Map:  60%|█████▉    | 8374/14042 [00:21<00:12, 442.66 examples/s]Map:  60%|█████▉    | 8422/14042 [00:21<00:12, 449.59 examples/s]Map:  60%|██████    | 8470/14042 [00:21<00:12, 453.84 examples/s]Map:  61%|██████    | 8540/14042 [00:22<00:12, 452.56 examples/s]Map:  61%|██████    | 8589/14042 [00:22<00:11, 458.26 examples/s]Map:  62%|██████▏   | 8637/14042 [00:22<00:11, 461.12 examples/s]Map:  62%|██████▏   | 8706/14042 [00:22<00:11, 456.46 examples/s]Map:  62%|██████▏   | 8773/14042 [00:22<00:11, 446.88 examples/s]Map:  63%|██████▎   | 8820/14042 [00:22<00:11, 451.50 examples/s]Map:  63%|██████▎   | 8867/14042 [00:22<00:11, 453.78 examples/s]Map:  63%|██████▎   | 8916/14042 [00:22<00:11, 460.02 examples/s]Map:  64%|██████▍   | 8965/14042 [00:23<00:10, 464.39 examples/s]Map:  64%|██████▍   | 9021/14042 [00:23<00:17, 286.17 examples/s]Map:  65%|██████▍   | 9068/14042 [00:23<00:15, 319.82 examples/s]Map:  65%|██████▍   | 9116/14042 [00:23<00:13, 352.71 examples/s]Map:  65%|██████▌   | 9161/14042 [00:23<00:13, 374.32 examples/s]Map:  66%|██████▌   | 9209/14042 [00:23<00:12, 399.71 examples/s]Map:  66%|██████▌   | 9256/14042 [00:23<00:11, 415.67 examples/s]Map:  66%|██████▋   | 9304/14042 [00:24<00:10, 431.19 examples/s]Map:  67%|██████▋   | 9353/14042 [00:24<00:10, 444.57 examples/s]Map:  67%|██████▋   | 9400/14042 [00:24<00:10, 448.69 examples/s]Map:  67%|██████▋   | 9447/14042 [00:24<00:10, 452.14 examples/s]Map:  68%|██████▊   | 9496/14042 [00:24<00:09, 461.06 examples/s]Map:  68%|██████▊   | 9544/14042 [00:24<00:09, 461.97 examples/s]Map:  68%|██████▊   | 9602/14042 [00:24<00:10, 429.26 examples/s]Map:  69%|██████▉   | 9660/14042 [00:24<00:10, 410.50 examples/s]Map:  69%|██████▉   | 9710/14042 [00:25<00:15, 277.95 examples/s]Map:  69%|██████▉   | 9747/14042 [00:25<00:14, 293.14 examples/s]Map:  70%|██████▉   | 9786/14042 [00:25<00:13, 311.94 examples/s]Map:  70%|███████   | 9830/14042 [00:25<00:12, 337.77 examples/s]Map:  70%|███████   | 9873/14042 [00:25<00:11, 358.58 examples/s]Map:  71%|███████   | 9916/14042 [00:25<00:10, 376.62 examples/s]Map:  71%|███████   | 9961/14042 [00:25<00:10, 393.08 examples/s]Map:  71%|███████▏  | 10020/14042 [00:26<00:15, 255.13 examples/s]Map:  72%|███████▏  | 10067/14042 [00:26<00:13, 293.46 examples/s]Map:  72%|███████▏  | 10116/14042 [00:26<00:11, 333.19 examples/s]Map:  72%|███████▏  | 10159/14042 [00:26<00:10, 354.19 examples/s]Map:  73%|███████▎  | 10205/14042 [00:26<00:10, 377.65 examples/s]Map:  73%|███████▎  | 10251/14042 [00:26<00:09, 396.21 examples/s]Map:  73%|███████▎  | 10298/14042 [00:26<00:09, 415.78 examples/s]Map:  74%|███████▎  | 10343/14042 [00:26<00:08, 420.87 examples/s]Map:  74%|███████▍  | 10388/14042 [00:26<00:08, 426.93 examples/s]Map:  74%|███████▍  | 10452/14042 [00:27<00:08, 424.78 examples/s]Map:  75%|███████▍  | 10498/14042 [00:27<00:08, 429.28 examples/s]Map:  75%|███████▌  | 10565/14042 [00:27<00:08, 432.50 examples/s]Map:  76%|███████▌  | 10611/14042 [00:27<00:07, 438.67 examples/s]Map:  76%|███████▌  | 10659/14042 [00:27<00:07, 447.47 examples/s]Map:  76%|███████▌  | 10706/14042 [00:27<00:07, 450.64 examples/s]Map:  77%|███████▋  | 10753/14042 [00:27<00:07, 453.30 examples/s]Map:  77%|███████▋  | 10820/14042 [00:27<00:07, 446.71 examples/s]Map:  77%|███████▋  | 10868/14042 [00:28<00:06, 453.82 examples/s]Map:  78%|███████▊  | 10914/14042 [00:28<00:06, 453.99 examples/s]Map:  78%|███████▊  | 10982/14042 [00:28<00:06, 450.73 examples/s]Map:  79%|███████▊  | 11044/14042 [00:28<00:10, 283.45 examples/s]Map:  79%|███████▉  | 11092/14042 [00:28<00:09, 316.63 examples/s]Map:  79%|███████▉  | 11140/14042 [00:28<00:08, 347.44 examples/s]Map:  80%|███████▉  | 11190/14042 [00:28<00:07, 378.42 examples/s]Map:  80%|████████  | 11255/14042 [00:29<00:07, 393.36 examples/s]Map:  80%|████████  | 11299/14042 [00:29<00:06, 403.08 examples/s]Map:  81%|████████  | 11362/14042 [00:29<00:06, 407.58 examples/s]Map:  81%|████████▏ | 11423/14042 [00:29<00:06, 404.30 examples/s]Map:  82%|████████▏ | 11465/14042 [00:29<00:06, 404.79 examples/s]Map:  82%|████████▏ | 11512/14042 [00:29<00:06, 417.25 examples/s]Map:  82%|████████▏ | 11560/14042 [00:29<00:05, 430.57 examples/s]Map:  83%|████████▎ | 11608/14042 [00:29<00:05, 440.74 examples/s]Map:  83%|████████▎ | 11654/14042 [00:30<00:05, 443.89 examples/s]Map:  83%|████████▎ | 11704/14042 [00:30<00:05, 456.10 examples/s]Map:  84%|████████▎ | 11754/14042 [00:30<00:04, 466.95 examples/s]Map:  84%|████████▍ | 11823/14042 [00:30<00:04, 462.86 examples/s]Map:  85%|████████▍ | 11873/14042 [00:30<00:04, 468.16 examples/s]Map:  85%|████████▍ | 11921/14042 [00:30<00:04, 467.02 examples/s]Map:  85%|████████▌ | 11969/14042 [00:30<00:04, 468.45 examples/s]Map:  86%|████████▌ | 12022/14042 [00:31<00:07, 283.85 examples/s]Map:  86%|████████▌ | 12069/14042 [00:31<00:06, 318.02 examples/s]Map:  86%|████████▋ | 12116/14042 [00:31<00:05, 348.95 examples/s]Map:  87%|████████▋ | 12161/14042 [00:31<00:05, 370.24 examples/s]Map:  87%|████████▋ | 12209/14042 [00:31<00:04, 393.95 examples/s]Map:  87%|████████▋ | 12257/14042 [00:31<00:04, 412.58 examples/s]Map:  88%|████████▊ | 12304/14042 [00:31<00:04, 425.39 examples/s]Map:  88%|████████▊ | 12351/14042 [00:31<00:03, 435.08 examples/s]Map:  88%|████████▊ | 12398/14042 [00:31<00:03, 442.80 examples/s]Map:  89%|████████▊ | 12444/14042 [00:31<00:03, 447.08 examples/s]Map:  89%|████████▉ | 12491/14042 [00:32<00:03, 453.09 examples/s]Map:  89%|████████▉ | 12537/14042 [00:32<00:03, 453.10 examples/s]Map:  90%|████████▉ | 12583/14042 [00:32<00:03, 452.27 examples/s]Map:  90%|████████▉ | 12632/14042 [00:32<00:03, 462.08 examples/s]Map:  90%|█████████ | 12703/14042 [00:32<00:02, 461.80 examples/s]Map:  91%|█████████ | 12750/14042 [00:32<00:02, 459.72 examples/s]Map:  91%|█████████ | 12797/14042 [00:32<00:02, 458.76 examples/s]Map:  91%|█████████▏| 12846/14042 [00:32<00:02, 466.29 examples/s]Map:  92%|█████████▏| 12893/14042 [00:32<00:02, 462.71 examples/s]Map:  92%|█████████▏| 12941/14042 [00:33<00:02, 464.06 examples/s]Map:  93%|█████████▎| 12989/14042 [00:33<00:02, 466.07 examples/s]Map:  93%|█████████▎| 13046/14042 [00:33<00:03, 283.59 examples/s]Map:  93%|█████████▎| 13094/14042 [00:33<00:02, 319.32 examples/s]Map:  94%|█████████▎| 13140/14042 [00:33<00:02, 347.62 examples/s]Map:  94%|█████████▍| 13190/14042 [00:33<00:02, 380.40 examples/s]Map:  94%|█████████▍| 13237/14042 [00:33<00:02, 399.35 examples/s]Map:  95%|█████████▍| 13286/14042 [00:34<00:01, 420.20 examples/s]Map:  95%|█████████▍| 13332/14042 [00:34<00:01, 430.32 examples/s]Map:  95%|█████████▌| 13380/14042 [00:34<00:01, 441.25 examples/s]Map:  96%|█████████▌| 13430/14042 [00:34<00:01, 455.48 examples/s]Map:  96%|█████████▌| 13478/14042 [00:34<00:01, 459.73 examples/s]Map:  96%|█████████▋| 13547/14042 [00:34<00:01, 455.20 examples/s]Map:  97%|█████████▋| 13597/14042 [00:34<00:00, 462.14 examples/s]Map:  97%|█████████▋| 13665/14042 [00:34<00:00, 456.35 examples/s]Map:  98%|█████████▊| 13712/14042 [00:34<00:00, 456.07 examples/s]Map:  98%|█████████▊| 13761/14042 [00:35<00:00, 462.11 examples/s]Map:  98%|█████████▊| 13809/14042 [00:35<00:00, 465.09 examples/s]Map:  99%|█████████▊| 13857/14042 [00:35<00:00, 466.31 examples/s]Map:  99%|█████████▉| 13904/14042 [00:35<00:00, 466.27 examples/s]Map:  99%|█████████▉| 13951/14042 [00:35<00:00, 465.51 examples/s]Map: 100%|█████████▉| 13998/14042 [00:35<00:00, 463.81 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 390.71 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 34/10042 [00:00<00:30, 329.11 examples/s]Map:   1%|          | 68/10042 [00:00<00:30, 326.02 examples/s]Map:   1%|          | 102/10042 [00:00<00:30, 329.74 examples/s]Map:   1%|▏         | 136/10042 [00:00<00:30, 326.71 examples/s]Map:   2%|▏         | 171/10042 [00:00<00:29, 330.01 examples/s]Map:   2%|▏         | 207/10042 [00:00<00:29, 334.24 examples/s]Map:   2%|▏         | 242/10042 [00:00<00:29, 335.10 examples/s]Map:   3%|▎         | 276/10042 [00:01<00:46, 212.09 examples/s]Map:   3%|▎         | 308/10042 [00:01<00:41, 234.00 examples/s]Map:   3%|▎         | 342/10042 [00:01<00:37, 258.57 examples/s]Map:   4%|▍         | 377/10042 [00:01<00:34, 280.06 examples/s]Map:   4%|▍         | 413/10042 [00:01<00:32, 292.87 examples/s]Map:   4%|▍         | 448/10042 [00:01<00:31, 306.21 examples/s]Map:   5%|▍         | 483/10042 [00:01<00:30, 315.85 examples/s]Map:   5%|▌         | 518/10042 [00:01<00:29, 322.04 examples/s]Map:   5%|▌         | 552/10042 [00:01<00:29, 325.05 examples/s]Map:   6%|▌         | 588/10042 [00:01<00:28, 330.75 examples/s]Map:   6%|▌         | 622/10042 [00:02<00:28, 333.02 examples/s]Map:   7%|▋         | 656/10042 [00:02<00:28, 333.17 examples/s]Map:   7%|▋         | 690/10042 [00:02<00:28, 330.87 examples/s]Map:   7%|▋         | 725/10042 [00:02<00:28, 332.66 examples/s]Map:   8%|▊         | 759/10042 [00:02<00:27, 332.43 examples/s]Map:   8%|▊         | 794/10042 [00:02<00:27, 335.12 examples/s]Map:   8%|▊         | 829/10042 [00:02<00:27, 335.38 examples/s]Map:   9%|▊         | 865/10042 [00:02<00:27, 338.32 examples/s]Map:   9%|▉         | 900/10042 [00:02<00:27, 337.99 examples/s]Map:   9%|▉         | 936/10042 [00:02<00:26, 339.49 examples/s]Map:  10%|▉         | 971/10042 [00:03<00:26, 338.77 examples/s]Map:  10%|█         | 1015/10042 [00:03<00:57, 156.40 examples/s]Map:  10%|█         | 1050/10042 [00:03<00:48, 184.77 examples/s]Map:  11%|█         | 1086/10042 [00:03<00:41, 214.13 examples/s]Map:  11%|█         | 1122/10042 [00:03<00:36, 241.47 examples/s]Map:  12%|█▏        | 1157/10042 [00:04<00:33, 263.75 examples/s]Map:  12%|█▏        | 1192/10042 [00:04<00:31, 283.58 examples/s]Map:  12%|█▏        | 1227/10042 [00:04<00:29, 298.83 examples/s]Map:  13%|█▎        | 1263/10042 [00:04<00:28, 310.88 examples/s]Map:  13%|█▎        | 1298/10042 [00:04<00:27, 318.26 examples/s]Map:  13%|█▎        | 1332/10042 [00:04<00:27, 321.31 examples/s]Map:  14%|█▎        | 1367/10042 [00:04<00:26, 326.47 examples/s]Map:  14%|█▍        | 1402/10042 [00:04<00:26, 329.80 examples/s]Map:  14%|█▍        | 1438/10042 [00:04<00:25, 334.11 examples/s]Map:  15%|█▍        | 1472/10042 [00:04<00:25, 333.78 examples/s]Map:  15%|█▌        | 1508/10042 [00:05<00:25, 336.37 examples/s]Map:  15%|█▌        | 1543/10042 [00:05<00:25, 338.26 examples/s]Map:  16%|█▌        | 1579/10042 [00:05<00:25, 338.44 examples/s]Map:  16%|█▌        | 1614/10042 [00:05<00:24, 337.28 examples/s]Map:  16%|█▋        | 1649/10042 [00:05<00:24, 338.09 examples/s]Map:  17%|█▋        | 1684/10042 [00:05<00:24, 337.93 examples/s]Map:  17%|█▋        | 1719/10042 [00:05<00:24, 338.67 examples/s]Map:  17%|█▋        | 1754/10042 [00:05<00:24, 338.62 examples/s]Map:  18%|█▊        | 1788/10042 [00:05<00:24, 334.70 examples/s]Map:  18%|█▊        | 1822/10042 [00:06<00:24, 335.13 examples/s]Map:  18%|█▊        | 1856/10042 [00:06<00:24, 335.13 examples/s]Map:  19%|█▉        | 1891/10042 [00:06<00:24, 337.61 examples/s]Map:  19%|█▉        | 1925/10042 [00:06<00:24, 337.19 examples/s]Map:  20%|█▉        | 1961/10042 [00:06<00:23, 338.34 examples/s]Map:  20%|█▉        | 1995/10042 [00:06<00:23, 336.64 examples/s]Map:  20%|██        | 2033/10042 [00:06<00:41, 191.82 examples/s]Map:  21%|██        | 2068/10042 [00:07<00:36, 220.16 examples/s]Map:  21%|██        | 2102/10042 [00:07<00:32, 243.51 examples/s]Map:  21%|██▏       | 2137/10042 [00:07<00:29, 266.60 examples/s]Map:  22%|██▏       | 2173/10042 [00:07<00:27, 286.83 examples/s]Map:  22%|██▏       | 2208/10042 [00:07<00:26, 300.42 examples/s]Map:  22%|██▏       | 2244/10042 [00:07<00:24, 312.52 examples/s]Map:  23%|██▎       | 2279/10042 [00:07<00:24, 318.46 examples/s]Map:  23%|██▎       | 2314/10042 [00:07<00:23, 325.67 examples/s]Map:  23%|██▎       | 2350/10042 [00:07<00:23, 331.47 examples/s]Map:  24%|██▍       | 2385/10042 [00:07<00:22, 333.40 examples/s]Map:  24%|██▍       | 2420/10042 [00:08<00:22, 335.77 examples/s]Map:  24%|██▍       | 2456/10042 [00:08<00:22, 337.98 examples/s]Map:  25%|██▍       | 2507/10042 [00:08<00:22, 336.71 examples/s]Map:  25%|██▌       | 2543/10042 [00:08<00:22, 337.93 examples/s]Map:  26%|██▌       | 2577/10042 [00:08<00:22, 337.44 examples/s]Map:  26%|██▌       | 2612/10042 [00:08<00:22, 337.61 examples/s]Map:  26%|██▋       | 2646/10042 [00:08<00:22, 335.59 examples/s]Map:  27%|██▋       | 2680/10042 [00:08<00:21, 336.54 examples/s]Map:  27%|██▋       | 2715/10042 [00:08<00:21, 337.40 examples/s]Map:  28%|██▊       | 2766/10042 [00:09<00:21, 334.73 examples/s]Map:  28%|██▊       | 2801/10042 [00:09<00:21, 336.52 examples/s]Map:  28%|██▊       | 2836/10042 [00:09<00:21, 337.40 examples/s]Map:  29%|██▊       | 2872/10042 [00:09<00:21, 339.88 examples/s]Map:  29%|██▉       | 2908/10042 [00:09<00:20, 340.63 examples/s]Map:  29%|██▉       | 2943/10042 [00:09<00:20, 340.32 examples/s]Map:  30%|██▉       | 2994/10042 [00:09<00:20, 338.56 examples/s]Map:  30%|███       | 3032/10042 [00:10<00:35, 198.51 examples/s]Map:  31%|███       | 3068/10042 [00:10<00:30, 225.65 examples/s]Map:  31%|███       | 3104/10042 [00:10<00:27, 249.85 examples/s]Map:  31%|███▏      | 3140/10042 [00:10<00:25, 271.68 examples/s]Map:  32%|███▏      | 3174/10042 [00:10<00:24, 286.09 examples/s]Map:  32%|███▏      | 3209/10042 [00:10<00:22, 299.09 examples/s]Map:  32%|███▏      | 3244/10042 [00:10<00:21, 309.98 examples/s]Map:  33%|███▎      | 3292/10042 [00:10<00:21, 311.39 examples/s]Map:  33%|███▎      | 3325/10042 [00:11<00:21, 313.34 examples/s]Map:  34%|███▎      | 3373/10042 [00:11<00:21, 314.37 examples/s]Map:  34%|███▍      | 3421/10042 [00:11<00:21, 312.54 examples/s]Map:  34%|███▍      | 3453/10042 [00:11<00:21, 312.82 examples/s]Map:  35%|███▍      | 3485/10042 [00:11<00:20, 313.68 examples/s]Map:  35%|███▌      | 3517/10042 [00:11<00:20, 313.16 examples/s]Map:  35%|███▌      | 3550/10042 [00:11<00:20, 314.16 examples/s]Map:  36%|███▌      | 3582/10042 [00:11<00:20, 315.76 examples/s]Map:  36%|███▌      | 3615/10042 [00:11<00:20, 315.84 examples/s]Map:  36%|███▋      | 3647/10042 [00:12<00:20, 314.00 examples/s]Map:  37%|███▋      | 3694/10042 [00:12<00:20, 311.21 examples/s]Map:  37%|███▋      | 3741/10042 [00:12<00:20, 308.38 examples/s]Map:  38%|███▊      | 3772/10042 [00:12<00:20, 306.07 examples/s]Map:  38%|███▊      | 3804/10042 [00:12<00:20, 307.99 examples/s]Map:  38%|███▊      | 3836/10042 [00:12<00:20, 309.43 examples/s]Map:  39%|███▊      | 3868/10042 [00:12<00:19, 309.68 examples/s]Map:  39%|███▉      | 3900/10042 [00:12<00:19, 310.81 examples/s]Map:  39%|███▉      | 3932/10042 [00:12<00:19, 311.25 examples/s]Map:  39%|███▉      | 3964/10042 [00:13<00:19, 311.25 examples/s]Map:  40%|███▉      | 3997/10042 [00:13<00:19, 312.91 examples/s]Map:  40%|████      | 4030/10042 [00:13<00:34, 175.84 examples/s]Map:  40%|████      | 4062/10042 [00:13<00:29, 201.65 examples/s]Map:  41%|████      | 4094/10042 [00:13<00:26, 225.29 examples/s]Map:  41%|████      | 4126/10042 [00:13<00:24, 245.53 examples/s]Map:  41%|████▏     | 4158/10042 [00:13<00:22, 262.18 examples/s]Map:  42%|████▏     | 4191/10042 [00:14<00:21, 276.44 examples/s]Map:  42%|████▏     | 4224/10042 [00:14<00:20, 288.51 examples/s]Map:  42%|████▏     | 4256/10042 [00:14<00:19, 295.45 examples/s]Map:  43%|████▎     | 4289/10042 [00:14<00:19, 301.67 examples/s]Map:  43%|████▎     | 4322/10042 [00:14<00:18, 306.27 examples/s]Map:  43%|████▎     | 4354/10042 [00:14<00:18, 309.21 examples/s]Map:  44%|████▎     | 4387/10042 [00:14<00:18, 311.90 examples/s]Map:  44%|████▍     | 4420/10042 [00:14<00:17, 314.76 examples/s]Map:  44%|████▍     | 4453/10042 [00:14<00:17, 315.56 examples/s]Map:  45%|████▍     | 4485/10042 [00:15<00:17, 315.75 examples/s]Map:  45%|████▍     | 4517/10042 [00:15<00:17, 315.31 examples/s]Map:  45%|████▌     | 4549/10042 [00:15<00:17, 314.10 examples/s]Map:  46%|████▌     | 4581/10042 [00:15<00:17, 312.24 examples/s]Map:  46%|████▌     | 4614/10042 [00:15<00:17, 312.93 examples/s]Map:  46%|████▋     | 4646/10042 [00:15<00:17, 311.34 examples/s]Map:  47%|████▋     | 4679/10042 [00:15<00:17, 312.49 examples/s]Map:  47%|████▋     | 4711/10042 [00:15<00:17, 312.74 examples/s]Map:  47%|████▋     | 4744/10042 [00:15<00:16, 312.81 examples/s]Map:  48%|████▊     | 4777/10042 [00:15<00:16, 315.11 examples/s]Map:  48%|████▊     | 4809/10042 [00:16<00:16, 314.25 examples/s]Map:  48%|████▊     | 4841/10042 [00:16<00:16, 313.50 examples/s]Map:  49%|████▊     | 4873/10042 [00:16<00:16, 313.91 examples/s]Map:  49%|████▉     | 4906/10042 [00:16<00:16, 316.56 examples/s]Map:  49%|████▉     | 4939/10042 [00:16<00:16, 316.18 examples/s]Map:  50%|████▉     | 4972/10042 [00:16<00:16, 316.73 examples/s]Map:  50%|████▉     | 5015/10042 [00:17<00:35, 140.95 examples/s]Map:  50%|█████     | 5046/10042 [00:17<00:30, 164.45 examples/s]Map:  51%|█████     | 5078/10042 [00:17<00:26, 189.88 examples/s]Map:  51%|█████     | 5110/10042 [00:17<00:23, 214.22 examples/s]Map:  51%|█████     | 5142/10042 [00:17<00:20, 235.80 examples/s]Map:  52%|█████▏    | 5174/10042 [00:17<00:19, 254.81 examples/s]Map:  52%|█████▏    | 5207/10042 [00:17<00:17, 270.48 examples/s]Map:  52%|█████▏    | 5240/10042 [00:17<00:17, 281.58 examples/s]Map:  53%|█████▎    | 5274/10042 [00:17<00:16, 294.64 examples/s]Map:  53%|█████▎    | 5306/10042 [00:18<00:15, 298.50 examples/s]Map:  53%|█████▎    | 5338/10042 [00:18<00:15, 301.96 examples/s]Map:  54%|█████▎    | 5383/10042 [00:18<00:15, 299.98 examples/s]Map:  54%|█████▍    | 5415/10042 [00:18<00:15, 300.60 examples/s]Map:  54%|█████▍    | 5446/10042 [00:18<00:15, 300.25 examples/s]Map:  55%|█████▍    | 5478/10042 [00:18<00:15, 301.75 examples/s]Map:  55%|█████▍    | 5510/10042 [00:18<00:14, 302.78 examples/s]Map:  55%|█████▌    | 5541/10042 [00:18<00:14, 302.06 examples/s]Map:  55%|█████▌    | 5573/10042 [00:18<00:14, 306.18 examples/s]Map:  56%|█████▌    | 5605/10042 [00:19<00:14, 308.72 examples/s]Map:  56%|█████▌    | 5636/10042 [00:19<00:14, 305.06 examples/s]Map:  56%|█████▋    | 5668/10042 [00:19<00:14, 306.49 examples/s]Map:  57%|█████▋    | 5700/10042 [00:19<00:14, 307.43 examples/s]Map:  57%|█████▋    | 5733/10042 [00:19<00:13, 308.78 examples/s]Map:  57%|█████▋    | 5765/10042 [00:19<00:13, 307.63 examples/s]Map:  58%|█████▊    | 5797/10042 [00:19<00:13, 308.53 examples/s]Map:  58%|█████▊    | 5830/10042 [00:19<00:13, 311.14 examples/s]Map:  58%|█████▊    | 5862/10042 [00:19<00:13, 310.28 examples/s]Map:  59%|█████▊    | 5894/10042 [00:20<00:13, 310.42 examples/s]Map:  59%|█████▉    | 5926/10042 [00:20<00:13, 311.79 examples/s]Map:  59%|█████▉    | 5958/10042 [00:20<00:13, 312.72 examples/s]Map:  60%|█████▉    | 5991/10042 [00:20<00:12, 315.19 examples/s]Map:  60%|██████    | 6030/10042 [00:20<00:23, 167.77 examples/s]Map:  60%|██████    | 6062/10042 [00:20<00:20, 193.62 examples/s]Map:  61%|██████    | 6094/10042 [00:20<00:18, 218.45 examples/s]Map:  61%|██████    | 6126/10042 [00:21<00:16, 239.69 examples/s]Map:  61%|██████▏   | 6159/10042 [00:21<00:14, 259.41 examples/s]Map:  62%|██████▏   | 6192/10042 [00:21<00:13, 275.15 examples/s]Map:  62%|██████▏   | 6224/10042 [00:21<00:13, 286.01 examples/s]Map:  62%|██████▏   | 6256/10042 [00:21<00:12, 294.56 examples/s]Map:  63%|██████▎   | 6288/10042 [00:21<00:12, 300.20 examples/s]Map:  63%|██████▎   | 6321/10042 [00:21<00:12, 305.79 examples/s]Map:  63%|██████▎   | 6354/10042 [00:21<00:11, 309.95 examples/s]Map:  64%|██████▎   | 6386/10042 [00:21<00:11, 310.85 examples/s]Map:  64%|██████▍   | 6418/10042 [00:21<00:11, 312.49 examples/s]Map:  64%|██████▍   | 6451/10042 [00:22<00:11, 315.70 examples/s]Map:  65%|██████▍   | 6498/10042 [00:22<00:11, 312.23 examples/s]Map:  65%|██████▌   | 6530/10042 [00:22<00:11, 312.65 examples/s]Map:  65%|██████▌   | 6563/10042 [00:22<00:11, 315.73 examples/s]Map:  66%|██████▌   | 6596/10042 [00:22<00:10, 317.37 examples/s]Map:  66%|██████▌   | 6628/10042 [00:22<00:10, 314.70 examples/s]Map:  66%|██████▋   | 6660/10042 [00:22<00:10, 314.20 examples/s]Map:  67%|██████▋   | 6692/10042 [00:22<00:10, 313.82 examples/s]Map:  67%|██████▋   | 6724/10042 [00:22<00:10, 312.32 examples/s]Map:  67%|██████▋   | 6756/10042 [00:23<00:10, 311.91 examples/s]Map:  68%|██████▊   | 6789/10042 [00:23<00:10, 314.01 examples/s]Map:  68%|██████▊   | 6822/10042 [00:23<00:10, 314.86 examples/s]Map:  68%|██████▊   | 6854/10042 [00:23<00:10, 314.72 examples/s]Map:  69%|██████▊   | 6886/10042 [00:23<00:10, 314.29 examples/s]Map:  69%|██████▉   | 6918/10042 [00:23<00:09, 312.88 examples/s]Map:  69%|██████▉   | 6965/10042 [00:23<00:09, 308.89 examples/s]Map:  70%|██████▉   | 6997/10042 [00:23<00:09, 308.93 examples/s]Map:  70%|███████   | 7030/10042 [00:24<00:17, 176.98 examples/s]Map:  70%|███████   | 7063/10042 [00:24<00:14, 203.28 examples/s]Map:  71%|███████   | 7096/10042 [00:24<00:12, 227.70 examples/s]Map:  71%|███████   | 7128/10042 [00:24<00:11, 247.28 examples/s]Map:  71%|███████▏  | 7161/10042 [00:24<00:10, 265.08 examples/s]Map:  72%|███████▏  | 7194/10042 [00:24<00:10, 279.13 examples/s]Map:  72%|███████▏  | 7228/10042 [00:24<00:09, 290.80 examples/s]Map:  72%|███████▏  | 7261/10042 [00:24<00:09, 298.57 examples/s]Map:  73%|███████▎  | 7293/10042 [00:25<00:09, 303.34 examples/s]Map:  73%|███████▎  | 7326/10042 [00:25<00:08, 308.55 examples/s]Map:  73%|███████▎  | 7358/10042 [00:25<00:08, 308.07 examples/s]Map:  74%|███████▎  | 7390/10042 [00:25<00:08, 310.44 examples/s]Map:  74%|███████▍  | 7423/10042 [00:25<00:08, 312.67 examples/s]Map:  74%|███████▍  | 7455/10042 [00:25<00:08, 312.17 examples/s]Map:  75%|███████▍  | 7487/10042 [00:25<00:08, 313.68 examples/s]Map:  75%|███████▍  | 7519/10042 [00:25<00:08, 313.50 examples/s]Map:  75%|███████▌  | 7553/10042 [00:25<00:07, 315.83 examples/s]Map:  76%|███████▌  | 7586/10042 [00:25<00:07, 317.29 examples/s]Map:  76%|███████▌  | 7620/10042 [00:26<00:07, 319.28 examples/s]Map:  76%|███████▌  | 7652/10042 [00:26<00:07, 318.53 examples/s]Map:  77%|███████▋  | 7684/10042 [00:26<00:07, 318.12 examples/s]Map:  77%|███████▋  | 7717/10042 [00:26<00:07, 317.01 examples/s]Map:  77%|███████▋  | 7749/10042 [00:26<00:07, 315.37 examples/s]Map:  77%|███████▋  | 7781/10042 [00:26<00:07, 314.73 examples/s]Map:  78%|███████▊  | 7813/10042 [00:26<00:07, 313.05 examples/s]Map:  78%|███████▊  | 7845/10042 [00:26<00:07, 312.40 examples/s]Map:  78%|███████▊  | 7877/10042 [00:26<00:06, 312.46 examples/s]Map:  79%|███████▉  | 7909/10042 [00:26<00:06, 313.80 examples/s]Map:  79%|███████▉  | 7941/10042 [00:27<00:06, 315.20 examples/s]Map:  79%|███████▉  | 7973/10042 [00:27<00:06, 314.73 examples/s]Map:  80%|███████▉  | 8015/10042 [00:27<00:11, 180.19 examples/s]Map:  80%|████████  | 8047/10042 [00:27<00:09, 205.14 examples/s]Map:  80%|████████  | 8080/10042 [00:27<00:08, 229.14 examples/s]Map:  81%|████████  | 8112/10042 [00:27<00:07, 248.01 examples/s]Map:  81%|████████  | 8145/10042 [00:28<00:07, 266.40 examples/s]Map:  81%|████████▏ | 8178/10042 [00:28<00:06, 279.79 examples/s]Map:  82%|████████▏ | 8211/10042 [00:28<00:06, 290.83 examples/s]Map:  82%|████████▏ | 8245/10042 [00:28<00:05, 299.99 examples/s]Map:  82%|████████▏ | 8277/10042 [00:28<00:05, 304.43 examples/s]Map:  83%|████████▎ | 8310/10042 [00:28<00:05, 309.04 examples/s]Map:  83%|████████▎ | 8342/10042 [00:28<00:05, 311.27 examples/s]Map:  83%|████████▎ | 8376/10042 [00:28<00:05, 314.82 examples/s]Map:  84%|████████▎ | 8408/10042 [00:28<00:05, 313.44 examples/s]Map:  84%|████████▍ | 8442/10042 [00:28<00:05, 315.53 examples/s]Map:  84%|████████▍ | 8474/10042 [00:29<00:04, 315.90 examples/s]Map:  85%|████████▍ | 8506/10042 [00:29<00:04, 316.46 examples/s]Map:  85%|████████▌ | 8538/10042 [00:29<00:04, 315.83 examples/s]Map:  85%|████████▌ | 8571/10042 [00:29<00:04, 316.83 examples/s]Map:  86%|████████▌ | 8603/10042 [00:29<00:04, 314.30 examples/s]Map:  86%|████████▌ | 8635/10042 [00:29<00:04, 314.75 examples/s]Map:  86%|████████▋ | 8667/10042 [00:29<00:04, 314.31 examples/s]Map:  87%|████████▋ | 8701/10042 [00:29<00:04, 317.26 examples/s]Map:  87%|████████▋ | 8733/10042 [00:29<00:04, 315.21 examples/s]Map:  87%|████████▋ | 8765/10042 [00:29<00:04, 314.64 examples/s]Map:  88%|████████▊ | 8797/10042 [00:30<00:03, 315.34 examples/s]Map:  88%|████████▊ | 8829/10042 [00:30<00:03, 315.53 examples/s]Map:  88%|████████▊ | 8862/10042 [00:30<00:03, 316.77 examples/s]Map:  89%|████████▊ | 8894/10042 [00:30<00:03, 315.30 examples/s]Map:  89%|████████▉ | 8926/10042 [00:30<00:03, 316.01 examples/s]Map:  89%|████████▉ | 8958/10042 [00:30<00:03, 311.87 examples/s]Map:  90%|████████▉ | 8990/10042 [00:30<00:03, 313.13 examples/s]Map:  90%|████████▉ | 9031/10042 [00:31<00:05, 180.95 examples/s]Map:  90%|█████████ | 9064/10042 [00:31<00:04, 206.57 examples/s]Map:  91%|█████████ | 9098/10042 [00:31<00:04, 231.53 examples/s]Map:  91%|█████████ | 9130/10042 [00:31<00:03, 250.52 examples/s]Map:  91%|█████████ | 9163/10042 [00:31<00:03, 268.20 examples/s]Map:  92%|█████████▏| 9195/10042 [00:31<00:03, 278.38 examples/s]Map:  92%|█████████▏| 9228/10042 [00:31<00:02, 289.52 examples/s]Map:  92%|█████████▏| 9261/10042 [00:31<00:02, 298.21 examples/s]Map:  93%|█████████▎| 9294/10042 [00:31<00:02, 303.19 examples/s]Map:  93%|█████████▎| 9328/10042 [00:32<00:02, 309.05 examples/s]Map:  93%|█████████▎| 9361/10042 [00:32<00:02, 311.72 examples/s]Map:  94%|█████████▎| 9394/10042 [00:32<00:02, 313.30 examples/s]Map:  94%|█████████▍| 9427/10042 [00:32<00:01, 315.46 examples/s]Map:  94%|█████████▍| 9460/10042 [00:32<00:01, 315.46 examples/s]Map:  95%|█████████▍| 9492/10042 [00:32<00:01, 315.56 examples/s]Map:  95%|█████████▍| 9525/10042 [00:32<00:01, 316.41 examples/s]Map:  95%|█████████▌| 9557/10042 [00:32<00:01, 314.15 examples/s]Map:  95%|█████████▌| 9589/10042 [00:32<00:01, 313.05 examples/s]Map:  96%|█████████▌| 9622/10042 [00:32<00:01, 314.28 examples/s]Map:  96%|█████████▌| 9654/10042 [00:33<00:01, 312.91 examples/s]Map:  96%|█████████▋| 9686/10042 [00:33<00:01, 312.35 examples/s]Map:  97%|█████████▋| 9718/10042 [00:33<00:01, 313.10 examples/s]Map:  97%|█████████▋| 9751/10042 [00:33<00:00, 313.45 examples/s]Map:  97%|█████████▋| 9783/10042 [00:33<00:00, 315.00 examples/s]Map:  98%|█████████▊| 9815/10042 [00:33<00:00, 315.30 examples/s]Map:  98%|█████████▊| 9848/10042 [00:33<00:00, 316.53 examples/s]Map:  98%|█████████▊| 9880/10042 [00:33<00:00, 315.26 examples/s]Map:  99%|█████████▊| 9912/10042 [00:33<00:00, 314.91 examples/s]Map:  99%|█████████▉| 9944/10042 [00:33<00:00, 315.00 examples/s]Map:  99%|█████████▉| 9976/10042 [00:34<00:00, 315.05 examples/s]Map: 100%|█████████▉| 10014/10042 [00:34<00:00, 139.20 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 159.14 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 288.92 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   8%|▊         | 97/1267 [00:00<00:01, 950.92 examples/s]Map:  16%|█▌        | 197/1267 [00:00<00:01, 972.65 examples/s]Map:  23%|██▎       | 297/1267 [00:00<00:00, 983.30 examples/s]Map:  31%|███▏      | 398/1267 [00:00<00:00, 989.14 examples/s]Map:  39%|███▉      | 499/1267 [00:00<00:00, 993.16 examples/s]Map:  51%|█████     | 647/1267 [00:00<00:00, 985.79 examples/s]Map:  59%|█████▉    | 748/1267 [00:00<00:00, 991.41 examples/s]Map:  67%|██████▋   | 849/1267 [00:00<00:00, 994.95 examples/s]Map:  75%|███████▌  | 952/1267 [00:00<00:00, 1002.21 examples/s]Map:  87%|████████▋ | 1101/1267 [00:01<00:00, 659.63 examples/s]Map:  95%|█████████▌| 1204/1267 [00:01<00:00, 731.15 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 834.67 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:01,  3.93it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  4.35it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  4.39it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  4.30it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:01<00:00,  4.11it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:01<00:00,  4.48it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:01<00:00,  4.35it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:48<04:02, 48.59s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [01:36<03:12, 48.23s/it]Loading checkpoint shards:  50%|█████     | 3/6 [02:23<02:23, 47.72s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [03:02<01:28, 44.12s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [03:41<00:42, 42.43s/it]Loading checkpoint shards: 100%|██████████| 6/6 [04:04<00:00, 35.88s/it]Loading checkpoint shards: 100%|██████████| 6/6 [04:04<00:00, 40.81s/it]
2024-05-04 06:24:54,651: rank0[543622][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-05-04 06:24:54,656: rank0[543622][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-05-04 06:24:55,904: rank0[543622][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-05-04 06:24:55,927: rank0[543622][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-05-04 06:25:10,692: rank0[543622][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-05-04 06:25:10,693: rank0[543622][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-05-04 06:25:10,693: rank0[543622][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned70.iterative-trained/combined
models:
- model_name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned70.iterative-trained/combined
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned70.iterative-trained/combined
    use_auth_token: true
  tokenizer:
    name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned70.iterative-trained/combined
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-05-04 06:25:10,699: rank0[543622][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.4027
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.3660
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.6232
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.6504
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                                                                 |
|:-----------|:--------------|:----------|-----------:|:------------------|:----------------------------------------------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.40273  | 25-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned70.iterative-trained/combined |
|            | mmlu          |           |   0.366045 | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned70.iterative-trained/combined |
|            | winogrande    |           |   0.650355 | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned70.iterative-trained/combined |
|            | hellaswag     |           |   0.623183 | 10-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_finetuning-pruned70.iterative-trained/combined |
2024-05-04 07:25:33,906: rank0[543622][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-05-04 07:25:33,906: rank0[543622][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-05-04 07:25:33,906: rank0[543622][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-05-04 07:25:33,906: rank0[543622][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
