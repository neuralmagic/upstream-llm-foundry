----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-04-27 06:27:35,925: rank0[3836980][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 34/10042 [00:00<00:30, 331.32 examples/s]Map:   1%|          | 69/10042 [00:00<00:29, 333.73 examples/s]Map:   1%|          | 103/10042 [00:00<00:29, 331.60 examples/s]Map:   1%|▏         | 150/10042 [00:00<00:31, 318.24 examples/s]Map:   2%|▏         | 198/10042 [00:00<00:31, 313.55 examples/s]Map:   2%|▏         | 232/10042 [00:00<00:30, 319.39 examples/s]Map:   3%|▎         | 266/10042 [00:00<00:30, 324.51 examples/s]Map:   3%|▎         | 300/10042 [00:00<00:29, 328.41 examples/s]Map:   3%|▎         | 335/10042 [00:01<00:29, 332.29 examples/s]Map:   4%|▎         | 371/10042 [00:01<00:28, 336.40 examples/s]Map:   4%|▍         | 406/10042 [00:01<00:28, 337.44 examples/s]Map:   4%|▍         | 441/10042 [00:01<00:28, 337.17 examples/s]Map:   5%|▍         | 477/10042 [00:01<00:28, 338.62 examples/s]Map:   5%|▌         | 511/10042 [00:01<00:28, 337.98 examples/s]Map:   5%|▌         | 545/10042 [00:01<00:28, 337.02 examples/s]Map:   6%|▌         | 580/10042 [00:01<00:27, 338.76 examples/s]Map:   6%|▌         | 615/10042 [00:01<00:27, 339.51 examples/s]Map:   6%|▋         | 651/10042 [00:01<00:27, 339.87 examples/s]Map:   7%|▋         | 701/10042 [00:02<00:27, 334.79 examples/s]Map:   7%|▋         | 737/10042 [00:02<00:27, 336.13 examples/s]Map:   8%|▊         | 771/10042 [00:02<00:27, 334.28 examples/s]Map:   8%|▊         | 806/10042 [00:02<00:27, 336.09 examples/s]Map:   8%|▊         | 840/10042 [00:02<00:27, 334.84 examples/s]Map:   9%|▊         | 874/10042 [00:02<00:27, 333.95 examples/s]Map:   9%|▉         | 908/10042 [00:02<00:27, 333.82 examples/s]Map:   9%|▉         | 942/10042 [00:02<00:27, 334.47 examples/s]Map:  10%|▉         | 976/10042 [00:02<00:27, 335.15 examples/s]Map:  10%|█         | 1016/10042 [00:03<00:55, 161.91 examples/s]Map:  10%|█         | 1052/10042 [00:03<00:46, 192.56 examples/s]Map:  11%|█         | 1086/10042 [00:03<00:40, 219.65 examples/s]Map:  11%|█         | 1121/10042 [00:03<00:36, 245.29 examples/s]Map:  12%|█▏        | 1157/10042 [00:03<00:33, 268.65 examples/s]Map:  12%|█▏        | 1192/10042 [00:03<00:30, 286.62 examples/s]Map:  12%|█▏        | 1227/10042 [00:04<00:29, 300.74 examples/s]Map:  13%|█▎        | 1261/10042 [00:04<00:28, 310.73 examples/s]Map:  13%|█▎        | 1295/10042 [00:04<00:27, 316.77 examples/s]Map:  13%|█▎        | 1329/10042 [00:04<00:27, 322.23 examples/s]Map:  14%|█▎        | 1363/10042 [00:04<00:26, 325.11 examples/s]Map:  14%|█▍        | 1398/10042 [00:04<00:26, 329.08 examples/s]Map:  14%|█▍        | 1432/10042 [00:04<00:25, 331.59 examples/s]Map:  15%|█▍        | 1466/10042 [00:04<00:25, 332.88 examples/s]Map:  15%|█▍        | 1500/10042 [00:04<00:25, 334.55 examples/s]Map:  15%|█▌        | 1534/10042 [00:04<00:25, 332.55 examples/s]Map:  16%|█▌        | 1568/10042 [00:05<00:25, 331.88 examples/s]Map:  16%|█▌        | 1602/10042 [00:05<00:25, 332.27 examples/s]Map:  16%|█▋        | 1636/10042 [00:05<00:25, 332.94 examples/s]Map:  17%|█▋        | 1670/10042 [00:05<00:25, 332.81 examples/s]Map:  17%|█▋        | 1710/10042 [00:05<00:37, 223.52 examples/s]Map:  17%|█▋        | 1746/10042 [00:05<00:33, 250.61 examples/s]Map:  18%|█▊        | 1779/10042 [00:05<00:30, 267.61 examples/s]Map:  18%|█▊        | 1812/10042 [00:05<00:29, 280.89 examples/s]Map:  18%|█▊        | 1846/10042 [00:06<00:27, 294.42 examples/s]Map:  19%|█▊        | 1882/10042 [00:06<00:26, 308.69 examples/s]Map:  19%|█▉        | 1917/10042 [00:06<00:25, 318.23 examples/s]Map:  19%|█▉        | 1952/10042 [00:06<00:24, 324.34 examples/s]Map:  20%|█▉        | 1987/10042 [00:06<00:24, 328.94 examples/s]Map:  20%|██        | 2034/10042 [00:06<00:39, 202.57 examples/s]Map:  21%|██        | 2069/10042 [00:06<00:34, 228.41 examples/s]Map:  21%|██        | 2103/10042 [00:07<00:31, 251.09 examples/s]Map:  21%|██▏       | 2138/10042 [00:07<00:29, 271.87 examples/s]Map:  22%|██▏       | 2174/10042 [00:07<00:27, 289.71 examples/s]Map:  22%|██▏       | 2209/10042 [00:07<00:25, 302.76 examples/s]Map:  22%|██▏       | 2245/10042 [00:07<00:24, 314.73 examples/s]Map:  23%|██▎       | 2280/10042 [00:07<00:24, 321.70 examples/s]Map:  23%|██▎       | 2316/10042 [00:07<00:23, 328.57 examples/s]Map:  23%|██▎       | 2351/10042 [00:07<00:23, 332.08 examples/s]Map:  24%|██▍       | 2386/10042 [00:07<00:22, 334.95 examples/s]Map:  24%|██▍       | 2422/10042 [00:08<00:22, 337.69 examples/s]Map:  24%|██▍       | 2458/10042 [00:08<00:22, 339.52 examples/s]Map:  25%|██▍       | 2493/10042 [00:08<00:22, 341.36 examples/s]Map:  25%|██▌       | 2529/10042 [00:08<00:21, 343.59 examples/s]Map:  26%|██▌       | 2565/10042 [00:08<00:21, 343.17 examples/s]Map:  26%|██▌       | 2600/10042 [00:08<00:21, 343.08 examples/s]Map:  26%|██▌       | 2635/10042 [00:08<00:21, 342.09 examples/s]Map:  27%|██▋       | 2670/10042 [00:08<00:21, 339.98 examples/s]Map:  27%|██▋       | 2721/10042 [00:08<00:21, 338.74 examples/s]Map:  27%|██▋       | 2756/10042 [00:08<00:21, 336.82 examples/s]Map:  28%|██▊       | 2791/10042 [00:09<00:21, 335.91 examples/s]Map:  28%|██▊       | 2826/10042 [00:09<00:21, 336.74 examples/s]Map:  28%|██▊       | 2860/10042 [00:09<00:21, 331.71 examples/s]Map:  29%|██▉       | 2894/10042 [00:09<00:21, 333.65 examples/s]Map:  29%|██▉       | 2928/10042 [00:09<00:21, 335.09 examples/s]Map:  29%|██▉       | 2962/10042 [00:09<00:21, 334.54 examples/s]Map:  30%|██▉       | 2997/10042 [00:09<00:20, 336.26 examples/s]Map:  30%|███       | 3033/10042 [00:10<00:34, 201.37 examples/s]Map:  31%|███       | 3069/10042 [00:10<00:30, 230.51 examples/s]Map:  31%|███       | 3104/10042 [00:10<00:27, 254.91 examples/s]Map:  31%|███▏      | 3139/10042 [00:10<00:25, 275.87 examples/s]Map:  32%|███▏      | 3174/10042 [00:10<00:23, 292.19 examples/s]Map:  32%|███▏      | 3209/10042 [00:10<00:22, 304.63 examples/s]Map:  32%|███▏      | 3244/10042 [00:10<00:21, 315.16 examples/s]Map:  33%|███▎      | 3293/10042 [00:10<00:21, 315.16 examples/s]Map:  33%|███▎      | 3326/10042 [00:10<00:21, 316.51 examples/s]Map:  34%|███▎      | 3374/10042 [00:11<00:21, 316.59 examples/s]Map:  34%|███▍      | 3422/10042 [00:11<00:20, 316.00 examples/s]Map:  35%|███▍      | 3471/10042 [00:11<00:20, 316.22 examples/s]Map:  35%|███▍      | 3503/10042 [00:11<00:20, 315.60 examples/s]Map:  35%|███▌      | 3536/10042 [00:11<00:20, 315.54 examples/s]Map:  36%|███▌      | 3568/10042 [00:11<00:20, 315.88 examples/s]Map:  36%|███▌      | 3601/10042 [00:11<00:20, 316.80 examples/s]Map:  36%|███▌      | 3634/10042 [00:11<00:20, 316.91 examples/s]Map:  37%|███▋      | 3666/10042 [00:12<00:20, 313.45 examples/s]Map:  37%|███▋      | 3698/10042 [00:12<00:20, 312.00 examples/s]Map:  37%|███▋      | 3730/10042 [00:12<00:20, 311.88 examples/s]Map:  37%|███▋      | 3762/10042 [00:12<00:20, 309.44 examples/s]Map:  38%|███▊      | 3794/10042 [00:12<00:20, 310.42 examples/s]Map:  38%|███▊      | 3826/10042 [00:12<00:20, 310.49 examples/s]Map:  38%|███▊      | 3858/10042 [00:12<00:20, 309.15 examples/s]Map:  39%|███▊      | 3889/10042 [00:12<00:20, 306.64 examples/s]Map:  39%|███▉      | 3921/10042 [00:12<00:19, 306.36 examples/s]Map:  39%|███▉      | 3953/10042 [00:12<00:19, 308.53 examples/s]Map:  40%|███▉      | 3985/10042 [00:13<00:19, 309.29 examples/s]Map:  40%|████      | 4030/10042 [00:13<00:32, 184.30 examples/s]Map:  40%|████      | 4062/10042 [00:13<00:28, 208.03 examples/s]Map:  41%|████      | 4094/10042 [00:13<00:25, 229.84 examples/s]Map:  41%|████      | 4127/10042 [00:13<00:23, 249.34 examples/s]Map:  41%|████▏     | 4159/10042 [00:13<00:22, 265.48 examples/s]Map:  42%|████▏     | 4192/10042 [00:13<00:21, 278.53 examples/s]Map:  42%|████▏     | 4225/10042 [00:14<00:20, 289.32 examples/s]Map:  42%|████▏     | 4258/10042 [00:14<00:19, 297.66 examples/s]Map:  43%|████▎     | 4290/10042 [00:14<00:19, 302.44 examples/s]Map:  43%|████▎     | 4324/10042 [00:14<00:18, 307.44 examples/s]Map:  43%|████▎     | 4356/10042 [00:14<00:18, 308.92 examples/s]Map:  44%|████▎     | 4389/10042 [00:14<00:18, 312.65 examples/s]Map:  44%|████▍     | 4422/10042 [00:14<00:17, 314.77 examples/s]Map:  45%|████▍     | 4469/10042 [00:14<00:17, 311.47 examples/s]Map:  45%|████▍     | 4502/10042 [00:14<00:17, 313.94 examples/s]Map:  45%|████▌     | 4535/10042 [00:15<00:17, 315.50 examples/s]Map:  45%|████▌     | 4567/10042 [00:15<00:17, 314.36 examples/s]Map:  46%|████▌     | 4600/10042 [00:15<00:17, 314.01 examples/s]Map:  46%|████▌     | 4633/10042 [00:15<00:17, 315.95 examples/s]Map:  46%|████▋     | 4665/10042 [00:15<00:17, 313.63 examples/s]Map:  47%|████▋     | 4699/10042 [00:15<00:16, 316.75 examples/s]Map:  47%|████▋     | 4731/10042 [00:15<00:16, 314.87 examples/s]Map:  47%|████▋     | 4765/10042 [00:15<00:16, 318.12 examples/s]Map:  48%|████▊     | 4797/10042 [00:15<00:16, 314.95 examples/s]Map:  48%|████▊     | 4829/10042 [00:15<00:16, 314.97 examples/s]Map:  48%|████▊     | 4861/10042 [00:16<00:16, 312.18 examples/s]Map:  49%|████▊     | 4894/10042 [00:16<00:16, 314.53 examples/s]Map:  49%|████▉     | 4926/10042 [00:16<00:16, 312.89 examples/s]Map:  49%|████▉     | 4958/10042 [00:16<00:16, 313.68 examples/s]Map:  50%|████▉     | 4990/10042 [00:16<00:16, 312.86 examples/s]Map:  50%|█████     | 5030/10042 [00:16<00:27, 185.18 examples/s]Map:  50%|█████     | 5062/10042 [00:16<00:23, 209.41 examples/s]Map:  51%|█████     | 5094/10042 [00:17<00:21, 231.52 examples/s]Map:  51%|█████     | 5126/10042 [00:17<00:19, 251.36 examples/s]Map:  51%|█████▏    | 5158/10042 [00:17<00:18, 267.19 examples/s]Map:  52%|█████▏    | 5190/10042 [00:17<00:17, 279.30 examples/s]Map:  52%|█████▏    | 5224/10042 [00:17<00:16, 291.64 examples/s]Map:  52%|█████▏    | 5257/10042 [00:17<00:15, 300.45 examples/s]Map:  53%|█████▎    | 5290/10042 [00:17<00:15, 307.09 examples/s]Map:  53%|█████▎    | 5323/10042 [00:17<00:15, 310.44 examples/s]Map:  53%|█████▎    | 5356/10042 [00:17<00:14, 312.47 examples/s]Map:  54%|█████▎    | 5388/10042 [00:18<00:14, 312.59 examples/s]Map:  54%|█████▍    | 5422/10042 [00:18<00:14, 315.26 examples/s]Map:  54%|█████▍    | 5454/10042 [00:18<00:14, 314.69 examples/s]Map:  55%|█████▍    | 5486/10042 [00:18<00:14, 313.58 examples/s]Map:  55%|█████▍    | 5518/10042 [00:18<00:14, 314.47 examples/s]Map:  55%|█████▌    | 5551/10042 [00:18<00:14, 315.54 examples/s]Map:  56%|█████▌    | 5583/10042 [00:18<00:14, 314.42 examples/s]Map:  56%|█████▌    | 5615/10042 [00:18<00:14, 314.47 examples/s]Map:  56%|█████▌    | 5647/10042 [00:18<00:13, 314.89 examples/s]Map:  57%|█████▋    | 5679/10042 [00:18<00:13, 313.90 examples/s]Map:  57%|█████▋    | 5712/10042 [00:19<00:13, 314.13 examples/s]Map:  57%|█████▋    | 5745/10042 [00:19<00:13, 314.67 examples/s]Map:  58%|█████▊    | 5777/10042 [00:19<00:13, 312.58 examples/s]Map:  58%|█████▊    | 5824/10042 [00:19<00:13, 311.69 examples/s]Map:  58%|█████▊    | 5856/10042 [00:19<00:13, 311.99 examples/s]Map:  59%|█████▊    | 5888/10042 [00:19<00:13, 311.99 examples/s]Map:  59%|█████▉    | 5920/10042 [00:19<00:13, 312.28 examples/s]Map:  59%|█████▉    | 5952/10042 [00:19<00:13, 312.87 examples/s]Map:  60%|█████▉    | 5986/10042 [00:19<00:12, 316.79 examples/s]Map:  60%|██████    | 6032/10042 [00:20<00:20, 193.61 examples/s]Map:  60%|██████    | 6065/10042 [00:20<00:18, 216.97 examples/s]Map:  61%|██████    | 6097/10042 [00:20<00:16, 238.02 examples/s]Map:  61%|██████    | 6129/10042 [00:20<00:15, 255.07 examples/s]Map:  61%|██████▏   | 6162/10042 [00:20<00:14, 271.78 examples/s]Map:  62%|██████▏   | 6194/10042 [00:20<00:13, 283.18 examples/s]Map:  62%|██████▏   | 6226/10042 [00:20<00:13, 290.76 examples/s]Map:  62%|██████▏   | 6258/10042 [00:21<00:12, 298.16 examples/s]Map:  63%|██████▎   | 6290/10042 [00:21<00:12, 302.88 examples/s]Map:  63%|██████▎   | 6324/10042 [00:21<00:12, 308.71 examples/s]Map:  63%|██████▎   | 6356/10042 [00:21<00:11, 310.37 examples/s]Map:  64%|██████▎   | 6390/10042 [00:21<00:17, 203.95 examples/s]Map:  64%|██████▍   | 6422/10042 [00:21<00:15, 227.10 examples/s]Map:  64%|██████▍   | 6455/10042 [00:21<00:14, 249.48 examples/s]Map:  65%|██████▍   | 6487/10042 [00:21<00:13, 265.99 examples/s]Map:  65%|██████▍   | 6519/10042 [00:22<00:12, 279.26 examples/s]Map:  65%|██████▌   | 6551/10042 [00:22<00:12, 290.00 examples/s]Map:  66%|██████▌   | 6584/10042 [00:22<00:11, 298.76 examples/s]Map:  66%|██████▌   | 6631/10042 [00:22<00:11, 302.81 examples/s]Map:  66%|██████▋   | 6663/10042 [00:22<00:11, 306.60 examples/s]Map:  67%|██████▋   | 6695/10042 [00:22<00:10, 307.72 examples/s]Map:  67%|██████▋   | 6727/10042 [00:22<00:10, 307.73 examples/s]Map:  67%|██████▋   | 6759/10042 [00:22<00:10, 310.08 examples/s]Map:  68%|██████▊   | 6791/10042 [00:22<00:10, 310.78 examples/s]Map:  68%|██████▊   | 6824/10042 [00:23<00:10, 312.05 examples/s]Map:  68%|██████▊   | 6856/10042 [00:23<00:10, 312.46 examples/s]Map:  69%|██████▊   | 6888/10042 [00:23<00:10, 314.34 examples/s]Map:  69%|██████▉   | 6920/10042 [00:23<00:09, 312.66 examples/s]Map:  69%|██████▉   | 6952/10042 [00:23<00:09, 313.17 examples/s]Map:  70%|██████▉   | 6984/10042 [00:23<00:09, 314.04 examples/s]Map:  70%|███████   | 7031/10042 [00:23<00:15, 192.68 examples/s]Map:  70%|███████   | 7063/10042 [00:24<00:13, 215.60 examples/s]Map:  71%|███████   | 7096/10042 [00:24<00:12, 237.83 examples/s]Map:  71%|███████   | 7129/10042 [00:24<00:11, 256.08 examples/s]Map:  71%|███████▏  | 7161/10042 [00:24<00:10, 271.01 examples/s]Map:  72%|███████▏  | 7194/10042 [00:24<00:10, 284.29 examples/s]Map:  72%|███████▏  | 7228/10042 [00:24<00:09, 295.89 examples/s]Map:  72%|███████▏  | 7261/10042 [00:24<00:09, 302.18 examples/s]Map:  73%|███████▎  | 7293/10042 [00:24<00:08, 306.35 examples/s]Map:  73%|███████▎  | 7326/10042 [00:24<00:08, 310.59 examples/s]Map:  73%|███████▎  | 7358/10042 [00:24<00:08, 311.63 examples/s]Map:  74%|███████▎  | 7391/10042 [00:25<00:08, 314.70 examples/s]Map:  74%|███████▍  | 7424/10042 [00:25<00:08, 315.14 examples/s]Map:  74%|███████▍  | 7456/10042 [00:25<00:08, 314.68 examples/s]Map:  75%|███████▍  | 7488/10042 [00:25<00:08, 311.15 examples/s]Map:  75%|███████▍  | 7520/10042 [00:25<00:08, 309.07 examples/s]Map:  75%|███████▌  | 7551/10042 [00:25<00:08, 306.66 examples/s]Map:  76%|███████▌  | 7584/10042 [00:25<00:07, 310.53 examples/s]Map:  76%|███████▌  | 7618/10042 [00:25<00:07, 314.13 examples/s]Map:  76%|███████▌  | 7651/10042 [00:25<00:07, 315.97 examples/s]Map:  77%|███████▋  | 7684/10042 [00:25<00:07, 316.86 examples/s]Map:  77%|███████▋  | 7718/10042 [00:26<00:07, 318.71 examples/s]Map:  77%|███████▋  | 7750/10042 [00:26<00:07, 316.51 examples/s]Map:  77%|███████▋  | 7782/10042 [00:26<00:07, 315.59 examples/s]Map:  78%|███████▊  | 7814/10042 [00:26<00:07, 313.19 examples/s]Map:  78%|███████▊  | 7846/10042 [00:26<00:06, 314.13 examples/s]Map:  78%|███████▊  | 7879/10042 [00:26<00:06, 316.09 examples/s]Map:  79%|███████▉  | 7912/10042 [00:26<00:06, 316.49 examples/s]Map:  79%|███████▉  | 7945/10042 [00:26<00:06, 315.77 examples/s]Map:  79%|███████▉  | 7977/10042 [00:26<00:06, 316.20 examples/s]Map:  80%|███████▉  | 8015/10042 [00:27<00:10, 190.13 examples/s]Map:  80%|████████  | 8047/10042 [00:27<00:09, 214.92 examples/s]Map:  80%|████████  | 8080/10042 [00:27<00:08, 238.32 examples/s]Map:  81%|████████  | 8112/10042 [00:27<00:07, 256.48 examples/s]Map:  81%|████████  | 8145/10042 [00:27<00:06, 273.45 examples/s]Map:  81%|████████▏ | 8178/10042 [00:27<00:06, 284.67 examples/s]Map:  82%|████████▏ | 8211/10042 [00:27<00:06, 294.07 examples/s]Map:  82%|████████▏ | 8245/10042 [00:27<00:05, 302.65 examples/s]Map:  82%|████████▏ | 8277/10042 [00:28<00:05, 305.14 examples/s]Map:  83%|████████▎ | 8324/10042 [00:28<00:05, 305.88 examples/s]Map:  83%|████████▎ | 8356/10042 [00:28<00:05, 307.95 examples/s]Map:  84%|████████▎ | 8388/10042 [00:28<00:05, 309.68 examples/s]Map:  84%|████████▍ | 8420/10042 [00:28<00:05, 311.74 examples/s]Map:  84%|████████▍ | 8453/10042 [00:28<00:05, 312.46 examples/s]Map:  85%|████████▍ | 8486/10042 [00:28<00:04, 313.92 examples/s]Map:  85%|████████▍ | 8518/10042 [00:28<00:04, 314.94 examples/s]Map:  85%|████████▌ | 8550/10042 [00:28<00:04, 315.03 examples/s]Map:  85%|████████▌ | 8582/10042 [00:29<00:04, 315.52 examples/s]Map:  86%|████████▌ | 8614/10042 [00:29<00:04, 314.03 examples/s]Map:  86%|████████▌ | 8646/10042 [00:29<00:04, 312.72 examples/s]Map:  87%|████████▋ | 8694/10042 [00:29<00:04, 312.66 examples/s]Map:  87%|████████▋ | 8726/10042 [00:29<00:04, 311.54 examples/s]Map:  87%|████████▋ | 8758/10042 [00:29<00:04, 312.26 examples/s]Map:  88%|████████▊ | 8790/10042 [00:29<00:04, 312.56 examples/s]Map:  88%|████████▊ | 8822/10042 [00:29<00:03, 313.42 examples/s]Map:  88%|████████▊ | 8854/10042 [00:29<00:03, 313.40 examples/s]Map:  88%|████████▊ | 8887/10042 [00:30<00:03, 314.33 examples/s]Map:  89%|████████▉ | 8919/10042 [00:30<00:03, 314.59 examples/s]Map:  89%|████████▉ | 8951/10042 [00:30<00:03, 314.06 examples/s]Map:  89%|████████▉ | 8983/10042 [00:30<00:03, 314.32 examples/s]Map:  90%|████████▉ | 9015/10042 [00:30<00:05, 181.57 examples/s]Map:  90%|█████████ | 9046/10042 [00:30<00:04, 205.34 examples/s]Map:  90%|█████████ | 9077/10042 [00:30<00:04, 227.24 examples/s]Map:  91%|█████████ | 9110/10042 [00:30<00:03, 248.36 examples/s]Map:  91%|█████████ | 9142/10042 [00:31<00:03, 262.88 examples/s]Map:  91%|█████████▏| 9173/10042 [00:31<00:03, 271.70 examples/s]Map:  92%|█████████▏| 9203/10042 [00:31<00:03, 278.54 examples/s]Map:  92%|█████████▏| 9235/10042 [00:31<00:02, 286.84 examples/s]Map:  92%|█████████▏| 9267/10042 [00:31<00:02, 292.81 examples/s]Map:  93%|█████████▎| 9301/10042 [00:31<00:02, 301.51 examples/s]Map:  93%|█████████▎| 9335/10042 [00:31<00:02, 307.96 examples/s]Map:  93%|█████████▎| 9369/10042 [00:31<00:02, 311.52 examples/s]Map:  94%|█████████▎| 9402/10042 [00:31<00:02, 314.10 examples/s]Map:  94%|█████████▍| 9435/10042 [00:32<00:01, 316.29 examples/s]Map:  94%|█████████▍| 9467/10042 [00:32<00:01, 314.90 examples/s]Map:  95%|█████████▍| 9499/10042 [00:32<00:01, 313.14 examples/s]Map:  95%|█████████▍| 9533/10042 [00:32<00:01, 315.42 examples/s]Map:  95%|█████████▌| 9565/10042 [00:32<00:01, 315.78 examples/s]Map:  96%|█████████▌| 9598/10042 [00:32<00:01, 318.26 examples/s]Map:  96%|█████████▌| 9630/10042 [00:32<00:01, 316.82 examples/s]Map:  96%|█████████▌| 9663/10042 [00:32<00:01, 316.04 examples/s]Map:  97%|█████████▋| 9695/10042 [00:32<00:01, 315.22 examples/s]Map:  97%|█████████▋| 9728/10042 [00:32<00:00, 316.36 examples/s]Map:  97%|█████████▋| 9760/10042 [00:33<00:00, 316.38 examples/s]Map:  98%|█████████▊| 9793/10042 [00:33<00:00, 316.40 examples/s]Map:  98%|█████████▊| 9825/10042 [00:33<00:00, 315.86 examples/s]Map:  98%|█████████▊| 9857/10042 [00:33<00:00, 315.61 examples/s]Map:  98%|█████████▊| 9889/10042 [00:33<00:00, 313.10 examples/s]Map:  99%|█████████▉| 9921/10042 [00:33<00:00, 312.81 examples/s]Map:  99%|█████████▉| 9953/10042 [00:33<00:00, 311.35 examples/s]Map:  99%|█████████▉| 9985/10042 [00:33<00:00, 312.16 examples/s]Map: 100%|█████████▉| 10031/10042 [00:34<00:00, 190.61 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 292.59 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   8%|▊         | 96/1267 [00:00<00:01, 942.37 examples/s]Map:  16%|█▌        | 198/1267 [00:00<00:01, 984.12 examples/s]Map:  27%|██▋       | 346/1267 [00:00<00:00, 980.53 examples/s]Map:  35%|███▌      | 449/1267 [00:00<00:00, 992.80 examples/s]Map:  43%|████▎     | 550/1267 [00:00<00:00, 996.04 examples/s]Map:  51%|█████▏    | 651/1267 [00:00<00:00, 995.38 examples/s]Map:  59%|█████▉    | 751/1267 [00:00<00:00, 992.21 examples/s]Map:  67%|██████▋   | 851/1267 [00:00<00:00, 991.99 examples/s]Map:  75%|███████▌  | 954/1267 [00:00<00:00, 999.91 examples/s]Map:  87%|████████▋ | 1100/1267 [00:01<00:00, 661.41 examples/s]Map:  95%|█████████▍| 1203/1267 [00:01<00:00, 733.52 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 841.26 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  5.29it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  6.34it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  6.84it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  7.11it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  7.26it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.42it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.05it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:08,  1.62s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:03<00:05,  1.48s/it]Loading checkpoint shards:  50%|█████     | 3/6 [00:03<00:03,  1.21s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:38<00:29, 14.52s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [01:13<00:21, 21.86s/it]Loading checkpoint shards: 100%|██████████| 6/6 [01:30<00:00, 20.21s/it]Loading checkpoint shards: 100%|██████████| 6/6 [01:30<00:00, 15.12s/it]
2024-04-27 06:29:47,030: rank0[3836980][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-04-27 06:29:47,032: rank0[3836980][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-04-27 06:29:48,290: rank0[3836980][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-04-27 06:29:48,315: rank0[3836980][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-04-27 06:30:06,496: rank0[3836980][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-04-27 06:30:06,497: rank0[3836980][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-04-27 06:30:06,497: rank0[3836980][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned70/combined
models:
- model_name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned70/combined
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned70/combined
    use_auth_token: true
  tokenizer:
    name: /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned70/combined
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-04-27 06:30:06,503: rank0[3836980][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.4462
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.4169
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7455
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7056
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                                             |
|:-----------|:--------------|:----------|-----------:|:------------------|:--------------------------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.446246 | 25-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned70/combined |
|            | mmlu          |           |   0.416892 | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned70/combined |
|            | winogrande    |           |   0.705604 | 5-shot            | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned70/combined |
|            | hellaswag     |           |   0.745469 | 10-shot           | /network/shubhra/cerebras_paper_models/llama2-7b_dolphin+open-platypus_transfer-pruned70/combined |
2024-04-27 07:30:40,551: rank0[3836980][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-04-27 07:30:40,551: rank0[3836980][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-04-27 07:30:40,551: rank0[3836980][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-04-27 07:30:40,552: rank0[3836980][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
