----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-05-20 20:42:56,806: rank0[354464][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 24/1172 [00:00<00:05, 224.91 examples/s]Map:   4%|▍         | 49/1172 [00:00<00:04, 235.62 examples/s]Map:   6%|▋         | 76/1172 [00:00<00:04, 247.29 examples/s]Map:   9%|▊         | 101/1172 [00:00<00:04, 245.37 examples/s]Map:  11%|█         | 127/1172 [00:00<00:04, 244.37 examples/s]Map:  13%|█▎        | 153/1172 [00:00<00:04, 244.59 examples/s]Map:  15%|█▌        | 179/1172 [00:00<00:04, 246.85 examples/s]Map:  17%|█▋        | 205/1172 [00:00<00:03, 248.63 examples/s]Map:  20%|█▉        | 233/1172 [00:00<00:03, 253.92 examples/s]Map:  22%|██▏       | 261/1172 [00:01<00:03, 257.86 examples/s]Map:  25%|██▍       | 288/1172 [00:01<00:03, 258.60 examples/s]Map:  27%|██▋       | 316/1172 [00:01<00:03, 260.80 examples/s]Map:  29%|██▉       | 343/1172 [00:01<00:03, 260.50 examples/s]Map:  32%|███▏      | 371/1172 [00:01<00:03, 261.71 examples/s]Map:  34%|███▍      | 399/1172 [00:01<00:02, 262.94 examples/s]Map:  36%|███▋      | 426/1172 [00:01<00:02, 261.30 examples/s]Map:  39%|███▊      | 454/1172 [00:01<00:02, 262.75 examples/s]Map:  41%|████      | 482/1172 [00:01<00:02, 264.74 examples/s]Map:  43%|████▎     | 509/1172 [00:01<00:02, 263.72 examples/s]Map:  46%|████▌     | 537/1172 [00:02<00:02, 266.97 examples/s]Map:  48%|████▊     | 565/1172 [00:02<00:02, 267.64 examples/s]Map:  51%|█████     | 593/1172 [00:02<00:02, 267.81 examples/s]Map:  53%|█████▎    | 621/1172 [00:02<00:02, 269.40 examples/s]Map:  55%|█████▌    | 649/1172 [00:02<00:01, 269.82 examples/s]Map:  58%|█████▊    | 676/1172 [00:02<00:01, 268.68 examples/s]Map:  60%|██████    | 704/1172 [00:02<00:01, 268.28 examples/s]Map:  62%|██████▏   | 732/1172 [00:02<00:01, 268.36 examples/s]Map:  65%|██████▍   | 760/1172 [00:02<00:01, 269.81 examples/s]Map:  67%|██████▋   | 788/1172 [00:03<00:01, 271.14 examples/s]Map:  71%|███████   | 829/1172 [00:03<00:01, 269.39 examples/s]Map:  73%|███████▎  | 857/1172 [00:03<00:01, 269.32 examples/s]Map:  76%|███████▌  | 885/1172 [00:03<00:01, 270.28 examples/s]Map:  79%|███████▉  | 926/1172 [00:03<00:00, 266.96 examples/s]Map:  81%|████████▏ | 954/1172 [00:03<00:00, 267.67 examples/s]Map:  84%|████████▍ | 982/1172 [00:03<00:00, 268.93 examples/s]Map:  87%|████████▋ | 1014/1172 [00:04<00:01, 94.10 examples/s]Map:  89%|████████▉ | 1042/1172 [00:04<00:01, 114.90 examples/s]Map:  91%|█████████▏| 1070/1172 [00:04<00:00, 137.85 examples/s]Map:  94%|█████████▎| 1098/1172 [00:04<00:00, 160.98 examples/s]Map:  96%|█████████▌| 1126/1172 [00:04<00:00, 182.99 examples/s]Map:  98%|█████████▊| 1154/1172 [00:05<00:00, 202.16 examples/s]Map: 100%|██████████| 1172/1172 [00:05<00:00, 223.70 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 40/14042 [00:00<00:35, 390.70 examples/s]Map:   1%|          | 99/14042 [00:00<00:36, 382.22 examples/s]Map:   1%|          | 156/14042 [00:00<00:36, 378.09 examples/s]Map:   1%|▏         | 196/14042 [00:00<00:36, 380.92 examples/s]Map:   2%|▏         | 238/14042 [00:00<00:35, 389.90 examples/s]Map:   2%|▏         | 295/14042 [00:00<00:35, 382.17 examples/s]Map:   2%|▏         | 337/14042 [00:00<00:35, 387.46 examples/s]Map:   3%|▎         | 381/14042 [00:01<01:09, 195.60 examples/s]Map:   3%|▎         | 418/14042 [00:01<01:01, 222.96 examples/s]Map:   3%|▎         | 458/14042 [00:01<00:53, 254.54 examples/s]Map:   4%|▎         | 498/14042 [00:01<00:47, 283.79 examples/s]Map:   4%|▍         | 539/14042 [00:01<00:43, 311.38 examples/s]Map:   4%|▍         | 578/14042 [00:01<00:41, 327.86 examples/s]Map:   4%|▍         | 619/14042 [00:01<00:38, 346.93 examples/s]Map:   5%|▍         | 658/14042 [00:02<00:37, 354.05 examples/s]Map:   5%|▍         | 697/14042 [00:02<00:36, 360.87 examples/s]Map:   5%|▌         | 736/14042 [00:02<00:36, 365.49 examples/s]Map:   6%|▌         | 776/14042 [00:02<00:35, 373.92 examples/s]Map:   6%|▌         | 834/14042 [00:02<00:35, 373.99 examples/s]Map:   6%|▋         | 892/14042 [00:02<00:34, 376.63 examples/s]Map:   7%|▋         | 934/14042 [00:02<00:34, 384.15 examples/s]Map:   7%|▋         | 975/14042 [00:02<00:33, 389.58 examples/s]Map:   7%|▋         | 1018/14042 [00:03<01:31, 142.27 examples/s]Map:   8%|▊         | 1061/14042 [00:03<01:13, 176.29 examples/s]Map:   8%|▊         | 1103/14042 [00:03<01:01, 210.96 examples/s]Map:   8%|▊         | 1147/14042 [00:03<00:51, 248.78 examples/s]Map:   8%|▊         | 1189/14042 [00:04<00:45, 281.27 examples/s]Map:   9%|▉         | 1229/14042 [00:04<00:41, 306.08 examples/s]Map:   9%|▉         | 1270/14042 [00:04<00:38, 329.29 examples/s]Map:   9%|▉         | 1311/14042 [00:04<00:36, 348.67 examples/s]Map:  10%|▉         | 1370/14042 [00:04<00:34, 362.60 examples/s]Map:  10%|█         | 1411/14042 [00:04<00:34, 371.25 examples/s]Map:  10%|█         | 1452/14042 [00:04<00:33, 378.18 examples/s]Map:  11%|█         | 1494/14042 [00:04<00:32, 387.33 examples/s]Map:  11%|█         | 1554/14042 [00:04<00:32, 388.98 examples/s]Map:  11%|█▏        | 1594/14042 [00:05<00:32, 388.42 examples/s]Map:  12%|█▏        | 1634/14042 [00:05<00:31, 389.75 examples/s]Map:  12%|█▏        | 1674/14042 [00:05<00:31, 389.25 examples/s]Map:  12%|█▏        | 1714/14042 [00:05<00:31, 389.74 examples/s]Map:  12%|█▏        | 1754/14042 [00:05<00:31, 390.07 examples/s]Map:  13%|█▎        | 1813/14042 [00:05<00:31, 388.35 examples/s]Map:  13%|█▎        | 1853/14042 [00:05<00:31, 385.76 examples/s]Map:  13%|█▎        | 1893/14042 [00:05<00:31, 387.22 examples/s]Map:  14%|█▍        | 1950/14042 [00:06<00:31, 381.51 examples/s]Map:  14%|█▍        | 1990/14042 [00:06<00:31, 383.34 examples/s]Map:  15%|█▍        | 2038/14042 [00:06<01:05, 183.47 examples/s]Map:  15%|█▍        | 2078/14042 [00:06<00:55, 214.16 examples/s]Map:  15%|█▌        | 2119/14042 [00:06<00:48, 245.96 examples/s]Map:  15%|█▌        | 2161/14042 [00:07<00:42, 277.80 examples/s]Map:  16%|█▌        | 2202/14042 [00:07<00:38, 305.51 examples/s]Map:  16%|█▌        | 2243/14042 [00:07<00:35, 328.29 examples/s]Map:  16%|█▋        | 2285/14042 [00:07<00:33, 349.52 examples/s]Map:  17%|█▋        | 2326/14042 [00:07<00:32, 363.85 examples/s]Map:  17%|█▋        | 2366/14042 [00:07<00:31, 370.92 examples/s]Map:  17%|█▋        | 2406/14042 [00:07<00:30, 376.77 examples/s]Map:  17%|█▋        | 2448/14042 [00:07<00:30, 384.12 examples/s]Map:  18%|█▊        | 2489/14042 [00:07<00:29, 385.99 examples/s]Map:  18%|█▊        | 2532/14042 [00:07<00:29, 395.91 examples/s]Map:  18%|█▊        | 2575/14042 [00:08<00:28, 403.02 examples/s]Map:  19%|█▉        | 2635/14042 [00:08<00:28, 400.10 examples/s]Map:  19%|█▉        | 2694/14042 [00:08<00:28, 397.42 examples/s]Map:  19%|█▉        | 2735/14042 [00:08<00:28, 396.56 examples/s]Map:  20%|█▉        | 2794/14042 [00:08<00:28, 392.41 examples/s]Map:  20%|██        | 2852/14042 [00:08<00:28, 388.87 examples/s]Map:  21%|██        | 2892/14042 [00:08<00:28, 389.87 examples/s]Map:  21%|██        | 2934/14042 [00:08<00:28, 393.60 examples/s]Map:  21%|██        | 2974/14042 [00:09<00:28, 393.27 examples/s]Map:  22%|██▏       | 3020/14042 [00:09<00:58, 188.96 examples/s]Map:  22%|██▏       | 3061/14042 [00:09<00:49, 221.34 examples/s]Map:  22%|██▏       | 3102/14042 [00:09<00:43, 254.27 examples/s]Map:  22%|██▏       | 3144/14042 [00:09<00:38, 285.70 examples/s]Map:  23%|██▎       | 3183/14042 [00:09<00:35, 306.39 examples/s]Map:  23%|██▎       | 3223/14042 [00:10<00:33, 326.55 examples/s]Map:  23%|██▎       | 3263/14042 [00:10<00:31, 342.34 examples/s]Map:  24%|██▎       | 3304/14042 [00:10<00:30, 356.45 examples/s]Map:  24%|██▍       | 3345/14042 [00:10<00:29, 368.00 examples/s]Map:  24%|██▍       | 3387/14042 [00:10<00:28, 379.83 examples/s]Map:  24%|██▍       | 3429/14042 [00:10<00:27, 386.34 examples/s]Map:  25%|██▍       | 3470/14042 [00:10<00:27, 388.68 examples/s]Map:  25%|██▌       | 3513/14042 [00:10<00:26, 396.56 examples/s]Map:  25%|██▌       | 3554/14042 [00:10<00:26, 398.55 examples/s]Map:  26%|██▌       | 3614/14042 [00:11<00:26, 396.66 examples/s]Map:  26%|██▌       | 3654/14042 [00:11<00:26, 394.78 examples/s]Map:  26%|██▋       | 3696/14042 [00:11<00:26, 395.89 examples/s]Map:  27%|██▋       | 3755/14042 [00:11<00:26, 392.84 examples/s]Map:  27%|██▋       | 3795/14042 [00:11<00:26, 389.83 examples/s]Map:  27%|██▋       | 3835/14042 [00:11<00:26, 388.39 examples/s]Map:  28%|██▊       | 3875/14042 [00:11<00:26, 388.84 examples/s]Map:  28%|██▊       | 3914/14042 [00:11<00:26, 387.04 examples/s]Map:  28%|██▊       | 3955/14042 [00:11<00:25, 390.41 examples/s]Map:  28%|██▊       | 4000/14042 [00:12<00:55, 182.36 examples/s]Map:  29%|██▊       | 4037/14042 [00:12<00:47, 211.22 examples/s]Map:  29%|██▉       | 4078/14042 [00:12<00:40, 246.27 examples/s]Map:  29%|██▉       | 4118/14042 [00:12<00:35, 276.57 examples/s]Map:  30%|██▉       | 4159/14042 [00:12<00:32, 305.12 examples/s]Map:  30%|██▉       | 4200/14042 [00:12<00:29, 329.94 examples/s]Map:  30%|███       | 4240/14042 [00:13<00:28, 345.97 examples/s]Map:  30%|███       | 4279/14042 [00:13<00:27, 355.05 examples/s]Map:  31%|███       | 4319/14042 [00:13<00:26, 364.00 examples/s]Map:  31%|███       | 4359/14042 [00:13<00:26, 371.50 examples/s]Map:  31%|███▏      | 4399/14042 [00:13<00:25, 377.67 examples/s]Map:  32%|███▏      | 4438/14042 [00:13<00:25, 377.91 examples/s]Map:  32%|███▏      | 4480/14042 [00:13<00:24, 387.88 examples/s]Map:  32%|███▏      | 4534/14042 [00:13<00:25, 374.13 examples/s]Map:  33%|███▎      | 4588/14042 [00:14<00:25, 363.65 examples/s]Map:  33%|███▎      | 4640/14042 [00:14<00:26, 353.71 examples/s]Map:  33%|███▎      | 4692/14042 [00:14<00:27, 346.24 examples/s]Map:  34%|███▎      | 4728/14042 [00:14<00:26, 346.65 examples/s]Map:  34%|███▍      | 4769/14042 [00:14<00:25, 359.72 examples/s]Map:  34%|███▍      | 4809/14042 [00:14<00:25, 367.42 examples/s]Map:  35%|███▍      | 4851/14042 [00:14<00:24, 377.08 examples/s]Map:  35%|███▍      | 4893/14042 [00:14<00:23, 387.06 examples/s]Map:  35%|███▌      | 4935/14042 [00:14<00:23, 394.36 examples/s]Map:  36%|███▌      | 4994/14042 [00:15<00:23, 389.81 examples/s]Map:  36%|███▌      | 5040/14042 [00:15<00:56, 160.44 examples/s]Map:  36%|███▌      | 5078/14042 [00:15<00:47, 188.24 examples/s]Map:  36%|███▋      | 5111/14042 [00:15<00:42, 209.10 examples/s]Map:  37%|███▋      | 5146/14042 [00:16<00:38, 232.94 examples/s]Map:  37%|███▋      | 5180/14042 [00:16<00:35, 252.31 examples/s]Map:  37%|███▋      | 5213/14042 [00:16<00:32, 268.21 examples/s]Map:  37%|███▋      | 5250/14042 [00:16<00:30, 291.38 examples/s]Map:  38%|███▊      | 5292/14042 [00:16<00:27, 321.68 examples/s]Map:  38%|███▊      | 5334/14042 [00:16<00:25, 344.87 examples/s]Map:  38%|███▊      | 5375/14042 [00:16<00:24, 360.00 examples/s]Map:  39%|███▊      | 5415/14042 [00:16<00:23, 365.62 examples/s]Map:  39%|███▉      | 5456/14042 [00:16<00:22, 376.42 examples/s]Map:  39%|███▉      | 5496/14042 [00:17<00:22, 380.86 examples/s]Map:  39%|███▉      | 5538/14042 [00:17<00:21, 391.11 examples/s]Map:  40%|███▉      | 5580/14042 [00:17<00:21, 396.00 examples/s]Map:  40%|████      | 5621/14042 [00:17<00:21, 395.01 examples/s]Map:  40%|████      | 5661/14042 [00:17<00:21, 396.27 examples/s]Map:  41%|████      | 5703/14042 [00:17<00:20, 400.01 examples/s]Map:  41%|████      | 5744/14042 [00:17<00:20, 399.87 examples/s]Map:  41%|████▏     | 5802/14042 [00:17<00:21, 391.39 examples/s]Map:  42%|████▏     | 5861/14042 [00:17<00:21, 387.70 examples/s]Map:  42%|████▏     | 5919/14042 [00:18<00:21, 384.31 examples/s]Map:  43%|████▎     | 5972/14042 [00:18<00:21, 371.84 examples/s]Map:  43%|████▎     | 6018/14042 [00:18<00:40, 196.39 examples/s]Map:  43%|████▎     | 6055/14042 [00:18<00:36, 220.44 examples/s]Map:  43%|████▎     | 6093/14042 [00:18<00:32, 245.82 examples/s]Map:  44%|████▎     | 6128/14042 [00:19<00:29, 265.54 examples/s]Map:  44%|████▍     | 6164/14042 [00:19<00:27, 284.31 examples/s]Map:  44%|████▍     | 6215/14042 [00:19<00:26, 298.79 examples/s]Map:  45%|████▍     | 6250/14042 [00:19<00:25, 308.21 examples/s]Map:  45%|████▍     | 6285/14042 [00:19<00:24, 316.95 examples/s]Map:  45%|████▌     | 6321/14042 [00:19<00:23, 325.24 examples/s]Map:  45%|████▌     | 6357/14042 [00:19<00:23, 332.73 examples/s]Map:  46%|████▌     | 6395/14042 [00:19<00:22, 342.33 examples/s]Map:  46%|████▌     | 6432/14042 [00:19<00:21, 347.38 examples/s]Map:  46%|████▌     | 6485/14042 [00:20<00:21, 346.04 examples/s]Map:  46%|████▋     | 6521/14042 [00:20<00:21, 347.60 examples/s]Map:  47%|████▋     | 6558/14042 [00:20<00:21, 351.25 examples/s]Map:  47%|████▋     | 6595/14042 [00:20<00:21, 352.65 examples/s]Map:  47%|████▋     | 6648/14042 [00:20<00:21, 348.94 examples/s]Map:  48%|████▊     | 6702/14042 [00:20<00:21, 349.48 examples/s]Map:  48%|████▊     | 6753/14042 [00:20<00:21, 344.49 examples/s]Map:  48%|████▊     | 6790/14042 [00:20<00:20, 346.85 examples/s]Map:  49%|████▊     | 6826/14042 [00:21<00:20, 348.24 examples/s]Map:  49%|████▉     | 6861/14042 [00:21<00:20, 347.13 examples/s]Map:  49%|████▉     | 6897/14042 [00:21<00:20, 347.73 examples/s]Map:  49%|████▉     | 6932/14042 [00:21<00:20, 345.89 examples/s]Map:  50%|████▉     | 6969/14042 [00:21<00:20, 347.40 examples/s]Map:  50%|████▉     | 7018/14042 [00:22<00:39, 177.43 examples/s]Map:  50%|█████     | 7054/14042 [00:22<00:33, 205.53 examples/s]Map:  50%|█████     | 7090/14042 [00:22<00:29, 232.90 examples/s]Map:  51%|█████     | 7127/14042 [00:22<00:26, 259.23 examples/s]Map:  51%|█████     | 7163/14042 [00:22<00:24, 280.06 examples/s]Map:  51%|█████▏    | 7201/14042 [00:22<00:22, 302.67 examples/s]Map:  52%|█████▏    | 7237/14042 [00:22<00:21, 315.25 examples/s]Map:  52%|█████▏    | 7272/14042 [00:22<00:21, 321.77 examples/s]Map:  52%|█████▏    | 7308/14042 [00:22<00:20, 328.15 examples/s]Map:  52%|█████▏    | 7343/14042 [00:22<00:20, 332.31 examples/s]Map:  53%|█████▎    | 7380/14042 [00:23<00:19, 339.44 examples/s]Map:  53%|█████▎    | 7416/14042 [00:23<00:19, 344.18 examples/s]Map:  53%|█████▎    | 7454/14042 [00:23<00:18, 351.57 examples/s]Map:  53%|█████▎    | 7493/14042 [00:23<00:18, 360.61 examples/s]Map:  54%|█████▎    | 7535/14042 [00:23<00:17, 374.18 examples/s]Map:  54%|█████▍    | 7575/14042 [00:23<00:16, 380.94 examples/s]Map:  54%|█████▍    | 7617/14042 [00:23<00:16, 387.95 examples/s]Map:  55%|█████▍    | 7658/14042 [00:23<00:16, 391.44 examples/s]Map:  55%|█████▍    | 7700/14042 [00:23<00:16, 395.52 examples/s]Map:  55%|█████▌    | 7741/14042 [00:23<00:15, 396.53 examples/s]Map:  56%|█████▌    | 7800/14042 [00:24<00:15, 392.66 examples/s]Map:  56%|█████▌    | 7840/14042 [00:24<00:15, 391.19 examples/s]Map:  56%|█████▌    | 7881/14042 [00:24<00:15, 394.54 examples/s]Map:  57%|█████▋    | 7941/14042 [00:24<00:15, 392.24 examples/s]Map:  57%|█████▋    | 7981/14042 [00:24<00:15, 393.58 examples/s]Map:  57%|█████▋    | 8040/14042 [00:25<00:30, 199.61 examples/s]Map:  58%|█████▊    | 8081/14042 [00:25<00:25, 229.87 examples/s]Map:  58%|█████▊    | 8122/14042 [00:25<00:22, 260.02 examples/s]Map:  58%|█████▊    | 8162/14042 [00:25<00:20, 286.63 examples/s]Map:  58%|█████▊    | 8203/14042 [00:25<00:18, 312.34 examples/s]Map:  59%|█████▊    | 8246/14042 [00:25<00:17, 337.05 examples/s]Map:  59%|█████▉    | 8286/14042 [00:25<00:16, 351.27 examples/s]Map:  59%|█████▉    | 8326/14042 [00:25<00:15, 361.69 examples/s]Map:  60%|█████▉    | 8367/14042 [00:25<00:15, 372.30 examples/s]Map:  60%|█████▉    | 8408/14042 [00:26<00:14, 379.03 examples/s]Map:  60%|██████    | 8448/14042 [00:26<00:14, 381.53 examples/s]Map:  60%|██████    | 8488/14042 [00:26<00:14, 383.42 examples/s]Map:  61%|██████    | 8528/14042 [00:26<00:14, 385.15 examples/s]Map:  61%|██████    | 8569/14042 [00:26<00:14, 389.19 examples/s]Map:  61%|██████▏   | 8611/14042 [00:26<00:13, 395.17 examples/s]Map:  62%|██████▏   | 8651/14042 [00:26<00:13, 394.96 examples/s]Map:  62%|██████▏   | 8691/14042 [00:26<00:13, 394.32 examples/s]Map:  62%|██████▏   | 8749/14042 [00:26<00:13, 389.57 examples/s]Map:  63%|██████▎   | 8789/14042 [00:27<00:13, 390.62 examples/s]Map:  63%|██████▎   | 8830/14042 [00:27<00:13, 393.70 examples/s]Map:  63%|██████▎   | 8872/14042 [00:27<00:12, 398.33 examples/s]Map:  63%|██████▎   | 8913/14042 [00:27<00:12, 399.52 examples/s]Map:  64%|██████▍   | 8973/14042 [00:27<00:12, 396.52 examples/s]Map:  64%|██████▍   | 9019/14042 [00:28<00:25, 198.13 examples/s]Map:  65%|██████▍   | 9060/14042 [00:28<00:21, 229.43 examples/s]Map:  65%|██████▍   | 9102/14042 [00:28<00:18, 261.89 examples/s]Map:  65%|██████▌   | 9141/14042 [00:28<00:17, 287.07 examples/s]Map:  65%|██████▌   | 9180/14042 [00:28<00:15, 307.93 examples/s]Map:  66%|██████▌   | 9221/14042 [00:28<00:14, 330.17 examples/s]Map:  66%|██████▌   | 9262/14042 [00:28<00:13, 347.95 examples/s]Map:  66%|██████▋   | 9303/14042 [00:28<00:13, 361.54 examples/s]Map:  67%|██████▋   | 9345/14042 [00:28<00:12, 375.27 examples/s]Map:  67%|██████▋   | 9385/14042 [00:28<00:12, 378.94 examples/s]Map:  67%|██████▋   | 9445/14042 [00:29<00:11, 385.53 examples/s]Map:  68%|██████▊   | 9487/14042 [00:29<00:11, 391.88 examples/s]Map:  68%|██████▊   | 9530/14042 [00:29<00:11, 398.69 examples/s]Map:  68%|██████▊   | 9583/14042 [00:29<00:11, 377.67 examples/s]Map:  69%|██████▊   | 9634/14042 [00:29<00:12, 362.46 examples/s]Map:  69%|██████▉   | 9686/14042 [00:29<00:12, 353.22 examples/s]Map:  69%|██████▉   | 9726/14042 [00:30<00:17, 243.52 examples/s]Map:  70%|██████▉   | 9760/14042 [00:30<00:16, 259.06 examples/s]Map:  70%|██████▉   | 9796/14042 [00:30<00:15, 278.51 examples/s]Map:  70%|███████   | 9833/14042 [00:30<00:14, 298.00 examples/s]Map:  70%|███████   | 9871/14042 [00:30<00:13, 315.03 examples/s]Map:  71%|███████   | 9906/14042 [00:30<00:12, 322.62 examples/s]Map:  71%|███████   | 9944/14042 [00:30<00:12, 334.01 examples/s]Map:  71%|███████   | 9981/14042 [00:30<00:11, 342.17 examples/s]Map:  71%|███████▏  | 10017/14042 [00:31<00:23, 167.80 examples/s]Map:  72%|███████▏  | 10057/14042 [00:31<00:19, 204.42 examples/s]Map:  72%|███████▏  | 10099/14042 [00:31<00:16, 243.09 examples/s]Map:  72%|███████▏  | 10141/14042 [00:31<00:14, 277.91 examples/s]Map:  72%|███████▏  | 10180/14042 [00:31<00:12, 302.00 examples/s]Map:  73%|███████▎  | 10221/14042 [00:31<00:11, 326.55 examples/s]Map:  73%|███████▎  | 10261/14042 [00:31<00:11, 343.71 examples/s]Map:  73%|███████▎  | 10302/14042 [00:31<00:10, 360.63 examples/s]Map:  74%|███████▎  | 10341/14042 [00:32<00:10, 366.42 examples/s]Map:  74%|███████▍  | 10381/14042 [00:32<00:09, 371.81 examples/s]Map:  74%|███████▍  | 10420/14042 [00:32<00:09, 373.13 examples/s]Map:  74%|███████▍  | 10459/14042 [00:32<00:09, 375.52 examples/s]Map:  75%|███████▍  | 10499/14042 [00:32<00:09, 378.70 examples/s]Map:  75%|███████▌  | 10538/14042 [00:32<00:09, 377.64 examples/s]Map:  75%|███████▌  | 10598/14042 [00:32<00:09, 382.02 examples/s]Map:  76%|███████▌  | 10639/14042 [00:32<00:08, 387.25 examples/s]Map:  76%|███████▌  | 10680/14042 [00:32<00:08, 389.44 examples/s]Map:  76%|███████▋  | 10720/14042 [00:33<00:08, 389.24 examples/s]Map:  77%|███████▋  | 10760/14042 [00:33<00:08, 391.38 examples/s]Map:  77%|███████▋  | 10819/14042 [00:33<00:08, 388.67 examples/s]Map:  77%|███████▋  | 10862/14042 [00:33<00:08, 395.03 examples/s]Map:  78%|███████▊  | 10922/14042 [00:33<00:07, 393.37 examples/s]Map:  78%|███████▊  | 10963/14042 [00:33<00:07, 394.14 examples/s]Map:  78%|███████▊  | 11019/14042 [00:34<00:14, 207.66 examples/s]Map:  79%|███████▉  | 11060/14042 [00:34<00:12, 237.22 examples/s]Map:  79%|███████▉  | 11102/14042 [00:34<00:10, 268.22 examples/s]Map:  79%|███████▉  | 11143/14042 [00:34<00:09, 295.58 examples/s]Map:  80%|███████▉  | 11186/14042 [00:34<00:08, 323.51 examples/s]Map:  80%|███████▉  | 11225/14042 [00:34<00:08, 338.12 examples/s]Map:  80%|████████  | 11282/14042 [00:34<00:07, 349.85 examples/s]Map:  81%|████████  | 11322/14042 [00:34<00:07, 358.20 examples/s]Map:  81%|████████  | 11379/14042 [00:35<00:07, 363.11 examples/s]Map:  81%|████████▏ | 11433/14042 [00:35<00:07, 358.09 examples/s]Map:  82%|████████▏ | 11470/14042 [00:35<00:07, 359.00 examples/s]Map:  82%|████████▏ | 11511/14042 [00:35<00:06, 367.78 examples/s]Map:  82%|████████▏ | 11552/14042 [00:35<00:06, 378.20 examples/s]Map:  83%|████████▎ | 11591/14042 [00:35<00:06, 380.09 examples/s]Map:  83%|████████▎ | 11631/14042 [00:35<00:06, 384.14 examples/s]Map:  83%|████████▎ | 11674/14042 [00:35<00:06, 392.07 examples/s]Map:  83%|████████▎ | 11715/14042 [00:36<00:05, 396.82 examples/s]Map:  84%|████████▎ | 11757/14042 [00:36<00:05, 402.23 examples/s]Map:  84%|████████▍ | 11817/14042 [00:36<00:05, 398.71 examples/s]Map:  84%|████████▍ | 11859/14042 [00:36<00:05, 400.95 examples/s]Map:  85%|████████▍ | 11901/14042 [00:36<00:05, 403.19 examples/s]Map:  85%|████████▌ | 11962/14042 [00:36<00:05, 400.39 examples/s]Map:  86%|████████▌ | 12019/14042 [00:37<00:09, 215.06 examples/s]Map:  86%|████████▌ | 12060/14042 [00:37<00:08, 243.45 examples/s]Map:  86%|████████▌ | 12102/14042 [00:37<00:07, 273.22 examples/s]Map:  86%|████████▋ | 12142/14042 [00:37<00:06, 296.58 examples/s]Map:  87%|████████▋ | 12182/14042 [00:37<00:05, 318.41 examples/s]Map:  87%|████████▋ | 12224/14042 [00:37<00:05, 339.88 examples/s]Map:  87%|████████▋ | 12266/14042 [00:37<00:04, 355.92 examples/s]Map:  88%|████████▊ | 12307/14042 [00:37<00:04, 368.14 examples/s]Map:  88%|████████▊ | 12366/14042 [00:38<00:04, 371.29 examples/s]Map:  88%|████████▊ | 12405/14042 [00:38<00:04, 373.40 examples/s]Map:  89%|████████▊ | 12446/14042 [00:38<00:04, 380.59 examples/s]Map:  89%|████████▉ | 12487/14042 [00:38<00:04, 383.30 examples/s]Map:  89%|████████▉ | 12527/14042 [00:38<00:03, 385.93 examples/s]Map:  90%|████████▉ | 12586/14042 [00:38<00:03, 384.92 examples/s]Map:  90%|████████▉ | 12628/14042 [00:38<00:03, 390.56 examples/s]Map:  90%|█████████ | 12687/14042 [00:38<00:03, 389.39 examples/s]Map:  91%|█████████ | 12727/14042 [00:38<00:03, 388.69 examples/s]Map:  91%|█████████ | 12767/14042 [00:39<00:03, 391.39 examples/s]Map:  91%|█████████ | 12808/14042 [00:39<00:03, 393.73 examples/s]Map:  92%|█████████▏| 12850/14042 [00:39<00:03, 396.41 examples/s]Map:  92%|█████████▏| 12891/14042 [00:39<00:02, 395.45 examples/s]Map:  92%|█████████▏| 12931/14042 [00:39<00:02, 393.85 examples/s]Map:  92%|█████████▏| 12972/14042 [00:39<00:02, 394.68 examples/s]Map:  93%|█████████▎| 13019/14042 [00:40<00:05, 201.72 examples/s]Map:  93%|█████████▎| 13060/14042 [00:40<00:04, 235.39 examples/s]Map:  93%|█████████▎| 13101/14042 [00:40<00:03, 267.56 examples/s]Map:  94%|█████████▎| 13141/14042 [00:40<00:03, 293.75 examples/s]Map:  94%|█████████▍| 13182/14042 [00:40<00:02, 320.15 examples/s]Map:  94%|█████████▍| 13221/14042 [00:40<00:02, 336.30 examples/s]Map:  94%|█████████▍| 13263/14042 [00:40<00:02, 355.18 examples/s]Map:  95%|█████████▍| 13306/14042 [00:40<00:01, 373.41 examples/s]Map:  95%|█████████▌| 13366/14042 [00:40<00:01, 379.59 examples/s]Map:  95%|█████████▌| 13406/14042 [00:40<00:01, 383.54 examples/s]Map:  96%|█████████▌| 13449/14042 [00:41<00:01, 393.80 examples/s]Map:  96%|█████████▌| 13508/14042 [00:41<00:01, 392.83 examples/s]Map:  96%|█████████▋| 13548/14042 [00:41<00:01, 392.47 examples/s]Map:  97%|█████████▋| 13589/14042 [00:41<00:01, 396.11 examples/s]Map:  97%|█████████▋| 13632/14042 [00:41<00:01, 402.02 examples/s]Map:  98%|█████████▊| 13691/14042 [00:41<00:00, 397.82 examples/s]Map:  98%|█████████▊| 13733/14042 [00:41<00:00, 399.98 examples/s]Map:  98%|█████████▊| 13775/14042 [00:41<00:00, 401.39 examples/s]Map:  98%|█████████▊| 13817/14042 [00:42<00:00, 402.68 examples/s]Map:  99%|█████████▊| 13859/14042 [00:42<00:00, 403.85 examples/s]Map:  99%|█████████▉| 13900/14042 [00:42<00:00, 404.01 examples/s]Map:  99%|█████████▉| 13941/14042 [00:42<00:00, 404.17 examples/s]Map: 100%|█████████▉| 14000/14042 [00:42<00:00, 213.71 examples/s]Map: 100%|█████████▉| 14041/14042 [00:42<00:00, 244.65 examples/s]Map: 100%|██████████| 14042/14042 [00:46<00:00, 299.48 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 28/10042 [00:00<00:36, 271.92 examples/s]Map:   1%|          | 58/10042 [00:00<00:35, 284.62 examples/s]Map:   1%|          | 90/10042 [00:00<00:33, 294.07 examples/s]Map:   1%|          | 122/10042 [00:00<00:32, 300.61 examples/s]Map:   2%|▏         | 154/10042 [00:00<00:32, 303.51 examples/s]Map:   2%|▏         | 186/10042 [00:00<00:32, 307.13 examples/s]Map:   2%|▏         | 218/10042 [00:00<00:32, 306.85 examples/s]Map:   2%|▏         | 250/10042 [00:00<00:31, 308.02 examples/s]Map:   3%|▎         | 291/10042 [00:01<00:47, 203.54 examples/s]Map:   3%|▎         | 323/10042 [00:01<00:42, 226.09 examples/s]Map:   4%|▎         | 356/10042 [00:01<00:39, 247.51 examples/s]Map:   4%|▍         | 389/10042 [00:01<00:36, 264.83 examples/s]Map:   4%|▍         | 421/10042 [00:01<00:34, 277.58 examples/s]Map:   5%|▍         | 453/10042 [00:01<00:33, 287.87 examples/s]Map:   5%|▍         | 485/10042 [00:01<00:32, 295.35 examples/s]Map:   5%|▌         | 517/10042 [00:01<00:31, 301.57 examples/s]Map:   5%|▌         | 550/10042 [00:01<00:31, 305.80 examples/s]Map:   6%|▌         | 582/10042 [00:02<00:30, 308.65 examples/s]Map:   6%|▌         | 614/10042 [00:02<00:30, 310.01 examples/s]Map:   6%|▋         | 647/10042 [00:02<00:30, 312.70 examples/s]Map:   7%|▋         | 679/10042 [00:02<00:30, 310.70 examples/s]Map:   7%|▋         | 711/10042 [00:02<00:30, 310.29 examples/s]Map:   7%|▋         | 743/10042 [00:02<00:29, 312.29 examples/s]Map:   8%|▊         | 775/10042 [00:02<00:29, 312.25 examples/s]Map:   8%|▊         | 808/10042 [00:02<00:29, 314.05 examples/s]Map:   8%|▊         | 840/10042 [00:02<00:29, 313.43 examples/s]Map:   9%|▊         | 873/10042 [00:02<00:29, 315.22 examples/s]Map:   9%|▉         | 905/10042 [00:03<00:29, 314.45 examples/s]Map:   9%|▉         | 952/10042 [00:03<00:29, 309.64 examples/s]Map:  10%|▉         | 984/10042 [00:03<00:29, 310.22 examples/s]Map:  10%|█         | 1031/10042 [00:04<01:14, 120.22 examples/s]Map:  11%|█         | 1063/10042 [00:04<01:02, 143.37 examples/s]Map:  11%|█         | 1095/10042 [00:04<00:53, 168.00 examples/s]Map:  11%|█         | 1128/10042 [00:04<00:45, 194.50 examples/s]Map:  12%|█▏        | 1161/10042 [00:04<00:40, 218.76 examples/s]Map:  12%|█▏        | 1194/10042 [00:04<00:36, 241.01 examples/s]Map:  12%|█▏        | 1227/10042 [00:04<00:34, 259.23 examples/s]Map:  13%|█▎        | 1259/10042 [00:04<00:32, 272.78 examples/s]Map:  13%|█▎        | 1291/10042 [00:04<00:30, 282.56 examples/s]Map:  13%|█▎        | 1323/10042 [00:05<00:30, 290.17 examples/s]Map:  13%|█▎        | 1355/10042 [00:05<00:29, 294.99 examples/s]Map:  14%|█▍        | 1387/10042 [00:05<00:28, 300.27 examples/s]Map:  14%|█▍        | 1419/10042 [00:05<00:28, 304.70 examples/s]Map:  14%|█▍        | 1451/10042 [00:05<00:27, 307.31 examples/s]Map:  15%|█▍        | 1484/10042 [00:05<00:27, 310.49 examples/s]Map:  15%|█▌        | 1516/10042 [00:05<00:27, 312.74 examples/s]Map:  15%|█▌        | 1549/10042 [00:05<00:27, 313.74 examples/s]Map:  16%|█▌        | 1581/10042 [00:05<00:27, 313.13 examples/s]Map:  16%|█▌        | 1613/10042 [00:06<00:26, 313.26 examples/s]Map:  16%|█▋        | 1645/10042 [00:06<00:26, 312.80 examples/s]Map:  17%|█▋        | 1692/10042 [00:06<00:26, 309.78 examples/s]Map:  17%|█▋        | 1724/10042 [00:06<00:26, 312.04 examples/s]Map:  17%|█▋        | 1756/10042 [00:06<00:26, 311.52 examples/s]Map:  18%|█▊        | 1788/10042 [00:06<00:26, 311.13 examples/s]Map:  18%|█▊        | 1820/10042 [00:06<00:26, 312.06 examples/s]Map:  18%|█▊        | 1852/10042 [00:06<00:26, 311.90 examples/s]Map:  19%|█▉        | 1884/10042 [00:06<00:26, 313.41 examples/s]Map:  19%|█▉        | 1916/10042 [00:06<00:25, 314.25 examples/s]Map:  19%|█▉        | 1948/10042 [00:07<00:25, 313.52 examples/s]Map:  20%|█▉        | 1980/10042 [00:07<00:25, 313.35 examples/s]Map:  20%|██        | 2015/10042 [00:07<00:54, 147.26 examples/s]Map:  20%|██        | 2048/10042 [00:07<00:45, 175.28 examples/s]Map:  21%|██        | 2080/10042 [00:07<00:39, 200.39 examples/s]Map:  21%|██        | 2112/10042 [00:08<00:35, 223.72 examples/s]Map:  21%|██▏       | 2144/10042 [00:08<00:32, 243.62 examples/s]Map:  22%|██▏       | 2176/10042 [00:08<00:30, 261.11 examples/s]Map:  22%|██▏       | 2208/10042 [00:08<00:28, 274.19 examples/s]Map:  22%|██▏       | 2240/10042 [00:08<00:27, 285.20 examples/s]Map:  23%|██▎       | 2272/10042 [00:08<00:26, 292.34 examples/s]Map:  23%|██▎       | 2305/10042 [00:08<00:25, 299.50 examples/s]Map:  23%|██▎       | 2337/10042 [00:08<00:25, 304.17 examples/s]Map:  24%|██▎       | 2371/10042 [00:08<00:24, 309.34 examples/s]Map:  24%|██▍       | 2403/10042 [00:08<00:24, 311.01 examples/s]Map:  24%|██▍       | 2436/10042 [00:09<00:24, 312.34 examples/s]Map:  25%|██▍       | 2468/10042 [00:09<00:24, 312.57 examples/s]Map:  25%|██▍       | 2501/10042 [00:09<00:23, 314.67 examples/s]Map:  25%|██▌       | 2534/10042 [00:09<00:23, 315.14 examples/s]Map:  26%|██▌       | 2566/10042 [00:09<00:23, 315.16 examples/s]Map:  26%|██▌       | 2598/10042 [00:09<00:23, 313.78 examples/s]Map:  26%|██▌       | 2630/10042 [00:09<00:23, 314.47 examples/s]Map:  27%|██▋       | 2662/10042 [00:09<00:23, 313.11 examples/s]Map:  27%|██▋       | 2695/10042 [00:09<00:23, 313.96 examples/s]Map:  27%|██▋       | 2727/10042 [00:09<00:23, 312.52 examples/s]Map:  27%|██▋       | 2759/10042 [00:10<00:23, 312.24 examples/s]Map:  28%|██▊       | 2791/10042 [00:10<00:23, 312.45 examples/s]Map:  28%|██▊       | 2824/10042 [00:10<00:23, 313.02 examples/s]Map:  28%|██▊       | 2856/10042 [00:10<00:22, 314.14 examples/s]Map:  29%|██▉       | 2888/10042 [00:10<00:22, 314.52 examples/s]Map:  29%|██▉       | 2921/10042 [00:10<00:22, 315.18 examples/s]Map:  29%|██▉       | 2953/10042 [00:10<00:22, 314.14 examples/s]Map:  30%|██▉       | 2985/10042 [00:10<00:22, 313.12 examples/s]Map:  30%|███       | 3031/10042 [00:11<00:44, 157.51 examples/s]Map:  31%|███       | 3063/10042 [00:11<00:38, 182.55 examples/s]Map:  31%|███       | 3095/10042 [00:11<00:33, 206.52 examples/s]Map:  31%|███       | 3127/10042 [00:11<00:30, 229.25 examples/s]Map:  31%|███▏      | 3159/10042 [00:11<00:27, 248.14 examples/s]Map:  32%|███▏      | 3191/10042 [00:11<00:25, 263.70 examples/s]Map:  32%|███▏      | 3223/10042 [00:11<00:24, 275.29 examples/s]Map:  32%|███▏      | 3254/10042 [00:12<00:23, 283.47 examples/s]Map:  33%|███▎      | 3299/10042 [00:12<00:23, 285.99 examples/s]Map:  33%|███▎      | 3329/10042 [00:12<00:23, 287.33 examples/s]Map:  33%|███▎      | 3359/10042 [00:12<00:23, 288.65 examples/s]Map:  34%|███▎      | 3389/10042 [00:12<00:22, 289.28 examples/s]Map:  34%|███▍      | 3419/10042 [00:12<00:22, 290.18 examples/s]Map:  34%|███▍      | 3449/10042 [00:12<00:22, 291.08 examples/s]Map:  35%|███▍      | 3479/10042 [00:12<00:22, 291.60 examples/s]Map:  35%|███▍      | 3509/10042 [00:12<00:22, 291.68 examples/s]Map:  35%|███▌      | 3539/10042 [00:13<00:22, 291.19 examples/s]Map:  36%|███▌      | 3569/10042 [00:13<00:22, 292.20 examples/s]Map:  36%|███▌      | 3613/10042 [00:13<00:22, 288.37 examples/s]Map:  36%|███▋      | 3643/10042 [00:13<00:22, 288.89 examples/s]Map:  37%|███▋      | 3673/10042 [00:13<00:22, 286.72 examples/s]Map:  37%|███▋      | 3703/10042 [00:13<00:22, 287.24 examples/s]Map:  37%|███▋      | 3733/10042 [00:13<00:21, 289.40 examples/s]Map:  38%|███▊      | 3776/10042 [00:13<00:21, 287.02 examples/s]Map:  38%|███▊      | 3806/10042 [00:13<00:21, 288.06 examples/s]Map:  38%|███▊      | 3836/10042 [00:14<00:21, 287.96 examples/s]Map:  38%|███▊      | 3866/10042 [00:14<00:21, 287.75 examples/s]Map:  39%|███▉      | 3896/10042 [00:14<00:21, 288.88 examples/s]Map:  39%|███▉      | 3926/10042 [00:14<00:21, 289.08 examples/s]Map:  39%|███▉      | 3956/10042 [00:14<00:21, 288.67 examples/s]Map:  40%|███▉      | 3986/10042 [00:14<00:20, 290.22 examples/s]Map:  40%|████      | 4030/10042 [00:15<00:40, 147.45 examples/s]Map:  40%|████      | 4060/10042 [00:15<00:35, 170.03 examples/s]Map:  41%|████      | 4089/10042 [00:15<00:31, 190.70 examples/s]Map:  41%|████      | 4119/10042 [00:15<00:27, 211.67 examples/s]Map:  41%|████▏     | 4149/10042 [00:15<00:25, 229.07 examples/s]Map:  42%|████▏     | 4179/10042 [00:15<00:24, 244.04 examples/s]Map:  42%|████▏     | 4209/10042 [00:15<00:22, 256.55 examples/s]Map:  42%|████▏     | 4239/10042 [00:15<00:21, 264.71 examples/s]Map:  43%|████▎     | 4269/10042 [00:15<00:21, 272.45 examples/s]Map:  43%|████▎     | 4300/10042 [00:16<00:20, 278.74 examples/s]Map:  43%|████▎     | 4330/10042 [00:16<00:20, 282.06 examples/s]Map:  43%|████▎     | 4360/10042 [00:16<00:19, 284.32 examples/s]Map:  44%|████▎     | 4391/10042 [00:16<00:19, 288.16 examples/s]Map:  44%|████▍     | 4421/10042 [00:16<00:19, 290.12 examples/s]Map:  44%|████▍     | 4451/10042 [00:16<00:19, 290.80 examples/s]Map:  45%|████▍     | 4481/10042 [00:16<00:19, 291.78 examples/s]Map:  45%|████▍     | 4511/10042 [00:16<00:18, 292.00 examples/s]Map:  45%|████▌     | 4555/10042 [00:16<00:19, 288.61 examples/s]Map:  46%|████▌     | 4597/10042 [00:17<00:19, 282.28 examples/s]Map:  46%|████▌     | 4639/10042 [00:17<00:19, 277.68 examples/s]Map:  46%|████▋     | 4669/10042 [00:17<00:19, 281.14 examples/s]Map:  47%|████▋     | 4699/10042 [00:17<00:18, 285.47 examples/s]Map:  47%|████▋     | 4729/10042 [00:17<00:18, 285.70 examples/s]Map:  47%|████▋     | 4760/10042 [00:17<00:18, 288.61 examples/s]Map:  48%|████▊     | 4790/10042 [00:17<00:18, 289.72 examples/s]Map:  48%|████▊     | 4820/10042 [00:17<00:17, 290.93 examples/s]Map:  48%|████▊     | 4864/10042 [00:17<00:17, 289.27 examples/s]Map:  49%|████▊     | 4894/10042 [00:18<00:17, 291.12 examples/s]Map:  49%|████▉     | 4924/10042 [00:18<00:17, 290.14 examples/s]Map:  49%|████▉     | 4954/10042 [00:18<00:17, 290.30 examples/s]Map:  50%|████▉     | 4984/10042 [00:18<00:17, 290.40 examples/s]Map:  50%|████▉     | 5014/10042 [00:19<00:45, 111.07 examples/s]Map:  50%|█████     | 5043/10042 [00:19<00:37, 134.58 examples/s]Map:  51%|█████     | 5073/10042 [00:19<00:31, 159.68 examples/s]Map:  51%|█████     | 5103/10042 [00:19<00:26, 184.34 examples/s]Map:  51%|█████     | 5133/10042 [00:19<00:23, 206.80 examples/s]Map:  51%|█████▏    | 5163/10042 [00:19<00:21, 225.60 examples/s]Map:  52%|█████▏    | 5193/10042 [00:19<00:20, 241.92 examples/s]Map:  52%|█████▏    | 5223/10042 [00:19<00:18, 255.90 examples/s]Map:  52%|█████▏    | 5253/10042 [00:19<00:17, 266.36 examples/s]Map:  53%|█████▎    | 5284/10042 [00:20<00:17, 275.32 examples/s]Map:  53%|█████▎    | 5314/10042 [00:20<00:16, 280.67 examples/s]Map:  53%|█████▎    | 5344/10042 [00:20<00:16, 283.82 examples/s]Map:  54%|█████▎    | 5374/10042 [00:20<00:16, 285.88 examples/s]Map:  54%|█████▍    | 5405/10042 [00:20<00:16, 288.42 examples/s]Map:  54%|█████▍    | 5436/10042 [00:20<00:15, 291.36 examples/s]Map:  54%|█████▍    | 5466/10042 [00:20<00:15, 292.33 examples/s]Map:  55%|█████▍    | 5510/10042 [00:20<00:15, 287.99 examples/s]Map:  55%|█████▌    | 5540/10042 [00:20<00:15, 289.15 examples/s]Map:  55%|█████▌    | 5570/10042 [00:20<00:15, 290.55 examples/s]Map:  56%|█████▌    | 5600/10042 [00:21<00:15, 291.47 examples/s]Map:  56%|█████▌    | 5630/10042 [00:21<00:15, 291.70 examples/s]Map:  56%|█████▋    | 5660/10042 [00:21<00:15, 291.13 examples/s]Map:  57%|█████▋    | 5690/10042 [00:21<00:14, 291.09 examples/s]Map:  57%|█████▋    | 5720/10042 [00:21<00:14, 291.58 examples/s]Map:  57%|█████▋    | 5750/10042 [00:21<00:14, 290.26 examples/s]Map:  58%|█████▊    | 5780/10042 [00:21<00:14, 290.53 examples/s]Map:  58%|█████▊    | 5811/10042 [00:21<00:14, 292.24 examples/s]Map:  58%|█████▊    | 5841/10042 [00:21<00:14, 291.86 examples/s]Map:  58%|█████▊    | 5871/10042 [00:22<00:14, 290.91 examples/s]Map:  59%|█████▉    | 5901/10042 [00:22<00:14, 290.54 examples/s]Map:  59%|█████▉    | 5931/10042 [00:22<00:14, 291.58 examples/s]Map:  59%|█████▉    | 5961/10042 [00:22<00:13, 292.89 examples/s]Map:  60%|█████▉    | 5991/10042 [00:22<00:13, 294.38 examples/s]Map:  60%|██████    | 6029/10042 [00:22<00:27, 146.40 examples/s]Map:  60%|██████    | 6059/10042 [00:23<00:23, 170.47 examples/s]Map:  61%|██████    | 6089/10042 [00:23<00:20, 193.58 examples/s]Map:  61%|██████    | 6119/10042 [00:23<00:18, 213.88 examples/s]Map:  61%|██████    | 6149/10042 [00:23<00:16, 231.11 examples/s]Map:  62%|██████▏   | 6180/10042 [00:23<00:15, 247.15 examples/s]Map:  62%|██████▏   | 6210/10042 [00:23<00:14, 257.81 examples/s]Map:  62%|██████▏   | 6240/10042 [00:23<00:14, 266.87 examples/s]Map:  62%|██████▏   | 6270/10042 [00:23<00:13, 273.96 examples/s]Map:  63%|██████▎   | 6300/10042 [00:23<00:13, 279.22 examples/s]Map:  63%|██████▎   | 6331/10042 [00:23<00:13, 284.19 examples/s]Map:  63%|██████▎   | 6361/10042 [00:24<00:12, 287.30 examples/s]Map:  64%|██████▎   | 6391/10042 [00:24<00:12, 289.09 examples/s]Map:  64%|██████▍   | 6421/10042 [00:24<00:12, 290.23 examples/s]Map:  64%|██████▍   | 6452/10042 [00:24<00:12, 293.79 examples/s]Map:  65%|██████▍   | 6482/10042 [00:24<00:12, 294.17 examples/s]Map:  65%|██████▍   | 6512/10042 [00:24<00:12, 292.49 examples/s]Map:  65%|██████▌   | 6542/10042 [00:24<00:11, 293.90 examples/s]Map:  65%|██████▌   | 6572/10042 [00:24<00:11, 295.39 examples/s]Map:  66%|██████▌   | 6603/10042 [00:24<00:11, 295.92 examples/s]Map:  66%|██████▌   | 6633/10042 [00:24<00:11, 294.30 examples/s]Map:  66%|██████▋   | 6663/10042 [00:25<00:11, 294.79 examples/s]Map:  67%|██████▋   | 6693/10042 [00:25<00:11, 294.11 examples/s]Map:  67%|██████▋   | 6723/10042 [00:25<00:11, 293.20 examples/s]Map:  67%|██████▋   | 6753/10042 [00:25<00:11, 291.72 examples/s]Map:  68%|██████▊   | 6784/10042 [00:25<00:11, 293.46 examples/s]Map:  68%|██████▊   | 6814/10042 [00:25<00:10, 293.52 examples/s]Map:  68%|██████▊   | 6844/10042 [00:25<00:10, 292.36 examples/s]Map:  68%|██████▊   | 6874/10042 [00:25<00:10, 292.52 examples/s]Map:  69%|██████▉   | 6904/10042 [00:25<00:10, 291.25 examples/s]Map:  69%|██████▉   | 6934/10042 [00:26<00:10, 290.98 examples/s]Map:  69%|██████▉   | 6978/10042 [00:26<00:10, 289.94 examples/s]Map:  70%|██████▉   | 7014/10042 [00:26<00:19, 152.61 examples/s]Map:  70%|███████   | 7043/10042 [00:26<00:17, 173.86 examples/s]Map:  70%|███████   | 7072/10042 [00:26<00:15, 194.65 examples/s]Map:  71%|███████   | 7102/10042 [00:26<00:13, 215.47 examples/s]Map:  71%|███████   | 7132/10042 [00:27<00:12, 231.84 examples/s]Map:  71%|███████▏  | 7162/10042 [00:27<00:11, 246.82 examples/s]Map:  72%|███████▏  | 7192/10042 [00:27<00:11, 258.42 examples/s]Map:  72%|███████▏  | 7223/10042 [00:27<00:10, 269.20 examples/s]Map:  72%|███████▏  | 7253/10042 [00:27<00:10, 275.43 examples/s]Map:  73%|███████▎  | 7283/10042 [00:27<00:09, 279.59 examples/s]Map:  73%|███████▎  | 7313/10042 [00:27<00:09, 282.75 examples/s]Map:  73%|███████▎  | 7343/10042 [00:27<00:09, 285.70 examples/s]Map:  73%|███████▎  | 7373/10042 [00:27<00:09, 287.34 examples/s]Map:  74%|███████▎  | 7403/10042 [00:27<00:09, 289.49 examples/s]Map:  74%|███████▍  | 7433/10042 [00:28<00:08, 291.29 examples/s]Map:  74%|███████▍  | 7463/10042 [00:28<00:08, 290.33 examples/s]Map:  75%|███████▍  | 7493/10042 [00:28<00:08, 291.56 examples/s]Map:  75%|███████▍  | 7523/10042 [00:28<00:08, 292.09 examples/s]Map:  75%|███████▌  | 7553/10042 [00:28<00:08, 292.77 examples/s]Map:  76%|███████▌  | 7584/10042 [00:28<00:08, 293.72 examples/s]Map:  76%|███████▌  | 7614/10042 [00:28<00:08, 294.13 examples/s]Map:  76%|███████▌  | 7644/10042 [00:28<00:08, 294.96 examples/s]Map:  76%|███████▋  | 7674/10042 [00:28<00:08, 295.25 examples/s]Map:  77%|███████▋  | 7704/10042 [00:29<00:07, 296.14 examples/s]Map:  77%|███████▋  | 7734/10042 [00:29<00:07, 293.70 examples/s]Map:  77%|███████▋  | 7764/10042 [00:29<00:07, 293.83 examples/s]Map:  78%|███████▊  | 7794/10042 [00:29<00:07, 293.25 examples/s]Map:  78%|███████▊  | 7824/10042 [00:29<00:07, 293.45 examples/s]Map:  78%|███████▊  | 7854/10042 [00:29<00:07, 293.25 examples/s]Map:  79%|███████▊  | 7885/10042 [00:29<00:07, 294.97 examples/s]Map:  79%|███████▉  | 7915/10042 [00:29<00:07, 294.64 examples/s]Map:  79%|███████▉  | 7945/10042 [00:29<00:07, 294.86 examples/s]Map:  79%|███████▉  | 7975/10042 [00:29<00:07, 293.80 examples/s]Map:  80%|███████▉  | 8014/10042 [00:30<00:13, 149.45 examples/s]Map:  80%|████████  | 8044/10042 [00:30<00:11, 173.29 examples/s]Map:  80%|████████  | 8074/10042 [00:30<00:10, 195.98 examples/s]Map:  81%|████████  | 8103/10042 [00:30<00:09, 214.98 examples/s]Map:  81%|████████  | 8132/10042 [00:30<00:08, 230.51 examples/s]Map:  81%|████████▏ | 8162/10042 [00:30<00:07, 246.39 examples/s]Map:  82%|████████▏ | 8192/10042 [00:31<00:07, 256.29 examples/s]Map:  82%|████████▏ | 8222/10042 [00:31<00:06, 266.04 examples/s]Map:  82%|████████▏ | 8252/10042 [00:31<00:06, 273.43 examples/s]Map:  82%|████████▏ | 8281/10042 [00:31<00:06, 277.16 examples/s]Map:  83%|████████▎ | 8311/10042 [00:31<00:06, 281.19 examples/s]Map:  83%|████████▎ | 8341/10042 [00:31<00:05, 284.14 examples/s]Map:  83%|████████▎ | 8371/10042 [00:31<00:05, 287.61 examples/s]Map:  84%|████████▍ | 8414/10042 [00:31<00:05, 283.42 examples/s]Map:  84%|████████▍ | 8444/10042 [00:31<00:05, 284.13 examples/s]Map:  84%|████████▍ | 8474/10042 [00:32<00:05, 285.12 examples/s]Map:  85%|████████▍ | 8503/10042 [00:32<00:05, 283.19 examples/s]Map:  85%|████████▍ | 8533/10042 [00:32<00:05, 285.07 examples/s]Map:  85%|████████▌ | 8563/10042 [00:32<00:05, 286.73 examples/s]Map:  86%|████████▌ | 8592/10042 [00:32<00:05, 286.67 examples/s]Map:  86%|████████▌ | 8622/10042 [00:32<00:04, 287.61 examples/s]Map:  86%|████████▌ | 8652/10042 [00:32<00:04, 288.25 examples/s]Map:  86%|████████▋ | 8682/10042 [00:32<00:04, 287.28 examples/s]Map:  87%|████████▋ | 8712/10042 [00:32<00:04, 288.69 examples/s]Map:  87%|████████▋ | 8742/10042 [00:32<00:04, 289.60 examples/s]Map:  87%|████████▋ | 8772/10042 [00:33<00:04, 287.56 examples/s]Map:  88%|████████▊ | 8802/10042 [00:33<00:04, 289.24 examples/s]Map:  88%|████████▊ | 8832/10042 [00:33<00:04, 290.34 examples/s]Map:  88%|████████▊ | 8862/10042 [00:33<00:04, 291.46 examples/s]Map:  89%|████████▊ | 8892/10042 [00:33<00:03, 290.97 examples/s]Map:  89%|████████▉ | 8922/10042 [00:33<00:03, 290.47 examples/s]Map:  89%|████████▉ | 8952/10042 [00:33<00:03, 289.72 examples/s]Map:  89%|████████▉ | 8982/10042 [00:33<00:03, 289.72 examples/s]Map:  90%|████████▉ | 9013/10042 [00:34<00:07, 139.96 examples/s]Map:  90%|█████████ | 9043/10042 [00:34<00:06, 164.85 examples/s]Map:  90%|█████████ | 9073/10042 [00:34<00:05, 189.51 examples/s]Map:  91%|█████████ | 9103/10042 [00:34<00:04, 211.24 examples/s]Map:  91%|█████████ | 9132/10042 [00:34<00:04, 227.11 examples/s]Map:  91%|█████████ | 9162/10042 [00:34<00:03, 242.61 examples/s]Map:  92%|█████████▏| 9190/10042 [00:34<00:03, 251.32 examples/s]Map:  92%|█████████▏| 9220/10042 [00:34<00:03, 262.08 examples/s]Map:  92%|█████████▏| 9250/10042 [00:35<00:02, 269.42 examples/s]Map:  92%|█████████▏| 9279/10042 [00:35<00:02, 272.46 examples/s]Map:  93%|█████████▎| 9309/10042 [00:35<00:02, 277.52 examples/s]Map:  93%|█████████▎| 9339/10042 [00:35<00:02, 281.24 examples/s]Map:  93%|█████████▎| 9369/10042 [00:35<00:02, 284.31 examples/s]Map:  94%|█████████▎| 9399/10042 [00:35<00:02, 286.63 examples/s]Map:  94%|█████████▍| 9428/10042 [00:35<00:02, 286.44 examples/s]Map:  94%|█████████▍| 9458/10042 [00:35<00:02, 286.00 examples/s]Map:  94%|█████████▍| 9487/10042 [00:35<00:01, 285.32 examples/s]Map:  95%|█████████▍| 9517/10042 [00:36<00:01, 287.74 examples/s]Map:  95%|█████████▌| 9547/10042 [00:36<00:01, 288.29 examples/s]Map:  95%|█████████▌| 9576/10042 [00:36<00:01, 286.30 examples/s]Map:  96%|█████████▌| 9606/10042 [00:36<00:01, 288.57 examples/s]Map:  96%|█████████▌| 9649/10042 [00:36<00:01, 283.81 examples/s]Map:  96%|█████████▋| 9679/10042 [00:36<00:01, 285.81 examples/s]Map:  97%|█████████▋| 9709/10042 [00:36<00:01, 287.31 examples/s]Map:  97%|█████████▋| 9738/10042 [00:36<00:01, 287.26 examples/s]Map:  97%|█████████▋| 9768/10042 [00:36<00:00, 287.58 examples/s]Map:  98%|█████████▊| 9798/10042 [00:37<00:00, 289.05 examples/s]Map:  98%|█████████▊| 9828/10042 [00:37<00:00, 290.44 examples/s]Map:  98%|█████████▊| 9858/10042 [00:37<00:00, 290.10 examples/s]Map:  98%|█████████▊| 9888/10042 [00:37<00:00, 290.27 examples/s]Map:  99%|█████████▉| 9918/10042 [00:37<00:00, 289.63 examples/s]Map:  99%|█████████▉| 9948/10042 [00:37<00:00, 290.32 examples/s]Map:  99%|█████████▉| 9978/10042 [00:37<00:00, 291.07 examples/s]Map: 100%|█████████▉| 10014/10042 [00:38<00:00, 115.85 examples/s]Map: 100%|██████████| 10042/10042 [00:38<00:00, 119.39 examples/s]Map: 100%|██████████| 10042/10042 [00:38<00:00, 260.73 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   6%|▌         | 79/1267 [00:00<00:01, 775.72 examples/s]Map:  13%|█▎        | 162/1267 [00:00<00:01, 801.09 examples/s]Map:  19%|█▉        | 247/1267 [00:00<00:01, 816.63 examples/s]Map:  26%|██▌       | 331/1267 [00:00<00:01, 821.95 examples/s]Map:  33%|███▎      | 417/1267 [00:00<00:01, 831.94 examples/s]Map:  40%|███▉      | 503/1267 [00:00<00:00, 840.02 examples/s]Map:  47%|████▋     | 590/1267 [00:00<00:00, 846.34 examples/s]Map:  53%|█████▎    | 676/1267 [00:00<00:00, 849.47 examples/s]Map:  60%|██████    | 762/1267 [00:00<00:00, 851.67 examples/s]Map:  70%|███████   | 891/1267 [00:01<00:00, 852.94 examples/s]Map:  77%|███████▋  | 978/1267 [00:01<00:00, 853.68 examples/s]Map:  86%|████████▌ | 1085/1267 [00:01<00:00, 463.78 examples/s]Map:  92%|█████████▏| 1171/1267 [00:01<00:00, 530.59 examples/s]Map:  99%|█████████▉| 1257/1267 [00:01<00:00, 594.04 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 671.56 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  6.46it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.91it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.48it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.26it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:09,  3.25s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.56s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:10<00:03,  3.71s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.47s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.87s/it]
2024-05-20 20:44:57,387: rank0[354464][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-05-20 20:44:57,389: rank0[354464][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen4096_perdeviceBS8_worldsize4
2024-05-20 20:44:58,899: rank0[354464][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-05-20 20:44:58,916: rank0[354464][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-05-20 20:45:10,305: rank0[354464][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-05-20 20:45:10,306: rank0[354464][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-05-20 20:45:10,306: rank0[354464][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 4096
precision: amp_bf16
device_eval_batch_size: 8
global_seed: 42
seed: 42
ckpt_path: /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-6-epochs3-wu20-seed42--7905
models:
- model_name: /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-6-epochs3-wu20-seed42--7905
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-6-epochs3-wu20-seed42--7905
    use_auth_token: true
  tokenizer:
    name: /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-6-epochs3-wu20-seed42--7905
    kwargs:
      model_max_length: 4096
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-05-20 20:45:10,313: rank0[354464][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 8
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 2. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.5862
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.6427
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7790
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 6 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 6 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7601
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                           |
|:-----------|:--------------|:----------|-----------:|:------------------|:--------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.586177 | 25-shot           | /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-6-epochs3-wu20-seed42--7905 |
|            | mmlu          |           |   0.642715 | 5-shot            | /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-6-epochs3-wu20-seed42--7905 |
|            | winogrande    |           |   0.760063 | 5-shot            | /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-6-epochs3-wu20-seed42--7905 |
|            | hellaswag     |           |   0.779028 | 10-shot           | /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-6-epochs3-wu20-seed42--7905 |
2024-05-20 21:49:45,876: rank0[354464][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-05-20 21:49:45,876: rank0[354464][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-05-20 21:49:45,876: rank0[354464][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-05-20 21:49:45,876: rank0[354464][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
