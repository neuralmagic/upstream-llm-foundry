----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-05-20 22:57:16,058: rank0[365018][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 26/1172 [00:00<00:04, 242.96 examples/s]Map:   5%|▍         | 54/1172 [00:00<00:04, 257.57 examples/s]Map:   7%|▋         | 82/1172 [00:00<00:04, 262.89 examples/s]Map:   9%|▉         | 110/1172 [00:00<00:04, 265.35 examples/s]Map:  12%|█▏        | 137/1172 [00:00<00:03, 262.48 examples/s]Map:  15%|█▍        | 175/1172 [00:00<00:03, 253.02 examples/s]Map:  17%|█▋        | 203/1172 [00:00<00:03, 258.78 examples/s]Map:  20%|█▉        | 231/1172 [00:00<00:03, 261.22 examples/s]Map:  22%|██▏       | 259/1172 [00:00<00:03, 264.29 examples/s]Map:  24%|██▍       | 286/1172 [00:01<00:03, 264.24 examples/s]Map:  27%|██▋       | 314/1172 [00:01<00:03, 266.88 examples/s]Map:  29%|██▉       | 342/1172 [00:01<00:03, 269.70 examples/s]Map:  32%|███▏      | 370/1172 [00:01<00:02, 268.06 examples/s]Map:  34%|███▍      | 398/1172 [00:01<00:02, 269.11 examples/s]Map:  36%|███▋      | 426/1172 [00:01<00:02, 269.19 examples/s]Map:  39%|███▊      | 453/1172 [00:01<00:02, 266.78 examples/s]Map:  41%|████      | 481/1172 [00:01<00:02, 267.42 examples/s]Map:  43%|████▎     | 509/1172 [00:01<00:02, 268.29 examples/s]Map:  46%|████▌     | 537/1172 [00:02<00:02, 270.17 examples/s]Map:  48%|████▊     | 565/1172 [00:02<00:02, 268.51 examples/s]Map:  51%|█████     | 593/1172 [00:02<00:02, 270.68 examples/s]Map:  53%|█████▎    | 621/1172 [00:02<00:02, 270.36 examples/s]Map:  55%|█████▌    | 649/1172 [00:02<00:01, 269.48 examples/s]Map:  58%|█████▊    | 677/1172 [00:02<00:01, 270.37 examples/s]Map:  60%|██████    | 705/1172 [00:02<00:01, 270.63 examples/s]Map:  64%|██████▎   | 746/1172 [00:02<00:01, 268.63 examples/s]Map:  66%|██████▌   | 774/1172 [00:02<00:01, 269.33 examples/s]Map:  68%|██████▊   | 802/1172 [00:03<00:01, 269.98 examples/s]Map:  71%|███████   | 830/1172 [00:03<00:01, 269.12 examples/s]Map:  73%|███████▎  | 858/1172 [00:03<00:01, 269.01 examples/s]Map:  77%|███████▋  | 898/1172 [00:03<00:01, 265.41 examples/s]Map:  79%|███████▉  | 925/1172 [00:03<00:00, 264.75 examples/s]Map:  81%|████████▏ | 953/1172 [00:03<00:00, 265.99 examples/s]Map:  84%|████████▎ | 981/1172 [00:03<00:00, 267.84 examples/s]Map:  86%|████████▋ | 1013/1172 [00:04<00:01, 96.22 examples/s]Map:  89%|████████▉ | 1041/1172 [00:04<00:01, 118.34 examples/s]Map:  91%|█████████▏| 1070/1172 [00:04<00:00, 142.83 examples/s]Map:  94%|█████████▎| 1098/1172 [00:04<00:00, 166.18 examples/s]Map:  96%|█████████▌| 1127/1172 [00:04<00:00, 188.78 examples/s]Map:  99%|█████████▊| 1155/1172 [00:04<00:00, 207.64 examples/s]Map: 100%|██████████| 1172/1172 [00:05<00:00, 226.89 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 38/14042 [00:00<00:38, 365.10 examples/s]Map:   1%|          | 93/14042 [00:00<00:38, 362.67 examples/s]Map:   1%|          | 146/14042 [00:00<00:39, 355.62 examples/s]Map:   1%|▏         | 195/14042 [00:00<00:40, 338.56 examples/s]Map:   2%|▏         | 232/14042 [00:00<00:39, 345.28 examples/s]Map:   2%|▏         | 269/14042 [00:00<00:39, 349.13 examples/s]Map:   2%|▏         | 307/14042 [00:00<00:38, 356.04 examples/s]Map:   2%|▏         | 349/14042 [00:00<00:37, 369.77 examples/s]Map:   3%|▎         | 399/14042 [00:01<00:55, 244.95 examples/s]Map:   3%|▎         | 435/14042 [00:01<00:50, 267.72 examples/s]Map:   3%|▎         | 475/14042 [00:01<00:45, 295.43 examples/s]Map:   4%|▎         | 513/14042 [00:01<00:43, 313.63 examples/s]Map:   4%|▍         | 551/14042 [00:01<00:41, 327.59 examples/s]Map:   4%|▍         | 590/14042 [00:01<00:39, 342.65 examples/s]Map:   4%|▍         | 629/14042 [00:01<00:37, 353.86 examples/s]Map:   5%|▍         | 668/14042 [00:02<00:37, 360.16 examples/s]Map:   5%|▌         | 706/14042 [00:02<00:36, 362.83 examples/s]Map:   5%|▌         | 745/14042 [00:02<00:36, 368.38 examples/s]Map:   6%|▌         | 784/14042 [00:02<00:35, 372.31 examples/s]Map:   6%|▌         | 824/14042 [00:02<00:35, 377.21 examples/s]Map:   6%|▌         | 863/14042 [00:02<00:34, 377.42 examples/s]Map:   6%|▋         | 901/14042 [00:02<00:35, 374.37 examples/s]Map:   7%|▋         | 942/14042 [00:02<00:34, 383.05 examples/s]Map:   7%|▋         | 984/14042 [00:02<00:33, 389.83 examples/s]Map:   7%|▋         | 1038/14042 [00:03<01:42, 126.45 examples/s]Map:   8%|▊         | 1077/14042 [00:03<01:23, 154.94 examples/s]Map:   8%|▊         | 1119/14042 [00:03<01:07, 190.13 examples/s]Map:   8%|▊         | 1161/14042 [00:04<00:57, 225.81 examples/s]Map:   9%|▊         | 1203/14042 [00:04<00:49, 260.17 examples/s]Map:   9%|▉         | 1241/14042 [00:04<00:44, 284.57 examples/s]Map:   9%|▉         | 1284/14042 [00:04<00:40, 315.40 examples/s]Map:   9%|▉         | 1325/14042 [00:04<00:37, 335.19 examples/s]Map:  10%|▉         | 1367/14042 [00:04<00:35, 352.31 examples/s]Map:  10%|█         | 1407/14042 [00:04<00:34, 362.90 examples/s]Map:  10%|█         | 1464/14042 [00:04<00:34, 368.20 examples/s]Map:  11%|█         | 1506/14042 [00:04<00:33, 378.65 examples/s]Map:  11%|█         | 1564/14042 [00:05<00:32, 378.40 examples/s]Map:  11%|█▏        | 1603/14042 [00:05<00:32, 376.97 examples/s]Map:  12%|█▏        | 1662/14042 [00:05<00:32, 378.26 examples/s]Map:  12%|█▏        | 1702/14042 [00:05<00:32, 381.18 examples/s]Map:  12%|█▏        | 1742/14042 [00:05<00:32, 382.23 examples/s]Map:  13%|█▎        | 1781/14042 [00:05<00:32, 382.50 examples/s]Map:  13%|█▎        | 1821/14042 [00:05<00:31, 382.73 examples/s]Map:  13%|█▎        | 1879/14042 [00:05<00:31, 381.82 examples/s]Map:  14%|█▎        | 1918/14042 [00:06<00:31, 380.52 examples/s]Map:  14%|█▍        | 1958/14042 [00:06<00:31, 382.84 examples/s]Map:  14%|█▍        | 1998/14042 [00:06<00:31, 386.55 examples/s]Map:  15%|█▍        | 2038/14042 [00:06<01:06, 179.23 examples/s]Map:  15%|█▍        | 2079/14042 [00:06<00:55, 214.49 examples/s]Map:  15%|█▌        | 2120/14042 [00:06<00:48, 246.94 examples/s]Map:  15%|█▌        | 2159/14042 [00:07<00:43, 275.67 examples/s]Map:  16%|█▌        | 2200/14042 [00:07<00:39, 303.60 examples/s]Map:  16%|█▌        | 2241/14042 [00:07<00:36, 325.67 examples/s]Map:  16%|█▋        | 2282/14042 [00:07<00:34, 344.67 examples/s]Map:  17%|█▋        | 2324/14042 [00:07<00:32, 361.07 examples/s]Map:  17%|█▋        | 2363/14042 [00:07<00:31, 366.37 examples/s]Map:  17%|█▋        | 2403/14042 [00:07<00:31, 374.04 examples/s]Map:  17%|█▋        | 2445/14042 [00:07<00:30, 382.19 examples/s]Map:  18%|█▊        | 2506/14042 [00:07<00:29, 388.32 examples/s]Map:  18%|█▊        | 2548/14042 [00:08<00:29, 393.25 examples/s]Map:  18%|█▊        | 2589/14042 [00:08<00:28, 395.02 examples/s]Map:  19%|█▊        | 2629/14042 [00:08<00:28, 395.70 examples/s]Map:  19%|█▉        | 2688/14042 [00:08<00:28, 392.71 examples/s]Map:  19%|█▉        | 2729/14042 [00:08<00:28, 393.72 examples/s]Map:  20%|█▉        | 2769/14042 [00:08<00:28, 392.79 examples/s]Map:  20%|██        | 2810/14042 [00:08<00:28, 393.62 examples/s]Map:  20%|██        | 2850/14042 [00:08<00:28, 391.09 examples/s]Map:  21%|██        | 2891/14042 [00:08<00:28, 391.77 examples/s]Map:  21%|██        | 2933/14042 [00:09<00:28, 396.54 examples/s]Map:  21%|██▏       | 2992/14042 [00:09<00:28, 390.86 examples/s]Map:  22%|██▏       | 3041/14042 [00:09<00:55, 198.60 examples/s]Map:  22%|██▏       | 3082/14042 [00:09<00:47, 229.05 examples/s]Map:  22%|██▏       | 3123/14042 [00:09<00:42, 259.96 examples/s]Map:  23%|██▎       | 3164/14042 [00:10<00:37, 287.51 examples/s]Map:  23%|██▎       | 3202/14042 [00:10<00:35, 307.31 examples/s]Map:  23%|██▎       | 3240/14042 [00:10<00:33, 324.22 examples/s]Map:  23%|██▎       | 3279/14042 [00:10<00:31, 339.35 examples/s]Map:  24%|██▎       | 3321/14042 [00:10<00:29, 359.38 examples/s]Map:  24%|██▍       | 3363/14042 [00:10<00:28, 370.96 examples/s]Map:  24%|██▍       | 3404/14042 [00:10<00:27, 380.87 examples/s]Map:  25%|██▍       | 3444/14042 [00:10<00:27, 381.47 examples/s]Map:  25%|██▍       | 3485/14042 [00:10<00:27, 388.09 examples/s]Map:  25%|██▌       | 3527/14042 [00:10<00:26, 392.71 examples/s]Map:  25%|██▌       | 3567/14042 [00:11<00:26, 393.31 examples/s]Map:  26%|██▌       | 3626/14042 [00:11<00:26, 391.24 examples/s]Map:  26%|██▌       | 3666/14042 [00:11<00:26, 390.45 examples/s]Map:  27%|██▋       | 3725/14042 [00:11<00:26, 389.97 examples/s]Map:  27%|██▋       | 3785/14042 [00:11<00:26, 388.25 examples/s]Map:  27%|██▋       | 3825/14042 [00:11<00:26, 387.14 examples/s]Map:  28%|██▊       | 3865/14042 [00:11<00:26, 387.37 examples/s]Map:  28%|██▊       | 3904/14042 [00:11<00:26, 386.70 examples/s]Map:  28%|██▊       | 3944/14042 [00:12<00:26, 386.45 examples/s]Map:  28%|██▊       | 3983/14042 [00:12<00:26, 382.50 examples/s]Map:  29%|██▉       | 4038/14042 [00:12<00:50, 197.00 examples/s]Map:  29%|██▉       | 4080/14042 [00:12<00:43, 230.58 examples/s]Map:  29%|██▉       | 4119/14042 [00:12<00:38, 258.58 examples/s]Map:  30%|██▉       | 4159/14042 [00:12<00:34, 286.90 examples/s]Map:  30%|██▉       | 4200/14042 [00:13<00:31, 313.03 examples/s]Map:  30%|███       | 4240/14042 [00:13<00:29, 331.10 examples/s]Map:  30%|███       | 4279/14042 [00:13<00:28, 343.62 examples/s]Map:  31%|███       | 4319/14042 [00:13<00:27, 354.03 examples/s]Map:  31%|███       | 4357/14042 [00:13<00:27, 358.47 examples/s]Map:  31%|███▏      | 4397/14042 [00:13<00:26, 365.46 examples/s]Map:  32%|███▏      | 4435/14042 [00:13<00:26, 369.00 examples/s]Map:  32%|███▏      | 4476/14042 [00:13<00:25, 378.62 examples/s]Map:  32%|███▏      | 4515/14042 [00:13<00:25, 379.46 examples/s]Map:  33%|███▎      | 4568/14042 [00:14<00:26, 361.33 examples/s]Map:  33%|███▎      | 4621/14042 [00:14<00:26, 354.06 examples/s]Map:  33%|███▎      | 4672/14042 [00:14<00:27, 346.26 examples/s]Map:  34%|███▎      | 4722/14042 [00:14<00:27, 338.17 examples/s]Map:  34%|███▍      | 4762/14042 [00:14<00:26, 350.32 examples/s]Map:  34%|███▍      | 4801/14042 [00:14<00:25, 358.01 examples/s]Map:  34%|███▍      | 4843/14042 [00:14<00:24, 369.56 examples/s]Map:  35%|███▍      | 4884/14042 [00:14<00:24, 378.76 examples/s]Map:  35%|███▌      | 4925/14042 [00:14<00:23, 385.25 examples/s]Map:  35%|███▌      | 4966/14042 [00:15<00:23, 388.33 examples/s]Map:  36%|███▌      | 5019/14042 [00:15<00:56, 160.67 examples/s]Map:  36%|███▌      | 5058/14042 [00:15<00:47, 190.51 examples/s]Map:  36%|███▋      | 5095/14042 [00:15<00:41, 217.08 examples/s]Map:  37%|███▋      | 5129/14042 [00:16<00:37, 238.33 examples/s]Map:  37%|███▋      | 5164/14042 [00:16<00:34, 259.38 examples/s]Map:  37%|███▋      | 5214/14042 [00:16<00:31, 278.90 examples/s]Map:  37%|███▋      | 5251/14042 [00:16<00:29, 298.04 examples/s]Map:  38%|███▊      | 5292/14042 [00:16<00:26, 324.29 examples/s]Map:  38%|███▊      | 5334/14042 [00:16<00:25, 345.68 examples/s]Map:  38%|███▊      | 5374/14042 [00:16<00:24, 357.68 examples/s]Map:  39%|███▊      | 5430/14042 [00:16<00:23, 361.13 examples/s]Map:  39%|███▉      | 5471/14042 [00:17<00:23, 369.85 examples/s]Map:  39%|███▉      | 5512/14042 [00:17<00:22, 377.19 examples/s]Map:  40%|███▉      | 5554/14042 [00:17<00:21, 385.84 examples/s]Map:  40%|███▉      | 5597/14042 [00:17<00:21, 392.19 examples/s]Map:  40%|████      | 5638/14042 [00:17<00:21, 393.00 examples/s]Map:  40%|████      | 5679/14042 [00:17<00:21, 392.92 examples/s]Map:  41%|████      | 5721/14042 [00:17<00:20, 397.33 examples/s]Map:  41%|████      | 5762/14042 [00:17<00:20, 398.31 examples/s]Map:  41%|████▏     | 5822/14042 [00:17<00:20, 395.50 examples/s]Map:  42%|████▏     | 5880/14042 [00:18<00:20, 388.69 examples/s]Map:  42%|████▏     | 5936/14042 [00:18<00:21, 377.66 examples/s]Map:  43%|████▎     | 5987/14042 [00:18<00:22, 362.68 examples/s]Map:  43%|████▎     | 6037/14042 [00:18<00:40, 199.02 examples/s]Map:  43%|████▎     | 6074/14042 [00:18<00:35, 222.18 examples/s]Map:  44%|████▎     | 6109/14042 [00:19<00:32, 242.01 examples/s]Map:  44%|████▍     | 6146/14042 [00:19<00:29, 265.05 examples/s]Map:  44%|████▍     | 6182/14042 [00:19<00:27, 283.71 examples/s]Map:  44%|████▍     | 6217/14042 [00:19<00:26, 296.84 examples/s]Map:  45%|████▍     | 6252/14042 [00:19<00:25, 309.31 examples/s]Map:  45%|████▍     | 6288/14042 [00:19<00:24, 318.57 examples/s]Map:  45%|████▌     | 6325/14042 [00:19<00:23, 328.84 examples/s]Map:  45%|████▌     | 6362/14042 [00:19<00:22, 336.82 examples/s]Map:  46%|████▌     | 6400/14042 [00:19<00:22, 346.80 examples/s]Map:  46%|████▌     | 6437/14042 [00:20<00:21, 351.37 examples/s]Map:  46%|████▌     | 6490/14042 [00:20<00:21, 348.04 examples/s]Map:  46%|████▋     | 6526/14042 [00:20<00:21, 349.76 examples/s]Map:  47%|████▋     | 6563/14042 [00:20<00:21, 351.84 examples/s]Map:  47%|████▋     | 6601/14042 [00:20<00:20, 355.50 examples/s]Map:  47%|████▋     | 6653/14042 [00:20<00:21, 349.29 examples/s]Map:  48%|████▊     | 6689/14042 [00:20<00:20, 350.29 examples/s]Map:  48%|████▊     | 6741/14042 [00:20<00:21, 344.43 examples/s]Map:  48%|████▊     | 6777/14042 [00:21<00:20, 346.19 examples/s]Map:  49%|████▊     | 6813/14042 [00:21<00:20, 345.70 examples/s]Map:  49%|████▉     | 6850/14042 [00:21<00:20, 346.73 examples/s]Map:  49%|████▉     | 6887/14042 [00:21<00:20, 349.43 examples/s]Map:  49%|████▉     | 6941/14042 [00:21<00:20, 350.21 examples/s]Map:  50%|████▉     | 6977/14042 [00:21<00:20, 351.19 examples/s]Map:  50%|████▉     | 7018/14042 [00:22<00:39, 178.36 examples/s]Map:  50%|█████     | 7054/14042 [00:22<00:33, 205.97 examples/s]Map:  50%|█████     | 7090/14042 [00:22<00:29, 233.17 examples/s]Map:  51%|█████     | 7125/14042 [00:22<00:27, 255.83 examples/s]Map:  51%|█████     | 7161/14042 [00:22<00:24, 277.04 examples/s]Map:  51%|█████▏    | 7199/14042 [00:22<00:22, 299.43 examples/s]Map:  52%|█████▏    | 7237/14042 [00:22<00:21, 317.69 examples/s]Map:  52%|█████▏    | 7272/14042 [00:22<00:20, 324.35 examples/s]Map:  52%|█████▏    | 7308/14042 [00:22<00:20, 330.36 examples/s]Map:  52%|█████▏    | 7343/14042 [00:22<00:20, 333.71 examples/s]Map:  53%|█████▎    | 7380/14042 [00:23<00:19, 340.71 examples/s]Map:  53%|█████▎    | 7416/14042 [00:23<00:19, 343.94 examples/s]Map:  53%|█████▎    | 7453/14042 [00:23<00:18, 350.49 examples/s]Map:  53%|█████▎    | 7492/14042 [00:23<00:18, 360.88 examples/s]Map:  54%|█████▎    | 7534/14042 [00:23<00:17, 373.43 examples/s]Map:  54%|█████▍    | 7574/14042 [00:23<00:17, 380.25 examples/s]Map:  54%|█████▍    | 7616/14042 [00:23<00:16, 386.85 examples/s]Map:  55%|█████▍    | 7656/14042 [00:23<00:16, 389.42 examples/s]Map:  55%|█████▍    | 7697/14042 [00:23<00:16, 393.46 examples/s]Map:  55%|█████▌    | 7738/14042 [00:24<00:16, 393.36 examples/s]Map:  56%|█████▌    | 7798/14042 [00:24<00:15, 390.54 examples/s]Map:  56%|█████▌    | 7839/14042 [00:24<00:15, 391.94 examples/s]Map:  56%|█████▌    | 7880/14042 [00:24<00:15, 395.01 examples/s]Map:  56%|█████▋    | 7921/14042 [00:24<00:15, 396.73 examples/s]Map:  57%|█████▋    | 7963/14042 [00:24<00:15, 399.24 examples/s]Map:  57%|█████▋    | 8019/14042 [00:25<00:29, 205.49 examples/s]Map:  57%|█████▋    | 8060/14042 [00:25<00:25, 237.16 examples/s]Map:  58%|█████▊    | 8100/14042 [00:25<00:22, 266.11 examples/s]Map:  58%|█████▊    | 8139/14042 [00:25<00:20, 290.92 examples/s]Map:  58%|█████▊    | 8181/14042 [00:25<00:18, 318.66 examples/s]Map:  59%|█████▊    | 8222/14042 [00:25<00:17, 337.71 examples/s]Map:  59%|█████▉    | 8262/14042 [00:25<00:16, 351.44 examples/s]Map:  59%|█████▉    | 8302/14042 [00:25<00:15, 361.51 examples/s]Map:  59%|█████▉    | 8343/14042 [00:25<00:15, 371.20 examples/s]Map:  60%|█████▉    | 8383/14042 [00:26<00:14, 378.15 examples/s]Map:  60%|█████▉    | 8424/14042 [00:26<00:14, 383.30 examples/s]Map:  60%|██████    | 8465/14042 [00:26<00:14, 387.01 examples/s]Map:  61%|██████    | 8505/14042 [00:26<00:14, 388.92 examples/s]Map:  61%|██████    | 8545/14042 [00:26<00:14, 389.60 examples/s]Map:  61%|██████    | 8588/14042 [00:26<00:13, 396.50 examples/s]Map:  61%|██████▏   | 8628/14042 [00:26<00:13, 395.33 examples/s]Map:  62%|██████▏   | 8668/14042 [00:26<00:13, 392.66 examples/s]Map:  62%|██████▏   | 8709/14042 [00:26<00:13, 393.83 examples/s]Map:  62%|██████▏   | 8767/14042 [00:26<00:13, 386.65 examples/s]Map:  63%|██████▎   | 8808/14042 [00:27<00:13, 391.66 examples/s]Map:  63%|██████▎   | 8848/14042 [00:27<00:13, 391.22 examples/s]Map:  63%|██████▎   | 8891/14042 [00:27<00:12, 400.25 examples/s]Map:  64%|██████▎   | 8932/14042 [00:27<00:12, 400.30 examples/s]Map:  64%|██████▍   | 8993/14042 [00:27<00:12, 397.38 examples/s]Map:  64%|██████▍   | 9040/14042 [00:28<00:23, 208.51 examples/s]Map:  65%|██████▍   | 9081/14042 [00:28<00:20, 239.15 examples/s]Map:  65%|██████▍   | 9122/14042 [00:28<00:18, 269.39 examples/s]Map:  65%|██████▌   | 9161/14042 [00:28<00:16, 293.14 examples/s]Map:  66%|██████▌   | 9203/14042 [00:28<00:15, 319.31 examples/s]Map:  66%|██████▌   | 9244/14042 [00:28<00:14, 338.42 examples/s]Map:  66%|██████▌   | 9285/14042 [00:28<00:13, 355.75 examples/s]Map:  66%|██████▋   | 9327/14042 [00:28<00:12, 371.70 examples/s]Map:  67%|██████▋   | 9368/14042 [00:28<00:12, 378.62 examples/s]Map:  67%|██████▋   | 9427/14042 [00:29<00:12, 382.59 examples/s]Map:  67%|██████▋   | 9468/14042 [00:29<00:11, 387.41 examples/s]Map:  68%|██████▊   | 9511/14042 [00:29<00:11, 397.38 examples/s]Map:  68%|██████▊   | 9566/14042 [00:29<00:11, 383.33 examples/s]Map:  68%|██████▊   | 9617/14042 [00:29<00:12, 366.88 examples/s]Map:  69%|██████▉   | 9669/14042 [00:29<00:12, 356.63 examples/s]Map:  69%|██████▉   | 9710/14042 [00:29<00:17, 251.27 examples/s]Map:  69%|██████▉   | 9743/14042 [00:30<00:16, 263.39 examples/s]Map:  70%|██████▉   | 9778/14042 [00:30<00:15, 279.78 examples/s]Map:  70%|██████▉   | 9815/14042 [00:30<00:14, 298.38 examples/s]Map:  70%|███████   | 9851/14042 [00:30<00:13, 311.32 examples/s]Map:  70%|███████   | 9889/14042 [00:30<00:12, 326.62 examples/s]Map:  71%|███████   | 9928/14042 [00:30<00:12, 340.94 examples/s]Map:  71%|███████   | 9966/14042 [00:30<00:11, 349.90 examples/s]Map:  71%|███████▏  | 10018/14042 [00:31<00:20, 193.73 examples/s]Map:  72%|███████▏  | 10059/14042 [00:31<00:17, 227.90 examples/s]Map:  72%|███████▏  | 10101/14042 [00:31<00:14, 262.82 examples/s]Map:  72%|███████▏  | 10140/14042 [00:31<00:13, 288.60 examples/s]Map:  72%|███████▏  | 10177/14042 [00:31<00:12, 306.15 examples/s]Map:  73%|███████▎  | 10217/14042 [00:31<00:11, 327.41 examples/s]Map:  73%|███████▎  | 10257/14042 [00:31<00:11, 343.89 examples/s]Map:  73%|███████▎  | 10297/14042 [00:31<00:10, 358.29 examples/s]Map:  74%|███████▍  | 10356/14042 [00:32<00:10, 366.71 examples/s]Map:  74%|███████▍  | 10413/14042 [00:32<00:09, 367.43 examples/s]Map:  74%|███████▍  | 10452/14042 [00:32<00:09, 371.55 examples/s]Map:  75%|███████▍  | 10491/14042 [00:32<00:09, 375.19 examples/s]Map:  75%|███████▌  | 10548/14042 [00:32<00:09, 373.28 examples/s]Map:  75%|███████▌  | 10589/14042 [00:32<00:09, 379.33 examples/s]Map:  76%|███████▌  | 10629/14042 [00:32<00:08, 383.02 examples/s]Map:  76%|███████▌  | 10670/14042 [00:32<00:08, 387.49 examples/s]Map:  76%|███████▋  | 10710/14042 [00:32<00:08, 388.31 examples/s]Map:  77%|███████▋  | 10751/14042 [00:33<00:08, 391.88 examples/s]Map:  77%|███████▋  | 10809/14042 [00:33<00:08, 388.26 examples/s]Map:  77%|███████▋  | 10851/14042 [00:33<00:08, 395.05 examples/s]Map:  78%|███████▊  | 10891/14042 [00:33<00:08, 393.63 examples/s]Map:  78%|███████▊  | 10931/14042 [00:33<00:07, 393.57 examples/s]Map:  78%|███████▊  | 10971/14042 [00:33<00:07, 388.63 examples/s]Map:  78%|███████▊  | 11019/14042 [00:34<00:15, 201.08 examples/s]Map:  79%|███████▉  | 11060/14042 [00:34<00:12, 234.59 examples/s]Map:  79%|███████▉  | 11102/14042 [00:34<00:10, 267.98 examples/s]Map:  79%|███████▉  | 11143/14042 [00:34<00:09, 296.61 examples/s]Map:  80%|███████▉  | 11186/14042 [00:34<00:08, 325.18 examples/s]Map:  80%|███████▉  | 11225/14042 [00:34<00:08, 338.81 examples/s]Map:  80%|████████  | 11281/14042 [00:34<00:07, 348.31 examples/s]Map:  81%|████████  | 11319/14042 [00:34<00:07, 354.34 examples/s]Map:  81%|████████  | 11357/14042 [00:34<00:07, 356.70 examples/s]Map:  81%|████████▏ | 11411/14042 [00:35<00:07, 353.94 examples/s]Map:  82%|████████▏ | 11449/14042 [00:35<00:07, 358.34 examples/s]Map:  82%|████████▏ | 11488/14042 [00:35<00:07, 364.53 examples/s]Map:  82%|████████▏ | 11528/14042 [00:35<00:06, 371.98 examples/s]Map:  82%|████████▏ | 11569/14042 [00:35<00:06, 380.32 examples/s]Map:  83%|████████▎ | 11611/14042 [00:35<00:06, 387.39 examples/s]Map:  83%|████████▎ | 11672/14042 [00:35<00:06, 390.43 examples/s]Map:  83%|████████▎ | 11713/14042 [00:35<00:05, 394.60 examples/s]Map:  84%|████████▎ | 11756/14042 [00:35<00:05, 400.97 examples/s]Map:  84%|████████▍ | 11797/14042 [00:36<00:05, 401.13 examples/s]Map:  84%|████████▍ | 11838/14042 [00:36<00:05, 400.36 examples/s]Map:  85%|████████▍ | 11880/14042 [00:36<00:05, 402.80 examples/s]Map:  85%|████████▍ | 11921/14042 [00:36<00:05, 402.64 examples/s]Map:  85%|████████▌ | 11962/14042 [00:36<00:05, 402.81 examples/s]Map:  86%|████████▌ | 12020/14042 [00:36<00:09, 213.20 examples/s]Map:  86%|████████▌ | 12061/14042 [00:37<00:08, 244.38 examples/s]Map:  86%|████████▌ | 12103/14042 [00:37<00:07, 276.39 examples/s]Map:  86%|████████▋ | 12143/14042 [00:37<00:06, 299.05 examples/s]Map:  87%|████████▋ | 12184/14042 [00:37<00:05, 321.40 examples/s]Map:  87%|████████▋ | 12224/14042 [00:37<00:05, 339.87 examples/s]Map:  87%|████████▋ | 12265/14042 [00:37<00:05, 355.20 examples/s]Map:  88%|████████▊ | 12304/14042 [00:37<00:04, 364.29 examples/s]Map:  88%|████████▊ | 12345/14042 [00:37<00:04, 373.54 examples/s]Map:  88%|████████▊ | 12385/14042 [00:37<00:04, 377.97 examples/s]Map:  88%|████████▊ | 12425/14042 [00:38<00:04, 381.00 examples/s]Map:  89%|████████▉ | 12465/14042 [00:38<00:04, 382.93 examples/s]Map:  89%|████████▉ | 12505/14042 [00:38<00:03, 386.62 examples/s]Map:  89%|████████▉ | 12563/14042 [00:38<00:03, 385.04 examples/s]Map:  90%|████████▉ | 12602/14042 [00:38<00:03, 383.73 examples/s]Map:  90%|█████████ | 12642/14042 [00:38<00:03, 384.98 examples/s]Map:  90%|█████████ | 12683/14042 [00:38<00:03, 388.34 examples/s]Map:  91%|█████████ | 12722/14042 [00:38<00:03, 385.43 examples/s]Map:  91%|█████████ | 12763/14042 [00:38<00:03, 388.18 examples/s]Map:  91%|█████████ | 12804/14042 [00:38<00:03, 390.89 examples/s]Map:  91%|█████████▏| 12846/14042 [00:39<00:03, 394.75 examples/s]Map:  92%|█████████▏| 12888/14042 [00:39<00:02, 397.04 examples/s]Map:  92%|█████████▏| 12928/14042 [00:39<00:02, 395.70 examples/s]Map:  92%|█████████▏| 12969/14042 [00:39<00:02, 397.04 examples/s]Map:  93%|█████████▎| 13020/14042 [00:39<00:05, 194.14 examples/s]Map:  93%|█████████▎| 13061/14042 [00:40<00:04, 227.56 examples/s]Map:  93%|█████████▎| 13102/14042 [00:40<00:03, 260.50 examples/s]Map:  94%|█████████▎| 13143/14042 [00:40<00:03, 288.52 examples/s]Map:  94%|█████████▍| 13185/14042 [00:40<00:02, 316.91 examples/s]Map:  94%|█████████▍| 13224/14042 [00:40<00:02, 333.19 examples/s]Map:  94%|█████████▍| 13266/14042 [00:40<00:02, 349.76 examples/s]Map:  95%|█████████▍| 13310/14042 [00:40<00:01, 371.12 examples/s]Map:  95%|█████████▌| 13369/14042 [00:40<00:01, 375.49 examples/s]Map:  95%|█████████▌| 13410/14042 [00:40<00:01, 381.09 examples/s]Map:  96%|█████████▌| 13453/14042 [00:41<00:01, 390.66 examples/s]Map:  96%|█████████▌| 13511/14042 [00:41<00:01, 383.87 examples/s]Map:  97%|█████████▋| 13551/14042 [00:41<00:01, 385.02 examples/s]Map:  97%|█████████▋| 13593/14042 [00:41<00:01, 390.55 examples/s]Map:  97%|█████████▋| 13636/14042 [00:41<00:01, 396.98 examples/s]Map:  98%|█████████▊| 13695/14042 [00:41<00:00, 393.92 examples/s]Map:  98%|█████████▊| 13736/14042 [00:41<00:00, 395.18 examples/s]Map:  98%|█████████▊| 13777/14042 [00:41<00:00, 396.28 examples/s]Map:  98%|█████████▊| 13819/14042 [00:41<00:00, 398.53 examples/s]Map:  99%|█████████▊| 13859/14042 [00:42<00:00, 397.13 examples/s]Map:  99%|█████████▉| 13899/14042 [00:42<00:00, 396.27 examples/s]Map:  99%|█████████▉| 13940/14042 [00:42<00:00, 397.48 examples/s]Map: 100%|█████████▉| 13980/14042 [00:42<00:00, 394.11 examples/s]Map: 100%|█████████▉| 14020/14042 [00:42<00:00, 191.82 examples/s]Map: 100%|██████████| 14042/14042 [00:43<00:00, 324.96 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 29/10042 [00:00<00:36, 276.42 examples/s]Map:   1%|          | 59/10042 [00:00<00:35, 280.34 examples/s]Map:   1%|          | 89/10042 [00:00<00:35, 283.47 examples/s]Map:   1%|          | 118/10042 [00:00<00:35, 279.98 examples/s]Map:   1%|▏         | 148/10042 [00:00<00:35, 282.56 examples/s]Map:   2%|▏         | 179/10042 [00:00<00:34, 287.47 examples/s]Map:   2%|▏         | 211/10042 [00:00<00:33, 295.74 examples/s]Map:   2%|▏         | 243/10042 [00:00<00:32, 299.29 examples/s]Map:   3%|▎         | 275/10042 [00:00<00:32, 300.94 examples/s]Map:   3%|▎         | 307/10042 [00:01<00:49, 195.63 examples/s]Map:   3%|▎         | 339/10042 [00:01<00:43, 220.95 examples/s]Map:   4%|▎         | 371/10042 [00:01<00:39, 242.70 examples/s]Map:   4%|▍         | 403/10042 [00:01<00:37, 260.30 examples/s]Map:   4%|▍         | 435/10042 [00:01<00:35, 273.94 examples/s]Map:   5%|▍         | 467/10042 [00:01<00:33, 284.46 examples/s]Map:   5%|▍         | 499/10042 [00:01<00:32, 291.89 examples/s]Map:   5%|▌         | 531/10042 [00:01<00:32, 296.83 examples/s]Map:   6%|▌         | 563/10042 [00:02<00:31, 302.95 examples/s]Map:   6%|▌         | 596/10042 [00:02<00:30, 306.28 examples/s]Map:   6%|▋         | 643/10042 [00:02<00:30, 304.32 examples/s]Map:   7%|▋         | 674/10042 [00:02<00:30, 303.56 examples/s]Map:   7%|▋         | 720/10042 [00:02<00:31, 300.49 examples/s]Map:   7%|▋         | 752/10042 [00:02<00:30, 303.37 examples/s]Map:   8%|▊         | 784/10042 [00:02<00:30, 303.61 examples/s]Map:   8%|▊         | 816/10042 [00:02<00:30, 305.73 examples/s]Map:   8%|▊         | 848/10042 [00:02<00:29, 306.87 examples/s]Map:   9%|▉         | 879/10042 [00:03<00:30, 303.25 examples/s]Map:   9%|▉         | 911/10042 [00:03<00:29, 304.74 examples/s]Map:   9%|▉         | 942/10042 [00:03<00:30, 302.49 examples/s]Map:  10%|▉         | 974/10042 [00:03<00:29, 302.89 examples/s]Map:  10%|█         | 1014/10042 [00:04<01:26, 104.68 examples/s]Map:  10%|█         | 1046/10042 [00:04<01:09, 129.19 examples/s]Map:  11%|█         | 1078/10042 [00:04<00:57, 155.48 examples/s]Map:  11%|█         | 1110/10042 [00:04<00:49, 182.04 examples/s]Map:  11%|█▏        | 1142/10042 [00:04<00:42, 208.11 examples/s]Map:  12%|█▏        | 1173/10042 [00:04<00:38, 229.01 examples/s]Map:  12%|█▏        | 1205/10042 [00:04<00:35, 248.57 examples/s]Map:  12%|█▏        | 1237/10042 [00:04<00:33, 264.28 examples/s]Map:  13%|█▎        | 1269/10042 [00:05<00:31, 275.55 examples/s]Map:  13%|█▎        | 1300/10042 [00:05<00:30, 283.14 examples/s]Map:  13%|█▎        | 1332/10042 [00:05<00:30, 290.26 examples/s]Map:  14%|█▎        | 1363/10042 [00:05<00:29, 292.38 examples/s]Map:  14%|█▍        | 1395/10042 [00:05<00:29, 296.36 examples/s]Map:  14%|█▍        | 1427/10042 [00:05<00:28, 299.22 examples/s]Map:  15%|█▍        | 1458/10042 [00:05<00:28, 298.49 examples/s]Map:  15%|█▍        | 1490/10042 [00:05<00:28, 301.34 examples/s]Map:  15%|█▌        | 1522/10042 [00:05<00:28, 302.95 examples/s]Map:  15%|█▌        | 1554/10042 [00:06<00:27, 303.76 examples/s]Map:  16%|█▌        | 1585/10042 [00:06<00:27, 302.21 examples/s]Map:  16%|█▌        | 1617/10042 [00:06<00:27, 302.74 examples/s]Map:  16%|█▋        | 1649/10042 [00:06<00:27, 304.30 examples/s]Map:  17%|█▋        | 1680/10042 [00:06<00:27, 305.01 examples/s]Map:  17%|█▋        | 1711/10042 [00:06<00:27, 303.27 examples/s]Map:  17%|█▋        | 1743/10042 [00:06<00:27, 305.19 examples/s]Map:  18%|█▊        | 1774/10042 [00:06<00:27, 303.82 examples/s]Map:  18%|█▊        | 1805/10042 [00:06<00:27, 303.44 examples/s]Map:  18%|█▊        | 1851/10042 [00:06<00:27, 301.11 examples/s]Map:  19%|█▉        | 1883/10042 [00:07<00:26, 303.36 examples/s]Map:  19%|█▉        | 1915/10042 [00:07<00:26, 304.70 examples/s]Map:  19%|█▉        | 1947/10042 [00:07<00:26, 304.67 examples/s]Map:  20%|█▉        | 1979/10042 [00:07<00:26, 304.92 examples/s]Map:  20%|██        | 2015/10042 [00:07<00:58, 137.56 examples/s]Map:  20%|██        | 2047/10042 [00:08<00:48, 164.19 examples/s]Map:  21%|██        | 2079/10042 [00:08<00:41, 189.79 examples/s]Map:  21%|██        | 2111/10042 [00:08<00:37, 214.04 examples/s]Map:  21%|██▏       | 2142/10042 [00:08<00:33, 234.49 examples/s]Map:  22%|██▏       | 2174/10042 [00:08<00:30, 253.94 examples/s]Map:  22%|██▏       | 2206/10042 [00:08<00:29, 268.41 examples/s]Map:  22%|██▏       | 2238/10042 [00:08<00:27, 279.90 examples/s]Map:  23%|██▎       | 2270/10042 [00:08<00:27, 287.31 examples/s]Map:  23%|██▎       | 2301/10042 [00:08<00:26, 291.12 examples/s]Map:  23%|██▎       | 2333/10042 [00:09<00:26, 295.93 examples/s]Map:  24%|██▎       | 2365/10042 [00:09<00:25, 300.57 examples/s]Map:  24%|██▍       | 2397/10042 [00:09<00:25, 303.04 examples/s]Map:  24%|██▍       | 2429/10042 [00:09<00:25, 303.92 examples/s]Map:  24%|██▍       | 2460/10042 [00:09<00:24, 304.18 examples/s]Map:  25%|██▍       | 2492/10042 [00:09<00:24, 306.34 examples/s]Map:  25%|██▌       | 2524/10042 [00:09<00:24, 308.10 examples/s]Map:  25%|██▌       | 2556/10042 [00:09<00:24, 307.22 examples/s]Map:  26%|██▌       | 2588/10042 [00:09<00:24, 307.25 examples/s]Map:  26%|██▌       | 2620/10042 [00:09<00:24, 307.20 examples/s]Map:  27%|██▋       | 2666/10042 [00:10<00:24, 304.04 examples/s]Map:  27%|██▋       | 2698/10042 [00:10<00:24, 304.92 examples/s]Map:  27%|██▋       | 2729/10042 [00:10<00:24, 304.20 examples/s]Map:  27%|██▋       | 2760/10042 [00:10<00:23, 304.25 examples/s]Map:  28%|██▊       | 2791/10042 [00:10<00:23, 304.76 examples/s]Map:  28%|██▊       | 2822/10042 [00:10<00:23, 301.06 examples/s]Map:  28%|██▊       | 2854/10042 [00:10<00:23, 303.96 examples/s]Map:  29%|██▊       | 2886/10042 [00:10<00:23, 305.77 examples/s]Map:  29%|██▉       | 2918/10042 [00:10<00:23, 307.21 examples/s]Map:  30%|██▉       | 2964/10042 [00:11<00:23, 305.11 examples/s]Map:  30%|██▉       | 2995/10042 [00:11<00:23, 303.89 examples/s]Map:  30%|███       | 3031/10042 [00:11<00:49, 141.67 examples/s]Map:  31%|███       | 3063/10042 [00:11<00:41, 167.67 examples/s]Map:  31%|███       | 3094/10042 [00:11<00:36, 191.24 examples/s]Map:  31%|███       | 3126/10042 [00:12<00:32, 215.31 examples/s]Map:  31%|███▏      | 3158/10042 [00:12<00:29, 235.91 examples/s]Map:  32%|███▏      | 3190/10042 [00:12<00:27, 253.63 examples/s]Map:  32%|███▏      | 3222/10042 [00:12<00:25, 266.56 examples/s]Map:  32%|███▏      | 3253/10042 [00:12<00:24, 275.50 examples/s]Map:  33%|███▎      | 3297/10042 [00:12<00:24, 278.78 examples/s]Map:  33%|███▎      | 3340/10042 [00:12<00:24, 278.07 examples/s]Map:  34%|███▎      | 3369/10042 [00:12<00:23, 279.37 examples/s]Map:  34%|███▍      | 3399/10042 [00:12<00:23, 280.77 examples/s]Map:  34%|███▍      | 3429/10042 [00:13<00:23, 281.89 examples/s]Map:  34%|███▍      | 3459/10042 [00:13<00:23, 282.62 examples/s]Map:  35%|███▍      | 3489/10042 [00:13<00:23, 283.34 examples/s]Map:  35%|███▌      | 3519/10042 [00:13<00:23, 283.60 examples/s]Map:  35%|███▌      | 3548/10042 [00:13<00:22, 283.95 examples/s]Map:  36%|███▌      | 3578/10042 [00:13<00:22, 285.10 examples/s]Map:  36%|███▌      | 3608/10042 [00:13<00:22, 285.69 examples/s]Map:  36%|███▌      | 3638/10042 [00:13<00:22, 285.95 examples/s]Map:  37%|███▋      | 3667/10042 [00:13<00:22, 284.31 examples/s]Map:  37%|███▋      | 3697/10042 [00:14<00:22, 284.53 examples/s]Map:  37%|███▋      | 3727/10042 [00:14<00:22, 284.98 examples/s]Map:  38%|███▊      | 3769/10042 [00:14<00:22, 280.92 examples/s]Map:  38%|███▊      | 3799/10042 [00:14<00:22, 282.20 examples/s]Map:  38%|███▊      | 3829/10042 [00:14<00:21, 283.64 examples/s]Map:  38%|███▊      | 3858/10042 [00:14<00:21, 283.04 examples/s]Map:  39%|███▊      | 3888/10042 [00:14<00:21, 283.88 examples/s]Map:  39%|███▉      | 3918/10042 [00:14<00:21, 284.19 examples/s]Map:  39%|███▉      | 3948/10042 [00:14<00:21, 284.66 examples/s]Map:  40%|███▉      | 3978/10042 [00:15<00:21, 284.73 examples/s]Map:  40%|███▉      | 4014/10042 [00:15<00:46, 130.91 examples/s]Map:  40%|████      | 4044/10042 [00:15<00:38, 155.24 examples/s]Map:  41%|████      | 4074/10042 [00:15<00:33, 179.34 examples/s]Map:  41%|████      | 4103/10042 [00:15<00:29, 201.05 examples/s]Map:  41%|████      | 4132/10042 [00:15<00:27, 218.85 examples/s]Map:  41%|████▏     | 4162/10042 [00:16<00:24, 236.58 examples/s]Map:  42%|████▏     | 4192/10042 [00:16<00:23, 250.29 examples/s]Map:  42%|████▏     | 4222/10042 [00:16<00:22, 261.96 examples/s]Map:  42%|████▏     | 4252/10042 [00:16<00:21, 270.92 examples/s]Map:  43%|████▎     | 4282/10042 [00:16<00:20, 276.41 examples/s]Map:  43%|████▎     | 4312/10042 [00:16<00:20, 281.05 examples/s]Map:  43%|████▎     | 4342/10042 [00:16<00:20, 283.29 examples/s]Map:  44%|████▎     | 4372/10042 [00:16<00:19, 284.23 examples/s]Map:  44%|████▍     | 4402/10042 [00:16<00:19, 288.57 examples/s]Map:  44%|████▍     | 4446/10042 [00:17<00:19, 286.62 examples/s]Map:  45%|████▍     | 4476/10042 [00:17<00:19, 286.92 examples/s]Map:  45%|████▍     | 4506/10042 [00:17<00:19, 288.27 examples/s]Map:  45%|████▌     | 4536/10042 [00:17<00:19, 287.66 examples/s]Map:  45%|████▌     | 4566/10042 [00:17<00:19, 286.55 examples/s]Map:  46%|████▌     | 4595/10042 [00:17<00:19, 285.99 examples/s]Map:  46%|████▌     | 4625/10042 [00:17<00:18, 287.49 examples/s]Map:  46%|████▋     | 4655/10042 [00:17<00:18, 288.05 examples/s]Map:  47%|████▋     | 4685/10042 [00:17<00:18, 289.30 examples/s]Map:  47%|████▋     | 4715/10042 [00:18<00:18, 288.62 examples/s]Map:  47%|████▋     | 4744/10042 [00:18<00:18, 284.95 examples/s]Map:  48%|████▊     | 4774/10042 [00:18<00:18, 287.53 examples/s]Map:  48%|████▊     | 4804/10042 [00:18<00:18, 287.94 examples/s]Map:  48%|████▊     | 4834/10042 [00:18<00:18, 288.66 examples/s]Map:  48%|████▊     | 4864/10042 [00:18<00:17, 287.72 examples/s]Map:  49%|████▊     | 4894/10042 [00:18<00:17, 289.10 examples/s]Map:  49%|████▉     | 4924/10042 [00:18<00:17, 288.26 examples/s]Map:  49%|████▉     | 4954/10042 [00:18<00:17, 287.96 examples/s]Map:  50%|████▉     | 4984/10042 [00:18<00:17, 287.32 examples/s]Map:  50%|████▉     | 5014/10042 [00:19<00:51, 97.84 examples/s] Map:  50%|█████     | 5043/10042 [00:19<00:41, 121.08 examples/s]Map:  51%|█████     | 5073/10042 [00:19<00:33, 146.78 examples/s]Map:  51%|█████     | 5103/10042 [00:20<00:28, 172.50 examples/s]Map:  51%|█████     | 5133/10042 [00:20<00:24, 196.46 examples/s]Map:  51%|█████▏    | 5163/10042 [00:20<00:22, 216.98 examples/s]Map:  52%|█████▏    | 5193/10042 [00:20<00:20, 234.92 examples/s]Map:  52%|█████▏    | 5222/10042 [00:20<00:19, 246.63 examples/s]Map:  52%|█████▏    | 5252/10042 [00:20<00:18, 258.59 examples/s]Map:  53%|█████▎    | 5282/10042 [00:20<00:17, 269.14 examples/s]Map:  53%|█████▎    | 5311/10042 [00:20<00:17, 273.46 examples/s]Map:  53%|█████▎    | 5341/10042 [00:20<00:16, 278.46 examples/s]Map:  53%|█████▎    | 5371/10042 [00:20<00:16, 280.53 examples/s]Map:  54%|█████▍    | 5401/10042 [00:21<00:16, 283.45 examples/s]Map:  54%|█████▍    | 5431/10042 [00:21<00:16, 286.43 examples/s]Map:  54%|█████▍    | 5461/10042 [00:21<00:15, 288.62 examples/s]Map:  55%|█████▍    | 5491/10042 [00:21<00:15, 287.55 examples/s]Map:  55%|█████▍    | 5521/10042 [00:21<00:15, 288.26 examples/s]Map:  55%|█████▌    | 5551/10042 [00:21<00:15, 288.63 examples/s]Map:  56%|█████▌    | 5580/10042 [00:21<00:15, 283.74 examples/s]Map:  56%|█████▌    | 5610/10042 [00:21<00:15, 284.85 examples/s]Map:  56%|█████▌    | 5640/10042 [00:21<00:15, 285.15 examples/s]Map:  56%|█████▋    | 5670/10042 [00:21<00:15, 285.65 examples/s]Map:  57%|█████▋    | 5700/10042 [00:22<00:15, 285.61 examples/s]Map:  57%|█████▋    | 5730/10042 [00:22<00:15, 287.31 examples/s]Map:  57%|█████▋    | 5759/10042 [00:22<00:15, 284.71 examples/s]Map:  58%|█████▊    | 5789/10042 [00:22<00:14, 284.82 examples/s]Map:  58%|█████▊    | 5819/10042 [00:22<00:14, 287.29 examples/s]Map:  58%|█████▊    | 5849/10042 [00:22<00:14, 286.67 examples/s]Map:  59%|█████▊    | 5879/10042 [00:22<00:14, 285.85 examples/s]Map:  59%|█████▉    | 5909/10042 [00:22<00:14, 286.40 examples/s]Map:  59%|█████▉    | 5938/10042 [00:22<00:14, 284.20 examples/s]Map:  59%|█████▉    | 5967/10042 [00:23<00:14, 285.33 examples/s]Map:  60%|█████▉    | 5997/10042 [00:23<00:14, 286.53 examples/s]Map:  60%|██████    | 6029/10042 [00:23<00:31, 128.26 examples/s]Map:  60%|██████    | 6059/10042 [00:23<00:25, 153.92 examples/s]Map:  61%|██████    | 6089/10042 [00:23<00:22, 179.33 examples/s]Map:  61%|██████    | 6119/10042 [00:23<00:19, 202.16 examples/s]Map:  61%|██████    | 6149/10042 [00:24<00:17, 221.72 examples/s]Map:  62%|██████▏   | 6180/10042 [00:24<00:16, 239.67 examples/s]Map:  62%|██████▏   | 6210/10042 [00:24<00:15, 252.58 examples/s]Map:  62%|██████▏   | 6240/10042 [00:24<00:14, 260.59 examples/s]Map:  62%|██████▏   | 6270/10042 [00:24<00:14, 268.16 examples/s]Map:  63%|██████▎   | 6300/10042 [00:24<00:13, 274.22 examples/s]Map:  63%|██████▎   | 6330/10042 [00:24<00:13, 279.34 examples/s]Map:  63%|██████▎   | 6360/10042 [00:24<00:13, 282.36 examples/s]Map:  64%|██████▎   | 6390/10042 [00:24<00:12, 283.86 examples/s]Map:  64%|██████▍   | 6420/10042 [00:25<00:12, 286.34 examples/s]Map:  64%|██████▍   | 6451/10042 [00:25<00:12, 289.60 examples/s]Map:  65%|██████▍   | 6481/10042 [00:25<00:12, 289.87 examples/s]Map:  65%|██████▍   | 6525/10042 [00:25<00:12, 288.66 examples/s]Map:  65%|██████▌   | 6555/10042 [00:25<00:12, 289.41 examples/s]Map:  66%|██████▌   | 6585/10042 [00:25<00:11, 290.16 examples/s]Map:  66%|██████▌   | 6615/10042 [00:25<00:11, 289.76 examples/s]Map:  66%|██████▌   | 6645/10042 [00:25<00:11, 290.51 examples/s]Map:  67%|██████▋   | 6689/10042 [00:25<00:11, 286.65 examples/s]Map:  67%|██████▋   | 6719/10042 [00:26<00:11, 285.92 examples/s]Map:  67%|██████▋   | 6749/10042 [00:26<00:11, 285.99 examples/s]Map:  68%|██████▊   | 6779/10042 [00:26<00:11, 288.03 examples/s]Map:  68%|██████▊   | 6809/10042 [00:26<00:11, 287.47 examples/s]Map:  68%|██████▊   | 6839/10042 [00:26<00:11, 287.99 examples/s]Map:  68%|██████▊   | 6869/10042 [00:26<00:11, 288.39 examples/s]Map:  69%|██████▊   | 6899/10042 [00:26<00:10, 288.77 examples/s]Map:  69%|██████▉   | 6929/10042 [00:26<00:10, 287.64 examples/s]Map:  69%|██████▉   | 6958/10042 [00:26<00:10, 285.87 examples/s]Map:  70%|██████▉   | 6987/10042 [00:27<00:10, 284.37 examples/s]Map:  70%|██████▉   | 7029/10042 [00:27<00:22, 132.46 examples/s]Map:  70%|███████   | 7060/10042 [00:27<00:18, 156.97 examples/s]Map:  71%|███████   | 7090/10042 [00:27<00:16, 180.24 examples/s]Map:  71%|███████   | 7120/10042 [00:27<00:14, 201.79 examples/s]Map:  71%|███████   | 7149/10042 [00:28<00:13, 220.35 examples/s]Map:  71%|███████▏  | 7179/10042 [00:28<00:12, 237.96 examples/s]Map:  72%|███████▏  | 7209/10042 [00:28<00:11, 251.38 examples/s]Map:  72%|███████▏  | 7239/10042 [00:28<00:10, 262.19 examples/s]Map:  72%|███████▏  | 7269/10042 [00:28<00:10, 268.81 examples/s]Map:  73%|███████▎  | 7299/10042 [00:28<00:10, 273.60 examples/s]Map:  73%|███████▎  | 7329/10042 [00:28<00:09, 278.38 examples/s]Map:  73%|███████▎  | 7359/10042 [00:28<00:09, 280.15 examples/s]Map:  74%|███████▎  | 7389/10042 [00:28<00:09, 283.27 examples/s]Map:  74%|███████▍  | 7419/10042 [00:28<00:09, 284.79 examples/s]Map:  74%|███████▍  | 7449/10042 [00:29<00:09, 285.97 examples/s]Map:  74%|███████▍  | 7479/10042 [00:29<00:08, 286.07 examples/s]Map:  75%|███████▍  | 7508/10042 [00:29<00:08, 283.00 examples/s]Map:  75%|███████▌  | 7538/10042 [00:29<00:08, 284.14 examples/s]Map:  75%|███████▌  | 7568/10042 [00:29<00:08, 286.70 examples/s]Map:  76%|███████▌  | 7598/10042 [00:29<00:08, 287.18 examples/s]Map:  76%|███████▌  | 7628/10042 [00:29<00:08, 287.21 examples/s]Map:  76%|███████▋  | 7658/10042 [00:29<00:08, 288.21 examples/s]Map:  77%|███████▋  | 7688/10042 [00:29<00:08, 288.67 examples/s]Map:  77%|███████▋  | 7717/10042 [00:29<00:08, 287.98 examples/s]Map:  77%|███████▋  | 7746/10042 [00:30<00:08, 286.78 examples/s]Map:  77%|███████▋  | 7776/10042 [00:30<00:07, 288.20 examples/s]Map:  78%|███████▊  | 7806/10042 [00:30<00:07, 287.84 examples/s]Map:  78%|███████▊  | 7836/10042 [00:30<00:07, 289.43 examples/s]Map:  78%|███████▊  | 7866/10042 [00:30<00:07, 289.44 examples/s]Map:  79%|███████▊  | 7896/10042 [00:30<00:07, 289.81 examples/s]Map:  79%|███████▉  | 7926/10042 [00:30<00:07, 290.61 examples/s]Map:  79%|███████▉  | 7956/10042 [00:30<00:07, 290.14 examples/s]Map:  80%|███████▉  | 7986/10042 [00:30<00:07, 289.89 examples/s]Map:  80%|███████▉  | 8028/10042 [00:31<00:14, 138.93 examples/s]Map:  80%|████████  | 8058/10042 [00:31<00:12, 162.19 examples/s]Map:  81%|████████  | 8088/10042 [00:31<00:10, 185.37 examples/s]Map:  81%|████████  | 8117/10042 [00:31<00:09, 205.01 examples/s]Map:  81%|████████  | 8148/10042 [00:31<00:08, 225.74 examples/s]Map:  81%|████████▏ | 8178/10042 [00:32<00:07, 240.51 examples/s]Map:  82%|████████▏ | 8208/10042 [00:32<00:07, 253.36 examples/s]Map:  82%|████████▏ | 8238/10042 [00:32<00:06, 263.86 examples/s]Map:  82%|████████▏ | 8268/10042 [00:32<00:06, 270.46 examples/s]Map:  83%|████████▎ | 8298/10042 [00:32<00:06, 277.30 examples/s]Map:  83%|████████▎ | 8328/10042 [00:32<00:06, 279.69 examples/s]Map:  83%|████████▎ | 8358/10042 [00:32<00:05, 282.88 examples/s]Map:  84%|████████▎ | 8388/10042 [00:32<00:05, 285.47 examples/s]Map:  84%|████████▍ | 8417/10042 [00:32<00:05, 285.54 examples/s]Map:  84%|████████▍ | 8447/10042 [00:32<00:05, 286.25 examples/s]Map:  84%|████████▍ | 8476/10042 [00:33<00:05, 285.48 examples/s]Map:  85%|████████▍ | 8506/10042 [00:33<00:05, 285.72 examples/s]Map:  85%|████████▌ | 8536/10042 [00:33<00:05, 285.66 examples/s]Map:  85%|████████▌ | 8566/10042 [00:33<00:05, 286.71 examples/s]Map:  86%|████████▌ | 8595/10042 [00:33<00:05, 285.86 examples/s]Map:  86%|████████▌ | 8625/10042 [00:33<00:04, 286.15 examples/s]Map:  86%|████████▌ | 8655/10042 [00:33<00:04, 286.78 examples/s]Map:  86%|████████▋ | 8685/10042 [00:33<00:04, 288.19 examples/s]Map:  87%|████████▋ | 8715/10042 [00:33<00:04, 288.64 examples/s]Map:  87%|████████▋ | 8745/10042 [00:33<00:04, 288.46 examples/s]Map:  87%|████████▋ | 8775/10042 [00:34<00:04, 288.39 examples/s]Map:  88%|████████▊ | 8805/10042 [00:34<00:04, 288.52 examples/s]Map:  88%|████████▊ | 8835/10042 [00:34<00:04, 288.81 examples/s]Map:  88%|████████▊ | 8865/10042 [00:34<00:04, 289.15 examples/s]Map:  89%|████████▊ | 8895/10042 [00:34<00:03, 288.55 examples/s]Map:  89%|████████▉ | 8925/10042 [00:34<00:03, 288.55 examples/s]Map:  89%|████████▉ | 8955/10042 [00:34<00:03, 287.86 examples/s]Map:  89%|████████▉ | 8985/10042 [00:34<00:03, 287.86 examples/s]Map:  90%|████████▉ | 9014/10042 [00:35<00:07, 129.47 examples/s]Map:  90%|█████████ | 9044/10042 [00:35<00:06, 154.92 examples/s]Map:  90%|█████████ | 9074/10042 [00:35<00:05, 180.64 examples/s]Map:  91%|█████████ | 9104/10042 [00:35<00:04, 203.76 examples/s]Map:  91%|█████████ | 9134/10042 [00:35<00:04, 222.83 examples/s]Map:  91%|█████████▏| 9164/10042 [00:35<00:03, 239.91 examples/s]Map:  92%|█████████▏| 9194/10042 [00:35<00:03, 250.96 examples/s]Map:  92%|█████████▏| 9224/10042 [00:36<00:03, 262.34 examples/s]Map:  92%|█████████▏| 9254/10042 [00:36<00:02, 270.53 examples/s]Map:  92%|█████████▏| 9284/10042 [00:36<00:02, 275.47 examples/s]Map:  93%|█████████▎| 9314/10042 [00:36<00:02, 280.78 examples/s]Map:  93%|█████████▎| 9344/10042 [00:36<00:02, 284.07 examples/s]Map:  93%|█████████▎| 9374/10042 [00:36<00:02, 286.47 examples/s]Map:  94%|█████████▎| 9404/10042 [00:36<00:02, 286.94 examples/s]Map:  94%|█████████▍| 9434/10042 [00:36<00:02, 288.17 examples/s]Map:  94%|█████████▍| 9464/10042 [00:36<00:02, 286.80 examples/s]Map:  95%|█████████▍| 9494/10042 [00:36<00:01, 287.03 examples/s]Map:  95%|█████████▍| 9524/10042 [00:37<00:01, 288.00 examples/s]Map:  95%|█████████▌| 9567/10042 [00:37<00:01, 282.51 examples/s]Map:  96%|█████████▌| 9597/10042 [00:37<00:01, 284.58 examples/s]Map:  96%|█████████▌| 9627/10042 [00:37<00:01, 285.03 examples/s]Map:  96%|█████████▌| 9656/10042 [00:37<00:01, 284.54 examples/s]Map:  96%|█████████▋| 9686/10042 [00:37<00:01, 284.50 examples/s]Map:  97%|█████████▋| 9716/10042 [00:37<00:01, 285.75 examples/s]Map:  97%|█████████▋| 9746/10042 [00:37<00:01, 285.66 examples/s]Map:  97%|█████████▋| 9776/10042 [00:37<00:00, 286.78 examples/s]Map:  98%|█████████▊| 9806/10042 [00:38<00:00, 286.04 examples/s]Map:  98%|█████████▊| 9836/10042 [00:38<00:00, 288.26 examples/s]Map:  98%|█████████▊| 9866/10042 [00:38<00:00, 287.30 examples/s]Map:  99%|█████████▊| 9896/10042 [00:38<00:00, 286.83 examples/s]Map:  99%|█████████▉| 9925/10042 [00:38<00:00, 286.60 examples/s]Map:  99%|█████████▉| 9955/10042 [00:38<00:00, 287.36 examples/s]Map:  99%|█████████▉| 9984/10042 [00:38<00:00, 285.81 examples/s]Map: 100%|█████████▉| 10014/10042 [00:39<00:00, 91.17 examples/s]Map: 100%|██████████| 10042/10042 [00:39<00:00, 110.66 examples/s]Map: 100%|██████████| 10042/10042 [00:39<00:00, 253.16 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   6%|▋         | 82/1267 [00:00<00:01, 804.35 examples/s]Map:  13%|█▎        | 164/1267 [00:00<00:01, 807.91 examples/s]Map:  20%|█▉        | 249/1267 [00:00<00:01, 824.30 examples/s]Map:  26%|██▌       | 332/1267 [00:00<00:01, 819.55 examples/s]Map:  33%|███▎      | 416/1267 [00:00<00:01, 824.26 examples/s]Map:  39%|███▉      | 499/1267 [00:00<00:00, 824.40 examples/s]Map:  46%|████▋     | 586/1267 [00:00<00:00, 835.90 examples/s]Map:  53%|█████▎    | 673/1267 [00:00<00:00, 843.68 examples/s]Map:  60%|█████▉    | 759/1267 [00:00<00:00, 847.32 examples/s]Map:  67%|██████▋   | 844/1267 [00:01<00:00, 845.49 examples/s]Map:  73%|███████▎  | 931/1267 [00:01<00:00, 850.05 examples/s]Map:  82%|████████▏ | 1039/1267 [00:01<00:00, 439.16 examples/s]Map:  89%|████████▉ | 1125/1267 [00:01<00:00, 509.60 examples/s]Map:  95%|█████████▌| 1209/1267 [00:01<00:00, 572.52 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 651.13 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  5.28it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  6.49it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.00it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  7.28it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  7.46it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  7.57it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.72it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.30it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:10,  1.79s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:04<00:10,  2.06s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:06<00:09,  2.33s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:09<00:07,  2.37s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:10<00:04,  2.18s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:13<00:02,  2.21s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:13<00:00,  1.71s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:13<00:00,  1.99s/it]
2024-05-20 22:59:17,270: rank0[365018][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-05-20 22:59:17,273: rank0[365018][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen4096_perdeviceBS8_worldsize4
2024-05-20 22:59:18,696: rank0[365018][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-05-20 22:59:18,719: rank0[365018][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-05-20 22:59:31,433: rank0[365018][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-05-20 22:59:31,434: rank0[365018][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-05-20 22:59:31,434: rank0[365018][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 4096
precision: amp_bf16
device_eval_batch_size: 8
global_seed: 42
seed: 42
ckpt_path: /home/eldar/dan_eval/panza_llama3_bf16-bs8-rosa_wl16_d0.01_4grads_mean_squared_r8_loralr5e-5_alpha16-lr5e-5-epochs7-wu8-seed42-PREAMBLE-7207
models:
- model_name: /home/eldar/dan_eval/panza_llama3_bf16-bs8-rosa_wl16_d0.01_4grads_mean_squared_r8_loralr5e-5_alpha16-lr5e-5-epochs7-wu8-seed42-PREAMBLE-7207
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /home/eldar/dan_eval/panza_llama3_bf16-bs8-rosa_wl16_d0.01_4grads_mean_squared_r8_loralr5e-5_alpha16-lr5e-5-epochs7-wu8-seed42-PREAMBLE-7207
    use_auth_token: true
  tokenizer:
    name: /home/eldar/dan_eval/panza_llama3_bf16-bs8-rosa_wl16_d0.01_4grads_mean_squared_r8_loralr5e-5_alpha16-lr5e-5-epochs7-wu8-seed42-PREAMBLE-7207
    kwargs:
      model_max_length: 4096
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-05-20 22:59:31,440: rank0[365018][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 8
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 2. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.5708
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.5989
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7712
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 6 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 6 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7230
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                                                                                        |
|:-----------|:--------------|:----------|-----------:|:------------------|:---------------------------------------------------------------------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.570819 | 25-shot           | /home/eldar/dan_eval/panza_llama3_bf16-bs8-rosa_wl16_d0.01_4grads_mean_squared_r8_loralr5e-5_alpha16-lr5e-5-epochs7-wu8-seed42-PREAMBLE-7207 |
|            | mmlu          |           |   0.598918 | 5-shot            | /home/eldar/dan_eval/panza_llama3_bf16-bs8-rosa_wl16_d0.01_4grads_mean_squared_r8_loralr5e-5_alpha16-lr5e-5-epochs7-wu8-seed42-PREAMBLE-7207 |
|            | winogrande    |           |   0.722968 | 5-shot            | /home/eldar/dan_eval/panza_llama3_bf16-bs8-rosa_wl16_d0.01_4grads_mean_squared_r8_loralr5e-5_alpha16-lr5e-5-epochs7-wu8-seed42-PREAMBLE-7207 |
|            | hellaswag     |           |   0.771161 | 10-shot           | /home/eldar/dan_eval/panza_llama3_bf16-bs8-rosa_wl16_d0.01_4grads_mean_squared_r8_loralr5e-5_alpha16-lr5e-5-epochs7-wu8-seed42-PREAMBLE-7207 |
2024-05-21 00:05:51,931: rank0[365018][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-05-21 00:05:51,931: rank0[365018][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-05-21 00:05:51,931: rank0[365018][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-05-21 00:05:51,931: rank0[365018][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
