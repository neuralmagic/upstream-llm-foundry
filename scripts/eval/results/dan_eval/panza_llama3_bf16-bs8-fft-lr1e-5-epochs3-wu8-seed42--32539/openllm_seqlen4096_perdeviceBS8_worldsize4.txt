----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-05-20 19:35:46,417: rank0[348969][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 23/1172 [00:00<00:05, 222.31 examples/s]Map:   4%|▍         | 49/1172 [00:00<00:04, 238.74 examples/s]Map:   6%|▋         | 74/1172 [00:00<00:04, 240.02 examples/s]Map:   9%|▉         | 110/1172 [00:00<00:04, 235.46 examples/s]Map:  12%|█▏        | 137/1172 [00:00<00:04, 242.88 examples/s]Map:  14%|█▍        | 162/1172 [00:00<00:04, 240.89 examples/s]Map:  16%|█▌        | 188/1172 [00:00<00:04, 245.19 examples/s]Map:  18%|█▊        | 214/1172 [00:00<00:03, 247.55 examples/s]Map:  21%|██        | 241/1172 [00:00<00:03, 251.42 examples/s]Map:  23%|██▎       | 268/1172 [00:01<00:03, 253.70 examples/s]Map:  25%|██▌       | 296/1172 [00:01<00:03, 256.64 examples/s]Map:  28%|██▊       | 324/1172 [00:01<00:03, 258.20 examples/s]Map:  30%|██▉       | 351/1172 [00:01<00:03, 259.40 examples/s]Map:  32%|███▏      | 379/1172 [00:01<00:03, 259.76 examples/s]Map:  35%|███▍      | 406/1172 [00:01<00:02, 259.65 examples/s]Map:  37%|███▋      | 432/1172 [00:01<00:02, 259.28 examples/s]Map:  39%|███▉      | 460/1172 [00:01<00:02, 260.14 examples/s]Map:  42%|████▏     | 488/1172 [00:01<00:02, 262.07 examples/s]Map:  44%|████▍     | 516/1172 [00:02<00:02, 263.58 examples/s]Map:  46%|████▋     | 544/1172 [00:02<00:02, 264.85 examples/s]Map:  49%|████▉     | 572/1172 [00:02<00:02, 264.77 examples/s]Map:  51%|█████     | 600/1172 [00:02<00:02, 265.65 examples/s]Map:  54%|█████▎    | 628/1172 [00:02<00:02, 266.50 examples/s]Map:  56%|█████▌    | 656/1172 [00:02<00:01, 266.95 examples/s]Map:  58%|█████▊    | 684/1172 [00:02<00:01, 266.80 examples/s]Map:  61%|██████    | 712/1172 [00:02<00:01, 266.12 examples/s]Map:  63%|██████▎   | 740/1172 [00:02<00:01, 266.43 examples/s]Map:  66%|██████▌   | 768/1172 [00:02<00:01, 266.21 examples/s]Map:  68%|██████▊   | 795/1172 [00:03<00:01, 265.32 examples/s]Map:  70%|███████   | 823/1172 [00:03<00:01, 265.79 examples/s]Map:  73%|███████▎  | 851/1172 [00:03<00:01, 265.22 examples/s]Map:  75%|███████▌  | 879/1172 [00:03<00:01, 265.51 examples/s]Map:  77%|███████▋  | 907/1172 [00:03<00:00, 265.38 examples/s]Map:  80%|███████▉  | 935/1172 [00:03<00:00, 264.60 examples/s]Map:  82%|████████▏ | 963/1172 [00:03<00:00, 264.62 examples/s]Map:  84%|████████▍ | 990/1172 [00:03<00:00, 263.18 examples/s]Map:  88%|████████▊ | 1027/1172 [00:04<00:01, 93.47 examples/s]Map:  90%|█████████ | 1055/1172 [00:04<00:01, 114.57 examples/s]Map:  92%|█████████▏| 1083/1172 [00:04<00:00, 137.51 examples/s]Map:  95%|█████████▍| 1111/1172 [00:04<00:00, 160.73 examples/s]Map:  97%|█████████▋| 1139/1172 [00:05<00:00, 181.92 examples/s]Map: 100%|█████████▉| 1167/1172 [00:05<00:00, 201.17 examples/s]Map: 100%|██████████| 1172/1172 [00:05<00:00, 222.14 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 38/14042 [00:00<00:38, 365.89 examples/s]Map:   1%|          | 92/14042 [00:00<00:39, 355.11 examples/s]Map:   1%|          | 129/14042 [00:00<00:38, 359.67 examples/s]Map:   1%|▏         | 184/14042 [00:00<00:39, 354.04 examples/s]Map:   2%|▏         | 224/14042 [00:00<00:37, 365.98 examples/s]Map:   2%|▏         | 263/14042 [00:00<00:37, 368.96 examples/s]Map:   2%|▏         | 320/14042 [00:00<00:37, 370.84 examples/s]Map:   3%|▎         | 360/14042 [00:00<00:36, 375.19 examples/s]Map:   3%|▎         | 399/14042 [00:01<01:12, 187.28 examples/s]Map:   3%|▎         | 434/14042 [00:01<01:03, 212.86 examples/s]Map:   3%|▎         | 475/14042 [00:01<00:54, 246.98 examples/s]Map:   4%|▎         | 514/14042 [00:01<00:48, 276.12 examples/s]Map:   4%|▍         | 552/14042 [00:01<00:45, 298.36 examples/s]Map:   4%|▍         | 589/14042 [00:01<00:42, 313.93 examples/s]Map:   4%|▍         | 629/14042 [00:02<00:40, 333.08 examples/s]Map:   5%|▍         | 667/14042 [00:02<00:39, 342.63 examples/s]Map:   5%|▌         | 705/14042 [00:02<00:38, 348.25 examples/s]Map:   5%|▌         | 761/14042 [00:02<00:37, 354.47 examples/s]Map:   6%|▌         | 800/14042 [00:02<00:36, 362.05 examples/s]Map:   6%|▌         | 839/14042 [00:02<00:35, 368.27 examples/s]Map:   6%|▋         | 878/14042 [00:02<00:35, 368.99 examples/s]Map:   7%|▋         | 917/14042 [00:02<00:35, 370.60 examples/s]Map:   7%|▋         | 959/14042 [00:02<00:34, 380.88 examples/s]Map:   7%|▋         | 1000/14042 [00:03<01:43, 126.41 examples/s]Map:   7%|▋         | 1036/14042 [00:03<01:24, 153.05 examples/s]Map:   8%|▊         | 1077/14042 [00:03<01:08, 189.26 examples/s]Map:   8%|▊         | 1119/14042 [00:04<00:56, 226.77 examples/s]Map:   8%|▊         | 1160/14042 [00:04<00:49, 260.98 examples/s]Map:   9%|▊         | 1200/14042 [00:04<00:44, 290.33 examples/s]Map:   9%|▉         | 1239/14042 [00:04<00:40, 312.48 examples/s]Map:   9%|▉         | 1280/14042 [00:04<00:38, 335.35 examples/s]Map:   9%|▉         | 1319/14042 [00:04<00:36, 347.77 examples/s]Map:  10%|▉         | 1359/14042 [00:04<00:35, 360.50 examples/s]Map:  10%|▉         | 1399/14042 [00:04<00:34, 368.03 examples/s]Map:  10%|█         | 1439/14042 [00:04<00:33, 373.82 examples/s]Map:  11%|█         | 1478/14042 [00:05<00:33, 376.77 examples/s]Map:  11%|█         | 1518/14042 [00:05<00:32, 382.20 examples/s]Map:  11%|█         | 1575/14042 [00:05<00:33, 376.62 examples/s]Map:  12%|█▏        | 1633/14042 [00:05<00:32, 377.41 examples/s]Map:  12%|█▏        | 1673/14042 [00:05<00:32, 380.45 examples/s]Map:  12%|█▏        | 1731/14042 [00:05<00:32, 379.55 examples/s]Map:  13%|█▎        | 1787/14042 [00:05<00:32, 371.56 examples/s]Map:  13%|█▎        | 1826/14042 [00:05<00:32, 371.84 examples/s]Map:  13%|█▎        | 1865/14042 [00:06<00:32, 372.87 examples/s]Map:  14%|█▎        | 1921/14042 [00:06<00:32, 371.12 examples/s]Map:  14%|█▍        | 1961/14042 [00:06<00:32, 374.65 examples/s]Map:  14%|█▍        | 2000/14042 [00:06<01:05, 183.45 examples/s]Map:  14%|█▍        | 2036/14042 [00:06<00:57, 210.23 examples/s]Map:  15%|█▍        | 2074/14042 [00:07<00:49, 239.89 examples/s]Map:  15%|█▌        | 2113/14042 [00:07<00:44, 268.56 examples/s]Map:  15%|█▌        | 2154/14042 [00:07<00:39, 297.90 examples/s]Map:  16%|█▌        | 2194/14042 [00:07<00:37, 320.20 examples/s]Map:  16%|█▌        | 2234/14042 [00:07<00:34, 339.85 examples/s]Map:  16%|█▌        | 2273/14042 [00:07<00:33, 350.12 examples/s]Map:  16%|█▋        | 2313/14042 [00:07<00:32, 360.89 examples/s]Map:  17%|█▋        | 2371/14042 [00:07<00:31, 367.81 examples/s]Map:  17%|█▋        | 2411/14042 [00:07<00:31, 373.07 examples/s]Map:  17%|█▋        | 2451/14042 [00:07<00:30, 375.03 examples/s]Map:  18%|█▊        | 2491/14042 [00:08<00:30, 378.54 examples/s]Map:  18%|█▊        | 2531/14042 [00:08<00:29, 384.08 examples/s]Map:  18%|█▊        | 2573/14042 [00:08<00:29, 390.36 examples/s]Map:  19%|█▊        | 2632/14042 [00:08<00:29, 387.92 examples/s]Map:  19%|█▉        | 2691/14042 [00:08<00:29, 388.01 examples/s]Map:  19%|█▉        | 2731/14042 [00:08<00:29, 386.83 examples/s]Map:  20%|█▉        | 2771/14042 [00:08<00:29, 385.82 examples/s]Map:  20%|██        | 2828/14042 [00:08<00:29, 379.68 examples/s]Map:  20%|██        | 2867/14042 [00:09<00:29, 381.64 examples/s]Map:  21%|██        | 2907/14042 [00:09<00:28, 384.00 examples/s]Map:  21%|██        | 2946/14042 [00:09<00:28, 383.85 examples/s]Map:  21%|██▏       | 2986/14042 [00:09<00:28, 386.92 examples/s]Map:  22%|██▏       | 3038/14042 [00:09<01:04, 170.78 examples/s]Map:  22%|██▏       | 3078/14042 [00:10<00:54, 202.16 examples/s]Map:  22%|██▏       | 3118/14042 [00:10<00:46, 234.24 examples/s]Map:  22%|██▏       | 3158/14042 [00:10<00:41, 264.55 examples/s]Map:  23%|██▎       | 3195/14042 [00:10<00:37, 285.90 examples/s]Map:  23%|██▎       | 3233/14042 [00:10<00:35, 304.91 examples/s]Map:  23%|██▎       | 3272/14042 [00:10<00:33, 324.53 examples/s]Map:  24%|██▎       | 3312/14042 [00:10<00:31, 343.06 examples/s]Map:  24%|██▍       | 3353/14042 [00:10<00:29, 357.68 examples/s]Map:  24%|██▍       | 3393/14042 [00:10<00:28, 368.08 examples/s]Map:  24%|██▍       | 3433/14042 [00:11<00:28, 373.81 examples/s]Map:  25%|██▍       | 3472/14042 [00:11<00:27, 377.96 examples/s]Map:  25%|██▌       | 3513/14042 [00:11<00:27, 385.60 examples/s]Map:  25%|██▌       | 3554/14042 [00:11<00:27, 387.79 examples/s]Map:  26%|██▌       | 3594/14042 [00:11<00:26, 388.50 examples/s]Map:  26%|██▌       | 3652/14042 [00:11<00:26, 384.95 examples/s]Map:  26%|██▋       | 3692/14042 [00:11<00:26, 387.05 examples/s]Map:  27%|██▋       | 3751/14042 [00:11<00:26, 387.14 examples/s]Map:  27%|██▋       | 3790/14042 [00:11<00:26, 383.76 examples/s]Map:  27%|██▋       | 3829/14042 [00:12<00:26, 382.71 examples/s]Map:  28%|██▊       | 3869/14042 [00:12<00:26, 384.56 examples/s]Map:  28%|██▊       | 3927/14042 [00:12<00:26, 381.85 examples/s]Map:  28%|██▊       | 3966/14042 [00:12<00:26, 381.59 examples/s]Map:  29%|██▊       | 4019/14042 [00:12<00:54, 183.13 examples/s]Map:  29%|██▉       | 4058/14042 [00:13<00:47, 211.79 examples/s]Map:  29%|██▉       | 4098/14042 [00:13<00:41, 242.28 examples/s]Map:  29%|██▉       | 4137/14042 [00:13<00:36, 270.15 examples/s]Map:  30%|██▉       | 4177/14042 [00:13<00:33, 296.87 examples/s]Map:  30%|███       | 4219/14042 [00:13<00:30, 321.97 examples/s]Map:  30%|███       | 4258/14042 [00:13<00:29, 335.30 examples/s]Map:  31%|███       | 4296/14042 [00:13<00:28, 344.57 examples/s]Map:  31%|███       | 4334/14042 [00:13<00:27, 351.54 examples/s]Map:  31%|███       | 4373/14042 [00:13<00:26, 358.60 examples/s]Map:  31%|███▏      | 4413/14042 [00:14<00:26, 363.18 examples/s]Map:  32%|███▏      | 4451/14042 [00:14<00:26, 364.54 examples/s]Map:  32%|███▏      | 4491/14042 [00:14<00:25, 373.18 examples/s]Map:  32%|███▏      | 4544/14042 [00:14<00:26, 362.99 examples/s]Map:  33%|███▎      | 4596/14042 [00:14<00:26, 353.44 examples/s]Map:  33%|███▎      | 4645/14042 [00:14<00:27, 342.56 examples/s]Map:  33%|███▎      | 4695/14042 [00:14<00:27, 336.75 examples/s]Map:  34%|███▎      | 4730/14042 [00:14<00:27, 337.18 examples/s]Map:  34%|███▍      | 4770/14042 [00:15<00:26, 350.95 examples/s]Map:  34%|███▍      | 4809/14042 [00:15<00:25, 357.49 examples/s]Map:  35%|███▍      | 4849/14042 [00:15<00:24, 368.56 examples/s]Map:  35%|███▍      | 4889/14042 [00:15<00:24, 376.25 examples/s]Map:  35%|███▌      | 4930/14042 [00:15<00:23, 383.25 examples/s]Map:  35%|███▌      | 4969/14042 [00:15<00:23, 383.47 examples/s]Map:  36%|███▌      | 5019/14042 [00:16<01:00, 147.93 examples/s]Map:  36%|███▌      | 5058/14042 [00:16<00:50, 178.07 examples/s]Map:  36%|███▋      | 5094/14042 [00:16<00:43, 205.00 examples/s]Map:  37%|███▋      | 5127/14042 [00:16<00:39, 226.95 examples/s]Map:  37%|███▋      | 5175/14042 [00:16<00:35, 251.22 examples/s]Map:  37%|███▋      | 5208/14042 [00:16<00:33, 265.43 examples/s]Map:  37%|███▋      | 5244/14042 [00:16<00:30, 284.46 examples/s]Map:  38%|███▊      | 5284/14042 [00:17<00:28, 311.65 examples/s]Map:  38%|███▊      | 5324/14042 [00:17<00:26, 332.39 examples/s]Map:  38%|███▊      | 5365/14042 [00:17<00:24, 350.58 examples/s]Map:  38%|███▊      | 5404/14042 [00:17<00:24, 358.24 examples/s]Map:  39%|███▉      | 5442/14042 [00:17<00:23, 363.07 examples/s]Map:  39%|███▉      | 5480/14042 [00:17<00:23, 366.55 examples/s]Map:  39%|███▉      | 5519/14042 [00:17<00:23, 370.51 examples/s]Map:  40%|███▉      | 5560/14042 [00:17<00:22, 378.52 examples/s]Map:  40%|███▉      | 5600/14042 [00:17<00:22, 382.27 examples/s]Map:  40%|████      | 5640/14042 [00:17<00:21, 385.51 examples/s]Map:  40%|████      | 5679/14042 [00:18<00:21, 385.35 examples/s]Map:  41%|████      | 5721/14042 [00:18<00:21, 391.29 examples/s]Map:  41%|████      | 5761/14042 [00:18<00:21, 390.04 examples/s]Map:  41%|████▏     | 5820/14042 [00:18<00:21, 385.62 examples/s]Map:  42%|████▏     | 5859/14042 [00:18<00:21, 381.64 examples/s]Map:  42%|████▏     | 5915/14042 [00:18<00:21, 374.91 examples/s]Map:  43%|████▎     | 5968/14042 [00:18<00:22, 361.98 examples/s]Map:  43%|████▎     | 6018/14042 [00:19<00:42, 189.72 examples/s]Map:  43%|████▎     | 6055/14042 [00:19<00:37, 213.63 examples/s]Map:  43%|████▎     | 6093/14042 [00:19<00:33, 239.07 examples/s]Map:  44%|████▎     | 6128/14042 [00:19<00:30, 258.66 examples/s]Map:  44%|████▍     | 6164/14042 [00:19<00:28, 277.25 examples/s]Map:  44%|████▍     | 6199/14042 [00:19<00:26, 291.51 examples/s]Map:  44%|████▍     | 6234/14042 [00:20<00:25, 302.19 examples/s]Map:  45%|████▍     | 6269/14042 [00:20<00:24, 311.75 examples/s]Map:  45%|████▌     | 6320/14042 [00:20<00:24, 317.03 examples/s]Map:  45%|████▌     | 6355/14042 [00:20<00:23, 323.60 examples/s]Map:  46%|████▌     | 6391/14042 [00:20<00:23, 331.72 examples/s]Map:  46%|████▌     | 6427/14042 [00:20<00:22, 337.02 examples/s]Map:  46%|████▌     | 6462/14042 [00:20<00:22, 339.59 examples/s]Map:  46%|████▋     | 6514/14042 [00:20<00:22, 337.52 examples/s]Map:  47%|████▋     | 6551/14042 [00:20<00:21, 342.58 examples/s]Map:  47%|████▋     | 6586/14042 [00:21<00:21, 343.52 examples/s]Map:  47%|████▋     | 6637/14042 [00:21<00:21, 340.35 examples/s]Map:  48%|████▊     | 6672/14042 [00:21<00:21, 339.55 examples/s]Map:  48%|████▊     | 6707/14042 [00:21<00:21, 340.46 examples/s]Map:  48%|████▊     | 6758/14042 [00:21<00:21, 336.04 examples/s]Map:  48%|████▊     | 6792/14042 [00:21<00:21, 335.37 examples/s]Map:  49%|████▊     | 6828/14042 [00:21<00:21, 338.14 examples/s]Map:  49%|████▉     | 6862/14042 [00:21<00:21, 338.34 examples/s]Map:  49%|████▉     | 6898/14042 [00:21<00:21, 339.95 examples/s]Map:  49%|████▉     | 6933/14042 [00:22<00:20, 340.38 examples/s]Map:  50%|████▉     | 6969/14042 [00:22<00:20, 342.10 examples/s]Map:  50%|████▉     | 7017/14042 [00:22<00:41, 167.49 examples/s]Map:  50%|█████     | 7053/14042 [00:22<00:35, 196.13 examples/s]Map:  50%|█████     | 7088/14042 [00:22<00:31, 222.21 examples/s]Map:  51%|█████     | 7124/14042 [00:23<00:27, 247.68 examples/s]Map:  51%|█████     | 7160/14042 [00:23<00:25, 271.23 examples/s]Map:  51%|█████▏    | 7197/14042 [00:23<00:23, 292.50 examples/s]Map:  52%|█████▏    | 7235/14042 [00:23<00:21, 311.89 examples/s]Map:  52%|█████▏    | 7270/14042 [00:23<00:21, 318.41 examples/s]Map:  52%|█████▏    | 7305/14042 [00:23<00:20, 325.47 examples/s]Map:  52%|█████▏    | 7340/14042 [00:23<00:20, 329.25 examples/s]Map:  53%|█████▎    | 7376/14042 [00:23<00:19, 337.28 examples/s]Map:  53%|█████▎    | 7412/14042 [00:23<00:19, 339.80 examples/s]Map:  53%|█████▎    | 7448/14042 [00:23<00:19, 344.67 examples/s]Map:  53%|█████▎    | 7487/14042 [00:24<00:18, 355.81 examples/s]Map:  54%|█████▎    | 7527/14042 [00:24<00:17, 366.42 examples/s]Map:  54%|█████▍    | 7566/14042 [00:24<00:17, 372.10 examples/s]Map:  54%|█████▍    | 7607/14042 [00:24<00:16, 380.15 examples/s]Map:  55%|█████▍    | 7666/14042 [00:24<00:16, 379.48 examples/s]Map:  55%|█████▌    | 7724/14042 [00:24<00:16, 379.87 examples/s]Map:  55%|█████▌    | 7763/14042 [00:24<00:16, 378.47 examples/s]Map:  56%|█████▌    | 7803/14042 [00:24<00:16, 380.17 examples/s]Map:  56%|█████▌    | 7843/14042 [00:24<00:16, 381.44 examples/s]Map:  56%|█████▌    | 7883/14042 [00:25<00:16, 384.81 examples/s]Map:  56%|█████▋    | 7924/14042 [00:25<00:15, 389.10 examples/s]Map:  57%|█████▋    | 7964/14042 [00:25<00:15, 390.42 examples/s]Map:  57%|█████▋    | 8019/14042 [00:25<00:30, 195.14 examples/s]Map:  57%|█████▋    | 8060/14042 [00:25<00:26, 227.39 examples/s]Map:  58%|█████▊    | 8100/14042 [00:26<00:23, 257.68 examples/s]Map:  58%|█████▊    | 8140/14042 [00:26<00:20, 284.81 examples/s]Map:  58%|█████▊    | 8182/14042 [00:26<00:18, 313.26 examples/s]Map:  59%|█████▊    | 8222/14042 [00:26<00:17, 331.91 examples/s]Map:  59%|█████▉    | 8262/14042 [00:26<00:16, 348.59 examples/s]Map:  59%|█████▉    | 8302/14042 [00:26<00:15, 359.80 examples/s]Map:  59%|█████▉    | 8343/14042 [00:26<00:15, 370.05 examples/s]Map:  60%|█████▉    | 8383/14042 [00:26<00:14, 377.34 examples/s]Map:  60%|█████▉    | 8423/14042 [00:26<00:14, 381.08 examples/s]Map:  60%|██████    | 8463/14042 [00:26<00:14, 384.06 examples/s]Map:  61%|██████    | 8503/14042 [00:27<00:14, 384.64 examples/s]Map:  61%|██████    | 8542/14042 [00:27<00:14, 383.29 examples/s]Map:  61%|██████    | 8583/14042 [00:27<00:14, 388.23 examples/s]Map:  61%|██████▏   | 8624/14042 [00:27<00:13, 390.40 examples/s]Map:  62%|██████▏   | 8682/14042 [00:27<00:13, 384.50 examples/s]Map:  62%|██████▏   | 8721/14042 [00:27<00:13, 384.40 examples/s]Map:  63%|██████▎   | 8777/14042 [00:27<00:13, 378.77 examples/s]Map:  63%|██████▎   | 8818/14042 [00:27<00:13, 383.24 examples/s]Map:  63%|██████▎   | 8857/14042 [00:27<00:13, 381.62 examples/s]Map:  63%|██████▎   | 8899/14042 [00:28<00:13, 389.67 examples/s]Map:  64%|██████▍   | 8959/14042 [00:28<00:12, 391.04 examples/s]Map:  64%|██████▍   | 8999/14042 [00:28<00:12, 390.29 examples/s]Map:  64%|██████▍   | 9039/14042 [00:28<00:25, 193.58 examples/s]Map:  65%|██████▍   | 9079/14042 [00:28<00:22, 225.49 examples/s]Map:  65%|██████▍   | 9119/14042 [00:29<00:19, 256.75 examples/s]Map:  65%|██████▌   | 9158/14042 [00:29<00:17, 282.62 examples/s]Map:  66%|██████▌   | 9199/14042 [00:29<00:15, 310.65 examples/s]Map:  66%|██████▌   | 9239/14042 [00:29<00:14, 328.16 examples/s]Map:  66%|██████▌   | 9280/14042 [00:29<00:13, 347.51 examples/s]Map:  66%|██████▋   | 9320/14042 [00:29<00:13, 359.59 examples/s]Map:  67%|██████▋   | 9360/14042 [00:29<00:12, 365.95 examples/s]Map:  67%|██████▋   | 9417/14042 [00:29<00:12, 367.54 examples/s]Map:  67%|██████▋   | 9457/14042 [00:29<00:12, 374.59 examples/s]Map:  68%|██████▊   | 9498/14042 [00:30<00:11, 382.62 examples/s]Map:  68%|██████▊   | 9538/14042 [00:30<00:11, 385.66 examples/s]Map:  68%|██████▊   | 9588/14042 [00:30<00:12, 363.24 examples/s]Map:  69%|██████▊   | 9638/14042 [00:30<00:12, 350.83 examples/s]Map:  69%|██████▉   | 9689/14042 [00:30<00:12, 341.91 examples/s]Map:  69%|██████▉   | 9725/14042 [00:30<00:18, 236.84 examples/s]Map:  69%|██████▉   | 9756/14042 [00:30<00:17, 248.54 examples/s]Map:  70%|██████▉   | 9791/14042 [00:31<00:15, 267.74 examples/s]Map:  70%|██████▉   | 9827/14042 [00:31<00:14, 287.43 examples/s]Map:  70%|███████   | 9863/14042 [00:31<00:13, 304.52 examples/s]Map:  70%|███████   | 9898/14042 [00:31<00:13, 315.39 examples/s]Map:  71%|███████   | 9936/14042 [00:31<00:12, 328.55 examples/s]Map:  71%|███████   | 9973/14042 [00:31<00:12, 337.88 examples/s]Map:  71%|███████▏  | 10017/14042 [00:32<00:23, 169.80 examples/s]Map:  72%|███████▏  | 10057/14042 [00:32<00:19, 204.85 examples/s]Map:  72%|███████▏  | 10098/14042 [00:32<00:16, 241.35 examples/s]Map:  72%|███████▏  | 10139/14042 [00:32<00:14, 274.71 examples/s]Map:  72%|███████▏  | 10177/14042 [00:32<00:13, 296.33 examples/s]Map:  73%|███████▎  | 10217/14042 [00:32<00:11, 319.78 examples/s]Map:  73%|███████▎  | 10257/14042 [00:32<00:11, 337.78 examples/s]Map:  73%|███████▎  | 10297/14042 [00:32<00:10, 353.95 examples/s]Map:  74%|███████▎  | 10355/14042 [00:32<00:10, 363.97 examples/s]Map:  74%|███████▍  | 10412/14042 [00:33<00:09, 364.62 examples/s]Map:  74%|███████▍  | 10451/14042 [00:33<00:09, 368.29 examples/s]Map:  75%|███████▍  | 10490/14042 [00:33<00:09, 370.15 examples/s]Map:  75%|███████▍  | 10529/14042 [00:33<00:09, 370.65 examples/s]Map:  75%|███████▌  | 10584/14042 [00:33<00:09, 366.88 examples/s]Map:  76%|███████▌  | 10625/14042 [00:33<00:09, 373.67 examples/s]Map:  76%|███████▌  | 10666/14042 [00:33<00:08, 379.02 examples/s]Map:  76%|███████▌  | 10706/14042 [00:33<00:08, 380.07 examples/s]Map:  77%|███████▋  | 10745/14042 [00:33<00:08, 381.23 examples/s]Map:  77%|███████▋  | 10802/14042 [00:34<00:08, 377.96 examples/s]Map:  77%|███████▋  | 10843/14042 [00:34<00:08, 383.32 examples/s]Map:  77%|███████▋  | 10882/14042 [00:34<00:08, 381.61 examples/s]Map:  78%|███████▊  | 10921/14042 [00:34<00:08, 381.51 examples/s]Map:  78%|███████▊  | 10960/14042 [00:34<00:08, 382.72 examples/s]Map:  78%|███████▊  | 11000/14042 [00:35<00:16, 187.01 examples/s]Map:  79%|███████▊  | 11039/14042 [00:35<00:13, 219.34 examples/s]Map:  79%|███████▉  | 11079/14042 [00:35<00:11, 252.54 examples/s]Map:  79%|███████▉  | 11121/14042 [00:35<00:10, 286.35 examples/s]Map:  79%|███████▉  | 11161/14042 [00:35<00:09, 312.50 examples/s]Map:  80%|███████▉  | 11201/14042 [00:35<00:08, 332.31 examples/s]Map:  80%|████████  | 11255/14042 [00:35<00:08, 337.83 examples/s]Map:  80%|████████  | 11292/14042 [00:35<00:07, 344.31 examples/s]Map:  81%|████████  | 11329/14042 [00:35<00:07, 350.31 examples/s]Map:  81%|████████  | 11366/14042 [00:36<00:07, 352.47 examples/s]Map:  81%|████████▏ | 11420/14042 [00:36<00:07, 352.27 examples/s]Map:  82%|████████▏ | 11457/14042 [00:36<00:07, 353.54 examples/s]Map:  82%|████████▏ | 11495/14042 [00:36<00:07, 358.90 examples/s]Map:  82%|████████▏ | 11535/14042 [00:36<00:06, 366.61 examples/s]Map:  82%|████████▏ | 11574/14042 [00:36<00:06, 371.82 examples/s]Map:  83%|████████▎ | 11614/14042 [00:36<00:06, 375.00 examples/s]Map:  83%|████████▎ | 11654/14042 [00:36<00:06, 379.60 examples/s]Map:  83%|████████▎ | 11695/14042 [00:36<00:06, 385.09 examples/s]Map:  84%|████████▎ | 11737/14042 [00:36<00:05, 391.64 examples/s]Map:  84%|████████▍ | 11778/14042 [00:37<00:05, 393.34 examples/s]Map:  84%|████████▍ | 11818/14042 [00:37<00:05, 390.62 examples/s]Map:  84%|████████▍ | 11858/14042 [00:37<00:05, 391.03 examples/s]Map:  85%|████████▍ | 11898/14042 [00:37<00:05, 393.09 examples/s]Map:  85%|████████▌ | 11958/14042 [00:37<00:05, 390.68 examples/s]Map:  85%|████████▌ | 12000/14042 [00:38<00:10, 192.67 examples/s]Map:  86%|████████▌ | 12038/14042 [00:38<00:09, 220.99 examples/s]Map:  86%|████████▌ | 12078/14042 [00:38<00:07, 253.33 examples/s]Map:  86%|████████▋ | 12119/14042 [00:38<00:06, 284.10 examples/s]Map:  87%|████████▋ | 12158/14042 [00:38<00:06, 306.28 examples/s]Map:  87%|████████▋ | 12198/14042 [00:38<00:05, 326.70 examples/s]Map:  87%|████████▋ | 12238/14042 [00:38<00:05, 343.44 examples/s]Map:  87%|████████▋ | 12279/14042 [00:38<00:04, 358.45 examples/s]Map:  88%|████████▊ | 12319/14042 [00:38<00:04, 368.09 examples/s]Map:  88%|████████▊ | 12358/14042 [00:38<00:04, 373.44 examples/s]Map:  88%|████████▊ | 12397/14042 [00:39<00:04, 376.25 examples/s]Map:  89%|████████▊ | 12436/14042 [00:39<00:04, 378.29 examples/s]Map:  89%|████████▉ | 12476/14042 [00:39<00:04, 383.09 examples/s]Map:  89%|████████▉ | 12517/14042 [00:39<00:03, 386.68 examples/s]Map:  90%|████████▉ | 12575/14042 [00:39<00:03, 379.78 examples/s]Map:  90%|████████▉ | 12616/14042 [00:39<00:03, 386.50 examples/s]Map:  90%|█████████ | 12675/14042 [00:39<00:03, 385.84 examples/s]Map:  91%|█████████ | 12714/14042 [00:39<00:03, 385.19 examples/s]Map:  91%|█████████ | 12753/14042 [00:39<00:03, 385.67 examples/s]Map:  91%|█████████ | 12792/14042 [00:40<00:03, 384.64 examples/s]Map:  91%|█████████▏| 12833/14042 [00:40<00:03, 388.58 examples/s]Map:  92%|█████████▏| 12875/14042 [00:40<00:02, 394.88 examples/s]Map:  92%|█████████▏| 12915/14042 [00:40<00:02, 394.75 examples/s]Map:  92%|█████████▏| 12971/14042 [00:40<00:02, 383.13 examples/s]Map:  93%|█████████▎| 13019/14042 [00:41<00:05, 197.19 examples/s]Map:  93%|█████████▎| 13058/14042 [00:41<00:04, 226.27 examples/s]Map:  93%|█████████▎| 13098/14042 [00:41<00:03, 256.79 examples/s]Map:  94%|█████████▎| 13137/14042 [00:41<00:03, 282.03 examples/s]Map:  94%|█████████▍| 13179/14042 [00:41<00:02, 310.27 examples/s]Map:  94%|█████████▍| 13218/14042 [00:41<00:02, 328.17 examples/s]Map:  94%|█████████▍| 13258/14042 [00:41<00:02, 345.75 examples/s]Map:  95%|█████████▍| 13301/14042 [00:41<00:02, 364.19 examples/s]Map:  95%|█████████▌| 13359/14042 [00:41<00:01, 371.48 examples/s]Map:  95%|█████████▌| 13399/14042 [00:42<00:01, 376.20 examples/s]Map:  96%|█████████▌| 13442/14042 [00:42<00:01, 388.23 examples/s]Map:  96%|█████████▌| 13482/14042 [00:42<00:01, 388.10 examples/s]Map:  96%|█████████▋| 13541/14042 [00:42<00:01, 385.17 examples/s]Map:  97%|█████████▋| 13582/14042 [00:42<00:01, 387.01 examples/s]Map:  97%|█████████▋| 13624/14042 [00:42<00:01, 393.80 examples/s]Map:  97%|█████████▋| 13683/14042 [00:42<00:00, 392.45 examples/s]Map:  98%|█████████▊| 13743/14042 [00:42<00:00, 391.34 examples/s]Map:  98%|█████████▊| 13783/14042 [00:43<00:00, 392.03 examples/s]Map:  99%|█████████▊| 13841/14042 [00:43<00:00, 387.45 examples/s]Map:  99%|█████████▉| 13882/14042 [00:43<00:00, 388.48 examples/s]Map:  99%|█████████▉| 13923/14042 [00:43<00:00, 391.87 examples/s]Map: 100%|█████████▉| 13982/14042 [00:43<00:00, 388.95 examples/s]Map: 100%|█████████▉| 14040/14042 [00:44<00:00, 204.93 examples/s]Map: 100%|██████████| 14042/14042 [00:46<00:00, 299.36 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 29/10042 [00:00<00:36, 276.91 examples/s]Map:   1%|          | 59/10042 [00:00<00:34, 285.74 examples/s]Map:   1%|          | 89/10042 [00:00<00:34, 290.86 examples/s]Map:   1%|          | 121/10042 [00:00<00:33, 294.91 examples/s]Map:   2%|▏         | 165/10042 [00:00<00:34, 289.34 examples/s]Map:   2%|▏         | 197/10042 [00:00<00:33, 294.33 examples/s]Map:   2%|▏         | 229/10042 [00:00<00:32, 297.98 examples/s]Map:   3%|▎         | 260/10042 [00:00<00:32, 299.35 examples/s]Map:   3%|▎         | 305/10042 [00:01<00:47, 203.70 examples/s]Map:   3%|▎         | 336/10042 [00:01<00:43, 223.81 examples/s]Map:   4%|▎         | 368/10042 [00:01<00:39, 243.66 examples/s]Map:   4%|▍         | 400/10042 [00:01<00:37, 258.79 examples/s]Map:   4%|▍         | 432/10042 [00:01<00:35, 271.11 examples/s]Map:   5%|▍         | 464/10042 [00:01<00:34, 281.56 examples/s]Map:   5%|▍         | 496/10042 [00:01<00:33, 288.86 examples/s]Map:   5%|▌         | 528/10042 [00:01<00:32, 293.55 examples/s]Map:   6%|▌         | 560/10042 [00:02<00:31, 298.59 examples/s]Map:   6%|▌         | 592/10042 [00:02<00:31, 302.04 examples/s]Map:   6%|▌         | 624/10042 [00:02<00:31, 302.55 examples/s]Map:   7%|▋         | 656/10042 [00:02<00:30, 303.88 examples/s]Map:   7%|▋         | 702/10042 [00:02<00:30, 301.70 examples/s]Map:   7%|▋         | 734/10042 [00:02<00:30, 303.42 examples/s]Map:   8%|▊         | 766/10042 [00:02<00:30, 304.24 examples/s]Map:   8%|▊         | 798/10042 [00:02<00:30, 305.42 examples/s]Map:   8%|▊         | 830/10042 [00:02<00:30, 305.14 examples/s]Map:   9%|▊         | 862/10042 [00:03<00:30, 305.53 examples/s]Map:   9%|▉         | 894/10042 [00:03<00:30, 304.69 examples/s]Map:   9%|▉         | 926/10042 [00:03<00:29, 305.10 examples/s]Map:  10%|▉         | 958/10042 [00:03<00:29, 305.38 examples/s]Map:  10%|▉         | 989/10042 [00:03<00:29, 304.63 examples/s]Map:  10%|█         | 1031/10042 [00:04<01:23, 107.61 examples/s]Map:  11%|█         | 1063/10042 [00:04<01:08, 131.65 examples/s]Map:  11%|█         | 1094/10042 [00:04<00:57, 156.38 examples/s]Map:  11%|█         | 1126/10042 [00:04<00:48, 182.96 examples/s]Map:  12%|█▏        | 1158/10042 [00:04<00:42, 207.55 examples/s]Map:  12%|█▏        | 1190/10042 [00:04<00:38, 229.69 examples/s]Map:  12%|█▏        | 1222/10042 [00:04<00:35, 248.31 examples/s]Map:  12%|█▏        | 1254/10042 [00:05<00:33, 262.75 examples/s]Map:  13%|█▎        | 1286/10042 [00:05<00:31, 273.90 examples/s]Map:  13%|█▎        | 1317/10042 [00:05<00:30, 281.62 examples/s]Map:  13%|█▎        | 1348/10042 [00:05<00:30, 287.22 examples/s]Map:  14%|█▎        | 1379/10042 [00:05<00:29, 290.64 examples/s]Map:  14%|█▍        | 1411/10042 [00:05<00:29, 295.10 examples/s]Map:  14%|█▍        | 1443/10042 [00:05<00:28, 297.46 examples/s]Map:  15%|█▍        | 1475/10042 [00:05<00:28, 299.75 examples/s]Map:  15%|█▌        | 1507/10042 [00:05<00:28, 303.25 examples/s]Map:  15%|█▌        | 1539/10042 [00:05<00:28, 303.05 examples/s]Map:  16%|█▌        | 1570/10042 [00:06<00:27, 302.81 examples/s]Map:  16%|█▌        | 1602/10042 [00:06<00:27, 303.16 examples/s]Map:  16%|█▋        | 1633/10042 [00:06<00:27, 302.36 examples/s]Map:  17%|█▋        | 1664/10042 [00:06<00:27, 301.72 examples/s]Map:  17%|█▋        | 1696/10042 [00:06<00:27, 303.50 examples/s]Map:  17%|█▋        | 1728/10042 [00:06<00:27, 305.41 examples/s]Map:  18%|█▊        | 1772/10042 [00:06<00:27, 298.73 examples/s]Map:  18%|█▊        | 1818/10042 [00:06<00:27, 298.54 examples/s]Map:  18%|█▊        | 1849/10042 [00:06<00:27, 298.77 examples/s]Map:  19%|█▊        | 1881/10042 [00:07<00:27, 300.41 examples/s]Map:  19%|█▉        | 1913/10042 [00:07<00:26, 301.68 examples/s]Map:  19%|█▉        | 1944/10042 [00:07<00:26, 301.68 examples/s]Map:  20%|█▉        | 1975/10042 [00:07<00:26, 302.16 examples/s]Map:  20%|██        | 2015/10042 [00:07<00:54, 147.50 examples/s]Map:  20%|██        | 2047/10042 [00:08<00:46, 173.29 examples/s]Map:  21%|██        | 2079/10042 [00:08<00:40, 197.68 examples/s]Map:  21%|██        | 2111/10042 [00:08<00:35, 220.35 examples/s]Map:  21%|██▏       | 2142/10042 [00:08<00:33, 239.36 examples/s]Map:  22%|██▏       | 2174/10042 [00:08<00:30, 257.57 examples/s]Map:  22%|██▏       | 2206/10042 [00:08<00:28, 270.58 examples/s]Map:  22%|██▏       | 2238/10042 [00:08<00:27, 280.56 examples/s]Map:  23%|██▎       | 2269/10042 [00:08<00:27, 286.53 examples/s]Map:  23%|██▎       | 2301/10042 [00:08<00:26, 294.27 examples/s]Map:  23%|██▎       | 2333/10042 [00:08<00:25, 298.32 examples/s]Map:  24%|██▎       | 2365/10042 [00:09<00:25, 301.84 examples/s]Map:  24%|██▍       | 2397/10042 [00:09<00:25, 303.52 examples/s]Map:  24%|██▍       | 2429/10042 [00:09<00:25, 303.83 examples/s]Map:  24%|██▍       | 2460/10042 [00:09<00:25, 302.61 examples/s]Map:  25%|██▍       | 2499/10042 [00:09<00:26, 282.17 examples/s]Map:  25%|██▌       | 2541/10042 [00:09<00:27, 277.59 examples/s]Map:  26%|██▌       | 2573/10042 [00:09<00:26, 284.67 examples/s]Map:  26%|██▌       | 2603/10042 [00:09<00:26, 285.97 examples/s]Map:  26%|██▌       | 2635/10042 [00:10<00:25, 290.89 examples/s]Map:  27%|██▋       | 2666/10042 [00:10<00:25, 294.51 examples/s]Map:  27%|██▋       | 2698/10042 [00:10<00:24, 297.64 examples/s]Map:  27%|██▋       | 2729/10042 [00:10<00:24, 298.37 examples/s]Map:  27%|██▋       | 2760/10042 [00:10<00:24, 299.83 examples/s]Map:  28%|██▊       | 2791/10042 [00:10<00:24, 301.31 examples/s]Map:  28%|██▊       | 2823/10042 [00:10<00:23, 303.72 examples/s]Map:  28%|██▊       | 2855/10042 [00:10<00:23, 303.93 examples/s]Map:  29%|██▊       | 2887/10042 [00:10<00:23, 304.93 examples/s]Map:  29%|██▉       | 2919/10042 [00:10<00:23, 305.54 examples/s]Map:  29%|██▉       | 2950/10042 [00:11<00:23, 304.60 examples/s]Map:  30%|██▉       | 2981/10042 [00:11<00:23, 303.64 examples/s]Map:  30%|███       | 3015/10042 [00:11<00:48, 146.36 examples/s]Map:  30%|███       | 3045/10042 [00:11<00:40, 170.80 examples/s]Map:  31%|███       | 3075/10042 [00:11<00:35, 193.67 examples/s]Map:  31%|███       | 3105/10042 [00:11<00:32, 215.22 examples/s]Map:  31%|███       | 3137/10042 [00:12<00:29, 236.75 examples/s]Map:  32%|███▏      | 3168/10042 [00:12<00:27, 253.44 examples/s]Map:  32%|███▏      | 3200/10042 [00:12<00:25, 266.33 examples/s]Map:  32%|███▏      | 3231/10042 [00:12<00:24, 276.53 examples/s]Map:  32%|███▏      | 3261/10042 [00:12<00:24, 279.99 examples/s]Map:  33%|███▎      | 3304/10042 [00:12<00:24, 280.20 examples/s]Map:  33%|███▎      | 3334/10042 [00:12<00:23, 281.82 examples/s]Map:  33%|███▎      | 3364/10042 [00:12<00:23, 282.53 examples/s]Map:  34%|███▍      | 3394/10042 [00:12<00:23, 282.67 examples/s]Map:  34%|███▍      | 3424/10042 [00:13<00:23, 282.89 examples/s]Map:  35%|███▍      | 3467/10042 [00:13<00:23, 281.85 examples/s]Map:  35%|███▍      | 3497/10042 [00:13<00:23, 282.36 examples/s]Map:  35%|███▌      | 3526/10042 [00:13<00:23, 282.98 examples/s]Map:  35%|███▌      | 3556/10042 [00:13<00:22, 284.62 examples/s]Map:  36%|███▌      | 3586/10042 [00:13<00:22, 285.47 examples/s]Map:  36%|███▌      | 3615/10042 [00:13<00:22, 281.97 examples/s]Map:  36%|███▋      | 3644/10042 [00:13<00:22, 280.34 examples/s]Map:  37%|███▋      | 3687/10042 [00:13<00:22, 279.53 examples/s]Map:  37%|███▋      | 3716/10042 [00:14<00:22, 280.57 examples/s]Map:  37%|███▋      | 3758/10042 [00:14<00:22, 277.84 examples/s]Map:  38%|███▊      | 3787/10042 [00:14<00:22, 278.47 examples/s]Map:  38%|███▊      | 3816/10042 [00:14<00:22, 279.05 examples/s]Map:  38%|███▊      | 3845/10042 [00:14<00:22, 279.13 examples/s]Map:  39%|███▊      | 3874/10042 [00:14<00:22, 279.27 examples/s]Map:  39%|███▉      | 3904/10042 [00:14<00:21, 280.33 examples/s]Map:  39%|███▉      | 3933/10042 [00:14<00:21, 280.58 examples/s]Map:  40%|███▉      | 3976/10042 [00:15<00:21, 279.21 examples/s]Map:  40%|███▉      | 4014/10042 [00:15<00:41, 145.97 examples/s]Map:  40%|████      | 4043/10042 [00:15<00:35, 167.21 examples/s]Map:  41%|████      | 4071/10042 [00:15<00:31, 186.71 examples/s]Map:  41%|████      | 4100/10042 [00:15<00:28, 206.08 examples/s]Map:  41%|████      | 4129/10042 [00:15<00:26, 222.59 examples/s]Map:  41%|████▏     | 4159/10042 [00:16<00:24, 238.72 examples/s]Map:  42%|████▏     | 4189/10042 [00:16<00:23, 250.99 examples/s]Map:  42%|████▏     | 4219/10042 [00:16<00:22, 261.01 examples/s]Map:  42%|████▏     | 4249/10042 [00:16<00:21, 268.53 examples/s]Map:  43%|████▎     | 4279/10042 [00:16<00:21, 273.74 examples/s]Map:  43%|████▎     | 4309/10042 [00:16<00:20, 277.76 examples/s]Map:  43%|████▎     | 4339/10042 [00:16<00:20, 279.58 examples/s]Map:  44%|████▎     | 4369/10042 [00:16<00:20, 279.95 examples/s]Map:  44%|████▍     | 4399/10042 [00:16<00:19, 284.09 examples/s]Map:  44%|████▍     | 4429/10042 [00:16<00:19, 284.50 examples/s]Map:  44%|████▍     | 4459/10042 [00:17<00:19, 284.70 examples/s]Map:  45%|████▍     | 4488/10042 [00:17<00:19, 285.42 examples/s]Map:  45%|████▍     | 4518/10042 [00:17<00:19, 284.64 examples/s]Map:  45%|████▌     | 4547/10042 [00:17<00:19, 282.83 examples/s]Map:  46%|████▌     | 4587/10042 [00:17<00:19, 274.16 examples/s]Map:  46%|████▌     | 4616/10042 [00:17<00:19, 275.17 examples/s]Map:  46%|████▋     | 4645/10042 [00:17<00:19, 276.69 examples/s]Map:  47%|████▋     | 4674/10042 [00:17<00:19, 278.40 examples/s]Map:  47%|████▋     | 4704/10042 [00:17<00:19, 280.12 examples/s]Map:  47%|████▋     | 4747/10042 [00:18<00:18, 281.30 examples/s]Map:  48%|████▊     | 4777/10042 [00:18<00:18, 282.82 examples/s]Map:  48%|████▊     | 4806/10042 [00:18<00:18, 282.50 examples/s]Map:  48%|████▊     | 4835/10042 [00:18<00:18, 282.54 examples/s]Map:  48%|████▊     | 4864/10042 [00:18<00:18, 281.84 examples/s]Map:  49%|████▊     | 4894/10042 [00:18<00:18, 283.18 examples/s]Map:  49%|████▉     | 4923/10042 [00:18<00:18, 281.62 examples/s]Map:  49%|████▉     | 4952/10042 [00:18<00:18, 282.12 examples/s]Map:  50%|████▉     | 4981/10042 [00:18<00:17, 281.68 examples/s]Map:  50%|████▉     | 5014/10042 [00:19<00:45, 109.61 examples/s]Map:  50%|█████     | 5042/10042 [00:19<00:37, 131.78 examples/s]Map:  50%|█████     | 5070/10042 [00:19<00:32, 154.29 examples/s]Map:  51%|█████     | 5100/10042 [00:19<00:27, 179.04 examples/s]Map:  51%|█████     | 5130/10042 [00:20<00:24, 201.64 examples/s]Map:  51%|█████▏    | 5160/10042 [00:20<00:22, 221.02 examples/s]Map:  52%|█████▏    | 5190/10042 [00:20<00:20, 236.92 examples/s]Map:  52%|█████▏    | 5220/10042 [00:20<00:19, 250.79 examples/s]Map:  52%|█████▏    | 5250/10042 [00:20<00:18, 261.26 examples/s]Map:  53%|█████▎    | 5280/10042 [00:20<00:17, 270.68 examples/s]Map:  53%|█████▎    | 5309/10042 [00:20<00:17, 274.21 examples/s]Map:  53%|█████▎    | 5339/10042 [00:20<00:16, 277.78 examples/s]Map:  53%|█████▎    | 5369/10042 [00:20<00:16, 279.34 examples/s]Map:  54%|█████▍    | 5399/10042 [00:20<00:16, 281.39 examples/s]Map:  54%|█████▍    | 5429/10042 [00:21<00:16, 283.54 examples/s]Map:  54%|█████▍    | 5458/10042 [00:21<00:16, 281.48 examples/s]Map:  55%|█████▍    | 5488/10042 [00:21<00:16, 281.68 examples/s]Map:  55%|█████▍    | 5518/10042 [00:21<00:16, 282.45 examples/s]Map:  55%|█████▌    | 5548/10042 [00:21<00:15, 283.61 examples/s]Map:  56%|█████▌    | 5578/10042 [00:21<00:15, 283.65 examples/s]Map:  56%|█████▌    | 5608/10042 [00:21<00:15, 283.34 examples/s]Map:  56%|█████▌    | 5638/10042 [00:21<00:15, 283.31 examples/s]Map:  56%|█████▋    | 5668/10042 [00:21<00:15, 283.04 examples/s]Map:  57%|█████▋    | 5698/10042 [00:22<00:15, 283.86 examples/s]Map:  57%|█████▋    | 5727/10042 [00:22<00:15, 284.24 examples/s]Map:  57%|█████▋    | 5756/10042 [00:22<00:15, 282.51 examples/s]Map:  58%|█████▊    | 5786/10042 [00:22<00:15, 282.76 examples/s]Map:  58%|█████▊    | 5816/10042 [00:22<00:14, 284.16 examples/s]Map:  58%|█████▊    | 5846/10042 [00:22<00:14, 283.72 examples/s]Map:  59%|█████▊    | 5876/10042 [00:22<00:14, 282.91 examples/s]Map:  59%|█████▉    | 5906/10042 [00:22<00:14, 283.04 examples/s]Map:  59%|█████▉    | 5936/10042 [00:22<00:14, 284.15 examples/s]Map:  59%|█████▉    | 5965/10042 [00:22<00:14, 284.38 examples/s]Map:  60%|█████▉    | 5995/10042 [00:23<00:14, 284.98 examples/s]Map:  60%|██████    | 6029/10042 [00:23<00:28, 141.36 examples/s]Map:  60%|██████    | 6059/10042 [00:23<00:24, 165.71 examples/s]Map:  61%|██████    | 6088/10042 [00:23<00:21, 187.76 examples/s]Map:  61%|██████    | 6117/10042 [00:23<00:18, 208.01 examples/s]Map:  61%|██████    | 6146/10042 [00:23<00:17, 225.23 examples/s]Map:  62%|██████▏   | 6176/10042 [00:24<00:16, 241.31 examples/s]Map:  62%|██████▏   | 6206/10042 [00:24<00:15, 252.73 examples/s]Map:  62%|██████▏   | 6236/10042 [00:24<00:14, 262.18 examples/s]Map:  62%|██████▏   | 6266/10042 [00:24<00:14, 268.18 examples/s]Map:  63%|██████▎   | 6296/10042 [00:24<00:13, 272.26 examples/s]Map:  63%|██████▎   | 6326/10042 [00:24<00:13, 276.76 examples/s]Map:  63%|██████▎   | 6356/10042 [00:24<00:13, 279.15 examples/s]Map:  64%|██████▎   | 6386/10042 [00:24<00:13, 280.28 examples/s]Map:  64%|██████▍   | 6416/10042 [00:24<00:12, 282.13 examples/s]Map:  64%|██████▍   | 6446/10042 [00:25<00:12, 284.58 examples/s]Map:  64%|██████▍   | 6476/10042 [00:25<00:12, 285.16 examples/s]Map:  65%|██████▍   | 6505/10042 [00:25<00:12, 283.76 examples/s]Map:  65%|██████▌   | 6534/10042 [00:25<00:12, 282.11 examples/s]Map:  65%|██████▌   | 6563/10042 [00:25<00:12, 282.67 examples/s]Map:  66%|██████▌   | 6593/10042 [00:25<00:12, 284.00 examples/s]Map:  66%|██████▌   | 6636/10042 [00:25<00:12, 280.16 examples/s]Map:  66%|██████▋   | 6666/10042 [00:25<00:12, 281.21 examples/s]Map:  67%|██████▋   | 6696/10042 [00:25<00:11, 281.64 examples/s]Map:  67%|██████▋   | 6726/10042 [00:26<00:11, 281.30 examples/s]Map:  67%|██████▋   | 6755/10042 [00:26<00:11, 280.07 examples/s]Map:  68%|██████▊   | 6785/10042 [00:26<00:11, 282.18 examples/s]Map:  68%|██████▊   | 6815/10042 [00:26<00:11, 282.83 examples/s]Map:  68%|██████▊   | 6844/10042 [00:26<00:11, 282.57 examples/s]Map:  68%|██████▊   | 6874/10042 [00:26<00:11, 283.98 examples/s]Map:  69%|██████▊   | 6903/10042 [00:26<00:11, 282.68 examples/s]Map:  69%|██████▉   | 6945/10042 [00:26<00:11, 279.52 examples/s]Map:  69%|██████▉   | 6975/10042 [00:26<00:10, 280.08 examples/s]Map:  70%|██████▉   | 7014/10042 [00:27<00:20, 144.28 examples/s]Map:  70%|███████   | 7043/10042 [00:27<00:18, 165.79 examples/s]Map:  70%|███████   | 7072/10042 [00:27<00:15, 186.55 examples/s]Map:  71%|███████   | 7100/10042 [00:27<00:14, 204.66 examples/s]Map:  71%|███████   | 7128/10042 [00:27<00:13, 219.39 examples/s]Map:  71%|███████▏  | 7157/10042 [00:27<00:12, 234.87 examples/s]Map:  72%|███████▏  | 7187/10042 [00:28<00:11, 248.91 examples/s]Map:  72%|███████▏  | 7217/10042 [00:28<00:10, 260.08 examples/s]Map:  72%|███████▏  | 7247/10042 [00:28<00:10, 267.28 examples/s]Map:  72%|███████▏  | 7277/10042 [00:28<00:10, 271.65 examples/s]Map:  73%|███████▎  | 7307/10042 [00:28<00:09, 274.72 examples/s]Map:  73%|███████▎  | 7337/10042 [00:28<00:09, 278.15 examples/s]Map:  73%|███████▎  | 7366/10042 [00:28<00:09, 279.13 examples/s]Map:  74%|███████▎  | 7396/10042 [00:28<00:09, 281.43 examples/s]Map:  74%|███████▍  | 7426/10042 [00:28<00:09, 282.50 examples/s]Map:  74%|███████▍  | 7455/10042 [00:29<00:09, 281.82 examples/s]Map:  75%|███████▍  | 7485/10042 [00:29<00:09, 283.00 examples/s]Map:  75%|███████▍  | 7514/10042 [00:29<00:08, 282.86 examples/s]Map:  75%|███████▌  | 7543/10042 [00:29<00:08, 282.44 examples/s]Map:  75%|███████▌  | 7573/10042 [00:29<00:08, 284.83 examples/s]Map:  76%|███████▌  | 7603/10042 [00:29<00:08, 285.01 examples/s]Map:  76%|███████▌  | 7633/10042 [00:29<00:08, 286.03 examples/s]Map:  76%|███████▋  | 7663/10042 [00:29<00:08, 285.66 examples/s]Map:  77%|███████▋  | 7693/10042 [00:29<00:08, 286.92 examples/s]Map:  77%|███████▋  | 7722/10042 [00:29<00:08, 284.71 examples/s]Map:  77%|███████▋  | 7752/10042 [00:30<00:08, 284.60 examples/s]Map:  78%|███████▊  | 7794/10042 [00:30<00:08, 278.79 examples/s]Map:  78%|███████▊  | 7823/10042 [00:30<00:07, 279.62 examples/s]Map:  78%|███████▊  | 7852/10042 [00:30<00:07, 279.99 examples/s]Map:  78%|███████▊  | 7882/10042 [00:30<00:07, 281.56 examples/s]Map:  79%|███████▉  | 7912/10042 [00:30<00:07, 281.96 examples/s]Map:  79%|███████▉  | 7942/10042 [00:30<00:07, 282.86 examples/s]Map:  79%|███████▉  | 7971/10042 [00:30<00:07, 282.39 examples/s]Map:  80%|███████▉  | 8000/10042 [00:31<00:14, 137.12 examples/s]Map:  80%|███████▉  | 8029/10042 [00:31<00:12, 161.31 examples/s]Map:  80%|████████  | 8059/10042 [00:31<00:10, 186.21 examples/s]Map:  81%|████████  | 8088/10042 [00:31<00:09, 207.29 examples/s]Map:  81%|████████  | 8116/10042 [00:31<00:08, 222.93 examples/s]Map:  81%|████████  | 8146/10042 [00:31<00:07, 239.48 examples/s]Map:  81%|████████▏ | 8175/10042 [00:31<00:07, 250.53 examples/s]Map:  82%|████████▏ | 8204/10042 [00:32<00:07, 259.24 examples/s]Map:  82%|████████▏ | 8234/10042 [00:32<00:06, 267.50 examples/s]Map:  82%|████████▏ | 8263/10042 [00:32<00:06, 271.80 examples/s]Map:  83%|████████▎ | 8293/10042 [00:32<00:06, 276.05 examples/s]Map:  83%|████████▎ | 8322/10042 [00:32<00:06, 277.00 examples/s]Map:  83%|████████▎ | 8352/10042 [00:32<00:06, 278.63 examples/s]Map:  83%|████████▎ | 8382/10042 [00:32<00:05, 280.60 examples/s]Map:  84%|████████▍ | 8411/10042 [00:32<00:05, 279.76 examples/s]Map:  84%|████████▍ | 8441/10042 [00:32<00:05, 281.31 examples/s]Map:  84%|████████▍ | 8470/10042 [00:32<00:05, 281.12 examples/s]Map:  85%|████████▍ | 8499/10042 [00:33<00:05, 281.21 examples/s]Map:  85%|████████▍ | 8529/10042 [00:33<00:05, 281.28 examples/s]Map:  85%|████████▌ | 8559/10042 [00:33<00:05, 281.81 examples/s]Map:  86%|████████▌ | 8588/10042 [00:33<00:05, 281.18 examples/s]Map:  86%|████████▌ | 8617/10042 [00:33<00:05, 281.24 examples/s]Map:  86%|████████▌ | 8647/10042 [00:33<00:04, 282.14 examples/s]Map:  86%|████████▋ | 8676/10042 [00:33<00:04, 281.28 examples/s]Map:  87%|████████▋ | 8706/10042 [00:33<00:04, 282.87 examples/s]Map:  87%|████████▋ | 8735/10042 [00:33<00:04, 282.13 examples/s]Map:  87%|████████▋ | 8765/10042 [00:34<00:04, 281.82 examples/s]Map:  88%|████████▊ | 8795/10042 [00:34<00:04, 282.15 examples/s]Map:  88%|████████▊ | 8825/10042 [00:34<00:04, 281.97 examples/s]Map:  88%|████████▊ | 8855/10042 [00:34<00:04, 282.92 examples/s]Map:  88%|████████▊ | 8885/10042 [00:34<00:04, 283.64 examples/s]Map:  89%|████████▉ | 8914/10042 [00:34<00:03, 282.44 examples/s]Map:  89%|████████▉ | 8957/10042 [00:34<00:03, 280.53 examples/s]Map:  89%|████████▉ | 8987/10042 [00:34<00:03, 280.99 examples/s]Map:  90%|████████▉ | 9029/10042 [00:35<00:06, 153.40 examples/s]Map:  90%|█████████ | 9058/10042 [00:35<00:05, 174.08 examples/s]Map:  90%|█████████ | 9088/10042 [00:35<00:04, 195.43 examples/s]Map:  91%|█████████ | 9117/10042 [00:35<00:04, 213.41 examples/s]Map:  91%|█████████ | 9146/10042 [00:35<00:03, 228.87 examples/s]Map:  91%|█████████▏| 9175/10042 [00:35<00:03, 241.58 examples/s]Map:  92%|█████████▏| 9204/10042 [00:35<00:03, 251.32 examples/s]Map:  92%|█████████▏| 9234/10042 [00:36<00:03, 260.72 examples/s]Map:  92%|█████████▏| 9264/10042 [00:36<00:02, 267.36 examples/s]Map:  93%|█████████▎| 9294/10042 [00:36<00:02, 272.90 examples/s]Map:  93%|█████████▎| 9324/10042 [00:36<00:02, 277.22 examples/s]Map:  93%|█████████▎| 9354/10042 [00:36<00:02, 279.32 examples/s]Map:  93%|█████████▎| 9384/10042 [00:36<00:02, 280.64 examples/s]Map:  94%|█████████▎| 9413/10042 [00:36<00:02, 281.69 examples/s]Map:  94%|█████████▍| 9443/10042 [00:36<00:02, 283.42 examples/s]Map:  94%|█████████▍| 9473/10042 [00:36<00:02, 282.42 examples/s]Map:  95%|█████████▍| 9503/10042 [00:36<00:01, 283.08 examples/s]Map:  95%|█████████▍| 9533/10042 [00:37<00:01, 283.51 examples/s]Map:  95%|█████████▌| 9562/10042 [00:37<00:01, 282.64 examples/s]Map:  96%|█████████▌| 9592/10042 [00:37<00:01, 283.91 examples/s]Map:  96%|█████████▌| 9622/10042 [00:37<00:01, 284.63 examples/s]Map:  96%|█████████▌| 9651/10042 [00:37<00:01, 282.81 examples/s]Map:  96%|█████████▋| 9681/10042 [00:37<00:01, 283.27 examples/s]Map:  97%|█████████▋| 9710/10042 [00:37<00:01, 282.67 examples/s]Map:  97%|█████████▋| 9739/10042 [00:37<00:01, 282.51 examples/s]Map:  97%|█████████▋| 9769/10042 [00:37<00:00, 283.32 examples/s]Map:  98%|█████████▊| 9798/10042 [00:38<00:00, 283.04 examples/s]Map:  98%|█████████▊| 9828/10042 [00:38<00:00, 284.06 examples/s]Map:  98%|█████████▊| 9857/10042 [00:38<00:00, 283.42 examples/s]Map:  98%|█████████▊| 9886/10042 [00:38<00:00, 282.61 examples/s]Map:  99%|█████████▊| 9915/10042 [00:38<00:00, 282.34 examples/s]Map:  99%|█████████▉| 9944/10042 [00:38<00:00, 282.57 examples/s]Map:  99%|█████████▉| 9974/10042 [00:38<00:00, 283.53 examples/s]Map: 100%|█████████▉| 10014/10042 [00:39<00:00, 116.50 examples/s]Map: 100%|██████████| 10042/10042 [00:39<00:00, 134.28 examples/s]Map: 100%|██████████| 10042/10042 [00:39<00:00, 254.52 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   6%|▌         | 73/1267 [00:00<00:01, 718.37 examples/s]Map:  12%|█▏        | 154/1267 [00:00<00:01, 767.73 examples/s]Map:  19%|█▉        | 239/1267 [00:00<00:01, 798.06 examples/s]Map:  26%|██▌       | 324/1267 [00:00<00:01, 814.73 examples/s]Map:  32%|███▏      | 406/1267 [00:00<00:01, 812.37 examples/s]Map:  39%|███▊      | 490/1267 [00:00<00:00, 818.28 examples/s]Map:  45%|████▌     | 575/1267 [00:00<00:00, 824.76 examples/s]Map:  52%|█████▏    | 660/1267 [00:00<00:00, 829.48 examples/s]Map:  59%|█████▉    | 745/1267 [00:00<00:00, 832.88 examples/s]Map:  66%|██████▌   | 830/1267 [00:01<00:00, 832.99 examples/s]Map:  72%|███████▏  | 915/1267 [00:01<00:00, 835.62 examples/s]Map:  79%|███████▉  | 1000/1267 [00:01<00:00, 433.75 examples/s]Map:  85%|████████▌ | 1081/1267 [00:01<00:00, 500.24 examples/s]Map:  92%|█████████▏| 1165/1267 [00:01<00:00, 568.34 examples/s]Map:  99%|█████████▊| 1249/1267 [00:01<00:00, 629.25 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 662.06 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  5.81it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.64it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.35it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.05it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:09,  3.23s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:06<00:06,  3.45s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:09<00:03,  3.29s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.21s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.62s/it]
2024-05-20 19:37:46,263: rank0[348969][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-05-20 19:37:46,265: rank0[348969][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen4096_perdeviceBS8_worldsize4
2024-05-20 19:37:47,890: rank0[348969][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-05-20 19:37:47,907: rank0[348969][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-05-20 19:37:57,678: rank0[348969][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-05-20 19:37:57,679: rank0[348969][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-05-20 19:37:57,679: rank0[348969][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 4096
precision: amp_bf16
device_eval_batch_size: 8
global_seed: 42
seed: 42
ckpt_path: /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-5-epochs3-wu8-seed42--32539
models:
- model_name: /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-5-epochs3-wu8-seed42--32539
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-5-epochs3-wu8-seed42--32539
    use_auth_token: true
  tokenizer:
    name: /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-5-epochs3-wu8-seed42--32539
    kwargs:
      model_max_length: 4096
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-05-20 19:37:57,685: rank0[348969][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 8
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 2. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.5802
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.6428
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7762
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 6 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 6 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7687
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                                           |
|:-----------|:--------------|:----------|-----------:|:------------------|:--------------------------------------------------------------------------------|
|            | arc_challenge |           |   0.580205 | 25-shot           | /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-5-epochs3-wu8-seed42--32539 |
|            | mmlu          |           |   0.642786 | 5-shot            | /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-5-epochs3-wu8-seed42--32539 |
|            | winogrande    |           |   0.768745 | 5-shot            | /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-5-epochs3-wu8-seed42--32539 |
|            | hellaswag     |           |   0.77624  | 10-shot           | /home/eldar/dan_eval/panza_llama3_bf16-bs8-fft-lr1e-5-epochs3-wu8-seed42--32539 |
2024-05-20 20:42:36,416: rank0[348969][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-05-20 20:42:36,416: rank0[348969][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-05-20 20:42:36,416: rank0[348969][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-05-20 20:42:36,416: rank0[348969][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
