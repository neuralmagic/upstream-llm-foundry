----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-04-27 08:51:29,606: rank0[3845995][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 27/1172 [00:00<00:04, 256.29 examples/s]Map:   5%|▍         | 55/1172 [00:00<00:04, 265.90 examples/s]Map:   7%|▋         | 82/1172 [00:00<00:04, 261.75 examples/s]Map:   9%|▉         | 109/1172 [00:00<00:04, 261.47 examples/s]Map:  12%|█▏        | 136/1172 [00:00<00:03, 260.72 examples/s]Map:  15%|█▍        | 175/1172 [00:00<00:03, 255.57 examples/s]Map:  17%|█▋        | 203/1172 [00:00<00:03, 258.90 examples/s]Map:  20%|█▉        | 230/1172 [00:00<00:03, 260.53 examples/s]Map:  22%|██▏       | 258/1172 [00:00<00:03, 262.04 examples/s]Map:  24%|██▍       | 285/1172 [00:01<00:03, 262.82 examples/s]Map:  27%|██▋       | 313/1172 [00:01<00:03, 263.22 examples/s]Map:  29%|██▉       | 341/1172 [00:01<00:03, 265.35 examples/s]Map:  31%|███▏      | 368/1172 [00:01<00:03, 263.54 examples/s]Map:  34%|███▍      | 396/1172 [00:01<00:02, 263.53 examples/s]Map:  36%|███▌      | 423/1172 [00:01<00:02, 262.64 examples/s]Map:  38%|███▊      | 450/1172 [00:01<00:02, 261.83 examples/s]Map:  41%|████      | 477/1172 [00:01<00:02, 261.38 examples/s]Map:  43%|████▎     | 505/1172 [00:01<00:02, 262.19 examples/s]Map:  45%|████▌     | 533/1172 [00:02<00:02, 263.73 examples/s]Map:  48%|████▊     | 561/1172 [00:02<00:02, 265.01 examples/s]Map:  50%|█████     | 588/1172 [00:02<00:02, 263.95 examples/s]Map:  53%|█████▎    | 616/1172 [00:02<00:02, 264.29 examples/s]Map:  55%|█████▍    | 644/1172 [00:02<00:01, 264.53 examples/s]Map:  57%|█████▋    | 672/1172 [00:02<00:01, 263.96 examples/s]Map:  60%|█████▉    | 700/1172 [00:02<00:01, 265.32 examples/s]Map:  62%|██████▏   | 727/1172 [00:02<00:01, 263.83 examples/s]Map:  64%|██████▍   | 755/1172 [00:02<00:01, 264.68 examples/s]Map:  67%|██████▋   | 783/1172 [00:02<00:01, 264.96 examples/s]Map:  69%|██████▉   | 810/1172 [00:03<00:01, 264.00 examples/s]Map:  71%|███████▏  | 837/1172 [00:03<00:01, 264.08 examples/s]Map:  74%|███████▎  | 864/1172 [00:03<00:01, 263.06 examples/s]Map:  76%|███████▌  | 892/1172 [00:03<00:01, 263.01 examples/s]Map:  78%|███████▊  | 919/1172 [00:03<00:00, 262.37 examples/s]Map:  81%|████████  | 947/1172 [00:03<00:00, 262.32 examples/s]Map:  83%|████████▎ | 975/1172 [00:03<00:00, 263.40 examples/s]Map:  86%|████████▋ | 1013/1172 [00:04<00:01, 134.43 examples/s]Map:  89%|████████▉ | 1041/1172 [00:04<00:00, 155.72 examples/s]Map:  91%|█████████ | 1068/1172 [00:04<00:00, 175.64 examples/s]Map:  94%|█████████▎| 1096/1172 [00:04<00:00, 194.34 examples/s]Map:  96%|█████████▌| 1122/1172 [00:04<00:00, 207.54 examples/s]Map:  98%|█████████▊| 1149/1172 [00:04<00:00, 220.76 examples/s]Map: 100%|██████████| 1172/1172 [00:04<00:00, 237.37 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 44/14042 [00:00<00:33, 423.41 examples/s]Map:   1%|          | 88/14042 [00:00<00:32, 426.61 examples/s]Map:   1%|          | 132/14042 [00:00<00:32, 426.92 examples/s]Map:   1%|▏         | 195/14042 [00:00<00:33, 417.12 examples/s]Map:   2%|▏         | 240/14042 [00:00<00:32, 422.97 examples/s]Map:   2%|▏         | 284/14042 [00:00<00:32, 424.69 examples/s]Map:   2%|▏         | 330/14042 [00:00<00:31, 432.87 examples/s]Map:   3%|▎         | 383/14042 [00:01<00:47, 287.06 examples/s]Map:   3%|▎         | 426/14042 [00:01<00:43, 315.45 examples/s]Map:   3%|▎         | 471/14042 [00:01<00:39, 345.01 examples/s]Map:   4%|▎         | 516/14042 [00:01<00:36, 369.30 examples/s]Map:   4%|▍         | 560/14042 [00:01<00:34, 385.44 examples/s]Map:   4%|▍         | 605/14042 [00:01<00:33, 400.47 examples/s]Map:   5%|▍         | 648/14042 [00:01<00:32, 407.49 examples/s]Map:   5%|▍         | 692/14042 [00:01<00:32, 413.10 examples/s]Map:   5%|▌         | 735/14042 [00:01<00:31, 415.99 examples/s]Map:   6%|▌         | 781/14042 [00:01<00:31, 425.68 examples/s]Map:   6%|▌         | 825/14042 [00:02<00:31, 425.38 examples/s]Map:   6%|▌         | 868/14042 [00:02<00:31, 423.46 examples/s]Map:   7%|▋         | 914/14042 [00:02<00:30, 431.72 examples/s]Map:   7%|▋         | 962/14042 [00:02<00:29, 442.27 examples/s]Map:   7%|▋         | 1021/14042 [00:02<00:57, 227.17 examples/s]Map:   8%|▊         | 1070/14042 [00:02<00:48, 269.10 examples/s]Map:   8%|▊         | 1120/14042 [00:03<00:41, 311.35 examples/s]Map:   8%|▊         | 1169/14042 [00:03<00:37, 347.55 examples/s]Map:   9%|▊         | 1217/14042 [00:03<00:34, 375.42 examples/s]Map:   9%|▉         | 1265/14042 [00:03<00:31, 399.35 examples/s]Map:   9%|▉         | 1312/14042 [00:03<00:30, 414.87 examples/s]Map:  10%|▉         | 1359/14042 [00:03<00:29, 427.70 examples/s]Map:  10%|█         | 1406/14042 [00:03<00:28, 436.34 examples/s]Map:  10%|█         | 1474/14042 [00:03<00:28, 438.94 examples/s]Map:  11%|█         | 1521/14042 [00:03<00:28, 446.24 examples/s]Map:  11%|█▏        | 1587/14042 [00:04<00:28, 441.65 examples/s]Map:  12%|█▏        | 1634/14042 [00:04<00:27, 446.41 examples/s]Map:  12%|█▏        | 1681/14042 [00:04<00:27, 451.08 examples/s]Map:  12%|█▏        | 1728/14042 [00:04<00:27, 453.37 examples/s]Map:  13%|█▎        | 1796/14042 [00:04<00:27, 450.10 examples/s]Map:  13%|█▎        | 1842/14042 [00:04<00:27, 448.73 examples/s]Map:  13%|█▎        | 1888/14042 [00:04<00:27, 447.27 examples/s]Map:  14%|█▍        | 1956/14042 [00:04<00:27, 444.15 examples/s]Map:  14%|█▍        | 2021/14042 [00:05<00:40, 293.26 examples/s]Map:  15%|█▍        | 2064/14042 [00:05<00:37, 316.92 examples/s]Map:  15%|█▌        | 2110/14042 [00:05<00:34, 343.65 examples/s]Map:  15%|█▌        | 2157/14042 [00:05<00:32, 370.01 examples/s]Map:  16%|█▌        | 2205/14042 [00:05<00:30, 394.03 examples/s]Map:  16%|█▌        | 2251/14042 [00:05<00:28, 408.33 examples/s]Map:  16%|█▋        | 2300/14042 [00:05<00:27, 428.37 examples/s]Map:  17%|█▋        | 2348/14042 [00:06<00:26, 438.29 examples/s]Map:  17%|█▋        | 2394/14042 [00:06<00:26, 443.75 examples/s]Map:  17%|█▋        | 2443/14042 [00:06<00:25, 454.78 examples/s]Map:  18%|█▊        | 2514/14042 [00:06<00:25, 456.91 examples/s]Map:  18%|█▊        | 2564/14042 [00:06<00:24, 464.44 examples/s]Map:  19%|█▊        | 2612/14042 [00:06<00:24, 463.66 examples/s]Map:  19%|█▉        | 2659/14042 [00:06<00:24, 461.29 examples/s]Map:  19%|█▉        | 2709/14042 [00:06<00:24, 468.60 examples/s]Map:  20%|█▉        | 2757/14042 [00:06<00:24, 466.37 examples/s]Map:  20%|█▉        | 2805/14042 [00:07<00:24, 466.68 examples/s]Map:  20%|██        | 2874/14042 [00:07<00:24, 459.30 examples/s]Map:  21%|██        | 2923/14042 [00:07<00:23, 463.58 examples/s]Map:  21%|██▏       | 2994/14042 [00:07<00:23, 464.51 examples/s]Map:  22%|██▏       | 3046/14042 [00:07<00:37, 296.78 examples/s]Map:  22%|██▏       | 3094/14042 [00:07<00:33, 328.84 examples/s]Map:  22%|██▏       | 3143/14042 [00:07<00:30, 359.25 examples/s]Map:  23%|██▎       | 3187/14042 [00:08<00:28, 375.10 examples/s]Map:  23%|██▎       | 3231/14042 [00:08<00:27, 389.27 examples/s]Map:  23%|██▎       | 3278/14042 [00:08<00:26, 405.05 examples/s]Map:  24%|██▎       | 3327/14042 [00:08<00:25, 424.57 examples/s]Map:  24%|██▍       | 3375/14042 [00:08<00:24, 438.03 examples/s]Map:  24%|██▍       | 3423/14042 [00:08<00:23, 447.44 examples/s]Map:  25%|██▍       | 3470/14042 [00:08<00:23, 449.77 examples/s]Map:  25%|██▌       | 3520/14042 [00:08<00:22, 461.71 examples/s]Map:  26%|██▌       | 3589/14042 [00:08<00:23, 454.15 examples/s]Map:  26%|██▌       | 3657/14042 [00:09<00:23, 450.01 examples/s]Map:  26%|██▋       | 3704/14042 [00:09<00:22, 453.28 examples/s]Map:  27%|██▋       | 3752/14042 [00:09<00:22, 457.02 examples/s]Map:  27%|██▋       | 3821/14042 [00:09<00:22, 455.07 examples/s]Map:  28%|██▊       | 3868/14042 [00:09<00:22, 456.12 examples/s]Map:  28%|██▊       | 3936/14042 [00:09<00:22, 451.97 examples/s]Map:  28%|██▊       | 3983/14042 [00:09<00:22, 451.62 examples/s]Map:  29%|██▉       | 4044/14042 [00:10<00:34, 287.09 examples/s]Map:  29%|██▉       | 4091/14042 [00:10<00:31, 317.77 examples/s]Map:  29%|██▉       | 4137/14042 [00:10<00:28, 344.96 examples/s]Map:  30%|██▉       | 4185/14042 [00:10<00:26, 372.43 examples/s]Map:  30%|███       | 4233/14042 [00:10<00:24, 396.08 examples/s]Map:  30%|███       | 4277/14042 [00:10<00:24, 405.57 examples/s]Map:  31%|███       | 4323/14042 [00:10<00:23, 417.87 examples/s]Map:  31%|███       | 4369/14042 [00:10<00:22, 427.51 examples/s]Map:  31%|███▏      | 4416/14042 [00:11<00:23, 409.33 examples/s]Map:  32%|███▏      | 4463/14042 [00:11<00:22, 422.93 examples/s]Map:  32%|███▏      | 4510/14042 [00:11<00:21, 433.78 examples/s]Map:  33%|███▎      | 4569/14042 [00:11<00:22, 414.97 examples/s]Map:  33%|███▎      | 4629/14042 [00:11<00:23, 405.22 examples/s]Map:  33%|███▎      | 4687/14042 [00:11<00:23, 394.44 examples/s]Map:  34%|███▍      | 4751/14042 [00:11<00:23, 400.20 examples/s]Map:  34%|███▍      | 4797/14042 [00:11<00:22, 411.39 examples/s]Map:  35%|███▍      | 4845/14042 [00:12<00:21, 426.84 examples/s]Map:  35%|███▍      | 4894/14042 [00:12<00:20, 441.39 examples/s]Map:  35%|███▌      | 4942/14042 [00:12<00:20, 449.91 examples/s]Map:  36%|███▌      | 4991/14042 [00:12<00:19, 457.69 examples/s]Map:  36%|███▌      | 5045/14042 [00:12<00:41, 218.04 examples/s]Map:  36%|███▌      | 5086/14042 [00:12<00:36, 246.23 examples/s]Map:  36%|███▋      | 5123/14042 [00:13<00:33, 267.74 examples/s]Map:  37%|███▋      | 5162/14042 [00:13<00:30, 291.64 examples/s]Map:  37%|███▋      | 5218/14042 [00:13<00:28, 314.84 examples/s]Map:  37%|███▋      | 5262/14042 [00:13<00:25, 341.26 examples/s]Map:  38%|███▊      | 5311/14042 [00:13<00:23, 373.17 examples/s]Map:  38%|███▊      | 5361/14042 [00:13<00:21, 402.87 examples/s]Map:  38%|███▊      | 5406/14042 [00:13<00:20, 414.05 examples/s]Map:  39%|███▉      | 5452/14042 [00:13<00:20, 425.79 examples/s]Map:  39%|███▉      | 5499/14042 [00:13<00:19, 434.11 examples/s]Map:  40%|███▉      | 5548/14042 [00:14<00:18, 447.84 examples/s]Map:  40%|███▉      | 5597/14042 [00:14<00:18, 456.78 examples/s]Map:  40%|████      | 5645/14042 [00:14<00:18, 458.44 examples/s]Map:  41%|████      | 5693/14042 [00:14<00:18, 460.15 examples/s]Map:  41%|████      | 5740/14042 [00:14<00:18, 460.89 examples/s]Map:  41%|████▏     | 5809/14042 [00:14<00:18, 456.82 examples/s]Map:  42%|████▏     | 5876/14042 [00:14<00:18, 449.58 examples/s]Map:  42%|████▏     | 5940/14042 [00:14<00:18, 436.03 examples/s]Map:  43%|████▎     | 5999/14042 [00:15<00:19, 417.05 examples/s]Map:  43%|████▎     | 6058/14042 [00:15<00:29, 273.82 examples/s]Map:  43%|████▎     | 6098/14042 [00:15<00:27, 293.23 examples/s]Map:  44%|████▎     | 6138/14042 [00:15<00:25, 312.48 examples/s]Map:  44%|████▍     | 6177/14042 [00:15<00:24, 327.06 examples/s]Map:  44%|████▍     | 6217/14042 [00:15<00:22, 341.21 examples/s]Map:  45%|████▍     | 6256/14042 [00:15<00:22, 350.54 examples/s]Map:  45%|████▍     | 6295/14042 [00:16<00:21, 357.50 examples/s]Map:  45%|████▌     | 6336/14042 [00:16<00:20, 371.14 examples/s]Map:  45%|████▌     | 6376/14042 [00:16<00:20, 378.12 examples/s]Map:  46%|████▌     | 6417/14042 [00:16<00:19, 384.59 examples/s]Map:  46%|████▌     | 6458/14042 [00:16<00:19, 389.76 examples/s]Map:  46%|████▋     | 6517/14042 [00:16<00:19, 388.58 examples/s]Map:  47%|████▋     | 6558/14042 [00:16<00:19, 392.42 examples/s]Map:  47%|████▋     | 6599/14042 [00:16<00:18, 396.06 examples/s]Map:  47%|████▋     | 6639/14042 [00:16<00:18, 390.31 examples/s]Map:  48%|████▊     | 6699/14042 [00:17<00:18, 388.85 examples/s]Map:  48%|████▊     | 6755/14042 [00:17<00:19, 379.73 examples/s]Map:  48%|████▊     | 6795/14042 [00:17<00:19, 379.75 examples/s]Map:  49%|████▊     | 6835/14042 [00:17<00:18, 381.72 examples/s]Map:  49%|████▉     | 6875/14042 [00:17<00:18, 384.65 examples/s]Map:  49%|████▉     | 6914/14042 [00:17<00:18, 382.47 examples/s]Map:  50%|████▉     | 6957/14042 [00:17<00:18, 390.85 examples/s]Map:  50%|████▉     | 6997/14042 [00:17<00:18, 390.80 examples/s]Map:  50%|█████     | 7039/14042 [00:18<00:30, 232.92 examples/s]Map:  50%|█████     | 7080/14042 [00:18<00:26, 265.83 examples/s]Map:  51%|█████     | 7120/14042 [00:18<00:23, 292.64 examples/s]Map:  51%|█████     | 7161/14042 [00:18<00:21, 316.17 examples/s]Map:  51%|█████▏    | 7203/14042 [00:18<00:20, 340.49 examples/s]Map:  52%|█████▏    | 7246/14042 [00:18<00:18, 360.63 examples/s]Map:  52%|█████▏    | 7286/14042 [00:18<00:18, 367.33 examples/s]Map:  52%|█████▏    | 7325/14042 [00:18<00:18, 369.76 examples/s]Map:  52%|█████▏    | 7364/14042 [00:19<00:17, 375.14 examples/s]Map:  53%|█████▎    | 7405/14042 [00:19<00:17, 384.24 examples/s]Map:  53%|█████▎    | 7446/14042 [00:19<00:16, 388.84 examples/s]Map:  53%|█████▎    | 7492/14042 [00:19<00:16, 404.56 examples/s]Map:  54%|█████▎    | 7540/14042 [00:19<00:15, 422.86 examples/s]Map:  54%|█████▍    | 7585/14042 [00:19<00:15, 428.36 examples/s]Map:  54%|█████▍    | 7633/14042 [00:19<00:14, 440.46 examples/s]Map:  55%|█████▍    | 7682/14042 [00:19<00:14, 452.66 examples/s]Map:  55%|█████▌    | 7728/14042 [00:19<00:13, 453.09 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2179 > 2048). Running this sequence through the model will result in indexing errors
Map:  55%|█████▌    | 7774/14042 [00:19<00:13, 447.85 examples/s]Map:  56%|█████▌    | 7822/14042 [00:20<00:13, 452.55 examples/s]Map:  56%|█████▌    | 7869/14042 [00:20<00:13, 453.42 examples/s]Map:  56%|█████▋    | 7918/14042 [00:20<00:13, 460.93 examples/s]Map:  57%|█████▋    | 7966/14042 [00:20<00:13, 462.60 examples/s]Map:  57%|█████▋    | 8022/14042 [00:20<00:20, 288.67 examples/s]Map:  57%|█████▋    | 8069/14042 [00:20<00:18, 324.00 examples/s]Map:  58%|█████▊    | 8115/14042 [00:20<00:16, 353.55 examples/s]Map:  58%|█████▊    | 8162/14042 [00:21<00:15, 379.48 examples/s]Map:  58%|█████▊    | 8211/14042 [00:21<00:14, 405.65 examples/s]Map:  59%|█████▉    | 8259/14042 [00:21<00:13, 423.10 examples/s]Map:  59%|█████▉    | 8305/14042 [00:21<00:13, 431.19 examples/s]Map:  59%|█████▉    | 8353/14042 [00:21<00:12, 441.13 examples/s]Map:  60%|█████▉    | 8399/14042 [00:21<00:12, 444.87 examples/s]Map:  60%|██████    | 8446/14042 [00:21<00:12, 451.26 examples/s]Map:  60%|██████    | 8492/14042 [00:21<00:12, 452.76 examples/s]Map:  61%|██████    | 8538/14042 [00:21<00:12, 450.43 examples/s]Map:  61%|██████    | 8587/14042 [00:21<00:11, 458.96 examples/s]Map:  61%|██████▏   | 8635/14042 [00:22<00:11, 461.79 examples/s]Map:  62%|██████▏   | 8705/14042 [00:22<00:11, 456.60 examples/s]Map:  62%|██████▏   | 8772/14042 [00:22<00:11, 449.88 examples/s]Map:  63%|██████▎   | 8820/14042 [00:22<00:11, 454.67 examples/s]Map:  63%|██████▎   | 8867/14042 [00:22<00:11, 457.52 examples/s]Map:  63%|██████▎   | 8916/14042 [00:22<00:11, 463.42 examples/s]Map:  64%|██████▍   | 8965/14042 [00:22<00:10, 467.62 examples/s]Map:  64%|██████▍   | 9021/14042 [00:23<00:17, 295.20 examples/s]Map:  65%|██████▍   | 9069/14042 [00:23<00:15, 328.89 examples/s]Map:  65%|██████▍   | 9117/14042 [00:23<00:13, 361.29 examples/s]Map:  65%|██████▌   | 9162/14042 [00:23<00:12, 381.48 examples/s]Map:  66%|██████▌   | 9210/14042 [00:23<00:11, 405.75 examples/s]Map:  66%|██████▌   | 9255/14042 [00:23<00:11, 415.34 examples/s]Map:  66%|██████▋   | 9303/14042 [00:23<00:11, 430.03 examples/s]Map:  67%|██████▋   | 9352/14042 [00:23<00:10, 442.83 examples/s]Map:  67%|██████▋   | 9398/14042 [00:23<00:10, 445.65 examples/s]Map:  67%|██████▋   | 9444/14042 [00:24<00:10, 448.38 examples/s]Map:  68%|██████▊   | 9494/14042 [00:24<00:09, 460.93 examples/s]Map:  68%|██████▊   | 9542/14042 [00:24<00:09, 465.27 examples/s]Map:  68%|██████▊   | 9600/14042 [00:24<00:10, 431.69 examples/s]Map:  69%|██████▉   | 9658/14042 [00:24<00:10, 412.82 examples/s]Map:  69%|██████▉   | 9710/14042 [00:24<00:15, 285.71 examples/s]Map:  69%|██████▉   | 9746/14042 [00:24<00:14, 298.33 examples/s]Map:  70%|██████▉   | 9785/14042 [00:25<00:13, 316.13 examples/s]Map:  70%|██████▉   | 9828/14042 [00:25<00:12, 340.70 examples/s]Map:  70%|███████   | 9872/14042 [00:25<00:11, 362.35 examples/s]Map:  71%|███████   | 9916/14042 [00:25<00:10, 380.00 examples/s]Map:  71%|███████   | 9960/14042 [00:25<00:10, 391.64 examples/s]Map:  71%|███████▏  | 10020/14042 [00:25<00:15, 262.02 examples/s]Map:  72%|███████▏  | 10067/14042 [00:25<00:13, 299.12 examples/s]Map:  72%|███████▏  | 10116/14042 [00:26<00:11, 338.36 examples/s]Map:  72%|███████▏  | 10161/14042 [00:26<00:10, 362.83 examples/s]Map:  73%|███████▎  | 10208/14042 [00:26<00:09, 385.67 examples/s]Map:  73%|███████▎  | 10255/14042 [00:26<00:09, 404.44 examples/s]Map:  73%|███████▎  | 10304/14042 [00:26<00:08, 422.22 examples/s]Map:  74%|███████▎  | 10349/14042 [00:26<00:08, 426.31 examples/s]Map:  74%|███████▍  | 10394/14042 [00:26<00:08, 429.46 examples/s]Map:  74%|███████▍  | 10439/14042 [00:26<00:08, 433.03 examples/s]Map:  75%|███████▍  | 10505/14042 [00:26<00:08, 432.90 examples/s]Map:  75%|███████▌  | 10549/14042 [00:27<00:08, 433.98 examples/s]Map:  75%|███████▌  | 10597/14042 [00:27<00:07, 444.94 examples/s]Map:  76%|███████▌  | 10644/14042 [00:27<00:07, 450.23 examples/s]Map:  76%|███████▌  | 10690/14042 [00:27<00:07, 449.65 examples/s]Map:  76%|███████▋  | 10737/14042 [00:27<00:07, 451.91 examples/s]Map:  77%|███████▋  | 10804/14042 [00:27<00:07, 447.37 examples/s]Map:  77%|███████▋  | 10854/14042 [00:27<00:06, 455.84 examples/s]Map:  78%|███████▊  | 10923/14042 [00:27<00:06, 454.72 examples/s]Map:  78%|███████▊  | 10969/14042 [00:27<00:06, 454.97 examples/s]Map:  78%|███████▊  | 11021/14042 [00:28<00:10, 295.05 examples/s]Map:  79%|███████▉  | 11067/14042 [00:28<00:09, 324.60 examples/s]Map:  79%|███████▉  | 11115/14042 [00:28<00:08, 355.75 examples/s]Map:  79%|███████▉  | 11163/14042 [00:28<00:07, 382.62 examples/s]Map:  80%|███████▉  | 11210/14042 [00:28<00:07, 401.83 examples/s]Map:  80%|████████  | 11274/14042 [00:28<00:06, 405.61 examples/s]Map:  81%|████████  | 11337/14042 [00:28<00:06, 406.31 examples/s]Map:  81%|████████  | 11380/14042 [00:29<00:06, 410.31 examples/s]Map:  81%|████████▏ | 11442/14042 [00:29<00:06, 408.67 examples/s]Map:  82%|████████▏ | 11486/14042 [00:29<00:06, 414.33 examples/s]Map:  82%|████████▏ | 11531/14042 [00:29<00:05, 421.54 examples/s]Map:  82%|████████▏ | 11579/14042 [00:29<00:05, 434.99 examples/s]Map:  83%|████████▎ | 11626/14042 [00:29<00:05, 442.13 examples/s]Map:  83%|████████▎ | 11676/14042 [00:29<00:05, 454.38 examples/s]Map:  83%|████████▎ | 11725/14042 [00:29<00:05, 462.13 examples/s]Map:  84%|████████▍ | 11774/14042 [00:29<00:04, 466.98 examples/s]Map:  84%|████████▍ | 11821/14042 [00:30<00:04, 465.12 examples/s]Map:  85%|████████▍ | 11872/14042 [00:30<00:04, 472.87 examples/s]Map:  85%|████████▌ | 11941/14042 [00:30<00:04, 463.38 examples/s]Map:  85%|████████▌ | 11993/14042 [00:30<00:04, 476.43 examples/s]Map:  86%|████████▌ | 12045/14042 [00:30<00:06, 297.89 examples/s]Map:  86%|████████▌ | 12094/14042 [00:30<00:05, 333.14 examples/s]Map:  86%|████████▋ | 12140/14042 [00:30<00:05, 358.65 examples/s]Map:  87%|████████▋ | 12187/14042 [00:31<00:04, 381.81 examples/s]Map:  87%|████████▋ | 12231/14042 [00:31<00:04, 395.32 examples/s]Map:  87%|████████▋ | 12278/14042 [00:31<00:04, 412.18 examples/s]Map:  88%|████████▊ | 12324/14042 [00:31<00:04, 423.70 examples/s]Map:  88%|████████▊ | 12370/14042 [00:31<00:03, 431.38 examples/s]Map:  88%|████████▊ | 12415/14042 [00:31<00:03, 435.38 examples/s]Map:  89%|████████▊ | 12461/14042 [00:31<00:03, 439.96 examples/s]Map:  89%|████████▉ | 12509/14042 [00:31<00:03, 450.35 examples/s]Map:  90%|████████▉ | 12576/14042 [00:31<00:03, 443.71 examples/s]Map:  90%|████████▉ | 12626/14042 [00:32<00:03, 453.54 examples/s]Map:  90%|█████████ | 12695/14042 [00:32<00:02, 452.66 examples/s]Map:  91%|█████████ | 12764/14042 [00:32<00:02, 451.37 examples/s]Map:  91%|█████████ | 12810/14042 [00:32<00:02, 451.29 examples/s]Map:  92%|█████████▏| 12859/14042 [00:32<00:02, 459.02 examples/s]Map:  92%|█████████▏| 12906/14042 [00:32<00:02, 458.95 examples/s]Map:  92%|█████████▏| 12953/14042 [00:32<00:02, 460.30 examples/s]Map:  93%|█████████▎| 13000/14042 [00:33<00:03, 284.67 examples/s]Map:  93%|█████████▎| 13047/14042 [00:33<00:03, 319.05 examples/s]Map:  93%|█████████▎| 13095/14042 [00:33<00:02, 352.15 examples/s]Map:  94%|█████████▎| 13141/14042 [00:33<00:02, 376.18 examples/s]Map:  94%|█████████▍| 13190/14042 [00:33<00:02, 402.29 examples/s]Map:  94%|█████████▍| 13237/14042 [00:33<00:01, 415.46 examples/s]Map:  95%|█████████▍| 13285/14042 [00:33<00:01, 430.44 examples/s]Map:  95%|█████████▍| 13331/14042 [00:33<00:01, 437.13 examples/s]Map:  95%|█████████▌| 13379/14042 [00:33<00:01, 444.12 examples/s]Map:  96%|█████████▌| 13428/14042 [00:33<00:01, 454.94 examples/s]Map:  96%|█████████▌| 13497/14042 [00:34<00:01, 453.16 examples/s]Map:  97%|█████████▋| 13565/14042 [00:34<00:01, 450.96 examples/s]Map:  97%|█████████▋| 13616/14042 [00:34<00:00, 461.90 examples/s]Map:  97%|█████████▋| 13687/14042 [00:34<00:00, 460.10 examples/s]Map:  98%|█████████▊| 13756/14042 [00:34<00:00, 457.01 examples/s]Map:  98%|█████████▊| 13805/14042 [00:34<00:00, 461.60 examples/s]Map:  99%|█████████▊| 13853/14042 [00:34<00:00, 464.19 examples/s]Map:  99%|█████████▉| 13900/14042 [00:35<00:00, 464.31 examples/s]Map:  99%|█████████▉| 13947/14042 [00:35<00:00, 465.57 examples/s]Map: 100%|█████████▉| 13994/14042 [00:35<00:00, 464.92 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 279.94 examples/s]Map: 100%|██████████| 14042/14042 [00:35<00:00, 395.00 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 31/10042 [00:00<00:33, 294.99 examples/s]Map:   1%|          | 63/10042 [00:00<00:32, 305.54 examples/s]Map:   1%|          | 97/10042 [00:00<00:31, 318.09 examples/s]Map:   1%|▏         | 129/10042 [00:00<00:31, 315.13 examples/s]Map:   2%|▏         | 161/10042 [00:00<00:31, 314.19 examples/s]Map:   2%|▏         | 194/10042 [00:00<00:30, 318.44 examples/s]Map:   2%|▏         | 229/10042 [00:00<00:30, 325.09 examples/s]Map:   3%|▎         | 263/10042 [00:00<00:29, 327.79 examples/s]Map:   3%|▎         | 309/10042 [00:01<00:44, 219.27 examples/s]Map:   3%|▎         | 345/10042 [00:01<00:39, 245.78 examples/s]Map:   4%|▍         | 381/10042 [00:01<00:35, 269.28 examples/s]Map:   4%|▍         | 415/10042 [00:01<00:33, 286.09 examples/s]Map:   4%|▍         | 450/10042 [00:01<00:31, 300.69 examples/s]Map:   5%|▍         | 484/10042 [00:01<00:30, 309.52 examples/s]Map:   5%|▌         | 519/10042 [00:01<00:29, 318.03 examples/s]Map:   6%|▌         | 554/10042 [00:01<00:29, 324.31 examples/s]Map:   6%|▌         | 590/10042 [00:01<00:28, 329.64 examples/s]Map:   6%|▌         | 624/10042 [00:02<00:28, 331.25 examples/s]Map:   7%|▋         | 658/10042 [00:02<00:28, 330.40 examples/s]Map:   7%|▋         | 692/10042 [00:02<00:28, 329.44 examples/s]Map:   7%|▋         | 727/10042 [00:02<00:28, 330.69 examples/s]Map:   8%|▊         | 762/10042 [00:02<00:27, 333.44 examples/s]Map:   8%|▊         | 796/10042 [00:02<00:27, 332.78 examples/s]Map:   8%|▊         | 830/10042 [00:02<00:27, 333.73 examples/s]Map:   9%|▊         | 865/10042 [00:02<00:27, 335.90 examples/s]Map:   9%|▉         | 899/10042 [00:02<00:27, 334.93 examples/s]Map:   9%|▉         | 934/10042 [00:02<00:27, 333.96 examples/s]Map:  10%|▉         | 968/10042 [00:03<00:27, 331.69 examples/s]Map:  10%|█         | 1016/10042 [00:03<00:52, 171.92 examples/s]Map:  10%|█         | 1051/10042 [00:03<00:44, 199.91 examples/s]Map:  11%|█         | 1087/10042 [00:03<00:39, 227.50 examples/s]Map:  11%|█         | 1123/10042 [00:03<00:35, 252.75 examples/s]Map:  12%|█▏        | 1158/10042 [00:04<00:32, 273.65 examples/s]Map:  12%|█▏        | 1193/10042 [00:04<00:30, 291.16 examples/s]Map:  12%|█▏        | 1228/10042 [00:04<00:28, 304.61 examples/s]Map:  13%|█▎        | 1263/10042 [00:04<00:27, 314.43 examples/s]Map:  13%|█▎        | 1313/10042 [00:04<00:27, 319.03 examples/s]Map:  13%|█▎        | 1347/10042 [00:04<00:26, 323.20 examples/s]Map:  14%|█▍        | 1381/10042 [00:04<00:26, 325.81 examples/s]Map:  14%|█▍        | 1416/10042 [00:04<00:26, 329.87 examples/s]Map:  14%|█▍        | 1450/10042 [00:04<00:25, 332.42 examples/s]Map:  15%|█▍        | 1485/10042 [00:04<00:25, 334.58 examples/s]Map:  15%|█▌        | 1520/10042 [00:05<00:25, 336.37 examples/s]Map:  15%|█▌        | 1555/10042 [00:05<00:25, 337.00 examples/s]Map:  16%|█▌        | 1590/10042 [00:05<00:25, 337.07 examples/s]Map:  16%|█▌        | 1624/10042 [00:05<00:25, 336.02 examples/s]Map:  17%|█▋        | 1658/10042 [00:05<00:24, 336.27 examples/s]Map:  17%|█▋        | 1694/10042 [00:05<00:24, 337.75 examples/s]Map:  17%|█▋        | 1730/10042 [00:05<00:24, 339.39 examples/s]Map:  18%|█▊        | 1764/10042 [00:05<00:24, 337.01 examples/s]Map:  18%|█▊        | 1798/10042 [00:05<00:24, 335.76 examples/s]Map:  18%|█▊        | 1832/10042 [00:06<00:24, 335.05 examples/s]Map:  19%|█▊        | 1867/10042 [00:06<00:24, 336.80 examples/s]Map:  19%|█▉        | 1901/10042 [00:06<00:24, 337.05 examples/s]Map:  19%|█▉        | 1936/10042 [00:06<00:23, 337.78 examples/s]Map:  20%|█▉        | 1970/10042 [00:06<00:23, 337.88 examples/s]Map:  20%|██        | 2016/10042 [00:06<00:38, 209.55 examples/s]Map:  20%|██        | 2052/10042 [00:06<00:33, 236.29 examples/s]Map:  21%|██        | 2086/10042 [00:06<00:30, 257.81 examples/s]Map:  21%|██        | 2121/10042 [00:07<00:28, 278.42 examples/s]Map:  21%|██▏       | 2156/10042 [00:07<00:26, 293.99 examples/s]Map:  22%|██▏       | 2191/10042 [00:07<00:25, 306.92 examples/s]Map:  22%|██▏       | 2227/10042 [00:07<00:24, 317.64 examples/s]Map:  23%|██▎       | 2262/10042 [00:07<00:24, 323.04 examples/s]Map:  23%|██▎       | 2298/10042 [00:07<00:23, 330.61 examples/s]Map:  23%|██▎       | 2334/10042 [00:07<00:23, 334.51 examples/s]Map:  24%|██▎       | 2370/10042 [00:07<00:22, 338.65 examples/s]Map:  24%|██▍       | 2405/10042 [00:07<00:22, 339.35 examples/s]Map:  24%|██▍       | 2440/10042 [00:08<00:22, 340.23 examples/s]Map:  25%|██▍       | 2475/10042 [00:08<00:22, 339.88 examples/s]Map:  25%|██▌       | 2511/10042 [00:08<00:22, 341.01 examples/s]Map:  25%|██▌       | 2546/10042 [00:08<00:22, 340.71 examples/s]Map:  26%|██▌       | 2582/10042 [00:08<00:21, 340.74 examples/s]Map:  26%|██▌       | 2617/10042 [00:08<00:21, 340.38 examples/s]Map:  27%|██▋       | 2669/10042 [00:08<00:21, 339.25 examples/s]Map:  27%|██▋       | 2704/10042 [00:08<00:21, 338.75 examples/s]Map:  27%|██▋       | 2738/10042 [00:08<00:21, 335.73 examples/s]Map:  28%|██▊       | 2774/10042 [00:09<00:21, 337.82 examples/s]Map:  28%|██▊       | 2809/10042 [00:09<00:21, 339.68 examples/s]Map:  28%|██▊       | 2844/10042 [00:09<00:21, 339.53 examples/s]Map:  29%|██▊       | 2880/10042 [00:09<00:20, 342.03 examples/s]Map:  29%|██▉       | 2916/10042 [00:09<00:20, 342.10 examples/s]Map:  30%|██▉       | 2967/10042 [00:09<00:20, 337.83 examples/s]Map:  30%|███       | 3016/10042 [00:09<00:32, 217.57 examples/s]Map:  30%|███       | 3051/10042 [00:10<00:29, 239.24 examples/s]Map:  31%|███       | 3085/10042 [00:10<00:26, 259.36 examples/s]Map:  31%|███       | 3120/10042 [00:10<00:24, 277.87 examples/s]Map:  31%|███▏      | 3154/10042 [00:10<00:23, 291.46 examples/s]Map:  32%|███▏      | 3190/10042 [00:10<00:22, 304.70 examples/s]Map:  32%|███▏      | 3224/10042 [00:10<00:21, 311.85 examples/s]Map:  32%|███▏      | 3258/10042 [00:10<00:21, 315.98 examples/s]Map:  33%|███▎      | 3306/10042 [00:10<00:21, 313.49 examples/s]Map:  33%|███▎      | 3339/10042 [00:10<00:21, 315.26 examples/s]Map:  34%|███▎      | 3387/10042 [00:11<00:21, 313.65 examples/s]Map:  34%|███▍      | 3419/10042 [00:11<00:21, 313.23 examples/s]Map:  34%|███▍      | 3451/10042 [00:11<00:21, 313.19 examples/s]Map:  35%|███▍      | 3483/10042 [00:11<00:20, 313.37 examples/s]Map:  35%|███▌      | 3515/10042 [00:11<00:20, 313.08 examples/s]Map:  35%|███▌      | 3547/10042 [00:11<00:20, 312.17 examples/s]Map:  36%|███▌      | 3579/10042 [00:11<00:20, 312.33 examples/s]Map:  36%|███▌      | 3611/10042 [00:11<00:20, 312.18 examples/s]Map:  36%|███▋      | 3657/10042 [00:11<00:20, 307.52 examples/s]Map:  37%|███▋      | 3688/10042 [00:12<00:20, 306.69 examples/s]Map:  37%|███▋      | 3719/10042 [00:12<00:20, 306.29 examples/s]Map:  37%|███▋      | 3750/10042 [00:12<00:20, 303.95 examples/s]Map:  38%|███▊      | 3782/10042 [00:12<00:20, 304.77 examples/s]Map:  38%|███▊      | 3814/10042 [00:12<00:20, 305.13 examples/s]Map:  38%|███▊      | 3845/10042 [00:12<00:20, 302.69 examples/s]Map:  39%|███▊      | 3877/10042 [00:12<00:20, 303.93 examples/s]Map:  39%|███▉      | 3909/10042 [00:12<00:20, 306.00 examples/s]Map:  39%|███▉      | 3941/10042 [00:12<00:19, 307.68 examples/s]Map:  40%|███▉      | 3973/10042 [00:13<00:19, 307.81 examples/s]Map:  40%|███▉      | 4015/10042 [00:13<00:31, 190.08 examples/s]Map:  40%|████      | 4047/10042 [00:13<00:28, 213.51 examples/s]Map:  41%|████      | 4079/10042 [00:13<00:25, 234.66 examples/s]Map:  41%|████      | 4111/10042 [00:13<00:23, 253.72 examples/s]Map:  41%|████▏     | 4143/10042 [00:13<00:21, 268.54 examples/s]Map:  42%|████▏     | 4175/10042 [00:13<00:20, 280.05 examples/s]Map:  42%|████▏     | 4208/10042 [00:13<00:20, 291.45 examples/s]Map:  42%|████▏     | 4240/10042 [00:14<00:19, 297.24 examples/s]Map:  43%|████▎     | 4272/10042 [00:14<00:19, 302.84 examples/s]Map:  43%|████▎     | 4305/10042 [00:14<00:18, 307.57 examples/s]Map:  43%|████▎     | 4337/10042 [00:14<00:18, 310.03 examples/s]Map:  44%|████▎     | 4369/10042 [00:14<00:18, 310.18 examples/s]Map:  44%|████▍     | 4403/10042 [00:14<00:17, 314.68 examples/s]Map:  44%|████▍     | 4436/10042 [00:14<00:17, 315.00 examples/s]Map:  44%|████▍     | 4468/10042 [00:14<00:17, 314.22 examples/s]Map:  45%|████▍     | 4501/10042 [00:14<00:17, 315.57 examples/s]Map:  45%|████▌     | 4533/10042 [00:15<00:17, 314.41 examples/s]Map:  45%|████▌     | 4565/10042 [00:15<00:17, 313.38 examples/s]Map:  46%|████▌     | 4597/10042 [00:15<00:17, 312.39 examples/s]Map:  46%|████▌     | 4630/10042 [00:15<00:17, 313.77 examples/s]Map:  46%|████▋     | 4662/10042 [00:15<00:17, 312.30 examples/s]Map:  47%|████▋     | 4694/10042 [00:15<00:17, 313.96 examples/s]Map:  47%|████▋     | 4739/10042 [00:15<00:17, 305.30 examples/s]Map:  48%|████▊     | 4771/10042 [00:15<00:17, 305.78 examples/s]Map:  48%|████▊     | 4802/10042 [00:15<00:17, 303.71 examples/s]Map:  48%|████▊     | 4833/10042 [00:15<00:17, 302.92 examples/s]Map:  49%|████▊     | 4879/10042 [00:16<00:17, 301.34 examples/s]Map:  49%|████▉     | 4911/10042 [00:16<00:16, 302.52 examples/s]Map:  49%|████▉     | 4943/10042 [00:16<00:16, 304.01 examples/s]Map:  50%|████▉     | 4975/10042 [00:16<00:16, 302.48 examples/s]Map:  50%|████▉     | 5015/10042 [00:17<00:34, 144.45 examples/s]Map:  50%|█████     | 5046/10042 [00:17<00:29, 168.18 examples/s]Map:  51%|█████     | 5078/10042 [00:17<00:25, 193.44 examples/s]Map:  51%|█████     | 5110/10042 [00:17<00:22, 217.31 examples/s]Map:  51%|█████     | 5142/10042 [00:17<00:20, 238.19 examples/s]Map:  52%|█████▏    | 5174/10042 [00:17<00:18, 256.47 examples/s]Map:  52%|█████▏    | 5206/10042 [00:17<00:17, 271.19 examples/s]Map:  52%|█████▏    | 5238/10042 [00:17<00:16, 282.82 examples/s]Map:  52%|█████▏    | 5272/10042 [00:17<00:16, 295.02 examples/s]Map:  53%|█████▎    | 5304/10042 [00:17<00:15, 299.52 examples/s]Map:  53%|█████▎    | 5336/10042 [00:18<00:15, 303.65 examples/s]Map:  53%|█████▎    | 5368/10042 [00:18<00:15, 306.12 examples/s]Map:  54%|█████▍    | 5400/10042 [00:18<00:15, 307.71 examples/s]Map:  54%|█████▍    | 5433/10042 [00:18<00:14, 310.47 examples/s]Map:  54%|█████▍    | 5465/10042 [00:18<00:14, 311.51 examples/s]Map:  55%|█████▍    | 5497/10042 [00:18<00:14, 310.85 examples/s]Map:  55%|█████▌    | 5529/10042 [00:18<00:14, 309.66 examples/s]Map:  55%|█████▌    | 5561/10042 [00:18<00:14, 310.73 examples/s]Map:  56%|█████▌    | 5593/10042 [00:18<00:14, 310.31 examples/s]Map:  56%|█████▌    | 5625/10042 [00:18<00:14, 309.94 examples/s]Map:  56%|█████▋    | 5657/10042 [00:19<00:14, 310.23 examples/s]Map:  57%|█████▋    | 5689/10042 [00:19<00:14, 309.21 examples/s]Map:  57%|█████▋    | 5721/10042 [00:19<00:13, 309.52 examples/s]Map:  57%|█████▋    | 5752/10042 [00:19<00:13, 306.60 examples/s]Map:  58%|█████▊    | 5784/10042 [00:19<00:13, 308.09 examples/s]Map:  58%|█████▊    | 5817/10042 [00:19<00:13, 309.70 examples/s]Map:  58%|█████▊    | 5849/10042 [00:19<00:13, 309.70 examples/s]Map:  59%|█████▊    | 5881/10042 [00:19<00:13, 309.93 examples/s]Map:  59%|█████▉    | 5913/10042 [00:19<00:13, 310.33 examples/s]Map:  59%|█████▉    | 5945/10042 [00:20<00:13, 310.98 examples/s]Map:  60%|█████▉    | 5977/10042 [00:20<00:13, 310.61 examples/s]Map:  60%|█████▉    | 6015/10042 [00:20<00:21, 189.95 examples/s]Map:  60%|██████    | 6047/10042 [00:20<00:18, 214.16 examples/s]Map:  61%|██████    | 6079/10042 [00:20<00:16, 236.22 examples/s]Map:  61%|██████    | 6111/10042 [00:20<00:15, 254.45 examples/s]Map:  61%|██████    | 6143/10042 [00:20<00:14, 268.71 examples/s]Map:  62%|██████▏   | 6176/10042 [00:20<00:13, 281.79 examples/s]Map:  62%|██████▏   | 6208/10042 [00:21<00:13, 289.29 examples/s]Map:  62%|██████▏   | 6240/10042 [00:21<00:12, 295.56 examples/s]Map:  62%|██████▏   | 6272/10042 [00:21<00:12, 299.86 examples/s]Map:  63%|██████▎   | 6304/10042 [00:21<00:12, 303.75 examples/s]Map:  63%|██████▎   | 6337/10042 [00:21<00:12, 307.85 examples/s]Map:  63%|██████▎   | 6369/10042 [00:21<00:11, 309.40 examples/s]Map:  64%|██████▎   | 6401/10042 [00:21<00:11, 309.56 examples/s]Map:  64%|██████▍   | 6433/10042 [00:21<00:11, 310.21 examples/s]Map:  64%|██████▍   | 6466/10042 [00:21<00:11, 312.66 examples/s]Map:  65%|██████▍   | 6498/10042 [00:22<00:11, 311.12 examples/s]Map:  65%|██████▌   | 6530/10042 [00:22<00:11, 311.12 examples/s]Map:  65%|██████▌   | 6563/10042 [00:22<00:11, 313.66 examples/s]Map:  66%|██████▌   | 6595/10042 [00:22<00:10, 314.22 examples/s]Map:  66%|██████▌   | 6627/10042 [00:22<00:10, 313.19 examples/s]Map:  66%|██████▋   | 6659/10042 [00:22<00:10, 313.23 examples/s]Map:  67%|██████▋   | 6706/10042 [00:22<00:10, 309.61 examples/s]Map:  67%|██████▋   | 6738/10042 [00:22<00:10, 309.70 examples/s]Map:  67%|██████▋   | 6771/10042 [00:22<00:10, 311.65 examples/s]Map:  68%|██████▊   | 6803/10042 [00:22<00:10, 309.78 examples/s]Map:  68%|██████▊   | 6835/10042 [00:23<00:10, 309.48 examples/s]Map:  68%|██████▊   | 6867/10042 [00:23<00:10, 311.37 examples/s]Map:  69%|██████▊   | 6900/10042 [00:23<00:10, 312.80 examples/s]Map:  69%|██████▉   | 6932/10042 [00:23<00:09, 312.24 examples/s]Map:  69%|██████▉   | 6964/10042 [00:23<00:09, 311.28 examples/s]Map:  70%|██████▉   | 6996/10042 [00:23<00:09, 310.69 examples/s]Map:  70%|███████   | 7031/10042 [00:23<00:15, 188.70 examples/s]Map:  70%|███████   | 7063/10042 [00:24<00:13, 213.70 examples/s]Map:  71%|███████   | 7094/10042 [00:24<00:12, 233.83 examples/s]Map:  71%|███████   | 7126/10042 [00:24<00:11, 251.49 examples/s]Map:  71%|███████▏  | 7158/10042 [00:24<00:10, 266.57 examples/s]Map:  72%|███████▏  | 7190/10042 [00:24<00:10, 279.05 examples/s]Map:  72%|███████▏  | 7223/10042 [00:24<00:09, 289.89 examples/s]Map:  72%|███████▏  | 7255/10042 [00:24<00:09, 296.11 examples/s]Map:  73%|███████▎  | 7287/10042 [00:24<00:09, 299.92 examples/s]Map:  73%|███████▎  | 7319/10042 [00:24<00:08, 303.38 examples/s]Map:  73%|███████▎  | 7351/10042 [00:24<00:08, 305.16 examples/s]Map:  74%|███████▎  | 7383/10042 [00:25<00:08, 307.13 examples/s]Map:  74%|███████▍  | 7415/10042 [00:25<00:08, 308.76 examples/s]Map:  74%|███████▍  | 7447/10042 [00:25<00:08, 309.37 examples/s]Map:  75%|███████▍  | 7494/10042 [00:25<00:08, 308.97 examples/s]Map:  75%|███████▍  | 7526/10042 [00:25<00:08, 309.26 examples/s]Map:  75%|███████▌  | 7558/10042 [00:25<00:08, 309.93 examples/s]Map:  76%|███████▌  | 7590/10042 [00:25<00:07, 310.84 examples/s]Map:  76%|███████▌  | 7622/10042 [00:25<00:07, 311.83 examples/s]Map:  76%|███████▌  | 7654/10042 [00:25<00:07, 312.19 examples/s]Map:  77%|███████▋  | 7686/10042 [00:26<00:07, 311.98 examples/s]Map:  77%|███████▋  | 7718/10042 [00:26<00:07, 311.59 examples/s]Map:  77%|███████▋  | 7765/10042 [00:26<00:07, 309.91 examples/s]Map:  78%|███████▊  | 7797/10042 [00:26<00:07, 309.97 examples/s]Map:  78%|███████▊  | 7829/10042 [00:26<00:07, 310.18 examples/s]Map:  78%|███████▊  | 7861/10042 [00:26<00:07, 310.66 examples/s]Map:  79%|███████▊  | 7893/10042 [00:26<00:06, 312.41 examples/s]Map:  79%|███████▉  | 7925/10042 [00:26<00:06, 314.19 examples/s]Map:  79%|███████▉  | 7957/10042 [00:26<00:06, 314.81 examples/s]Map:  80%|███████▉  | 7989/10042 [00:27<00:06, 313.62 examples/s]Map:  80%|███████▉  | 8031/10042 [00:27<00:10, 194.95 examples/s]Map:  80%|████████  | 8063/10042 [00:27<00:09, 218.12 examples/s]Map:  81%|████████  | 8095/10042 [00:27<00:08, 238.06 examples/s]Map:  81%|████████  | 8127/10042 [00:27<00:07, 254.98 examples/s]Map:  81%|████████▏ | 8160/10042 [00:27<00:06, 271.12 examples/s]Map:  82%|████████▏ | 8192/10042 [00:27<00:06, 279.96 examples/s]Map:  82%|████████▏ | 8224/10042 [00:28<00:06, 289.73 examples/s]Map:  82%|████████▏ | 8256/10042 [00:28<00:06, 295.88 examples/s]Map:  83%|████████▎ | 8288/10042 [00:28<00:05, 300.18 examples/s]Map:  83%|████████▎ | 8320/10042 [00:28<00:05, 302.89 examples/s]Map:  83%|████████▎ | 8352/10042 [00:28<00:05, 306.04 examples/s]Map:  83%|████████▎ | 8385/10042 [00:28<00:05, 309.82 examples/s]Map:  84%|████████▍ | 8417/10042 [00:28<00:05, 311.64 examples/s]Map:  84%|████████▍ | 8450/10042 [00:28<00:05, 312.31 examples/s]Map:  84%|████████▍ | 8483/10042 [00:28<00:04, 315.24 examples/s]Map:  85%|████████▍ | 8516/10042 [00:28<00:04, 314.36 examples/s]Map:  85%|████████▌ | 8563/10042 [00:29<00:04, 310.50 examples/s]Map:  86%|████████▌ | 8610/10042 [00:29<00:04, 310.27 examples/s]Map:  86%|████████▌ | 8642/10042 [00:29<00:04, 310.10 examples/s]Map:  86%|████████▋ | 8674/10042 [00:29<00:04, 310.97 examples/s]Map:  87%|████████▋ | 8706/10042 [00:29<00:04, 312.21 examples/s]Map:  87%|████████▋ | 8738/10042 [00:29<00:04, 312.38 examples/s]Map:  87%|████████▋ | 8770/10042 [00:29<00:04, 311.77 examples/s]Map:  88%|████████▊ | 8803/10042 [00:29<00:03, 312.74 examples/s]Map:  88%|████████▊ | 8836/10042 [00:29<00:03, 314.17 examples/s]Map:  88%|████████▊ | 8868/10042 [00:30<00:03, 314.78 examples/s]Map:  89%|████████▉ | 8915/10042 [00:30<00:03, 312.10 examples/s]Map:  89%|████████▉ | 8963/10042 [00:30<00:03, 312.17 examples/s]Map:  90%|████████▉ | 8995/10042 [00:30<00:03, 312.87 examples/s]Map:  90%|████████▉ | 9031/10042 [00:30<00:05, 197.55 examples/s]Map:  90%|█████████ | 9063/10042 [00:30<00:04, 219.15 examples/s]Map:  91%|█████████ | 9095/10042 [00:31<00:03, 239.84 examples/s]Map:  91%|█████████ | 9127/10042 [00:31<00:03, 256.46 examples/s]Map:  91%|█████████ | 9160/10042 [00:31<00:03, 271.24 examples/s]Map:  92%|█████████▏| 9191/10042 [00:31<00:03, 279.48 examples/s]Map:  92%|█████████▏| 9223/10042 [00:31<00:02, 289.38 examples/s]Map:  92%|█████████▏| 9255/10042 [00:31<00:02, 296.24 examples/s]Map:  92%|█████████▏| 9287/10042 [00:31<00:02, 300.27 examples/s]Map:  93%|█████████▎| 9319/10042 [00:31<00:02, 304.76 examples/s]Map:  93%|█████████▎| 9351/10042 [00:31<00:02, 306.12 examples/s]Map:  93%|█████████▎| 9383/10042 [00:31<00:02, 306.94 examples/s]Map:  94%|█████████▍| 9415/10042 [00:32<00:02, 307.77 examples/s]Map:  94%|█████████▍| 9448/10042 [00:32<00:01, 310.31 examples/s]Map:  94%|█████████▍| 9480/10042 [00:32<00:01, 309.21 examples/s]Map:  95%|█████████▍| 9512/10042 [00:32<00:01, 309.65 examples/s]Map:  95%|█████████▌| 9544/10042 [00:32<00:01, 309.05 examples/s]Map:  95%|█████████▌| 9575/10042 [00:32<00:01, 306.76 examples/s]Map:  96%|█████████▌| 9607/10042 [00:32<00:01, 308.08 examples/s]Map:  96%|█████████▌| 9638/10042 [00:32<00:01, 306.72 examples/s]Map:  96%|█████████▋| 9670/10042 [00:32<00:01, 307.55 examples/s]Map:  97%|█████████▋| 9701/10042 [00:32<00:01, 305.43 examples/s]Map:  97%|█████████▋| 9747/10042 [00:33<00:00, 302.39 examples/s]Map:  97%|█████████▋| 9779/10042 [00:33<00:00, 302.90 examples/s]Map:  98%|█████████▊| 9811/10042 [00:33<00:00, 304.18 examples/s]Map:  98%|█████████▊| 9843/10042 [00:33<00:00, 306.70 examples/s]Map:  98%|█████████▊| 9875/10042 [00:33<00:00, 305.77 examples/s]Map:  99%|█████████▊| 9907/10042 [00:33<00:00, 307.77 examples/s]Map:  99%|█████████▉| 9939/10042 [00:33<00:00, 309.49 examples/s]Map:  99%|█████████▉| 9971/10042 [00:33<00:00, 307.67 examples/s]Map: 100%|█████████▉| 10015/10042 [00:34<00:00, 152.03 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 168.70 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 290.93 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   7%|▋         | 93/1267 [00:00<00:01, 917.16 examples/s]Map:  15%|█▌        | 193/1267 [00:00<00:01, 964.77 examples/s]Map:  23%|██▎       | 295/1267 [00:00<00:00, 984.01 examples/s]Map:  31%|███▏      | 396/1267 [00:00<00:00, 989.72 examples/s]Map:  39%|███▉      | 497/1267 [00:00<00:00, 985.78 examples/s]Map:  47%|████▋     | 596/1267 [00:00<00:00, 984.71 examples/s]Map:  55%|█████▍    | 696/1267 [00:00<00:00, 985.31 examples/s]Map:  63%|██████▎   | 796/1267 [00:00<00:00, 988.10 examples/s]Map:  71%|███████   | 898/1267 [00:00<00:00, 995.90 examples/s]Map:  79%|███████▉  | 1000/1267 [00:01<00:00, 632.90 examples/s]Map:  87%|████████▋ | 1100/1267 [00:01<00:00, 710.86 examples/s]Map:  95%|█████████▍| 1202/1267 [00:01<00:00, 781.68 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 826.86 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.25it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  4.41it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.74it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.63it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:11<00:22, 11.13s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:20<00:09,  9.96s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:28<00:00,  9.16s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:28<00:00,  9.49s/it]
2024-04-27 08:53:19,685: rank0[3845995][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-04-27 08:53:19,687: rank0[3845995][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-04-27 08:53:20,946: rank0[3845995][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-04-27 08:53:21,119: rank0[3845995][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-04-27 08:53:30,686: rank0[3845995][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-04-27 08:53:30,687: rank0[3845995][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-04-27 08:53:30,687: rank0[3845995][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/eldar/cerebras/Llama-2-7b-pruned70-retrained
models:
- model_name: /network/eldar/cerebras/Llama-2-7b-pruned70-retrained
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/eldar/cerebras/Llama-2-7b-pruned70-retrained
    use_auth_token: true
  tokenizer:
    name: /network/eldar/cerebras/Llama-2-7b-pruned70-retrained
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-04-27 08:53:30,694: rank0[3845995][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.4369
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.3321
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7269
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7009
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                 |
|:-----------|:--------------|:----------|-----------:|:------------------|:------------------------------------------------------|
|            | arc_challenge |           |   0.43686  | 25-shot           | /network/eldar/cerebras/Llama-2-7b-pruned70-retrained |
|            | mmlu          |           |   0.332075 | 5-shot            | /network/eldar/cerebras/Llama-2-7b-pruned70-retrained |
|            | winogrande    |           |   0.700868 | 5-shot            | /network/eldar/cerebras/Llama-2-7b-pruned70-retrained |
|            | hellaswag     |           |   0.726947 | 10-shot           | /network/eldar/cerebras/Llama-2-7b-pruned70-retrained |
2024-04-27 09:54:02,099: rank0[3845995][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-04-27 09:54:02,100: rank0[3845995][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-04-27 09:54:02,100: rank0[3845995][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-04-27 09:54:02,100: rank0[3845995][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
