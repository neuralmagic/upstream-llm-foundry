----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
----****----[eldar debug]----****---- Using fused CrossEntropyLoss from flash_attn.losses.cross_entropy ----****----[eldar debug]----****----
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter global_seed found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-llm-foundry/scripts/eval/eval.py:281: UserWarning: Unused parameter ckpt_path found in cfg. Please check your yaml to ensure this parameter is necessary.
  warnings.warn(
[W Utils.hpp:133] Warning: Environment variable NCCL_ASYNC_ERROR_HANDLING is deprecated; use TORCH_NCCL_ASYNC_ERROR_HANDLING instead (function getCvarInt)
2024-04-27 08:47:46,399: rank0[3844553][MainThread]: INFO: llmfoundry.utils.builders: Extracting ICL task config from path: eval/yamls/openllm.yaml
Map:   0%|          | 0/1172 [00:00<?, ? examples/s]Map:   2%|▏         | 27/1172 [00:00<00:04, 263.34 examples/s]Map:   5%|▍         | 55/1172 [00:00<00:04, 270.27 examples/s]Map:   8%|▊         | 96/1172 [00:00<00:04, 265.50 examples/s]Map:  11%|█         | 124/1172 [00:00<00:03, 266.85 examples/s]Map:  13%|█▎        | 152/1172 [00:00<00:03, 269.14 examples/s]Map:  15%|█▌        | 180/1172 [00:00<00:03, 271.07 examples/s]Map:  18%|█▊        | 208/1172 [00:00<00:03, 271.83 examples/s]Map:  20%|██        | 236/1172 [00:00<00:03, 272.15 examples/s]Map:  23%|██▎       | 264/1172 [00:00<00:03, 271.72 examples/s]Map:  25%|██▍       | 292/1172 [00:01<00:03, 271.09 examples/s]Map:  27%|██▋       | 320/1172 [00:01<00:03, 271.36 examples/s]Map:  30%|██▉       | 348/1172 [00:01<00:03, 272.12 examples/s]Map:  32%|███▏      | 376/1172 [00:01<00:02, 271.47 examples/s]Map:  34%|███▍      | 404/1172 [00:01<00:02, 271.61 examples/s]Map:  37%|███▋      | 432/1172 [00:01<00:02, 269.49 examples/s]Map:  39%|███▉      | 460/1172 [00:01<00:02, 268.46 examples/s]Map:  42%|████▏     | 488/1172 [00:01<00:02, 268.84 examples/s]Map:  44%|████▍     | 516/1172 [00:01<00:02, 269.37 examples/s]Map:  46%|████▋     | 544/1172 [00:02<00:02, 270.17 examples/s]Map:  49%|████▉     | 572/1172 [00:02<00:02, 269.59 examples/s]Map:  51%|█████     | 600/1172 [00:02<00:02, 270.55 examples/s]Map:  54%|█████▎    | 628/1172 [00:02<00:02, 270.80 examples/s]Map:  56%|█████▌    | 656/1172 [00:02<00:01, 271.08 examples/s]Map:  58%|█████▊    | 684/1172 [00:02<00:01, 271.13 examples/s]Map:  61%|██████    | 712/1172 [00:02<00:01, 269.92 examples/s]Map:  63%|██████▎   | 740/1172 [00:02<00:01, 269.94 examples/s]Map:  66%|██████▌   | 768/1172 [00:02<00:01, 269.91 examples/s]Map:  68%|██████▊   | 796/1172 [00:02<00:01, 269.86 examples/s]Map:  70%|███████   | 824/1172 [00:03<00:01, 270.22 examples/s]Map:  73%|███████▎  | 852/1172 [00:03<00:01, 268.42 examples/s]Map:  75%|███████▌  | 880/1172 [00:03<00:01, 268.47 examples/s]Map:  77%|███████▋  | 908/1172 [00:03<00:00, 267.86 examples/s]Map:  80%|███████▉  | 935/1172 [00:03<00:00, 265.55 examples/s]Map:  82%|████████▏ | 963/1172 [00:03<00:00, 266.32 examples/s]Map:  85%|████████▍ | 991/1172 [00:03<00:00, 267.76 examples/s]Map:  88%|████████▊ | 1028/1172 [00:04<00:01, 139.08 examples/s]Map:  90%|█████████ | 1056/1172 [00:04<00:00, 160.72 examples/s]Map:  92%|█████████▏| 1084/1172 [00:04<00:00, 181.63 examples/s]Map:  95%|█████████▍| 1112/1172 [00:04<00:00, 201.09 examples/s]Map:  97%|█████████▋| 1140/1172 [00:04<00:00, 216.22 examples/s]Map: 100%|█████████▉| 1168/1172 [00:04<00:00, 229.65 examples/s]Map: 100%|██████████| 1172/1172 [00:04<00:00, 246.97 examples/s]
Map:   0%|          | 0/14042 [00:00<?, ? examples/s]Map:   0%|          | 47/14042 [00:00<00:30, 457.32 examples/s]Map:   1%|          | 113/14042 [00:00<00:31, 436.42 examples/s]Map:   1%|▏         | 177/14042 [00:00<00:32, 428.71 examples/s]Map:   2%|▏         | 225/14042 [00:00<00:31, 442.65 examples/s]Map:   2%|▏         | 270/14042 [00:00<00:31, 439.94 examples/s]Map:   2%|▏         | 317/14042 [00:00<00:30, 445.64 examples/s]Map:   3%|▎         | 362/14042 [00:01<00:48, 281.75 examples/s]Map:   3%|▎         | 406/14042 [00:01<00:43, 312.74 examples/s]Map:   3%|▎         | 452/14042 [00:01<00:39, 344.49 examples/s]Map:   4%|▎         | 498/14042 [00:01<00:36, 370.18 examples/s]Map:   4%|▍         | 544/14042 [00:01<00:34, 392.80 examples/s]Map:   4%|▍         | 588/14042 [00:01<00:33, 404.03 examples/s]Map:   5%|▍         | 635/14042 [00:01<00:32, 417.66 examples/s]Map:   5%|▍         | 680/14042 [00:01<00:31, 422.16 examples/s]Map:   5%|▌         | 746/14042 [00:01<00:31, 424.77 examples/s]Map:   6%|▌         | 793/14042 [00:01<00:30, 433.30 examples/s]Map:   6%|▌         | 839/14042 [00:02<00:30, 437.41 examples/s]Map:   6%|▋         | 907/14042 [00:02<00:30, 437.38 examples/s]Map:   7%|▋         | 958/14042 [00:02<00:28, 451.38 examples/s]Map:   7%|▋         | 1021/14042 [00:02<00:55, 233.66 examples/s]Map:   8%|▊         | 1070/14042 [00:02<00:47, 271.81 examples/s]Map:   8%|▊         | 1120/14042 [00:03<00:41, 311.76 examples/s]Map:   8%|▊         | 1170/14042 [00:03<00:37, 347.61 examples/s]Map:   9%|▊         | 1219/14042 [00:03<00:34, 376.91 examples/s]Map:   9%|▉         | 1267/14042 [00:03<00:31, 401.19 examples/s]Map:   9%|▉         | 1314/14042 [00:03<00:30, 415.92 examples/s]Map:  10%|▉         | 1362/14042 [00:03<00:29, 429.95 examples/s]Map:  10%|█         | 1409/14042 [00:03<00:28, 438.42 examples/s]Map:  10%|█         | 1456/14042 [00:03<00:28, 444.87 examples/s]Map:  11%|█         | 1505/14042 [00:03<00:27, 453.72 examples/s]Map:  11%|█         | 1573/14042 [00:04<00:27, 450.01 examples/s]Map:  12%|█▏        | 1619/14042 [00:04<00:27, 448.22 examples/s]Map:  12%|█▏        | 1668/14042 [00:04<00:27, 455.73 examples/s]Map:  12%|█▏        | 1715/14042 [00:04<00:26, 457.68 examples/s]Map:  13%|█▎        | 1762/14042 [00:04<00:26, 458.28 examples/s]Map:  13%|█▎        | 1809/14042 [00:04<00:26, 456.32 examples/s]Map:  13%|█▎        | 1877/14042 [00:04<00:26, 453.40 examples/s]Map:  14%|█▎        | 1924/14042 [00:04<00:26, 451.54 examples/s]Map:  14%|█▍        | 1971/14042 [00:04<00:26, 455.16 examples/s]Map:  14%|█▍        | 2021/14042 [00:05<00:42, 282.31 examples/s]Map:  15%|█▍        | 2068/14042 [00:05<00:37, 316.23 examples/s]Map:  15%|█▌        | 2116/14042 [00:05<00:34, 349.83 examples/s]Map:  15%|█▌        | 2165/14042 [00:05<00:31, 380.80 examples/s]Map:  16%|█▌        | 2214/14042 [00:05<00:29, 405.86 examples/s]Map:  16%|█▌        | 2262/14042 [00:05<00:27, 424.65 examples/s]Map:  16%|█▋        | 2312/14042 [00:05<00:26, 443.39 examples/s]Map:  17%|█▋        | 2360/14042 [00:05<00:25, 450.67 examples/s]Map:  17%|█▋        | 2408/14042 [00:06<00:25, 457.55 examples/s]Map:  17%|█▋        | 2457/14042 [00:06<00:25, 463.18 examples/s]Map:  18%|█▊        | 2508/14042 [00:06<00:24, 473.41 examples/s]Map:  18%|█▊        | 2559/14042 [00:06<00:23, 481.16 examples/s]Map:  19%|█▊        | 2608/14042 [00:06<00:23, 479.61 examples/s]Map:  19%|█▉        | 2680/14042 [00:06<00:23, 477.67 examples/s]Map:  19%|█▉        | 2730/14042 [00:06<00:23, 480.55 examples/s]Map:  20%|█▉        | 2803/14042 [00:06<00:23, 478.14 examples/s]Map:  20%|██        | 2873/14042 [00:07<00:23, 473.11 examples/s]Map:  21%|██        | 2924/14042 [00:07<00:23, 477.76 examples/s]Map:  21%|██▏       | 2996/14042 [00:07<00:23, 476.64 examples/s]Map:  22%|██▏       | 3047/14042 [00:07<00:35, 309.65 examples/s]Map:  22%|██▏       | 3096/14042 [00:07<00:32, 341.22 examples/s]Map:  22%|██▏       | 3146/14042 [00:07<00:29, 371.17 examples/s]Map:  23%|██▎       | 3192/14042 [00:07<00:27, 388.19 examples/s]Map:  23%|██▎       | 3237/14042 [00:08<00:26, 400.43 examples/s]Map:  23%|██▎       | 3284/14042 [00:08<00:25, 415.31 examples/s]Map:  24%|██▍       | 3335/14042 [00:08<00:24, 434.71 examples/s]Map:  24%|██▍       | 3385/14042 [00:08<00:23, 449.05 examples/s]Map:  24%|██▍       | 3434/14042 [00:08<00:23, 456.30 examples/s]Map:  25%|██▍       | 3483/14042 [00:08<00:22, 463.52 examples/s]Map:  25%|██▌       | 3532/14042 [00:08<00:22, 470.14 examples/s]Map:  25%|██▌       | 3580/14042 [00:08<00:22, 470.37 examples/s]Map:  26%|██▌       | 3650/14042 [00:08<00:22, 466.53 examples/s]Map:  26%|██▋       | 3699/14042 [00:09<00:22, 468.43 examples/s]Map:  27%|██▋       | 3748/14042 [00:09<00:21, 470.68 examples/s]Map:  27%|██▋       | 3797/14042 [00:09<00:21, 472.40 examples/s]Map:  28%|██▊       | 3868/14042 [00:09<00:21, 471.27 examples/s]Map:  28%|██▊       | 3938/14042 [00:09<00:21, 466.77 examples/s]Map:  28%|██▊       | 3985/14042 [00:09<00:21, 464.83 examples/s]Map:  29%|██▉       | 4046/14042 [00:09<00:32, 306.13 examples/s]Map:  29%|██▉       | 4094/14042 [00:10<00:29, 336.06 examples/s]Map:  29%|██▉       | 4142/14042 [00:10<00:27, 364.47 examples/s]Map:  30%|██▉       | 4191/14042 [00:10<00:25, 390.95 examples/s]Map:  30%|███       | 4239/14042 [00:10<00:23, 410.57 examples/s]Map:  31%|███       | 4286/14042 [00:10<00:23, 423.78 examples/s]Map:  31%|███       | 4333/14042 [00:10<00:22, 433.62 examples/s]Map:  31%|███▏      | 4393/14042 [00:10<00:23, 415.79 examples/s]Map:  32%|███▏      | 4438/14042 [00:10<00:22, 424.03 examples/s]Map:  32%|███▏      | 4488/14042 [00:10<00:21, 440.45 examples/s]Map:  32%|███▏      | 4551/14042 [00:11<00:22, 429.44 examples/s]Map:  33%|███▎      | 4611/14042 [00:11<00:22, 416.66 examples/s]Map:  33%|███▎      | 4671/14042 [00:11<00:23, 405.74 examples/s]Map:  34%|███▎      | 4731/14042 [00:11<00:23, 399.46 examples/s]Map:  34%|███▍      | 4779/14042 [00:11<00:22, 414.83 examples/s]Map:  34%|███▍      | 4827/14042 [00:11<00:21, 428.67 examples/s]Map:  35%|███▍      | 4877/14042 [00:11<00:20, 443.69 examples/s]Map:  35%|███▌      | 4927/14042 [00:11<00:19, 456.72 examples/s]Map:  35%|███▌      | 4975/14042 [00:12<00:19, 459.06 examples/s]Map:  36%|███▌      | 5022/14042 [00:12<00:41, 216.69 examples/s]Map:  36%|███▌      | 5068/14042 [00:12<00:35, 254.06 examples/s]Map:  37%|███▋      | 5126/14042 [00:12<00:31, 285.31 examples/s]Map:  37%|███▋      | 5166/14042 [00:12<00:29, 305.78 examples/s]Map:  37%|███▋      | 5223/14042 [00:13<00:27, 324.09 examples/s]Map:  38%|███▊      | 5269/14042 [00:13<00:24, 351.99 examples/s]Map:  38%|███▊      | 5317/14042 [00:13<00:22, 381.22 examples/s]Map:  38%|███▊      | 5367/14042 [00:13<00:21, 408.51 examples/s]Map:  39%|███▊      | 5412/14042 [00:13<00:20, 417.51 examples/s]Map:  39%|███▉      | 5460/14042 [00:13<00:19, 432.06 examples/s]Map:  39%|███▉      | 5509/14042 [00:13<00:19, 444.06 examples/s]Map:  40%|███▉      | 5558/14042 [00:13<00:18, 455.58 examples/s]Map:  40%|███▉      | 5608/14042 [00:13<00:18, 464.96 examples/s]Map:  40%|████      | 5658/14042 [00:14<00:17, 470.89 examples/s]Map:  41%|████      | 5706/14042 [00:14<00:17, 472.69 examples/s]Map:  41%|████      | 5755/14042 [00:14<00:17, 474.79 examples/s]Map:  41%|████▏     | 5825/14042 [00:14<00:17, 468.83 examples/s]Map:  42%|████▏     | 5894/14042 [00:14<00:17, 461.04 examples/s]Map:  42%|████▏     | 5957/14042 [00:14<00:18, 441.92 examples/s]Map:  43%|████▎     | 6020/14042 [00:15<00:27, 289.23 examples/s]Map:  43%|████▎     | 6062/14042 [00:15<00:25, 310.10 examples/s]Map:  43%|████▎     | 6103/14042 [00:15<00:24, 327.29 examples/s]Map:  44%|████▍     | 6145/14042 [00:15<00:22, 344.91 examples/s]Map:  44%|████▍     | 6185/14042 [00:15<00:22, 355.71 examples/s]Map:  44%|████▍     | 6225/14042 [00:15<00:21, 363.43 examples/s]Map:  45%|████▍     | 6265/14042 [00:15<00:21, 368.95 examples/s]Map:  45%|████▍     | 6305/14042 [00:15<00:20, 375.29 examples/s]Map:  45%|████▌     | 6348/14042 [00:15<00:19, 386.89 examples/s]Map:  46%|████▌     | 6390/14042 [00:15<00:19, 393.68 examples/s]Map:  46%|████▌     | 6433/14042 [00:16<00:18, 401.09 examples/s]Map:  46%|████▌     | 6493/14042 [00:16<00:19, 396.99 examples/s]Map:  47%|████▋     | 6535/14042 [00:16<00:18, 400.24 examples/s]Map:  47%|████▋     | 6576/14042 [00:16<00:18, 401.42 examples/s]Map:  47%|████▋     | 6618/14042 [00:16<00:18, 403.87 examples/s]Map:  48%|████▊     | 6678/14042 [00:16<00:18, 397.12 examples/s]Map:  48%|████▊     | 6736/14042 [00:16<00:18, 391.40 examples/s]Map:  48%|████▊     | 6776/14042 [00:16<00:18, 391.65 examples/s]Map:  49%|████▊     | 6816/14042 [00:17<00:18, 390.92 examples/s]Map:  49%|████▉     | 6856/14042 [00:17<00:18, 391.21 examples/s]Map:  49%|████▉     | 6897/14042 [00:17<00:18, 394.71 examples/s]Map:  49%|████▉     | 6938/14042 [00:17<00:17, 396.54 examples/s]Map:  50%|████▉     | 6979/14042 [00:17<00:17, 397.62 examples/s]Map:  50%|████▉     | 7019/14042 [00:17<00:28, 243.72 examples/s]Map:  50%|█████     | 7060/14042 [00:17<00:25, 275.45 examples/s]Map:  51%|█████     | 7102/14042 [00:18<00:22, 306.55 examples/s]Map:  51%|█████     | 7142/14042 [00:18<00:21, 326.60 examples/s]Map:  51%|█████     | 7185/14042 [00:18<00:19, 350.87 examples/s]Map:  51%|█████▏    | 7229/14042 [00:18<00:18, 371.88 examples/s]Map:  52%|█████▏    | 7269/14042 [00:18<00:17, 376.76 examples/s]Map:  52%|█████▏    | 7309/14042 [00:18<00:17, 381.16 examples/s]Map:  52%|█████▏    | 7350/14042 [00:18<00:17, 386.93 examples/s]Map:  53%|█████▎    | 7392/14042 [00:18<00:16, 394.43 examples/s]Map:  53%|█████▎    | 7456/14042 [00:18<00:16, 402.92 examples/s]Map:  53%|█████▎    | 7503/14042 [00:18<00:15, 419.30 examples/s]Map:  54%|█████▍    | 7551/14042 [00:19<00:14, 434.59 examples/s]Map:  54%|█████▍    | 7601/14042 [00:19<00:14, 449.54 examples/s]Map:  54%|█████▍    | 7649/14042 [00:19<00:13, 457.10 examples/s]Map:  55%|█████▍    | 7699/14042 [00:19<00:13, 467.38 examples/s]Map:  55%|█████▌    | 7746/14042 [00:19<00:13, 465.05 examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2179 > 2048). Running this sequence through the model will result in indexing errors
Map:  56%|█████▌    | 7816/14042 [00:19<00:13, 461.77 examples/s]Map:  56%|█████▌    | 7863/14042 [00:19<00:13, 463.59 examples/s]Map:  56%|█████▋    | 7912/14042 [00:19<00:13, 468.80 examples/s]Map:  57%|█████▋    | 7961/14042 [00:19<00:12, 470.72 examples/s]Map:  57%|█████▋    | 8022/14042 [00:20<00:20, 295.19 examples/s]Map:  57%|█████▋    | 8071/14042 [00:20<00:18, 330.10 examples/s]Map:  58%|█████▊    | 8120/14042 [00:20<00:16, 361.74 examples/s]Map:  58%|█████▊    | 8169/14042 [00:20<00:15, 387.98 examples/s]Map:  59%|█████▊    | 8219/14042 [00:20<00:14, 411.63 examples/s]Map:  59%|█████▉    | 8269/14042 [00:20<00:13, 431.20 examples/s]Map:  59%|█████▉    | 8317/14042 [00:20<00:13, 439.68 examples/s]Map:  60%|█████▉    | 8366/14042 [00:21<00:12, 448.58 examples/s]Map:  60%|█████▉    | 8414/14042 [00:21<00:12, 454.87 examples/s]Map:  60%|██████    | 8462/14042 [00:21<00:12, 460.09 examples/s]Map:  61%|██████    | 8509/14042 [00:21<00:12, 460.32 examples/s]Map:  61%|██████    | 8556/14042 [00:21<00:11, 460.47 examples/s]Map:  61%|██████▏   | 8605/14042 [00:21<00:11, 466.68 examples/s]Map:  62%|██████▏   | 8652/14042 [00:21<00:11, 463.40 examples/s]Map:  62%|██████▏   | 8700/14042 [00:21<00:11, 463.81 examples/s]Map:  62%|██████▏   | 8768/14042 [00:21<00:11, 457.12 examples/s]Map:  63%|██████▎   | 8818/14042 [00:21<00:11, 464.18 examples/s]Map:  63%|██████▎   | 8865/14042 [00:22<00:11, 463.72 examples/s]Map:  63%|██████▎   | 8914/14042 [00:22<00:10, 470.78 examples/s]Map:  64%|██████▍   | 8964/14042 [00:22<00:10, 476.15 examples/s]Map:  64%|██████▍   | 9021/14042 [00:22<00:16, 296.04 examples/s]Map:  65%|██████▍   | 9069/14042 [00:22<00:15, 330.67 examples/s]Map:  65%|██████▍   | 9118/14042 [00:22<00:13, 364.00 examples/s]Map:  65%|██████▌   | 9165/14042 [00:22<00:12, 386.99 examples/s]Map:  66%|██████▌   | 9213/14042 [00:23<00:11, 410.17 examples/s]Map:  66%|██████▌   | 9261/14042 [00:23<00:11, 426.29 examples/s]Map:  66%|██████▋   | 9310/14042 [00:23<00:10, 441.50 examples/s]Map:  67%|██████▋   | 9360/14042 [00:23<00:10, 455.51 examples/s]Map:  67%|██████▋   | 9431/14042 [00:23<00:10, 459.25 examples/s]Map:  68%|██████▊   | 9479/14042 [00:23<00:09, 463.02 examples/s]Map:  68%|██████▊   | 9530/14042 [00:23<00:09, 473.79 examples/s]Map:  68%|██████▊   | 9590/14042 [00:23<00:10, 442.84 examples/s]Map:  69%|██████▊   | 9648/14042 [00:24<00:10, 421.93 examples/s]Map:  69%|██████▉   | 9706/14042 [00:24<00:10, 408.15 examples/s]Map:  70%|██████▉   | 9766/14042 [00:24<00:14, 286.20 examples/s]Map:  70%|██████▉   | 9808/14042 [00:24<00:13, 309.09 examples/s]Map:  70%|███████   | 9852/14042 [00:24<00:12, 333.94 examples/s]Map:  70%|███████   | 9896/14042 [00:24<00:11, 355.30 examples/s]Map:  71%|███████   | 9940/14042 [00:24<00:10, 374.30 examples/s]Map:  71%|███████   | 9984/14042 [00:25<00:10, 387.84 examples/s]Map:  72%|███████▏  | 10043/14042 [00:25<00:14, 267.85 examples/s]Map:  72%|███████▏  | 10092/14042 [00:25<00:12, 308.29 examples/s]Map:  72%|███████▏  | 10141/14042 [00:25<00:11, 344.96 examples/s]Map:  73%|███████▎  | 10187/14042 [00:25<00:10, 367.82 examples/s]Map:  73%|███████▎  | 10236/14042 [00:25<00:09, 393.95 examples/s]Map:  73%|███████▎  | 10284/14042 [00:25<00:09, 414.41 examples/s]Map:  74%|███████▎  | 10330/14042 [00:25<00:08, 424.39 examples/s]Map:  74%|███████▍  | 10378/14042 [00:26<00:08, 433.15 examples/s]Map:  74%|███████▍  | 10445/14042 [00:26<00:08, 435.08 examples/s]Map:  75%|███████▍  | 10491/14042 [00:26<00:08, 438.66 examples/s]Map:  75%|███████▌  | 10536/14042 [00:26<00:08, 437.85 examples/s]Map:  75%|███████▌  | 10582/14042 [00:26<00:07, 441.36 examples/s]Map:  76%|███████▌  | 10632/14042 [00:26<00:07, 455.26 examples/s]Map:  76%|███████▌  | 10679/14042 [00:26<00:07, 457.31 examples/s]Map:  77%|███████▋  | 10749/14042 [00:26<00:07, 458.14 examples/s]Map:  77%|███████▋  | 10817/14042 [00:27<00:07, 454.54 examples/s]Map:  77%|███████▋  | 10867/14042 [00:27<00:06, 462.63 examples/s]Map:  78%|███████▊  | 10914/14042 [00:27<00:06, 462.17 examples/s]Map:  78%|███████▊  | 10961/14042 [00:27<00:06, 460.18 examples/s]Map:  78%|███████▊  | 11022/14042 [00:27<00:10, 291.79 examples/s]Map:  79%|███████▉  | 11070/14042 [00:27<00:09, 325.64 examples/s]Map:  79%|███████▉  | 11120/14042 [00:27<00:08, 360.57 examples/s]Map:  80%|███████▉  | 11169/14042 [00:28<00:07, 387.89 examples/s]Map:  80%|███████▉  | 11217/14042 [00:28<00:06, 408.34 examples/s]Map:  80%|████████  | 11282/14042 [00:28<00:06, 414.09 examples/s]Map:  81%|████████  | 11327/14042 [00:28<00:06, 420.42 examples/s]Map:  81%|████████  | 11391/14042 [00:28<00:06, 420.20 examples/s]Map:  81%|████████▏ | 11435/14042 [00:28<00:06, 421.48 examples/s]Map:  82%|████████▏ | 11480/14042 [00:28<00:06, 426.46 examples/s]Map:  82%|████████▏ | 11527/14042 [00:28<00:05, 434.98 examples/s]Map:  82%|████████▏ | 11576/14042 [00:28<00:05, 447.96 examples/s]Map:  83%|████████▎ | 11624/14042 [00:29<00:05, 453.49 examples/s]Map:  83%|████████▎ | 11674/14042 [00:29<00:05, 463.66 examples/s]Map:  83%|████████▎ | 11724/14042 [00:29<00:04, 472.28 examples/s]Map:  84%|████████▍ | 11796/14042 [00:29<00:04, 472.93 examples/s]Map:  84%|████████▍ | 11844/14042 [00:29<00:04, 472.48 examples/s]Map:  85%|████████▍ | 11893/14042 [00:29<00:04, 475.16 examples/s]Map:  85%|████████▌ | 11967/14042 [00:29<00:04, 477.20 examples/s]Map:  86%|████████▌ | 12022/14042 [00:30<00:06, 314.12 examples/s]Map:  86%|████████▌ | 12069/14042 [00:30<00:05, 343.31 examples/s]Map:  86%|████████▋ | 12118/14042 [00:30<00:05, 372.43 examples/s]Map:  87%|████████▋ | 12165/14042 [00:30<00:04, 393.45 examples/s]Map:  87%|████████▋ | 12213/14042 [00:30<00:04, 411.07 examples/s]Map:  87%|████████▋ | 12262/14042 [00:30<00:04, 429.86 examples/s]Map:  88%|████████▊ | 12310/14042 [00:30<00:03, 440.09 examples/s]Map:  88%|████████▊ | 12358/14042 [00:30<00:03, 448.18 examples/s]Map:  88%|████████▊ | 12405/14042 [00:30<00:03, 451.04 examples/s]Map:  89%|████████▊ | 12452/14042 [00:31<00:03, 455.38 examples/s]Map:  89%|████████▉ | 12501/14042 [00:31<00:03, 463.83 examples/s]Map:  89%|████████▉ | 12549/14042 [00:31<00:03, 461.91 examples/s]Map:  90%|████████▉ | 12597/14042 [00:31<00:03, 462.36 examples/s]Map:  90%|█████████ | 12646/14042 [00:31<00:02, 466.98 examples/s]Map:  90%|█████████ | 12695/14042 [00:31<00:02, 469.68 examples/s]Map:  91%|█████████ | 12767/14042 [00:31<00:02, 467.89 examples/s]Map:  91%|█████████▏| 12815/14042 [00:31<00:02, 468.31 examples/s]Map:  92%|█████████▏| 12866/14042 [00:31<00:02, 477.02 examples/s]Map:  92%|█████████▏| 12917/14042 [00:31<00:02, 480.01 examples/s]Map:  92%|█████████▏| 12988/14042 [00:32<00:02, 472.33 examples/s]Map:  93%|█████████▎| 13047/14042 [00:32<00:03, 315.27 examples/s]Map:  93%|█████████▎| 13095/14042 [00:32<00:02, 345.37 examples/s]Map:  94%|█████████▎| 13143/14042 [00:32<00:02, 370.85 examples/s]Map:  94%|█████████▍| 13193/14042 [00:32<00:02, 398.56 examples/s]Map:  94%|█████████▍| 13241/14042 [00:32<00:01, 415.57 examples/s]Map:  95%|█████████▍| 13291/14042 [00:32<00:01, 434.96 examples/s]Map:  95%|█████████▍| 13339/14042 [00:33<00:01, 443.01 examples/s]Map:  95%|█████████▌| 13387/14042 [00:33<00:01, 452.01 examples/s]Map:  96%|█████████▌| 13438/14042 [00:33<00:01, 467.21 examples/s]Map:  96%|█████████▌| 13487/14042 [00:33<00:01, 468.03 examples/s]Map:  97%|█████████▋| 13556/14042 [00:33<00:01, 461.73 examples/s]Map:  97%|█████████▋| 13608/14042 [00:33<00:00, 473.22 examples/s]Map:  97%|█████████▋| 13656/14042 [00:33<00:00, 470.92 examples/s]Map:  98%|█████████▊| 13704/14042 [00:33<00:00, 469.94 examples/s]Map:  98%|█████████▊| 13753/14042 [00:33<00:00, 472.82 examples/s]Map:  98%|█████████▊| 13803/14042 [00:34<00:00, 477.37 examples/s]Map:  99%|█████████▊| 13851/14042 [00:34<00:00, 477.57 examples/s]Map:  99%|█████████▉| 13900/14042 [00:34<00:00, 478.63 examples/s]Map:  99%|█████████▉| 13949/14042 [00:34<00:00, 477.87 examples/s]Map: 100%|█████████▉| 13998/14042 [00:34<00:00, 477.67 examples/s]Map: 100%|██████████| 14042/14042 [00:34<00:00, 403.39 examples/s]
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   0%|          | 33/10042 [00:00<00:31, 320.47 examples/s]Map:   1%|          | 66/10042 [00:00<00:31, 316.63 examples/s]Map:   1%|          | 100/10042 [00:00<00:30, 324.61 examples/s]Map:   1%|▏         | 134/10042 [00:00<00:30, 330.01 examples/s]Map:   2%|▏         | 168/10042 [00:00<00:30, 328.14 examples/s]Map:   2%|▏         | 204/10042 [00:00<00:29, 333.43 examples/s]Map:   2%|▏         | 240/10042 [00:00<00:29, 336.56 examples/s]Map:   3%|▎         | 276/10042 [00:01<00:45, 217.02 examples/s]Map:   3%|▎         | 311/10042 [00:01<00:39, 243.44 examples/s]Map:   3%|▎         | 348/10042 [00:01<00:35, 270.61 examples/s]Map:   4%|▍         | 384/10042 [00:01<00:33, 292.61 examples/s]Map:   4%|▍         | 420/10042 [00:01<00:31, 307.13 examples/s]Map:   5%|▍         | 456/10042 [00:01<00:29, 320.24 examples/s]Map:   5%|▍         | 492/10042 [00:01<00:29, 329.26 examples/s]Map:   5%|▌         | 528/10042 [00:01<00:28, 334.27 examples/s]Map:   6%|▌         | 565/10042 [00:01<00:27, 340.28 examples/s]Map:   6%|▌         | 601/10042 [00:01<00:27, 342.59 examples/s]Map:   6%|▋         | 637/10042 [00:02<00:27, 344.85 examples/s]Map:   7%|▋         | 672/10042 [00:02<00:27, 343.05 examples/s]Map:   7%|▋         | 724/10042 [00:02<00:27, 341.67 examples/s]Map:   8%|▊         | 760/10042 [00:02<00:27, 343.49 examples/s]Map:   8%|▊         | 797/10042 [00:02<00:26, 345.20 examples/s]Map:   8%|▊         | 833/10042 [00:02<00:26, 345.87 examples/s]Map:   9%|▊         | 869/10042 [00:02<00:26, 346.88 examples/s]Map:   9%|▉         | 905/10042 [00:02<00:26, 345.93 examples/s]Map:   9%|▉         | 941/10042 [00:02<00:26, 346.54 examples/s]Map:  10%|▉         | 976/10042 [00:03<00:26, 344.22 examples/s]Map:  10%|█         | 1016/10042 [00:03<00:53, 169.28 examples/s]Map:  10%|█         | 1052/10042 [00:03<00:45, 199.74 examples/s]Map:  11%|█         | 1088/10042 [00:03<00:39, 228.66 examples/s]Map:  11%|█         | 1124/10042 [00:03<00:34, 255.25 examples/s]Map:  12%|█▏        | 1160/10042 [00:03<00:31, 277.98 examples/s]Map:  12%|█▏        | 1196/10042 [00:04<00:29, 296.88 examples/s]Map:  12%|█▏        | 1232/10042 [00:04<00:28, 311.38 examples/s]Map:  13%|█▎        | 1268/10042 [00:04<00:27, 321.96 examples/s]Map:  13%|█▎        | 1303/10042 [00:04<00:26, 326.49 examples/s]Map:  13%|█▎        | 1339/10042 [00:04<00:26, 332.15 examples/s]Map:  14%|█▎        | 1375/10042 [00:04<00:25, 335.44 examples/s]Map:  14%|█▍        | 1411/10042 [00:04<00:25, 338.65 examples/s]Map:  14%|█▍        | 1447/10042 [00:04<00:25, 340.87 examples/s]Map:  15%|█▍        | 1483/10042 [00:04<00:24, 343.53 examples/s]Map:  15%|█▌        | 1519/10042 [00:04<00:24, 344.94 examples/s]Map:  15%|█▌        | 1555/10042 [00:05<00:24, 345.80 examples/s]Map:  16%|█▌        | 1590/10042 [00:05<00:24, 345.20 examples/s]Map:  16%|█▌        | 1625/10042 [00:05<00:24, 344.28 examples/s]Map:  17%|█▋        | 1661/10042 [00:05<00:24, 344.32 examples/s]Map:  17%|█▋        | 1697/10042 [00:05<00:24, 345.35 examples/s]Map:  17%|█▋        | 1733/10042 [00:05<00:23, 346.67 examples/s]Map:  18%|█▊        | 1784/10042 [00:05<00:24, 341.98 examples/s]Map:  18%|█▊        | 1820/10042 [00:05<00:23, 342.68 examples/s]Map:  18%|█▊        | 1855/10042 [00:05<00:23, 341.42 examples/s]Map:  19%|█▉        | 1891/10042 [00:06<00:23, 344.28 examples/s]Map:  19%|█▉        | 1926/10042 [00:06<00:23, 341.46 examples/s]Map:  20%|█▉        | 1962/10042 [00:06<00:23, 341.73 examples/s]Map:  20%|█▉        | 1998/10042 [00:06<00:23, 342.08 examples/s]Map:  20%|██        | 2034/10042 [00:06<00:38, 207.31 examples/s]Map:  21%|██        | 2069/10042 [00:06<00:33, 234.76 examples/s]Map:  21%|██        | 2105/10042 [00:06<00:30, 259.51 examples/s]Map:  21%|██▏       | 2141/10042 [00:07<00:28, 280.93 examples/s]Map:  22%|██▏       | 2177/10042 [00:07<00:26, 298.77 examples/s]Map:  22%|██▏       | 2213/10042 [00:07<00:25, 311.59 examples/s]Map:  22%|██▏       | 2249/10042 [00:07<00:24, 322.40 examples/s]Map:  23%|██▎       | 2284/10042 [00:07<00:23, 329.45 examples/s]Map:  23%|██▎       | 2320/10042 [00:07<00:22, 336.06 examples/s]Map:  23%|██▎       | 2356/10042 [00:07<00:22, 341.39 examples/s]Map:  24%|██▍       | 2392/10042 [00:07<00:22, 344.18 examples/s]Map:  24%|██▍       | 2428/10042 [00:07<00:22, 345.22 examples/s]Map:  25%|██▍       | 2464/10042 [00:07<00:21, 346.95 examples/s]Map:  25%|██▍       | 2500/10042 [00:08<00:21, 348.99 examples/s]Map:  25%|██▌       | 2536/10042 [00:08<00:21, 349.82 examples/s]Map:  26%|██▌       | 2572/10042 [00:08<00:21, 349.61 examples/s]Map:  26%|██▌       | 2608/10042 [00:08<00:21, 348.23 examples/s]Map:  26%|██▋       | 2643/10042 [00:08<00:21, 346.36 examples/s]Map:  27%|██▋       | 2678/10042 [00:08<00:21, 344.70 examples/s]Map:  27%|██▋       | 2714/10042 [00:08<00:21, 344.45 examples/s]Map:  28%|██▊       | 2766/10042 [00:08<00:21, 342.43 examples/s]Map:  28%|██▊       | 2802/10042 [00:08<00:21, 343.85 examples/s]Map:  28%|██▊       | 2838/10042 [00:09<00:20, 344.02 examples/s]Map:  29%|██▊       | 2874/10042 [00:09<00:20, 345.58 examples/s]Map:  29%|██▉       | 2910/10042 [00:09<00:20, 345.58 examples/s]Map:  29%|██▉       | 2962/10042 [00:09<00:20, 341.09 examples/s]Map:  30%|██▉       | 2997/10042 [00:09<00:20, 341.62 examples/s]Map:  30%|███       | 3034/10042 [00:09<00:31, 219.52 examples/s]Map:  31%|███       | 3070/10042 [00:09<00:28, 245.81 examples/s]Map:  31%|███       | 3106/10042 [00:09<00:25, 268.56 examples/s]Map:  31%|███▏      | 3141/10042 [00:10<00:24, 286.90 examples/s]Map:  32%|███▏      | 3177/10042 [00:10<00:22, 302.14 examples/s]Map:  32%|███▏      | 3213/10042 [00:10<00:21, 313.00 examples/s]Map:  32%|███▏      | 3248/10042 [00:10<00:21, 320.45 examples/s]Map:  33%|███▎      | 3298/10042 [00:10<00:21, 320.10 examples/s]Map:  33%|███▎      | 3348/10042 [00:10<00:20, 320.84 examples/s]Map:  34%|███▍      | 3397/10042 [00:10<00:20, 320.06 examples/s]Map:  34%|███▍      | 3431/10042 [00:10<00:20, 320.65 examples/s]Map:  34%|███▍      | 3464/10042 [00:11<00:20, 320.68 examples/s]Map:  35%|███▍      | 3497/10042 [00:11<00:20, 319.92 examples/s]Map:  35%|███▌      | 3530/10042 [00:11<00:20, 319.40 examples/s]Map:  35%|███▌      | 3564/10042 [00:11<00:20, 321.49 examples/s]Map:  36%|███▌      | 3598/10042 [00:11<00:19, 322.46 examples/s]Map:  36%|███▋      | 3646/10042 [00:11<00:20, 319.33 examples/s]Map:  37%|███▋      | 3694/10042 [00:11<00:20, 316.94 examples/s]Map:  37%|███▋      | 3726/10042 [00:11<00:20, 315.57 examples/s]Map:  37%|███▋      | 3758/10042 [00:12<00:20, 313.77 examples/s]Map:  38%|███▊      | 3790/10042 [00:12<00:19, 313.49 examples/s]Map:  38%|███▊      | 3822/10042 [00:12<00:19, 314.09 examples/s]Map:  38%|███▊      | 3854/10042 [00:12<00:19, 313.64 examples/s]Map:  39%|███▊      | 3886/10042 [00:12<00:19, 314.12 examples/s]Map:  39%|███▉      | 3918/10042 [00:12<00:19, 313.13 examples/s]Map:  39%|███▉      | 3950/10042 [00:12<00:19, 314.39 examples/s]Map:  40%|███▉      | 3982/10042 [00:12<00:19, 313.97 examples/s]Map:  40%|███▉      | 4016/10042 [00:13<00:31, 192.88 examples/s]Map:  40%|████      | 4048/10042 [00:13<00:27, 218.17 examples/s]Map:  41%|████      | 4080/10042 [00:13<00:24, 240.06 examples/s]Map:  41%|████      | 4114/10042 [00:13<00:22, 260.79 examples/s]Map:  41%|████▏     | 4147/10042 [00:13<00:21, 275.94 examples/s]Map:  42%|████▏     | 4180/10042 [00:13<00:20, 287.98 examples/s]Map:  42%|████▏     | 4214/10042 [00:13<00:19, 298.66 examples/s]Map:  42%|████▏     | 4247/10042 [00:13<00:18, 305.56 examples/s]Map:  43%|████▎     | 4281/10042 [00:13<00:18, 311.23 examples/s]Map:  43%|████▎     | 4315/10042 [00:13<00:18, 315.57 examples/s]Map:  43%|████▎     | 4348/10042 [00:14<00:17, 317.18 examples/s]Map:  44%|████▎     | 4382/10042 [00:14<00:17, 320.27 examples/s]Map:  44%|████▍     | 4416/10042 [00:14<00:17, 322.57 examples/s]Map:  44%|████▍     | 4449/10042 [00:14<00:17, 321.33 examples/s]Map:  45%|████▍     | 4483/10042 [00:14<00:17, 322.55 examples/s]Map:  45%|████▍     | 4517/10042 [00:14<00:17, 323.66 examples/s]Map:  45%|████▌     | 4550/10042 [00:14<00:17, 322.38 examples/s]Map:  46%|████▌     | 4583/10042 [00:14<00:16, 322.18 examples/s]Map:  46%|████▌     | 4616/10042 [00:14<00:16, 321.79 examples/s]Map:  46%|████▋     | 4649/10042 [00:15<00:16, 320.99 examples/s]Map:  47%|████▋     | 4682/10042 [00:15<00:16, 322.11 examples/s]Map:  47%|████▋     | 4715/10042 [00:15<00:16, 321.87 examples/s]Map:  47%|████▋     | 4748/10042 [00:15<00:16, 322.98 examples/s]Map:  48%|████▊     | 4781/10042 [00:15<00:16, 323.86 examples/s]Map:  48%|████▊     | 4815/10042 [00:15<00:16, 324.47 examples/s]Map:  48%|████▊     | 4863/10042 [00:15<00:16, 319.93 examples/s]Map:  49%|████▉     | 4897/10042 [00:15<00:15, 322.23 examples/s]Map:  49%|████▉     | 4930/10042 [00:15<00:15, 322.10 examples/s]Map:  49%|████▉     | 4963/10042 [00:15<00:15, 321.99 examples/s]Map:  50%|████▉     | 5000/10042 [00:16<00:33, 151.88 examples/s]Map:  50%|█████     | 5030/10042 [00:16<00:28, 174.24 examples/s]Map:  50%|█████     | 5062/10042 [00:16<00:24, 199.81 examples/s]Map:  51%|█████     | 5094/10042 [00:16<00:22, 224.19 examples/s]Map:  51%|█████     | 5126/10042 [00:16<00:20, 244.82 examples/s]Map:  51%|█████▏    | 5159/10042 [00:17<00:18, 263.48 examples/s]Map:  52%|█████▏    | 5191/10042 [00:17<00:17, 276.43 examples/s]Map:  52%|█████▏    | 5225/10042 [00:17<00:16, 289.67 examples/s]Map:  52%|█████▏    | 5259/10042 [00:17<00:15, 300.44 examples/s]Map:  53%|█████▎    | 5292/10042 [00:17<00:15, 307.01 examples/s]Map:  53%|█████▎    | 5326/10042 [00:17<00:15, 312.12 examples/s]Map:  53%|█████▎    | 5359/10042 [00:17<00:14, 314.25 examples/s]Map:  54%|█████▍    | 5408/10042 [00:17<00:14, 315.88 examples/s]Map:  54%|█████▍    | 5442/10042 [00:17<00:14, 318.54 examples/s]Map:  55%|█████▍    | 5475/10042 [00:18<00:14, 318.71 examples/s]Map:  55%|█████▍    | 5508/10042 [00:18<00:14, 318.36 examples/s]Map:  55%|█████▌    | 5540/10042 [00:18<00:14, 318.30 examples/s]Map:  56%|█████▌    | 5574/10042 [00:18<00:13, 319.85 examples/s]Map:  56%|█████▌    | 5622/10042 [00:18<00:13, 318.82 examples/s]Map:  56%|█████▋    | 5655/10042 [00:18<00:13, 318.85 examples/s]Map:  57%|█████▋    | 5687/10042 [00:18<00:13, 317.78 examples/s]Map:  57%|█████▋    | 5720/10042 [00:18<00:13, 317.49 examples/s]Map:  57%|█████▋    | 5752/10042 [00:18<00:13, 315.21 examples/s]Map:  58%|█████▊    | 5785/10042 [00:18<00:13, 315.94 examples/s]Map:  58%|█████▊    | 5818/10042 [00:19<00:13, 317.08 examples/s]Map:  58%|█████▊    | 5850/10042 [00:19<00:13, 316.81 examples/s]Map:  59%|█████▊    | 5882/10042 [00:19<00:13, 316.44 examples/s]Map:  59%|█████▉    | 5914/10042 [00:19<00:13, 316.30 examples/s]Map:  59%|█████▉    | 5947/10042 [00:19<00:12, 317.71 examples/s]Map:  60%|█████▉    | 5981/10042 [00:19<00:12, 318.93 examples/s]Map:  60%|█████▉    | 6015/10042 [00:19<00:20, 194.52 examples/s]Map:  60%|██████    | 6048/10042 [00:20<00:18, 220.54 examples/s]Map:  61%|██████    | 6080/10042 [00:20<00:16, 241.69 examples/s]Map:  61%|██████    | 6112/10042 [00:20<00:15, 259.70 examples/s]Map:  61%|██████    | 6145/10042 [00:20<00:14, 274.31 examples/s]Map:  62%|██████▏   | 6178/10042 [00:20<00:13, 287.33 examples/s]Map:  62%|██████▏   | 6210/10042 [00:20<00:12, 295.52 examples/s]Map:  62%|██████▏   | 6242/10042 [00:20<00:12, 301.83 examples/s]Map:  62%|██████▏   | 6275/10042 [00:20<00:12, 305.47 examples/s]Map:  63%|██████▎   | 6308/10042 [00:20<00:12, 310.15 examples/s]Map:  63%|██████▎   | 6342/10042 [00:20<00:11, 314.89 examples/s]Map:  63%|██████▎   | 6376/10042 [00:21<00:11, 317.86 examples/s]Map:  64%|██████▍   | 6410/10042 [00:21<00:11, 319.87 examples/s]Map:  64%|██████▍   | 6444/10042 [00:21<00:11, 321.75 examples/s]Map:  65%|██████▍   | 6478/10042 [00:21<00:11, 323.76 examples/s]Map:  65%|██████▍   | 6511/10042 [00:21<00:11, 320.90 examples/s]Map:  65%|██████▌   | 6544/10042 [00:21<00:10, 321.70 examples/s]Map:  65%|██████▌   | 6577/10042 [00:21<00:10, 323.08 examples/s]Map:  66%|██████▌   | 6610/10042 [00:21<00:10, 322.33 examples/s]Map:  66%|██████▌   | 6643/10042 [00:21<00:10, 322.07 examples/s]Map:  66%|██████▋   | 6676/10042 [00:21<00:10, 321.72 examples/s]Map:  67%|██████▋   | 6724/10042 [00:22<00:10, 319.00 examples/s]Map:  67%|██████▋   | 6756/10042 [00:22<00:10, 317.60 examples/s]Map:  68%|██████▊   | 6789/10042 [00:22<00:10, 319.16 examples/s]Map:  68%|██████▊   | 6822/10042 [00:22<00:10, 320.11 examples/s]Map:  68%|██████▊   | 6855/10042 [00:22<00:09, 320.08 examples/s]Map:  69%|██████▊   | 6889/10042 [00:22<00:09, 320.41 examples/s]Map:  69%|██████▉   | 6938/10042 [00:22<00:09, 317.59 examples/s]Map:  69%|██████▉   | 6971/10042 [00:22<00:09, 317.55 examples/s]Map:  70%|██████▉   | 7015/10042 [00:23<00:14, 202.97 examples/s]Map:  70%|███████   | 7048/10042 [00:23<00:13, 224.64 examples/s]Map:  71%|███████   | 7082/10042 [00:23<00:12, 245.48 examples/s]Map:  71%|███████   | 7115/10042 [00:23<00:11, 262.77 examples/s]Map:  71%|███████   | 7147/10042 [00:23<00:10, 275.73 examples/s]Map:  72%|███████▏  | 7181/10042 [00:23<00:09, 288.77 examples/s]Map:  72%|███████▏  | 7214/10042 [00:23<00:09, 297.18 examples/s]Map:  72%|███████▏  | 7247/10042 [00:24<00:09, 303.65 examples/s]Map:  72%|███████▏  | 7280/10042 [00:24<00:08, 308.04 examples/s]Map:  73%|███████▎  | 7313/10042 [00:24<00:08, 311.48 examples/s]Map:  73%|███████▎  | 7346/10042 [00:24<00:08, 314.35 examples/s]Map:  73%|███████▎  | 7379/10042 [00:24<00:08, 315.79 examples/s]Map:  74%|███████▍  | 7412/10042 [00:24<00:08, 318.08 examples/s]Map:  74%|███████▍  | 7445/10042 [00:24<00:08, 319.35 examples/s]Map:  74%|███████▍  | 7478/10042 [00:24<00:08, 319.47 examples/s]Map:  75%|███████▍  | 7527/10042 [00:24<00:07, 318.74 examples/s]Map:  75%|███████▌  | 7560/10042 [00:24<00:07, 320.21 examples/s]Map:  76%|███████▌  | 7594/10042 [00:25<00:07, 321.52 examples/s]Map:  76%|███████▌  | 7627/10042 [00:25<00:07, 321.48 examples/s]Map:  76%|███████▋  | 7661/10042 [00:25<00:07, 321.77 examples/s]Map:  77%|███████▋  | 7694/10042 [00:25<00:07, 322.70 examples/s]Map:  77%|███████▋  | 7742/10042 [00:25<00:07, 319.14 examples/s]Map:  77%|███████▋  | 7775/10042 [00:25<00:07, 319.79 examples/s]Map:  78%|███████▊  | 7808/10042 [00:25<00:07, 319.01 examples/s]Map:  78%|███████▊  | 7842/10042 [00:25<00:06, 320.12 examples/s]Map:  78%|███████▊  | 7875/10042 [00:25<00:06, 320.24 examples/s]Map:  79%|███████▉  | 7909/10042 [00:26<00:06, 320.50 examples/s]Map:  79%|███████▉  | 7942/10042 [00:26<00:06, 321.11 examples/s]Map:  79%|███████▉  | 7975/10042 [00:26<00:06, 320.58 examples/s]Map:  80%|███████▉  | 8015/10042 [00:26<00:10, 197.66 examples/s]Map:  80%|████████  | 8049/10042 [00:26<00:08, 223.07 examples/s]Map:  80%|████████  | 8082/10042 [00:26<00:08, 244.60 examples/s]Map:  81%|████████  | 8114/10042 [00:26<00:07, 260.85 examples/s]Map:  81%|████████  | 8148/10042 [00:27<00:06, 278.19 examples/s]Map:  81%|████████▏ | 8180/10042 [00:27<00:06, 286.83 examples/s]Map:  82%|████████▏ | 8213/10042 [00:27<00:06, 296.54 examples/s]Map:  82%|████████▏ | 8247/10042 [00:27<00:05, 304.80 examples/s]Map:  82%|████████▏ | 8279/10042 [00:27<00:05, 308.11 examples/s]Map:  83%|████████▎ | 8312/10042 [00:27<00:05, 311.79 examples/s]Map:  83%|████████▎ | 8345/10042 [00:27<00:05, 314.16 examples/s]Map:  83%|████████▎ | 8378/10042 [00:27<00:05, 315.64 examples/s]Map:  84%|████████▍ | 8411/10042 [00:27<00:05, 316.95 examples/s]Map:  84%|████████▍ | 8445/10042 [00:27<00:05, 318.90 examples/s]Map:  84%|████████▍ | 8478/10042 [00:28<00:04, 320.97 examples/s]Map:  85%|████████▍ | 8511/10042 [00:28<00:04, 320.62 examples/s]Map:  85%|████████▌ | 8545/10042 [00:28<00:04, 320.56 examples/s]Map:  85%|████████▌ | 8578/10042 [00:28<00:04, 321.07 examples/s]Map:  86%|████████▌ | 8611/10042 [00:28<00:04, 319.25 examples/s]Map:  86%|████████▌ | 8644/10042 [00:28<00:04, 319.02 examples/s]Map:  86%|████████▋ | 8677/10042 [00:28<00:04, 319.35 examples/s]Map:  87%|████████▋ | 8710/10042 [00:28<00:04, 319.71 examples/s]Map:  87%|████████▋ | 8743/10042 [00:28<00:04, 319.15 examples/s]Map:  87%|████████▋ | 8775/10042 [00:29<00:03, 318.52 examples/s]Map:  88%|████████▊ | 8808/10042 [00:29<00:03, 318.86 examples/s]Map:  88%|████████▊ | 8840/10042 [00:29<00:03, 318.24 examples/s]Map:  88%|████████▊ | 8874/10042 [00:29<00:03, 319.09 examples/s]Map:  89%|████████▊ | 8906/10042 [00:29<00:03, 317.95 examples/s]Map:  89%|████████▉ | 8939/10042 [00:29<00:03, 316.69 examples/s]Map:  89%|████████▉ | 8971/10042 [00:29<00:03, 317.41 examples/s]Map:  90%|████████▉ | 9015/10042 [00:30<00:05, 191.92 examples/s]Map:  90%|█████████ | 9047/10042 [00:30<00:04, 215.59 examples/s]Map:  90%|█████████ | 9081/10042 [00:30<00:04, 239.62 examples/s]Map:  91%|█████████ | 9115/10042 [00:30<00:03, 259.29 examples/s]Map:  91%|█████████ | 9149/10042 [00:30<00:03, 276.01 examples/s]Map:  91%|█████████▏| 9182/10042 [00:30<00:02, 287.03 examples/s]Map:  92%|█████████▏| 9215/10042 [00:30<00:02, 296.39 examples/s]Map:  92%|█████████▏| 9249/10042 [00:30<00:02, 304.19 examples/s]Map:  92%|█████████▏| 9282/10042 [00:30<00:02, 309.00 examples/s]Map:  93%|█████████▎| 9316/10042 [00:30<00:02, 314.13 examples/s]Map:  93%|█████████▎| 9350/10042 [00:31<00:02, 317.74 examples/s]Map:  93%|█████████▎| 9383/10042 [00:31<00:02, 319.15 examples/s]Map:  94%|█████████▍| 9416/10042 [00:31<00:01, 320.23 examples/s]Map:  94%|█████████▍| 9450/10042 [00:31<00:01, 322.40 examples/s]Map:  94%|█████████▍| 9483/10042 [00:31<00:01, 320.85 examples/s]Map:  95%|█████████▍| 9531/10042 [00:31<00:01, 318.19 examples/s]Map:  95%|█████████▌| 9563/10042 [00:31<00:01, 317.16 examples/s]Map:  96%|█████████▌| 9596/10042 [00:31<00:01, 318.65 examples/s]Map:  96%|█████████▌| 9628/10042 [00:31<00:01, 318.03 examples/s]Map:  96%|█████████▌| 9661/10042 [00:32<00:01, 317.34 examples/s]Map:  97%|█████████▋| 9693/10042 [00:32<00:01, 316.11 examples/s]Map:  97%|█████████▋| 9726/10042 [00:32<00:01, 315.89 examples/s]Map:  97%|█████████▋| 9758/10042 [00:32<00:00, 315.82 examples/s]Map:  98%|█████████▊| 9791/10042 [00:32<00:00, 316.75 examples/s]Map:  98%|█████████▊| 9824/10042 [00:32<00:00, 317.11 examples/s]Map:  98%|█████████▊| 9858/10042 [00:32<00:00, 317.87 examples/s]Map:  98%|█████████▊| 9891/10042 [00:32<00:00, 318.99 examples/s]Map:  99%|█████████▉| 9924/10042 [00:32<00:00, 318.09 examples/s]Map:  99%|█████████▉| 9957/10042 [00:32<00:00, 319.10 examples/s]Map:  99%|█████████▉| 9991/10042 [00:33<00:00, 319.93 examples/s]Map: 100%|█████████▉| 10032/10042 [00:33<00:00, 152.84 examples/s]Map: 100%|██████████| 10042/10042 [00:34<00:00, 292.18 examples/s]
Map:   0%|          | 0/1267 [00:00<?, ? examples/s]Map:   7%|▋         | 83/1267 [00:00<00:01, 819.99 examples/s]Map:  13%|█▎        | 169/1267 [00:00<00:01, 841.44 examples/s]Map:  20%|██        | 257/1267 [00:00<00:01, 854.02 examples/s]Map:  27%|██▋       | 345/1267 [00:00<00:01, 858.07 examples/s]Map:  34%|███▍      | 432/1267 [00:00<00:00, 855.51 examples/s]Map:  41%|████      | 520/1267 [00:00<00:00, 862.41 examples/s]Map:  48%|████▊     | 607/1267 [00:00<00:00, 861.77 examples/s]Map:  55%|█████▍    | 695/1267 [00:00<00:00, 866.10 examples/s]Map:  62%|██████▏   | 783/1267 [00:00<00:00, 866.13 examples/s]Map:  69%|██████▉   | 872/1267 [00:01<00:00, 870.37 examples/s]Map:  76%|███████▌  | 960/1267 [00:01<00:00, 871.19 examples/s]Map:  86%|████████▌ | 1086/1267 [00:01<00:00, 565.79 examples/s]Map:  93%|█████████▎| 1174/1267 [00:01<00:00, 627.55 examples/s]Map: 100%|█████████▉| 1262/1267 [00:01<00:00, 681.50 examples/s]Map: 100%|██████████| 1267/1267 [00:01<00:00, 739.32 examples/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/configuration_auto.py:1111: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.85it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.31it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.64it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.59it/s]
/home/eldar/eldar-upstream/upstream-transformers/src/transformers/models/auto/auto_factory.py:468: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [01:11<02:22, 71.43s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:24<00:37, 37.30s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:34<00:00, 24.89s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:34<00:00, 31.65s/it]
2024-04-27 08:50:42,294: rank0[3844553][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
/home/eldar/eldar-upstream/upstream-composer/composer/trainer/trainer.py:1163: UserWarning: No optimizer was specified. Defaulting to DecoupledSGDW(lr=0.1)
  warnings.warn((
2024-04-27 08:50:42,296: rank0[3844553][MainThread]: INFO: composer.trainer.trainer: Run name: openllm_seqlen2048_perdeviceBS16_worldsize4
2024-04-27 08:50:43,637: rank0[3844553][MainThread]: INFO: composer.trainer.trainer: Stepping schedulers every batch. To step schedulers every epoch, set `step_schedulers_every_batch=False`.
2024-04-27 08:50:43,657: rank0[3844553][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
2024-04-27 08:51:08,914: rank0[3844553][MainThread]: DEBUG: composer.utils.reproducibility: Restoring the RNG state
2024-04-27 08:51:08,914: rank0[3844553][MainThread]: INFO: composer.trainer.trainer: Setting seed to 42
2024-04-27 08:51:08,914: rank0[3844553][MainThread]: INFO: composer.utils.reproducibility: Setting seed to 42
max_seq_len: 2048
precision: amp_bf16
device_eval_batch_size: 16
global_seed: 42
seed: 42
ckpt_path: /network/eldar/cerebras/Llama-2-7b-pruned50-retrained
models:
- model_name: /network/eldar/cerebras/Llama-2-7b-pruned50-retrained
  model:
    name: hf_causal_lm
    use_flash_attention_2: true
    pretrained: true
    pretrained_model_name_or_path: /network/eldar/cerebras/Llama-2-7b-pruned50-retrained
    use_auth_token: true
  tokenizer:
    name: /network/eldar/cerebras/Llama-2-7b-pruned50-retrained
    kwargs:
      model_max_length: 2048
fsdp_config:
  sharding_strategy: FULL_SHARD
  mixed_precision: PURE
  activation_checkpointing: false
  activation_checkpointing_reentrant: false
  activation_cpu_offload: false
  limit_all_gathers: true
icl_tasks: eval/yamls/openllm.yaml

2024-04-27 08:51:08,920: rank0[3844553][MainThread]: INFO: composer.trainer.trainer: Added ['arc_challenge/25-shot', 'mmlu/5-shot', 'hellaswag/10-shot', 'winogrande/5-shot'] to eval_metrics.
******************************
Config:
composer_commit_hash: None
composer_version: 0.20.1
node_name: unknown because NODENAME environment variable not set
num_gpus_per_node: 4
num_nodes: 1
rank_zero_seed: 42

******************************
[Eval batch=1/74] Eval on arc_challenge/25-shot data
[Eval batch=8/74] Eval on arc_challenge/25-shot data
[Eval batch=16/74] Eval on arc_challenge/25-shot data
[Eval batch=23/74] Eval on arc_challenge/25-shot data
[Eval batch=30/74] Eval on arc_challenge/25-shot data
[Eval batch=38/74] Eval on arc_challenge/25-shot data
[Eval batch=45/74] Eval on arc_challenge/25-shot data
[Eval batch=52/74] Eval on arc_challenge/25-shot data
[Eval batch=59/74] Eval on arc_challenge/25-shot data
[Eval batch=67/74] Eval on arc_challenge/25-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 4 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 1 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=74/74] Eval on arc_challenge/25-shot data:
	 Eval metrics/arc_challenge/25-shot/InContextLearningMultipleChoiceAccuracy: 0.4906
[Eval batch=1/878] Eval on mmlu/5-shot data
[Eval batch=89/878] Eval on mmlu/5-shot data
[Eval batch=176/878] Eval on mmlu/5-shot data
[Eval batch=264/878] Eval on mmlu/5-shot data
[Eval batch=352/878] Eval on mmlu/5-shot data
[Eval batch=440/878] Eval on mmlu/5-shot data
[Eval batch=527/878] Eval on mmlu/5-shot data
[Eval batch=615/878] Eval on mmlu/5-shot data
[Eval batch=703/878] Eval on mmlu/5-shot data
[Eval batch=790/878] Eval on mmlu/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 12 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 3 into batches of size 4. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=878/878] Eval on mmlu/5-shot data:
	 Eval metrics/mmlu/5-shot/InContextLearningMultipleChoiceAccuracy: 0.3701
[Eval batch=1/628] Eval on hellaswag/10-shot data
[Eval batch=64/628] Eval on hellaswag/10-shot data
[Eval batch=126/628] Eval on hellaswag/10-shot data
[Eval batch=189/628] Eval on hellaswag/10-shot data
[Eval batch=252/628] Eval on hellaswag/10-shot data
[Eval batch=314/628] Eval on hellaswag/10-shot data
[Eval batch=377/628] Eval on hellaswag/10-shot data
[Eval batch=440/628] Eval on hellaswag/10-shot data
[Eval batch=503/628] Eval on hellaswag/10-shot data
[Eval batch=565/628] Eval on hellaswag/10-shot data
[Eval batch=628/628] Eval on hellaswag/10-shot data:
	 Eval metrics/hellaswag/10-shot/InContextLearningMultipleChoiceAccuracy: 0.7540
[Eval batch=1/40] Eval on winogrande/5-shot data
[Eval batch=5/40] Eval on winogrande/5-shot data
[Eval batch=9/40] Eval on winogrande/5-shot data
[Eval batch=13/40] Eval on winogrande/5-shot data
[Eval batch=17/40] Eval on winogrande/5-shot data
[Eval batch=20/40] Eval on winogrande/5-shot data
[Eval batch=24/40] Eval on winogrande/5-shot data
[Eval batch=28/40] Eval on winogrande/5-shot data
[Eval batch=32/40] Eval on winogrande/5-shot data
[Eval batch=36/40] Eval on winogrande/5-shot data
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:37: UserWarning: Cannot split tensor of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 10 into batches of size 16. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
/home/eldar/eldar-upstream/upstream-composer/composer/core/data_spec.py:26: UserWarning: Cannot split list of length 5 into batches of size 8. As it is smaller, no splitting will be done. This may happen on the last batch of a dataset if it is a smaller size than the microbatch size.
  warnings.warn(
[Eval batch=40/40] Eval on winogrande/5-shot data:
	 Eval metrics/winogrande/5-shot/InContextLearningMultipleChoiceAccuracy: 0.7096
Printing complete results for all models
| Category   | Benchmark     | Subtask   |   Accuracy | Number few shot   | Model                                                 |
|:-----------|:--------------|:----------|-----------:|:------------------|:------------------------------------------------------|
|            | arc_challenge |           |   0.490614 | 25-shot           | /network/eldar/cerebras/Llama-2-7b-pruned50-retrained |
|            | mmlu          |           |   0.370104 | 5-shot            | /network/eldar/cerebras/Llama-2-7b-pruned50-retrained |
|            | winogrande    |           |   0.70955  | 5-shot            | /network/eldar/cerebras/Llama-2-7b-pruned50-retrained |
|            | hellaswag     |           |   0.754033 | 10-shot           | /network/eldar/cerebras/Llama-2-7b-pruned50-retrained |
2024-04-27 09:51:54,030: rank0[3844553][MainThread]: DEBUG: composer.core.engine: Closing the engine.
2024-04-27 09:51:54,030: rank0[3844553][MainThread]: DEBUG: composer.core.engine: Closing callback ConsoleLogger
2024-04-27 09:51:54,030: rank0[3844553][MainThread]: DEBUG: composer.core.engine: Post-closing callback ConsoleLogger
2024-04-27 09:51:54,030: rank0[3844553][MainThread]: DEBUG: composer.core.engine: Engine closed.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
